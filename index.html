<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
<meta property="og:type" content="website">
<meta property="og:title" content="XiSun的博客">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="XiSun的博客">
<meta property="og:description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="XiSun">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>XiSun的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">XiSun的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Learning is endless</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/04/git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/04/git/" class="post-title-link" itemprop="url">Gitlab 代码开发的使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-04 11:28:46" itemprop="dateCreated datePublished" datetime="2022-01-04T11:28:46+08:00">2022-01-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-14 16:28:57" itemprop="dateModified" datetime="2022-01-14T16:28:57+08:00">2022-01-14</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>723</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Gitlab-代码开发的一般流程"><a href="#Gitlab-代码开发的一般流程" class="headerlink" title="Gitlab 代码开发的一般流程"></a>Gitlab 代码开发的一般流程</h2><ul>
<li>PM（项目主管/项目经理） 在 Gitlab 创建任务，分配给开发人员；</li>
<li>开发人员领取任务后，在本地使用 <code>git clone</code> 命令拉取代码库；</li>
<li>开发人员创建开发分支，并进行开发；</li>
<li>开发人员完成代码之后，提交到本地仓库；</li>
<li>开发人员在 Gitlab 界面上申请分支合并请求；</li>
<li>PM 在 Gitlab 上查看代码提交和修改情况，确认无误后，将开发人员的分支合并到主分支（master）。</li>
<li>开发人员在 Gitlab 上 Mark done 确认开发完成，并关闭 issue。这一步在提交合并请求时，可以通过描述中填写 “close #1” 等字样，直接关闭 issue。</li>
</ul>
<h2 id="Gitlab-常用命令"><a href="#Gitlab-常用命令" class="headerlink" title="Gitlab 常用命令"></a>Gitlab 常用命令</h2><ul>
<li><p>拉取远程仓库的代码到本地：<code>git pull &lt;REMOTENAME&gt; &lt;BRANCHNAME&gt;</code>。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git pull origin master				# 远程仓库：origin，分支：master</span><br></pre></td></tr></table></figure>

<ul>
<li>不建议使用 <code>git pull</code> 这种模糊的命令。</li>
</ul>
</li>
<li><p>推送本地代码到远程仓库：<code>git push &lt;REMOTENAME&gt; &lt;BRANCHNAME&gt;</code>。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git add .								# 添加待提交的代码到本地库，.可以替换为指定的代码文件或文件夹</span><br><span class="line"></span><br><span class="line">$ git commit -m &#39;definition message&#39;	# 提交本地库代码，并附加提交的信息</span><br><span class="line"></span><br><span class="line">$ git push origin master				# 推送代码到远程仓库：origin，分支：master</span><br></pre></td></tr></table></figure>

<ul>
<li>不建议使用 <code>git push</code> 这种模糊的命令。</li>
</ul>
</li>
<li><p>s</p>
</li>
</ul>
<h2 id="Gitlab-创建分支"><a href="#Gitlab-创建分支" class="headerlink" title="Gitlab 创建分支"></a>Gitlab 创建分支</h2><ul>
<li><p>创建新分支：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>切换分支：</p>
</li>
<li><p>查看分支：</p>
</li>
</ul>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41287260/article/details/89743120">https://blog.csdn.net/weixin_41287260/article/details/89743120</a></li>
<li>s</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/04/java-md5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/04/java-md5/" class="post-title-link" itemprop="url">java-md5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-01-04 10:51:22 / 修改时间：10:52:52" itemprop="dateCreated datePublished" datetime="2022-01-04T10:51:22+08:00">2022-01-04</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>62</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="JA"><a href="#JA" class="headerlink" title="JA"></a>JA</h2><p>java 获取 md5 的四种方法：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/pcheng/p/7724863.html">https://www.cnblogs.com/pcheng/p/7724863.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/12/21/ceph/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/21/ceph/" class="post-title-link" itemprop="url">Ceph 入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-12-21 15:59:22" itemprop="dateCreated datePublished" datetime="2021-12-21T15:59:22+08:00">2021-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-25 14:24:07" itemprop="dateModified" datetime="2022-01-25T14:24:07+08:00">2022-01-25</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>97k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:28</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="CentOS-安装-Ceph"><a href="#CentOS-安装-Ceph" class="headerlink" title="CentOS  安装 Ceph"></a>CentOS  安装 Ceph</h2><h3 id="节点规划"><a href="#节点规划" class="headerlink" title="节点规划"></a>节点规划</h3><ul>
<li><p>各节点规划：</p>
<table>
<thead>
<tr>
<th>主机名</th>
<th>ip</th>
<th>磁盘</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>hadoop102</td>
<td>192.168.10.102</td>
<td>系统盘：sda<br>osd盘：sdb</td>
<td>cephadm，monitor，mgr，rgw，mds，osd，nfs</td>
</tr>
<tr>
<td>hadoop103</td>
<td>192.168.10.103</td>
<td>系统盘：sda<br>osd盘：sdb</td>
<td>monitor，mgr，rgw，mds，osd，nfs</td>
</tr>
<tr>
<td>hadoop104</td>
<td>192.168.10.104</td>
<td>系统盘：sda<br>osd盘：sdb</td>
<td>monitor，mgr，rgw，mds，osd，nfs</td>
</tr>
</tbody></table>
</li>
<li><p>各节点内核版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# uname -r</span><br><span class="line">3.10.0-1160.49.1.el7.x86_64</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点操作系统版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# cat /etc/redhat-release</span><br><span class="line">CentOS Linux release 7.9.2009 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点配置 CentOS 7 yum 阿里云镜像源：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清空缓存</span></span><br><span class="line">[root@hadoop102 opt]# yum clean cache</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成缓存</span></span><br><span class="line">[root@hadoop102 opt]# yum makecache</span><br></pre></td></tr></table></figure>

<ul>
<li><p>执行命令 <code>curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code>，会把 Centos-7.repo 下载到 <code>/etc/yum.repos.d/</code> 目录下，如果该目录下有 CentOS-Base.repo，则会自动覆盖。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# ll /etc/yum.repos.d/</span><br><span class="line">总用量 56</span><br><span class="line">-rw-r--r--. 1 root root 2523 12月 21 14:16 CentOS-Base.repo						# yum源</span><br><span class="line">-rw-r--r--. 1 root root 1309 11月 23 2020 CentOS-CR.repo</span><br><span class="line">-rw-r--r--. 1 root root  649 11月 23 2020 CentOS-Debuginfo.repo</span><br><span class="line">-rw-r--r--. 1 root root  314 11月 23 2020 CentOS-fasttrack.repo</span><br><span class="line">-rw-r--r--. 1 root root  630 11月 23 2020 CentOS-Media.repo</span><br><span class="line">-rw-r--r--. 1 root root 1331 11月 23 2020 CentOS-Sources.repo</span><br><span class="line">-rw-r--r--. 1 root root 8515 11月 23 2020 CentOS-Vault.repo</span><br><span class="line">-rw-r--r--. 1 root root  616 11月 23 2020 CentOS-x86_64-kernel.repo</span><br><span class="line">-rw-r--r--. 1 root root  477 12月 21 15:38 ceph.repo								# ceph源</span><br><span class="line">-rw-r--r--. 1 root root 2081 12月 20 12:37 docker-ce.repo						# docker源</span><br><span class="line">-rw-r--r--. 1 root root 1358 9月   5 01:37 epel.repo</span><br><span class="line">-rw-r--r--. 1 root root 1457 9月   5 01:37 epel-testing.repo</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>各节点更新 yum 包（生产环境中此步操作需慎重，看自己情况，学习的话随便搞，这个命令不是必须执行的）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# yum -y update</span><br><span class="line">[root@hadoop102 opt]# yum -y upgrade</span><br></pre></td></tr></table></figure>

<ul>
<li><code>yum -y update</code>：升级所有包，也升级软件和系统内核。</li>
<li><code>yum -y upgrade</code>：升级所有包，但不升级软件和系统内核。</li>
</ul>
</li>
<li><p>各节点配置主机名：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# vim /etc/hostname</span><br><span class="line">[root@hadoop102 opt]# cat /etc/hostname</span><br><span class="line">hadoop102</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点配置 host 解析：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# vim /etc/hosts</span><br><span class="line">[root@hadoop102 opt]# cat /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"></span><br><span class="line">192.168.10.99 centos7</span><br><span class="line">192.168.10.100 hadoop100</span><br><span class="line">192.168.10.101 hadoop101</span><br><span class="line">192.168.10.102 hadoop102</span><br><span class="line">192.168.10.103 hadoop103</span><br><span class="line">192.168.10.104 hadoop104</span><br><span class="line">192.168.10.105 hadoop105</span><br><span class="line">192.168.10.106 hadoop106</span><br><span class="line">192.168.10.107 hadoop107</span><br><span class="line">192.168.10.108 hadoop108</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><ul>
<li><p>关闭防火墙：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 xisun]# systemctl stop firewalld.service</span><br><span class="line">[root@hadoop102 xisun]# firewall-cmd --state</span><br><span class="line">not running</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙开机自启：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 xisun]# systemctl disable firewalld.service </span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看防火墙是否开机自启</span></span><br><span class="line">[root@hadoop102 opt]#  systemctl list-unit-files | grep firewalld.service </span><br><span class="line">firewalld.service                             disabled</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="SSH-免密登录"><a href="#SSH-免密登录" class="headerlink" title="SSH 免密登录"></a>SSH 免密登录</h3><h3 id="服务器时间同步"><a href="#服务器时间同步" class="headerlink" title="服务器时间同步"></a>服务器时间同步</h3><ul>
<li>在 Linux 系统中，可以通过 ntpdate 和 ntpd 两种方式实现 NTP 时间同步，ntpdate 为断点更新，ntpd 为步进式地逐渐调整时间。对于新服务器，可以使用 ntpdate 同步时间，对于已经承载有运行中业务的服务器，建议使用 ntpd 同步时间。</li>
<li>直接同步：使用 ntpdate 命令进行同步，直接进行时间变更。如果服务器上存在一个 12 点运行的任务，当前服务器时间是 13 点，但标准时间时 11 点，使用此命令可能会造成任务重复执行。因此使用 ntpdate 同步可能会引发风险，该命令也多用于配置时钟同步服务时第一次同步时间时使用。</li>
<li>平滑同步：使用 ntpd 进行时钟同步，可以保证一个时间不经历两次，它每次同步时间的偏移量不会太陡，是慢慢来的，这正因为这样，ntpd 平滑同步可能耗费的时间比较长。</li>
</ul>
<h4 id="NTP-服务器配置"><a href="#NTP-服务器配置" class="headerlink" title="NTP 服务器配置"></a>NTP 服务器配置</h4><ul>
<li><p>寻找 NTP Server，<a target="_blank" rel="noopener" href="https://www.ntppool.org/">https://www.ntppool.org/</a> 是 NTP 的官方网站，在这上面我们可以找到离我们城市最近的 NTP Server。NTP 建议我们为了保障时间的准确性，最少找两个 NTP Server。我们找到对应的中国 NTP Server：</p>
<p><img src="/2021/12/21/ceph/image-20211222150302860.png" alt="image-20211222150302860"></p>
</li>
<li><p>也可以在 <a target="_blank" rel="noopener" href="http://www.ntp.org.cn/">http://www.ntp.org.cn/</a> 网站查找 NTP Server，推荐使用域名，而非 IP 地址。后面的 NTP 服务器配置，以下图为准：</p>
<p><img src="/2021/12/21/ceph/image-20211222151324901.png" alt="image-20211222151324901"></p>
</li>
<li><p>设置时区：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 设置东八区</span></span><br><span class="line">[root@hadoop102 opt]# timedatectl set-timezone Asia/Shanghai</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看时区</span></span><br><span class="line">[root@hadoop102 opt]# timedatectl status | grep &#x27;Time zone&#x27;</span><br><span class="line">       Time zone: Asia/Shanghai (CST, +0800)</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查系统是否安装了 NTP 服务：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# rpm -qa | grep ntp</span><br><span class="line">python-ntplib-0.3.2-1.el7.noarch</span><br><span class="line">ntpdate-4.2.6p5-29.el7.centos.2.x86_64</span><br><span class="line">ntp-4.2.6p5-29.el7.centos.2.x86_64</span><br><span class="line">fontpackages-filesystem-1.44-8.el7.noarch</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果没有安装，使用下面的命令安装 ntp 和 ntpdate：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# yum -y install ntp ntpdate</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据 NTP 的设置，如果你的系统时间比正确时间快，那么 NTP 是不会帮你调整的，所以要么你把时间设置回去，要么先做一个手动同步，使用下面的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# ntpdate cn.ntp.org.cn</span><br><span class="line">22 Dec 15:09:33 ntpdate[5303]: adjust time server 114.67.237.130 offset -0.010511 sec</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 NTP 服务器（设定 hadoop102 为 NTP 服务器），NTP 服务器主配置文件 <code>/etc/ntp.conf</code>，配置前做好备份：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# mkdir /home/backup</span><br><span class="line">[root@hadoop102 opt]# cp /etc/ntp.conf /home/backup/</span><br><span class="line">[root@hadoop102 opt]# mv /home/backup/ntp.conf /home/backup/ntp.conf.bak</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 NTP 服务器端配置文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# vim /etc/ntp.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2021/12/21/ceph/image-20211222154745752.png" alt="image-20211222154745752"></p>
<ul>
<li><p>restrict 语法说明：</p>
<p><img src="/2021/12/21/ceph/image-20211222155420355.png" alt="image-20211222155420355"></p>
</li>
<li><p>如果服务器是内网，不能连接外网，则无法使用网络 NTP Server，此时可以将本机作为 NTP Server，按如下方法配置：</p>
<p><img src="/2021/12/21/ceph/image-20211222155356339.png" alt="image-20211222155356339"></p>
</li>
</ul>
</li>
<li><p>ntp 服务，默认只会同步系统时间。如果想要让 ntp 同时同步硬件时间，可以在 <code>/etc/sysconfig/ntpd</code> 文件中，添加 <code>SYNC_HWCLOCK=yes</code>，这样，就可以让硬件时间与系统时间一起同步：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# vim /etc/sysconfig/ntpd</span><br></pre></td></tr></table></figure>

<p><img src="/2021/12/21/ceph/image-20211223154742836.png" alt="image-20211223154742836"></p>
</li>
<li><p>启动 NTP 服务并设置开机自动启动。(Linux 防火墙需要关闭，否则会阻止 NTP 服务端口，NTP 服务默认端口 123)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动ntp服务</span></span><br><span class="line">[root@hadoop102 opt]# systemctl start ntpd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看ntp服务是否启动</span></span><br><span class="line">[root@hadoop102 opt]# systemctl status ntpd</span><br><span class="line">● ntpd.service - Network Time Service</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/ntpd.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since 三 2021-12-22 16:00:12 CST; 1min 27s ago</span><br><span class="line">  Process: 5883 ExecStart=/usr/sbin/ntpd -u ntp:ntp $OPTIONS (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 5884 (ntpd)</span><br><span class="line">    Tasks: 1</span><br><span class="line">   CGroup: /system.slice/ntpd.service</span><br><span class="line">           └─5884 /usr/sbin/ntpd -u ntp:ntp -g</span><br><span class="line"></span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listen and drop on 1 v6wildcard :: UDP 123</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listen normally on 2 lo 127.0.0.1 UDP 123</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listen normally on 3 ens33 192.168.10.102 UDP 123</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listen normally on 4 virbr0 192.168.122.1 UDP 123</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listen normally on 5 lo ::1 UDP 123</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listen normally on 6 ens33 fe80::ac1e:7fe1:a566:2670 UDP 123</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: Listening on routing socket on fd #23 for interface updates</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: 0.0.0.0 c016 06 restart</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: 0.0.0.0 c012 02 freq_set kernel 0.000 PPM</span><br><span class="line">12月 22 16:00:13 hadoop102 ntpd[5884]: 0.0.0.0 c011 01 freq_not_set</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看ntpd端口</span></span><br><span class="line">[root@hadoop102 opt]# netstat -ln | grep 123</span><br><span class="line">udp        0      0 192.168.122.1:123       0.0.0.0:*                          </span><br><span class="line">udp        0      0 192.168.10.102:123      0.0.0.0:*                          </span><br><span class="line">udp        0      0 127.0.0.1:123           0.0.0.0:*                          </span><br><span class="line">udp        0      0 0.0.0.0:123             0.0.0.0:*                          </span><br><span class="line">udp6       0      0 fe80::ac1e:7fe1:a56:123 :::*                               </span><br><span class="line">udp6       0      0 ::1:123                 :::*                               </span><br><span class="line">udp6       0      0 :::123                  :::*</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看ntp服务是否开机启动</span></span><br><span class="line">[root@hadoop102 opt]# systemctl list-unit-files | grep ntpd</span><br><span class="line">ntpd.service                                  disabled</span><br><span class="line">ntpdate.service                               disabled</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置开机启动ntp服务</span></span><br><span class="line">[root@hadoop102 opt]# systemctl enable ntpd</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/ntpd.service to /usr/lib/systemd/system/ntpd.service.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认ntp服务开机启动设置成功</span></span><br><span class="line">[root@hadoop102 opt]# systemctl list-unit-files | grep ntpd</span><br><span class="line">ntpd.service                                  enabled </span><br><span class="line">ntpdate.service                               disabled</span><br></pre></td></tr></table></figure>

<ul>
<li><p>如果是重启 ntpd 服务，使用下面的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# systemctl restart ntpd</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>查看 NTP 服务器与外部 NTP 服务器同步情况：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 静态查看</span></span><br><span class="line">[root@hadoop102 opt]# ntpq -p</span><br><span class="line">     remote           refid      st t when poll reach   delay   offset  jitter</span><br><span class="line">==============================================================================</span><br><span class="line"> 2001:da8:9000:: .STEP.          16 -    -  512    0    0.000    0.000   0.000</span><br><span class="line">*202.118.1.130   .PTP.            1 u   14   64  277   39.772  -39.060   5.282</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 动态查看，一般ntp启动后，需要等5~10分钟左右，NTP服务器才会与外部NTP服务器同步</span></span><br><span class="line">[root@hadoop102 opt]# watch ntpq  -p</span><br></pre></td></tr></table></figure>

<p><img src="/2021/12/21/ceph/image-20211222162602332.png" alt="image-20211222162602332"></p>
<ul>
<li>remote：即网络 NTP 服务器的 IP 或主机名称。注意最左边的符号，如果有 <code>+</code>，则代表目前正在作用中的上层 NTP 服务器；如果是 <code>*</code>，则表示也有连上线，不过是作为次要联机的 NTP 服务器。</li>
<li>refid：参考的上一层 NTP 服务器的地址。</li>
<li>st：即 stratum 阶层，值越小表示 NTP Server 的精准度越高。</li>
<li>when：几秒前曾做过时间同步更新的操作。</li>
<li>poll：每隔多少毫秒与 NTP Server 同步一次。</li>
<li>reach：已经向上层 NTP 服务器要求更新的次数。</li>
<li>delay：网络传输过程中延迟的时间。</li>
<li>offset：时间补偿的结果。</li>
<li>jitter：Linux 系统时间与 BIOS 硬件时间的差异时间。</li>
</ul>
</li>
<li><p>查看系统时间和硬件时间：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 系统时间</span></span><br><span class="line">[root@hadoop102 opt]# date</span><br><span class="line">2021年 12月 23日 星期四 16:28:10 CST</span><br><span class="line"><span class="meta">#</span><span class="bash"> 硬件时间</span></span><br><span class="line">[root@hadoop102 opt]# hwclock --show</span><br><span class="line">2021年12月23日 星期四 16时28分15秒  -0.631618 秒</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h4><ul>
<li><p>设置时区：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 设置东八区</span></span><br><span class="line">[root@hadoop103 opt]# timedatectl set-timezone Asia/Shanghai</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看时区</span></span><br><span class="line">[root@hadoop103 opt]# timedatectl status | grep &#x27;Time zone&#x27;</span><br><span class="line">       Time zone: Asia/Shanghai (CST, +0800)</span><br></pre></td></tr></table></figure>
</li>
<li><p>客户端向 NTP 服务器（192.168.10.102）更新时间时，客户端不需要开启 NTP 服务：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# systemctl stop ntpd</span><br><span class="line">[root@hadoop103 opt]# systemctl status ntpd</span><br><span class="line">● ntpd.service - Network Time Service</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/ntpd.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line"></span><br><span class="line">12月 23 11:11:08 hadoop103 ntpd[18278]: Listening on routing socket on fd #24 for interface updates</span><br><span class="line">12月 23 11:11:10 hadoop103 ntpd[18278]: 0.0.0.0 c016 06 restart</span><br><span class="line">12月 23 11:11:10 hadoop103 ntpd[18278]: 0.0.0.0 c012 02 freq_set kernel 0.000 PPM</span><br><span class="line">12月 23 11:11:10 hadoop103 ntpd[18278]: 0.0.0.0 c011 01 freq_not_set</span><br><span class="line">12月 23 11:11:16 hadoop103 ntpd[18278]: 0.0.0.0 c61c 0c clock_step -3.147226 s</span><br><span class="line">12月 23 11:11:13 hadoop103 ntpd[18278]: 0.0.0.0 c614 04 freq_mode</span><br><span class="line">12月 23 11:11:14 hadoop103 ntpd[18278]: 0.0.0.0 c618 08 no_sys_peer</span><br><span class="line">12月 23 11:16:42 hadoop103 ntpd[18278]: ntpd exiting on signal 15</span><br><span class="line">12月 23 11:16:42 hadoop103 systemd[1]: Stopping Network Time Service...</span><br><span class="line">12月 23 11:16:42 hadoop103 systemd[1]: Stopped Network Time Service.</span><br></pre></td></tr></table></figure>
</li>
<li><p>客户端向 NTP 服务器（192.168.10.102）进行时间同步：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# ntpdate -u 192.168.10.102</span><br><span class="line">23 Dec 11:16:57 ntpdate[18349]: adjust time server 192.168.10.102 offset -0.003982 sec</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置 ntpdate 每次同步系统时间之后，也一并同步硬件时间：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# vim /etc/sysconfig/ntpdate</span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改 ntpdate 文件最后一行 <code>SYNC_HWCLOCK=no</code> 为 <code>SYNC_HWCLOCK=yes</code>：</p>
<p><img src="/2021/12/21/ceph/image-20211223115230538.png" alt="image-20211223115230538"></p>
</li>
</ul>
</li>
<li><p>设置客户端定时向 NTP 服务器（192.168.10.102）进行时间同步：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# vim /etc/crontab</span><br></pre></td></tr></table></figure>

<ul>
<li><p>向 crontab 文件中添加配置，每天早晨 6 点同步一次时间：</p>
<p><img src="/2021/12/21/ceph/image-20211223134042762.png" alt="image-20211223134042762"></p>
</li>
</ul>
</li>
<li><p>重启 crond 服务：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# systemctl restart crond.service</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 crond 服务执行情况：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# systemctl status crond.service </span><br><span class="line">● crond.service - Command Scheduler</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/crond.service; enabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since 四 2021-12-23 13:41:42 CST; 4min 33s ago</span><br><span class="line"> Main PID: 20442 (crond)</span><br><span class="line">    Tasks: 1</span><br><span class="line">   Memory: 644.0K</span><br><span class="line">   CGroup: /system.slice/crond.service</span><br><span class="line">           └─20442 /usr/sbin/crond -n</span><br><span class="line"></span><br><span class="line">12月 23 13:41:42 hadoop103 systemd[1]: Started Command Scheduler.</span><br><span class="line">12月 23 13:41:42 hadoop103 crond[20442]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 33% if used.)</span><br><span class="line">12月 23 13:41:43 hadoop103 crond[20442]: (CRON) INFO (running with inotify support)</span><br><span class="line">12月 23 13:41:43 hadoop103 crond[20442]: (CRON) INFO (@reboot jobs will be run at computer&#x27;s startup.)</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看系统时间和硬件时间：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 系统时间</span></span><br><span class="line">[root@hadoop103 opt]# date </span><br><span class="line">2021年 12月 23日 星期四 16:30:22 CST</span><br><span class="line"><span class="meta">#</span><span class="bash"> 硬件时间</span></span><br><span class="line">[root@hadoop103 opt]# hwclock </span><br><span class="line">2021年12月23日 星期四 16时30分29秒  -1.020610 秒</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul>
<li><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/5615">https://developer.aliyun.com/article/5615</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/aa2bb27debd9">https://www.jianshu.com/p/aa2bb27debd9</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zoulongbin/p/6198186.html">https://www.cnblogs.com/zoulongbin/p/6198186.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/16e68204b3dc">https://www.jianshu.com/p/16e68204b3dc</a></li>
</ul>
<h3 id="安装-Python3"><a href="#安装-Python3" class="headerlink" title="安装 Python3"></a>安装 Python3</h3><ul>
<li><p>Ceph 的 Octopus 版本需要 Python3 支持。</p>
</li>
<li><p>各节点检查是否有 GCC：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看gcc版本</span></span><br><span class="line">[root@hadoop101 software]# gcc --version</span><br><span class="line">bash: gcc: 未找到命令...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装gcc</span></span><br><span class="line">[root@hadoop101 software]# yum -y install gcc</span><br><span class="line">已加载插件：fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Could not get metalink https://mirrors.fedoraproject.org/metalink?repo=epel-7&amp;arch=x86_64&amp;infra=stock&amp;content=centos error was</span><br><span class="line">14: curl#7 - &quot;Failed to connect to 2406:da18:39f:a01:35a2:d9e9:8164:a209: 网络不可达&quot;</span><br><span class="line"> * base: mirrors.aliyun.com</span><br><span class="line"> * epel: mirror.sjtu.edu.cn</span><br><span class="line"> * extras: mirrors.aliyun.com</span><br><span class="line"> * updates: mirrors.aliyun.com</span><br><span class="line">正在解决依赖关系</span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在检查事务</span></span><br><span class="line"><span class="meta">---&gt;</span><span class="bash"> 软件包 gcc.x86_64.0.4.8.5-44.el7 将被 安装</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在处理依赖关系 cpp = 4.8.5-44.el7，它被软件包 gcc-4.8.5-44.el7.x86_64 需要</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在处理依赖关系 glibc-devel &gt;= 2.2.90-12，它被软件包 gcc-4.8.5-44.el7.x86_64 需要</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在检查事务</span></span><br><span class="line"><span class="meta">---&gt;</span><span class="bash"> 软件包 cpp.x86_64.0.4.8.5-44.el7 将被 安装</span></span><br><span class="line"><span class="meta">---&gt;</span><span class="bash"> 软件包 glibc-devel.x86_64.0.2.17-325.el7_9 将被 安装</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在处理依赖关系 glibc-headers = 2.17-325.el7_9，它被软件包 glibc-devel-2.17-325.el7_9.x86_64 需要</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在处理依赖关系 glibc-headers，它被软件包 glibc-devel-2.17-325.el7_9.x86_64 需要</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在检查事务</span></span><br><span class="line"><span class="meta">---&gt;</span><span class="bash"> 软件包 glibc-headers.x86_64.0.2.17-325.el7_9 将被 安装</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在处理依赖关系 kernel-headers &gt;= 2.2.1，它被软件包 glibc-headers-2.17-325.el7_9.x86_64 需要</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在处理依赖关系 kernel-headers，它被软件包 glibc-headers-2.17-325.el7_9.x86_64 需要</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 正在检查事务</span></span><br><span class="line"><span class="meta">---&gt;</span><span class="bash"> 软件包 kernel-headers.x86_64.0.3.10.0-1160.49.1.el7 将被 安装</span></span><br><span class="line"><span class="meta">--&gt;</span><span class="bash"> 解决依赖关系完成</span></span><br><span class="line"></span><br><span class="line">依赖关系解决</span><br><span class="line"></span><br><span class="line">========================================================================================================================================================================================================</span><br><span class="line"> Package                                           架构                                      版本                                                      源                                          大小</span><br><span class="line">========================================================================================================================================================================================================</span><br><span class="line">正在安装:</span><br><span class="line"> gcc                                               x86_64                                    4.8.5-44.el7                                              base                                        16 M</span><br><span class="line">为依赖而安装:</span><br><span class="line"> cpp                                               x86_64                                    4.8.5-44.el7                                              base                                       5.9 M</span><br><span class="line"> glibc-devel                                       x86_64                                    2.17-325.el7_9                                            updates                                    1.1 M</span><br><span class="line"> glibc-headers                                     x86_64                                    2.17-325.el7_9                                            updates                                    691 k</span><br><span class="line"> kernel-headers                                    x86_64                                    3.10.0-1160.49.1.el7                                      updates                                    9.0 M</span><br><span class="line"></span><br><span class="line">事务概要</span><br><span class="line">========================================================================================================================================================================================================</span><br><span class="line">安装  1 软件包 (+4 依赖软件包)</span><br><span class="line"></span><br><span class="line">总计：33 M</span><br><span class="line">总下载量：1.1 M</span><br><span class="line">安装大小：59 M</span><br><span class="line">Downloading packages:</span><br><span class="line">No Presto metadata available for updates</span><br><span class="line">glibc-devel-2.17-325.el7_9.x86_64.rpm                                                                                                                                            | 1.1 MB  00:00:00     </span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  正在安装    : cpp-4.8.5-44.el7.x86_64                                                                                                                                                             1/5 </span><br><span class="line">  正在安装    : kernel-headers-3.10.0-1160.49.1.el7.x86_64                                                                                                                                          2/5 </span><br><span class="line">  正在安装    : glibc-headers-2.17-325.el7_9.x86_64                                                                                                                                                 3/5 </span><br><span class="line">  正在安装    : glibc-devel-2.17-325.el7_9.x86_64                                                                                                                                                   4/5 </span><br><span class="line">  正在安装    : gcc-4.8.5-44.el7.x86_64                                                                                                                                                             5/5 </span><br><span class="line">  验证中      : gcc-4.8.5-44.el7.x86_64                                                                                                                                                             1/5 </span><br><span class="line">  验证中      : glibc-headers-2.17-325.el7_9.x86_64                                                                                                                                                 2/5 </span><br><span class="line">  验证中      : kernel-headers-3.10.0-1160.49.1.el7.x86_64                                                                                                                                          3/5 </span><br><span class="line">  验证中      : glibc-devel-2.17-325.el7_9.x86_64                                                                                                                                                   4/5 </span><br><span class="line">  验证中      : cpp-4.8.5-44.el7.x86_64                                                                                                                                                             5/5 </span><br><span class="line"></span><br><span class="line">已安装:</span><br><span class="line">  gcc.x86_64 0:4.8.5-44.el7                                                                                                                                                                             </span><br><span class="line"></span><br><span class="line">作为依赖被安装:</span><br><span class="line">  cpp.x86_64 0:4.8.5-44.el7              glibc-devel.x86_64 0:2.17-325.el7_9              glibc-headers.x86_64 0:2.17-325.el7_9              kernel-headers.x86_64 0:3.10.0-1160.49.1.el7             </span><br><span class="line"></span><br><span class="line">完毕！</span><br><span class="line">[root@hadoop102 software]# gcc --version</span><br><span class="line">gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44)</span><br><span class="line">Copyright © 2015 Free Software Foundation, Inc.</span><br><span class="line">本程序是自由软件；请参看源代码的版权声明。本软件没有任何担保；</span><br><span class="line">包括没有适销性和某一专用目的下的适用性担保。</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点下载相应版本的 Python 包：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop101 software]# wget https://www.python.org/ftp/python/3.9.9/Python-3.9.9.tar.xz</span><br><span class="line">--2021-12-24 10:16:02--  https://www.python.org/ftp/python/3.9.9/Python-3.9.9.tar.xz</span><br><span class="line">正在解析主机 www.python.org (www.python.org)... 151.101.72.223</span><br><span class="line">正在连接 www.python.org (www.python.org)|151.101.72.223|:443... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 200 OK</span><br><span class="line">长度：19144372 (18M) [application/octet-stream]</span><br><span class="line">正在保存至: “Python-3.9.9.tar.xz”</span><br><span class="line"></span><br><span class="line"><span class="meta">100%</span><span class="bash">[==============================================================================================================================================================&gt;] 19,144,372  7.20MB/s 用时 2.5s   </span></span><br><span class="line"></span><br><span class="line">2021-12-24 10:16:05 (7.20 MB/s) - 已保存 “Python-3.9.9.tar.xz” [19144372/19144372])</span><br><span class="line"></span><br><span class="line">[root@hadoop101 software]# ls -l</span><br><span class="line">总用量 18696</span><br><span class="line">-rw-r--r--. 1 root root 19144372 11月 16 02:49 Python-3.9.9.tar.xz</span><br></pre></td></tr></table></figure>
</li>
<li><p>解压到指定目录：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop101 software]# tar -xvJf Python-3.9.9.tar.xz -C /opt/module/</span><br><span class="line">[root@hadoop101 software]# ls -l /opt/module/</span><br><span class="line">总用量 2</span><br><span class="line">drwxrwxr-x. 16 xisun xisun 4096 11月 16 02:05 Python-3.9.9</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点安装依赖，否则会报错：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop101 software]# yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</span><br><span class="line">...</span><br><span class="line">已安装:</span><br><span class="line">  bzip2-devel.x86_64 0:1.0.6-13.el7      gdbm-devel.x86_64 0:1.10-8.el7     libdb4-devel.x86_64 0:4.8.30-13.el7    libpcap-devel.x86_64 14:1.5.3-12.el7 ncurses-devel.x86_64 0:5.9-14.20130511.el7_4</span><br><span class="line">  openssl-devel.x86_64 1:1.0.2k-22.el7_9 readline-devel.x86_64 0:6.2-11.el7 sqlite-devel.x86_64 0:3.7.17-8.el7_7.1 tk-devel.x86_64 1:8.5.13-6.el7       xz-devel.x86_64 0:5.2.2-1.el7               </span><br><span class="line">  zlib-devel.x86_64 0:1.2.7-19.el7_9    </span><br><span class="line"></span><br><span class="line">作为依赖被安装:</span><br><span class="line">  expat-devel.x86_64 0:2.1.0-12.el7    fontconfig-devel.x86_64 0:2.13.0-4.3.el7 freetype-devel.x86_64 0:2.8-14.el7_9.1   keyutils-libs-devel.x86_64 0:1.5.8-3.el7 krb5-devel.x86_64 0:1.15.1-51.el7_9</span><br><span class="line">  libXft-devel.x86_64 0:2.3.2-2.el7    libXrender-devel.x86_64 0:0.9.10-1.el7   libcom_err-devel.x86_64 0:1.42.9-19.el7  libdb4.x86_64 0:4.8.30-13.el7            libpng-devel.x86_64 2:1.5.13-8.el7 </span><br><span class="line">  libselinux-devel.x86_64 0:2.5-15.el7 libsepol-devel.x86_64 0:2.5-10.el7       libuuid-devel.x86_64 0:2.23.2-65.el7_9.1 libverto-devel.x86_64 0:0.2.5-4.el7      pcre-devel.x86_64 0:8.32-17.el7</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点安装 Python3：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 指定安装的路径，不指定的话，安装过程中可能软件所需要的文件复制到其他不同目录，删除软件很不方便，复制软件也不方便</span></span><br><span class="line">[root@hadoop101 software]# mkdir /usr/local/python3</span><br><span class="line">[root@hadoop101 software]# cd /opt/module/Python-3.9.9/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置，指定安装目录</span></span><br><span class="line">[root@hadoop101 Python-3.9.9]# ./configure --prefix=/usr/local/python3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 编译安装</span></span><br><span class="line">[root@hadoop101 Python-3.9.9]# make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在安装过程中，如果出现错误，在重新安装之前先执行下面的命令，清空缓存：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop101 Python-3.9.9]# make clean</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>各节点添加软链接：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 Python-3.9.9]# ln -s /usr/local/python3/bin/python3 /usr/bin/python3</span><br><span class="line">[root@hadoop102 Python-3.9.9]# ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure>

<ul>
<li>软链接位置定为 <code>/usr/bin/python3</code> 和 <code>/usr/bin/pip3</code>。</li>
</ul>
</li>
<li><p>各节点查看版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 Python-3.9.9]# python3 --version</span><br><span class="line">Python 3.9.9</span><br><span class="line">[root@hadoop102 Python-3.9.9]# pip3 --version</span><br><span class="line">pip 21.2.4 from /usr/local/python3/lib/python3.9/site-packages/pip (python 3.9)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h3><ul>
<li><p>Cephadm 基于容器运行所有 Ceph 组件，各节点需要安装 Docker 或 Podman，此处安装 Docker。</p>
</li>
<li><p>各节点卸载旧版本 Docker（如果之前有安装过）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点安装需要的软件包，yum-util 提供 yum-config-manager 功能：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# yum install -y yum-utils</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点设置 yum 的 Docker 源（下面两个都可以用）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 中央仓库</span></span><br><span class="line">[root@hadoop102 opt]# yum-config-manager --add-repo http://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 阿里仓库</span></span><br><span class="line">[root@hadoop102 opt]# yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点安装最新版本 Docker：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>

<ul>
<li><p>安装特定版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看不同版本</span></span><br><span class="line">[root@hadoop102 opt]# yum list docker-ce --showduplicates | sort -r</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装特定版本</span></span><br><span class="line">[root@hadoop102 opt]# yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>各节点启动 Docker，并设置开机启动：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动</span></span><br><span class="line">[root@hadoop102 opt]# systemctl start docker</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看docker版本</span></span><br><span class="line">[root@hadoop102 opt]# docker --version</span><br><span class="line">Docker version 20.10.12, build e91ed57</span><br><span class="line"><span class="meta">#</span><span class="bash"> 开机启动</span></span><br><span class="line">[root@hadoop102 opt]# systemctl enable docker</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看docker是否开机启动</span></span><br><span class="line">[root@hadoop102 opt]# systemctl list-unit-files | grep docker</span><br><span class="line">docker.service                                enabled </span><br><span class="line">docker.socket                                 disabled</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点测试：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# docker run hello-world</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image which runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"><span class="meta"> $</span><span class="bash"> docker run -it ubuntu bash</span></span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br></pre></td></tr></table></figure>
</li>
<li><p>参考：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p>
</li>
</ul>
<h3 id="安装-Cephadm"><a href="#安装-Cephadm" class="headerlink" title="安装 Cephadm"></a>安装 Cephadm</h3><ul>
<li><p>各节点使用 curl 获取 Cephadm 独立脚本的最新版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载</span></span><br><span class="line">[root@hadoop102 opt]# curl --remote-name --location https://github.com/ceph/ceph/raw/octopus/src/cephadm/cephadm</span><br><span class="line"><span class="meta">  %</span><span class="bash"> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   137  100   137    0     0     15      0  0:00:09  0:00:09 --:--:--    18</span><br><span class="line">100  218k  100  218k    0     0  17210      0  0:00:12  0:00:12 --:--:-- 93775</span><br><span class="line">[root@hadoop102 opt]# ll</span><br><span class="line">总用量 220</span><br><span class="line">-rw-r--r--. 1 root  root  223468 12月 26 15:42 cephadm</span><br><span class="line">drwx--x--x. 4 root  root      28 12月 21 14:56 containerd</span><br><span class="line">drwxr-xr-x. 4 xisun xisun     46 12月 24 10:32 module</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     33 12月 24 10:30 software</span><br><span class="line"><span class="meta">#</span><span class="bash"> 赋权可执行</span></span><br><span class="line">[root@hadoop102 opt]# chmod +x cephadm</span><br><span class="line">[root@hadoop102 opt]# ll</span><br><span class="line">总用量 220</span><br><span class="line">-rwxr-xr-x. 1 root  root  223468 12月 26 15:42 cephadm</span><br><span class="line">drwx--x--x. 4 root  root      28 12月 21 14:56 containerd</span><br><span class="line">drwxr-xr-x. 4 xisun xisun     46 12月 24 10:32 module</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     33 12月 24 10:30 software</span><br></pre></td></tr></table></figure>

<ul>
<li>下载可能需要执行多次。</li>
</ul>
</li>
<li><p>各节点添加源信息，指定为 Octopus 版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 添加Ceph源，这个是官方源</span></span><br><span class="line">[root@hadoop102 opt]# ./cephadm add-repo --release octopus</span><br><span class="line">Writing repo to /etc/yum.repos.d/ceph.repo...</span><br><span class="line">Enabling EPEL...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看Ceph源信息</span></span><br><span class="line">[root@hadoop102 opt]# ll /etc/yum.repos.d/</span><br><span class="line">总用量 56</span><br><span class="line">-rw-r--r--. 1 root root 2523 12月 21 14:16 CentOS-Base.repo</span><br><span class="line">-rw-r--r--. 1 root root 1309 11月 23 2020 CentOS-CR.repo</span><br><span class="line">-rw-r--r--. 1 root root  649 11月 23 2020 CentOS-Debuginfo.repo</span><br><span class="line">-rw-r--r--. 1 root root  314 11月 23 2020 CentOS-fasttrack.repo</span><br><span class="line">-rw-r--r--. 1 root root  630 11月 23 2020 CentOS-Media.repo</span><br><span class="line">-rw-r--r--. 1 root root 1331 11月 23 2020 CentOS-Sources.repo</span><br><span class="line">-rw-r--r--. 1 root root 8515 11月 23 2020 CentOS-Vault.repo</span><br><span class="line">-rw-r--r--. 1 root root  616 11月 23 2020 CentOS-x86_64-kernel.repo</span><br><span class="line">-rw-r--r--. 1 root root  477 12月 26 15:49 ceph.repo						# Ceph源</span><br><span class="line">-rw-r--r--. 1 root root 2081 12月 21 12:38 docker-ce.repo</span><br><span class="line">-rw-r--r--. 1 root root 1358 9月   5 01:37 epel.repo</span><br><span class="line">-rw-r--r--. 1 root root 1457 9月   5 01:37 epel-testing.repo</span><br><span class="line">[root@hadoop102 opt]# cat /etc/yum.repos.d/ceph.repo </span><br><span class="line">[Ceph]</span><br><span class="line">name=Ceph $basearch</span><br><span class="line">baseurl=https://download.ceph.com/rpm-octopus/el7/$basearch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://download.ceph.com/keys/release.asc</span><br><span class="line"></span><br><span class="line">[Ceph-noarch]</span><br><span class="line">name=Ceph noarch</span><br><span class="line">baseurl=https://download.ceph.com/rpm-octopus/el7/noarch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://download.ceph.com/keys/release.asc</span><br><span class="line"></span><br><span class="line">[Ceph-source]</span><br><span class="line">name=Ceph SRPMS</span><br><span class="line">baseurl=https://download.ceph.com/rpm-octopus/el7/SRPMS</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://download.ceph.com/keys/release.asc</span><br></pre></td></tr></table></figure>

<ul>
<li><p>添加 Ceph 源可能需要执行多次，或重启。</p>
</li>
<li><p>如果官方源下载较慢，可以使用阿里云 Ceph 源：</p>
<p><img src="/2021/12/21/ceph/image-20211227113311642.png" alt="image-20211227113311642"></p>
</li>
</ul>
</li>
<li><p>各节点安装 Cephadm：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# ./cephadm install</span><br><span class="line">Installing packages [&#x27;cephadm&#x27;]...</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点验证 Cephadm 安装完成：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# which cephadm</span><br><span class="line">/usr/sbin/cephadm</span><br><span class="line">[root@hadoop102 opt]# cephadm version</span><br><span class="line">Using recent ceph image quay.io/ceph/ceph@sha256:a2c23b6942f7fbc1e15d8cfacd6655a681fe0e44f288e4a158db22030b8d58e3</span><br><span class="line">ceph version 15.2.15 (2dfb18841cfecc2f7eb7eb2afd65986ca4d95985) octopus (stable)</span><br><span class="line">[root@hadoop102 opt]# cephadm --help</span><br><span class="line">usage: cephadm [-h] [--image IMAGE] [--docker] [--data-dir DATA_DIR] [--log-dir LOG_DIR] [--logrotate-dir LOGROTATE_DIR] [--unit-dir UNIT_DIR] [--verbose] [--timeout TIMEOUT] [--retry RETRY]</span><br><span class="line">               [--env ENV] [--no-container-init]</span><br><span class="line">               &#123;version,pull,inspect-image,ls,list-networks,adopt,rm-daemon,rm-cluster,run,shell,enter,ceph-volume,unit,logs,bootstrap,deploy,check-host,prepare-host,add-repo,rm-repo,install,registry-login,gather-facts&#125;</span><br><span class="line">               ...</span><br><span class="line"></span><br><span class="line">Bootstrap Ceph daemons with systemd and containers.</span><br><span class="line"></span><br><span class="line">positional arguments:</span><br><span class="line">  &#123;version,pull,inspect-image,ls,list-networks,adopt,rm-daemon,rm-cluster,run,shell,enter,ceph-volume,unit,logs,bootstrap,deploy,check-host,prepare-host,add-repo,rm-repo,install,registry-login,gather-facts&#125;</span><br><span class="line">                        sub-command</span><br><span class="line">    version             get ceph version from container</span><br><span class="line">    pull                pull latest image version</span><br><span class="line">    inspect-image       inspect local container image</span><br><span class="line">    ls                  list daemon instances on this host</span><br><span class="line">    list-networks       list IP networks</span><br><span class="line">    adopt               adopt daemon deployed with a different tool</span><br><span class="line">    rm-daemon           remove daemon instance</span><br><span class="line">    rm-cluster          remove all daemons for a cluster</span><br><span class="line">    run                 run a ceph daemon, in a container, in the foreground</span><br><span class="line">    shell               run an interactive shell inside a daemon container</span><br><span class="line">    enter               run an interactive shell inside a running daemon container</span><br><span class="line">    ceph-volume         run ceph-volume inside a container</span><br><span class="line">    unit                operate on the daemon&#x27;s systemd unit</span><br><span class="line">    logs                print journald logs for a daemon container</span><br><span class="line">    bootstrap           bootstrap a cluster (mon + mgr daemons)</span><br><span class="line">    deploy              deploy a daemon</span><br><span class="line">    check-host          check host configuration</span><br><span class="line">    prepare-host        prepare a host for cephadm use</span><br><span class="line">    add-repo            configure package repository</span><br><span class="line">    rm-repo             remove package repository configuration</span><br><span class="line">    install             install ceph package(s)</span><br><span class="line">    registry-login      log host into authenticated registry</span><br><span class="line">    gather-facts        gather and return host related information (JSON format)</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --help            show this help message and exit</span><br><span class="line">  --image IMAGE         container image. Can also be set via the &quot;CEPHADM_IMAGE&quot; env var (default: None)</span><br><span class="line">  --docker              use docker instead of podman (default: False)</span><br><span class="line">  --data-dir DATA_DIR   base directory for daemon data (default: /var/lib/ceph)</span><br><span class="line">  --log-dir LOG_DIR     base directory for daemon logs (default: /var/log/ceph)</span><br><span class="line">  --logrotate-dir LOGROTATE_DIR</span><br><span class="line">                        location of logrotate configuration files (default: /etc/logrotate.d)</span><br><span class="line">  --unit-dir UNIT_DIR   base directory for systemd units (default: /etc/systemd/system)</span><br><span class="line">  --verbose, -v         Show debug-level log messages (default: False)</span><br><span class="line">  --timeout TIMEOUT     timeout in seconds (default: None)</span><br><span class="line">  --retry RETRY         max number of retries (default: 10)</span><br><span class="line">  --env ENV, -e ENV     set environment variable (default: [])</span><br><span class="line">  --no-container-init   Do not run podman/docker with `--init` (default: True)</span><br></pre></td></tr></table></figure>
</li>
<li><p>为方便后续使用，各节点安装 ceph-common 包，里面包含了所有的 ceph 命令，其中包括 ceph，rbd，mount.ceph（用于安装 CephFS 文件系统）等：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装</span></span><br><span class="line">[root@hadoop102 opt]# cephadm install ceph-common</span><br><span class="line">Installing packages [&#x27;ceph-common&#x27;]...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认可以使用</span></span><br><span class="line">[root@hadoop102 opt]# ceph -v</span><br><span class="line">ceph version 15.2.15 (2dfb18841cfecc2f7eb7eb2afd65986ca4d95985) octopus (stable)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="创建-Ceph-新集群"><a href="#创建-Ceph-新集群" class="headerlink" title="创建 Ceph 新集群"></a>创建 Ceph 新集群</h3><ul>
<li><p>在 hadoop102 上创建一个可以被任何访问 Ceph 集群的主机访问的网络，指定 mon-ip，并将生成的配置文件写进 <code>/etc/ceph</code> 目录里：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# cephadm bootstrap --mon-ip 192.168.10.102</span><br><span class="line">Verifying podman|docker is present...</span><br><span class="line">Verifying lvm2 is present...</span><br><span class="line">Verifying time synchronization is in place...</span><br><span class="line">Unit ntpd.service is enabled and running</span><br><span class="line">Repeating the final host check...</span><br><span class="line">podman|docker (/usr/bin/docker) is present</span><br><span class="line">systemctl is present</span><br><span class="line">lvcreate is present</span><br><span class="line">Unit ntpd.service is enabled and running</span><br><span class="line">Host looks OK</span><br><span class="line">Cluster fsid: 81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line">Verifying IP 192.168.10.102 port 3300 ...</span><br><span class="line">Verifying IP 192.168.10.102 port 6789 ...</span><br><span class="line">Mon IP 192.168.10.102 is in CIDR network 192.168.10.0/24</span><br><span class="line">Pulling container image quay.io/ceph/ceph:v15...</span><br><span class="line">Extracting ceph user uid/gid from container image...</span><br><span class="line">Creating initial keys...</span><br><span class="line">Creating initial monmap...</span><br><span class="line">Creating mon...</span><br><span class="line">Waiting for mon to start...</span><br><span class="line">Waiting for mon...</span><br><span class="line">mon is available</span><br><span class="line">Assimilating anything we can from ceph.conf...</span><br><span class="line">Generating new minimal ceph.conf...</span><br><span class="line">Restarting the monitor...</span><br><span class="line">Setting mon public_network...</span><br><span class="line">Creating mgr...</span><br><span class="line">Verifying port 9283 ...</span><br><span class="line">Wrote keyring to /etc/ceph/ceph.client.admin.keyring</span><br><span class="line">Wrote config to /etc/ceph/ceph.conf</span><br><span class="line">Waiting for mgr to start...</span><br><span class="line">Waiting for mgr...</span><br><span class="line">mgr not available, waiting (1/10)...</span><br><span class="line">mgr not available, waiting (2/10)...</span><br><span class="line">mgr not available, waiting (3/10)...</span><br><span class="line">mgr not available, waiting (4/10)...</span><br><span class="line">mgr not available, waiting (5/10)...</span><br><span class="line">mgr is available</span><br><span class="line">Enabling cephadm module...</span><br><span class="line">Waiting for the mgr to restart...</span><br><span class="line">Waiting for Mgr epoch 5...</span><br><span class="line">Mgr epoch 5 is available</span><br><span class="line">Setting orchestrator backend to cephadm...</span><br><span class="line">Generating ssh key...</span><br><span class="line">Wrote public SSH key to to /etc/ceph/ceph.pub</span><br><span class="line">Adding key to root@localhost&#x27;s authorized_keys...</span><br><span class="line">Adding host hadoop102...</span><br><span class="line">Deploying mon service with default placement...</span><br><span class="line">Deploying mgr service with default placement...</span><br><span class="line">Deploying crash service with default placement...</span><br><span class="line">Enabling mgr prometheus module...</span><br><span class="line">Deploying prometheus service with default placement...</span><br><span class="line">Deploying grafana service with default placement...</span><br><span class="line">Deploying node-exporter service with default placement...</span><br><span class="line">Deploying alertmanager service with default placement...</span><br><span class="line">Enabling the dashboard module...</span><br><span class="line">Waiting for the mgr to restart...</span><br><span class="line">Waiting for Mgr epoch 13...</span><br><span class="line">Mgr epoch 13 is available</span><br><span class="line">Generating a dashboard self-signed certificate...</span><br><span class="line">Creating initial admin user...</span><br><span class="line">Fetching dashboard port number...</span><br><span class="line">Ceph Dashboard is now available at:</span><br><span class="line"></span><br><span class="line">	     URL: https://hadoop102:8443/</span><br><span class="line">	    User: admin</span><br><span class="line">	Password: v5b0064nc4</span><br><span class="line"></span><br><span class="line">You can access the Ceph CLI with:</span><br><span class="line"></span><br><span class="line">	sudo /usr/sbin/cephadm shell --fsid 81b469b6-662d-11ec-b2eb-000c29c51d96 -c /etc/ceph/ceph.conf -k /etc/ceph/ceph.client.admin.keyring</span><br><span class="line"></span><br><span class="line">Please consider enabling telemetry to help improve Ceph:</span><br><span class="line"></span><br><span class="line">	ceph telemetry on</span><br><span class="line"></span><br><span class="line">For more information see:</span><br><span class="line"></span><br><span class="line">	https://docs.ceph.com/docs/master/mgr/telemetry/</span><br><span class="line"></span><br><span class="line">Bootstrap complete.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>该命令执行如下操作：</p>
<ul>
<li><p>在本地主机上为新集群创建 monitor  和 manager daemon 守护程序。</p>
</li>
<li><p>为 Ceph 集群生成一个新的 SSH 密钥，并将其添加到 root 用户的 <code>/root/.ssh/authorized_keys</code> 文件中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDkEXI7QySiz2VlLNrYW7OypfS9ZtMXS2h725W+pTpv71e4z6YjjxIpt6DvggtuD/UhktL1HxIvAREYKQ5vNYhGuV9jHI4VU+y4evpPEMR8GJ8OTlhfwhwovsik4TfYW0SmHUw01bxBpH2BjX4u/dSpyN9KG9710WXTIGJQ6zbHjxPg0JQX4C1KLuaD1WMVo1z6xscRGs7RAZ7sYAIQdf8LOI4IYVzO1n66NJNY4vpAJx1wCLajoGN0689Do42jX6t0/Qn6RGddXermTbbPW+hcD20pRIHO4f9VCQwqSNdcEVDUS74VMJRuOxd+N0uAxvHz8lTdCSfUnfPeKEvEH+cr root@hadoop102</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9lRXTDUhUKdfu5PznYhoFsJFw1n6qXKJXCgFmuFCBB3T75na5xSgGbUEcQ5HYIWk8ywjynGjzCQMlyG+DTaQVvxOcpNNyKv57sm2quegFzu+c86Q726npspidr8Knl7dJALXF3q8k3eQrscWrRyJEA6vh1PikrNtDwzdB92WoYkAH5dJj3MxuHPJXoX+UbOZ8jWV7dARBT2LXFiS09bJy+7P2QZSa5BVirWFzoRjAD4JlEeaW2OPcujHTe+IjHXale4fjNh0tUDtteMRcwLnfMpTl6M7qgpUXm/IrlJHfAqtPmYPQUiDCVFQ9wntTeF5ph6WM9qk/2BJni5BX44VH root@hadoop103</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsgI3CnXcTkQkSHxvhGvBGY1Fh7gaIXqhI5n7rtEM3fmJ2k8/VoWjLwxE1xqSm7tsGufabIhpLdUJBfj4cpqa+PazgSVF59cPlYArp115YFOCGWv2z9tZ5Cq70i9EEfNCyhWNhNUEd9cqiei/G1by4yQzOwvpiuDhiGlDtQk3pRGvvdjGQV3YVDVjDv6JG3QQkxPY+oYQFjDBy+usGEvcuIFDJXmS4hlB8xDMZCw8R0gcvBEnA9RxIIb0N0jLf0uZt0varFZqlguwJJdT6nBCWJ+NYxu5aggX7PGgHB+F97gCoIRusqjT/scoS+jSK8yx4WzJ6ZfCp1wQEXJ+XgrbX root@hadoop104</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDCfFd837abQYj+trazR8y5OSOc7ET+vzn0o6pR+JF3N1knD5JGKXyB0umMsYehwcU55XkMARHRS+jothz0PAqWUpdV73pVZyy+Nxhu/5rySf+NiaoYd8IYAtcgbw174E5deudPF5Ac7IIUxJAgPxEb/NnrpYEPFLHg31ZCKUvzHkEbP9I1iMgM9LtKN3M/aAbaHY2Pd046joVhOo7DsIlYyd147X1MgFhwTeVThpu+zdjPwNoenQGIhrH1J46thBL8TyTC0Wjui5YVwim9Nxoet7E46BiuqrAS6TBvLOTAZlD/g2UB+6NbGYdQKpOs8k2XQqrEBtPB4Wo/hZ0efg8gvCs4AaOqICaMOUt52lfJHInnsycB99nxh95sLDhkHfQIlqTEvGPQDiJVU8tPS5mo7+oeqpCTsvnIINQTMlCtA6eR6kmNumCdSpwbCMkuwVxHjGgNxMy3ykBRItU0vH9mAv/5OxyfjKQutELHQn+5fb5v0lrDq/WZ60jMJYGpTh8= ceph-81b469b6-662d-11ec-b2eb-000c29c51d96</span><br></pre></td></tr></table></figure>
</li>
<li><p>将与新群集进行通信所需的最小配置文件保存到 <code>/etc/ceph/ceph.conf</code>。</p>
</li>
<li><p>向 <code>/etc/ceph/ceph.client.admin.keyring</code> 写入 <code>client.admin</code> 管理 secret key 的副本（特权！）。</p>
</li>
<li><p>将 public key 的副本写入 <code>/etc/ceph/ceph.pub</code>。</p>
</li>
</ul>
</li>
<li><p>查看当前配置文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# ll /etc/ceph/</span><br><span class="line">总用量 12</span><br><span class="line">-rw-------. 1 root root  63 12月 26 17:23 ceph.client.admin.keyring</span><br><span class="line">-rw-r--r--. 1 root root 179 12月 26 17:23 ceph.conf</span><br><span class="line">-rw-r--r--. 1 root root 595 12月 26 17:24 ceph.pub</span><br><span class="line">[root@hadoop102 opt]# cat /etc/ceph/ceph.conf </span><br><span class="line"><span class="meta">#</span><span class="bash"> minimal ceph.conf <span class="keyword">for</span> 81b469b6-662d-11ec-b2eb-000c29c51d96</span></span><br><span class="line">[global]</span><br><span class="line">	fsid = 81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line">	mon_host = [v2:192.168.10.102:3300/0,v1:192.168.10.102:6789/0]</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看拉取的镜像和启动的容器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装之前</span></span><br><span class="line">[root@hadoop104 opt]# docker images</span><br><span class="line">REPOSITORY          TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world         latest    feb5d9fea6a5   3 months ago   13.3kB</span><br><span class="line">[root@hadoop104 opt]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE         COMMAND    CREATED        STATUS                  PORTS     NAMES</span><br><span class="line">72c655a613fc   hello-world   &quot;/hello&quot;   41 hours ago   Created                           gallant_cohen</span><br><span class="line">de6240f04135   hello-world   &quot;/hello&quot;   5 days ago     Exited (0) 5 days ago             priceless_nash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装之后</span></span><br><span class="line">[root@hadoop102 opt]# docker images</span><br><span class="line">REPOSITORY                         TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">quay.io/ceph/ceph                  v15       3437f7bed968   2 months ago    1.08GB		# Ceph组件</span><br><span class="line">hello-world                        latest    feb5d9fea6a5   3 months ago    13.3kB</span><br><span class="line">quay.io/ceph/ceph-grafana          6.7.4     557c83e11646   4 months ago    486MB		# Ceph组件</span><br><span class="line">quay.io/prometheus/prometheus      v2.18.1   de242295e225   19 months ago   140MB		# Ceph组件</span><br><span class="line">quay.io/prometheus/alertmanager    v0.20.0   0881eb8f169f   2 years ago     52.1MB		# Ceph组件</span><br><span class="line">quay.io/prometheus/node-exporter   v0.18.1   e5a616e4b9cf   2 years ago     22.9MB		# Ceph组件</span><br><span class="line">[root@hadoop102 opt]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE                                      COMMAND                  CREATED          STATUS                    PORTS     NAMES</span><br><span class="line">5e62fe89c60f   quay.io/ceph/ceph-grafana:6.7.4            &quot;/bin/sh -c &#x27;grafana…&quot;   45 minutes ago   Up 45 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-grafana.hadoop102				# Ceph组件</span><br><span class="line">fcf1abbde49f   quay.io/prometheus/alertmanager:v0.20.0    &quot;/bin/alertmanager -…&quot;   45 minutes ago   Up 45 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-alertmanager.hadoop102		# Ceph组件</span><br><span class="line">ee65841914dd   quay.io/prometheus/prometheus:v2.18.1      &quot;/bin/prometheus --c…&quot;   45 minutes ago   Up 45 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-prometheus.hadoop102			# Ceph组件</span><br><span class="line">b248a474c78e   quay.io/prometheus/node-exporter:v0.18.1   &quot;/bin/node_exporter …&quot;   46 minutes ago   Up 46 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-node-exporter.hadoop102		# Ceph组件</span><br><span class="line">31dd5f2a7479   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-crash…&quot;   50 minutes ago   Up 50 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-crash.hadoop102				# Ceph组件</span><br><span class="line">443c33b517e0   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mgr -…&quot;   52 minutes ago   Up 52 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-mgr.hadoop102.kwrjaw			# Ceph组件</span><br><span class="line">895542296c01   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mon -…&quot;   52 minutes ago   Up 52 minutes                       ceph-81b469b6-662d-11ec-b2eb-000c29c51d96-mon.hadoop102					# Ceph组件</span><br><span class="line">7213f1a0510a   hello-world                                &quot;/hello&quot;                 27 hours ago     Exited (0) 27 hours ago             hungry_driscoll</span><br><span class="line">ad4e221a918b   hello-world                                &quot;/hello&quot;                 5 days ago       Exited (0) 5 days ago               kind_elbakyan</span><br></pre></td></tr></table></figure>

<ul>
<li>此时已经运行了以下组件：<ul>
<li>ceph-mgr：Ceph 管理程序。</li>
<li>ceph-monitor：Ceph 监视器。</li>
<li>ceph-crash：崩溃数据收集模块。</li>
<li>prometheus：prometheus 监控组件。</li>
<li>grafana：监控数据展示 dashboard。</li>
<li>alertmanager：prometheus 告警组件。</li>
<li>node_exporter：prometheus 节点数据收集组件。</li>
</ul>
</li>
</ul>
</li>
<li><p>参阅下面的一些对某些用户可能有用的选项，或者运行 <code>cephadm bootstrap -h</code> 命令查看所有可用选项：</p>
<ul>
<li>为了方便起见，Bootstrap 会将访问新集群所需的文件写入 <code>/etc/ceph</code>，以便主机上安装的任何 Ceph 软件包（例如，访问命令行界面）都可以轻松找到它们。</li>
<li>但是使用 cephadm 部署的 daemon 容器根本不需要 <code>/etc/ceph</code>。避免与同一主机上的现有 Ceph 配置（cephadm 或其他方式）存在潜在冲突，可以使用 –output-dir 选项将它们放置在不同的目录中。</li>
<li>可以使用 –config 选项将任何初始 Ceph 配置选项传递到新集群，方法是将它们放在标准 ini 样式的配置文件中。</li>
</ul>
</li>
<li><p>查看容器状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# cephadm ls</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;mon.hadoop102&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@mon.hadoop102&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;db378568f82337811eff2c7c44ad1a713d955a5b04fcde47c18674671e735704&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph:v15&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;3437f7bed9688a799444b439e1947a6f00d1f9b1fc986e843aec7e3ac8acd12b&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;15.2.15&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:27.486408Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:23:53.780886Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:23:52.866923Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:30:45.494492Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;mgr.hadoop102.kwrjaw&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@mgr.hadoop102.kwrjaw&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;32e7e6a303b2af413b90739fde7e1f3b60c26214a1a5fe8d34d36133f733ea61&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph:v15&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;3437f7bed9688a799444b439e1947a6f00d1f9b1fc986e843aec7e3ac8acd12b&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;15.2.15&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:24.388823Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:23:57.956720Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:23:57.302746Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:30:46.551456Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;alertmanager.hadoop102&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@alertmanager.hadoop102&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;843d8e781d923fa302322c78e5251ab1fa4b7b3d5a5998906ee30e089cc2e506&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/prometheus/alertmanager:v0.20.0&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;0881eb8f169f5556a292b4e2c01d683172b12830a62a9225a98a8e206bb734f0&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;0.20.0&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:30.498509Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:25:51.990176Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:25:51.485197Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:30:48.260398Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;crash.hadoop102&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@crash.hadoop102&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;2d08d2614605c2a4350c56cf1733f85cd5916afc03a899ce65c600a437c36184&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph:v15&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;3437f7bed9688a799444b439e1947a6f00d1f9b1fc986e843aec7e3ac8acd12b&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;15.2.15&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:28.253480Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:25:54.341083Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:25:53.839103Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:25:54.341083Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;grafana.hadoop102&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@grafana.hadoop102&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;cbb4a8a923e2f3205e02e9dd026d3fdcf1a07c55a3eda6b9de13408dadc0465a&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph-grafana:6.7.4&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;557c83e11646f123a27b5e4b62ac6c45e7bb8b2e90d6044034d0db5b7019415c&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;6.7.4&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:27.676553Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:29:44.175925Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:29:42.555990Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:30:51.194299Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;node-exporter.hadoop102&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@node-exporter.hadoop102&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;ee29b873a834252d1d55c20c67ecfbff9a3b6acf8621063efd9070a79cb1cba5&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/prometheus/node-exporter:v0.18.1&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;e5a616e4b9cf68dfcad7782b78e118be4310022e874d52da85c55923fb615f87&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;0.18.1&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:21.758252Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:29:47.899777Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:29:47.307801Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:29:47.899777Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;prometheus.hadoop102&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;81b469b6-662d-11ec-b2eb-000c29c51d96&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-81b469b6-662d-11ec-b2eb-000c29c51d96@prometheus.hadoop102&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;f236295847bf07d2db2b3c79d3a209f5db369cf2a61ae7bb7d2ef7597982eb23&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/prometheus/prometheus:v2.18.1&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;de242295e2257c37c8cadfd962369228f8f10b2d48a44259b65fef44ad4f6490&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;2.18.1&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2021-12-27T09:11:25.545626Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2021-12-26T09:30:36.125856Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2021-12-26T09:30:35.546879Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2021-12-26T09:30:36.125856Z&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据初始化完成的提示使用浏览器访问 dashboard：</p>
<p><img src="/2021/12/21/ceph/image-20211227141903939.png" alt="image-20211227141903939"></p>
<ul>
<li><p>使用虚拟机自带的火狐浏览器登陆 dashboard，初次登陆需要修改密码（admin，xisun_ceph001）：</p>
<p><img src="/2021/12/21/ceph/image-20211227172731909.png" alt="image-20211227172731909"></p>
</li>
</ul>
</li>
<li><p>如果上述引导集群的命令执行过程发生了异常，需要删除已经添加的配置文件，并关闭已经启动的 Ceph 组件进程，然后重新执行命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看已经添加的配置文件</span></span><br><span class="line">[root@hadoop102 opt]# ll /etc/ceph/</span><br><span class="line">总用量 12</span><br><span class="line">-rw-------. 1 root root  63 12月 26 17:23 ceph.client.admin.keyring</span><br><span class="line">-rw-r--r--. 1 root root 179 12月 26 17:23 ceph.conf</span><br><span class="line">-rw-r--r--. 1 root root 595 12月 26 17:24 ceph.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除已经添加的配置文件，或者重新执行命令时，添加--allow-overwrite参数</span></span><br><span class="line">[root@hadoop102 opt]# rm /etc/ceph/*</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看已经启动的Ceph组件所占用的端口</span></span><br><span class="line">[root@hadoop102 opt]# netstat -ntlp</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      713/rpcbind         </span><br><span class="line">tcp        0      0 0.0.0.0:6800            0.0.0.0:*               LISTEN      2864/ceph-mgr       # 删除</span><br><span class="line">tcp        0      0 0.0.0.0:6801            0.0.0.0:*               LISTEN      2864/ceph-mgr       # 删除</span><br><span class="line">tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN      1467/dnsmasq        </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1041/sshd           </span><br><span class="line">tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      1044/cupsd          </span><br><span class="line">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1234/master         </span><br><span class="line">tcp        0      0 127.0.0.1:6010          0.0.0.0:*               LISTEN      2131/sshd: xisun@pt </span><br><span class="line">tcp        0      0 192.168.10.102:3300     0.0.0.0:*               LISTEN      3026/ceph-mon       # 删除</span><br><span class="line">tcp        0      0 192.168.10.102:6789     0.0.0.0:*               LISTEN      3026/ceph-mon       # 删除</span><br><span class="line">tcp6       0      0 :::111                  :::*                    LISTEN      713/rpcbind         </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      1041/sshd           </span><br><span class="line">tcp6       0      0 ::1:631                 :::*                    LISTEN      1044/cupsd          </span><br><span class="line">tcp6       0      0 ::1:25                  :::*                    LISTEN      1234/master         </span><br><span class="line">tcp6       0      0 ::1:6010                :::*                    LISTEN      2131/sshd: xisun@pt </span><br><span class="line"><span class="meta">#</span><span class="bash"> 同时删除ceph-mgr和ceph-mon这两个进程</span></span><br><span class="line">[root@hadoop102 opt]# kill -9 2864 3026</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="启用-Ceph-命令"><a href="#启用-Ceph-命令" class="headerlink" title="启用 Ceph 命令"></a>启用 Ceph 命令</h3><ul>
<li><p>Cephadm 不需要在主机上安装任何 Ceph 包。但是，建议启用对 Ceph 命令的简单访问。</p>
</li>
<li><p><code>cephadm shell</code> 命令在安装了所有 Ceph 包的容器中启动一个 bash shell。默认情况下，如果在主机上的 <code>/etc/ceph</code> 路径中找到配置和 keyring 文件，则会将它们传递到容器环境中，这样 shell 就可以完全正常工作。注意，在 MON 主机上执行时，<code>cephadm shell</code> 将从 MON 容器推断配置，而不是使用默认配置。如果给定 –mount，则主机（文件或目录）将显示在容器中的 <code>/mnt</code> 下。在 hadoop102 上执行下面的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动一个bash shell</span></span><br><span class="line">[root@hadoop102 opt]# cephadm shell</span><br><span class="line">Inferring fsid 81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line">Inferring config /var/lib/ceph/81b469b6-662d-11ec-b2eb-000c29c51d96/mon.hadoop102/config</span><br><span class="line">Using recent ceph image quay.io/ceph/ceph@sha256:a2c23b6942f7fbc1e15d8cfacd6655a681fe0e44f288e4a158db22030b8d58e3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建别名</span></span><br><span class="line">[ceph: root@hadoop102 /]# alias ceph=&#x27;cephadm shell -- ceph&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 退出</span></span><br><span class="line">[ceph: root@hadoop102 /]# exit</span><br><span class="line">exit</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看集群状态，使用ceph -s 或者 ceph status命令</span></span><br><span class="line">[root@hadoop102 opt]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            Reduced data availability: 1 pg inactive</span><br><span class="line">            OSD count 0 &lt; osd_pool_default_size 3</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum hadoop102 (age 17m)</span><br><span class="line">    mgr: hadoop102.kwrjaw(active, since 15m)</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   1 pools, 1 pgs</span><br><span class="line">    objects: 0 objects, 0 B</span><br><span class="line">    usage:   0 B used, 0 B / 0 B avail</span><br><span class="line">    pgs:     100.000% pgs unknown</span><br><span class="line">             1 unknown</span><br><span class="line"> </span><br><span class="line">[root@hadoop102 opt]# ceph status</span><br><span class="line">  cluster:</span><br><span class="line">    id:     81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            Reduced data availability: 1 pg inactive</span><br><span class="line">            OSD count 0 &lt; osd_pool_default_size 3</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum hadoop102 (age 17m)</span><br><span class="line">    mgr: hadoop102.kwrjaw(active, since 15m)</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   1 pools, 1 pgs</span><br><span class="line">    objects: 0 objects, 0 B</span><br><span class="line">    usage:   0 B used, 0 B / 0 B avail</span><br><span class="line">    pgs:     100.000% pgs unknown</span><br><span class="line">             1 unknown</span><br><span class="line"> </span><br><span class="line">[root@hadoop102 opt]# ceph health</span><br><span class="line">HEALTH_WARN Reduced data availability: 1 pg inactive; OSD count 0 &lt; osd_pool_default_size 3</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在执行过程中发生了异常，解决如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 ceph]# ceph shell</span><br><span class="line">2021-12-27T14:45:22.661+0800 7faad8e1c700 -1 monclient(hunting): handle_auth_bad_method server allowed_methods [2] but i only support [2,1]</span><br><span class="line">[errno 13] RADOS permission denied (error connecting to the cluster)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有的集群数据文件夹</span></span><br><span class="line">[root@hadoop102 ceph]# ll /var/lib/ceph</span><br><span class="line">总用量 0</span><br><span class="line">drwx------.  5 ceph           ceph   68 12月 26 16:42 6f08de88-6627-11ec-ad8e-000c29c51d96</span><br><span class="line">drwx------. 10 libstoragemgmt cgred 205 12月 26 17:30 81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看配置中的集群数据文件夹</span></span><br><span class="line">[root@hadoop102 ceph]# cat /etc/ceph/ceph.conf </span><br><span class="line"><span class="meta">#</span><span class="bash"> minimal ceph.conf <span class="keyword">for</span> 81b469b6-662d-11ec-b2eb-000c29c51d96</span></span><br><span class="line">[global]</span><br><span class="line">	fsid = 81b469b6-662d-11ec-b2eb-000c29c51d96</span><br><span class="line">	mon_host = [v2:192.168.10.102:3300/0,v1:192.168.10.102:6789/0]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除旧的集群数据文件夹，然后重新执行命令</span></span><br><span class="line">[root@hadoop102 ceph]# rm -rf /var/lib/ceph/6f08de88-6627-11ec-ad8e-000c29c51d96/</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="添加新主机到集群中"><a href="#添加新主机到集群中" class="headerlink" title="添加新主机到集群中"></a>添加新主机到集群中</h3><ul>
<li><p>第一步，在 hadoop102 上执行命令，将集群的公共 SSH 密钥添加到新主机的根用户 authorized_keys 文件中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 opt]# ssh-copy-id -f -i /etc/ceph/ceph.pub root@hadoop103</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/etc/ceph/ceph.pub&quot;</span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   &quot;ssh &#x27;root@hadoop103&#x27;&quot;</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">[root@hadoop102 opt]# ssh-copy-id -f -i /etc/ceph/ceph.pub root@hadoop104</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/etc/ceph/ceph.pub&quot;</span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   &quot;ssh &#x27;root@hadoop104&#x27;&quot;</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line">[root@hadoop102 opt]# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDkEXI7QySiz2VlLNrYW7OypfS9ZtMXS2h725W+pTpv71e4z6YjjxIpt6DvggtuD/UhktL1HxIvAREYKQ5vNYhGuV9jHI4VU+y4evpPEMR8GJ8OTlhfwhwovsik4TfYW0SmHUw01bxBpH2BjX4u/dSpyN9KG9710WXTIGJQ6zbHjxPg0JQX4C1KLuaD1WMVo1z6xscRGs7RAZ7sYAIQdf8LOI4IYVzO1n66NJNY4vpAJx1wCLajoGN0689Do42jX6t0/Qn6RGddXermTbbPW+hcD20pRIHO4f9VCQwqSNdcEVDUS74VMJRuOxd+N0uAxvHz8lTdCSfUnfPeKEvEH+cr root@hadoop102</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9lRXTDUhUKdfu5PznYhoFsJFw1n6qXKJXCgFmuFCBB3T75na5xSgGbUEcQ5HYIWk8ywjynGjzCQMlyG+DTaQVvxOcpNNyKv57sm2quegFzu+c86Q726npspidr8Knl7dJALXF3q8k3eQrscWrRyJEA6vh1PikrNtDwzdB92WoYkAH5dJj3MxuHPJXoX+UbOZ8jWV7dARBT2LXFiS09bJy+7P2QZSa5BVirWFzoRjAD4JlEeaW2OPcujHTe+IjHXale4fjNh0tUDtteMRcwLnfMpTl6M7qgpUXm/IrlJHfAqtPmYPQUiDCVFQ9wntTeF5ph6WM9qk/2BJni5BX44VH root@hadoop103</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsgI3CnXcTkQkSHxvhGvBGY1Fh7gaIXqhI5n7rtEM3fmJ2k8/VoWjLwxE1xqSm7tsGufabIhpLdUJBfj4cpqa+PazgSVF59cPlYArp115YFOCGWv2z9tZ5Cq70i9EEfNCyhWNhNUEd9cqiei/G1by4yQzOwvpiuDhiGlDtQk3pRGvvdjGQV3YVDVjDv6JG3QQkxPY+oYQFjDBy+usGEvcuIFDJXmS4hlB8xDMZCw8R0gcvBEnA9RxIIb0N0jLf0uZt0varFZqlguwJJdT6nBCWJ+NYxu5aggX7PGgHB+F97gCoIRusqjT/scoS+jSK8yx4WzJ6ZfCp1wQEXJ+XgrbX root@hadoop104</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDCfFd837abQYj+trazR8y5OSOc7ET+vzn0o6pR+JF3N1knD5JGKXyB0umMsYehwcU55XkMARHRS+jothz0PAqWUpdV73pVZyy+Nxhu/5rySf+NiaoYd8IYAtcgbw174E5deudPF5Ac7IIUxJAgPxEb/NnrpYEPFLHg31ZCKUvzHkEbP9I1iMgM9LtKN3M/aAbaHY2Pd046joVhOo7DsIlYyd147X1MgFhwTeVThpu+zdjPwNoenQGIhrH1J46thBL8TyTC0Wjui5YVwim9Nxoet7E46BiuqrAS6TBvLOTAZlD/g2UB+6NbGYdQKpOs8k2XQqrEBtPB4Wo/hZ0efg8gvCs4AaOqICaMOUt52lfJHInnsycB99nxh95sLDhkHfQIlqTEvGPQDiJVU8tPS5mo7+oeqpCTsvnIINQTMlCtA6eR6kmNumCdSpwbCMkuwVxHjGgNxMy3ykBRItU0vH9mAv/5OxyfjKQutELHQn+5fb5v0lrDq/WZ60jMJYGpTh8= ceph-81b469b6-662d-11ec-b2eb-000c29c51d96</span><br></pre></td></tr></table></figure>
</li>
<li><p>在新结点上查看密钥是否添加成功：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop103 opt]# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDkEXI7QySiz2VlLNrYW7OypfS9ZtMXS2h725W+pTpv71e4z6YjjxIpt6DvggtuD/UhktL1HxIvAREYKQ5vNYhGuV9jHI4VU+y4evpPEMR8GJ8OTlhfwhwovsik4TfYW0SmHUw01bxBpH2BjX4u/dSpyN9KG9710WXTIGJQ6zbHjxPg0JQX4C1KLuaD1WMVo1z6xscRGs7RAZ7sYAIQdf8LOI4IYVzO1n66NJNY4vpAJx1wCLajoGN0689Do42jX6t0/Qn6RGddXermTbbPW+hcD20pRIHO4f9VCQwqSNdcEVDUS74VMJRuOxd+N0uAxvHz8lTdCSfUnfPeKEvEH+cr root@hadoop102</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9lRXTDUhUKdfu5PznYhoFsJFw1n6qXKJXCgFmuFCBB3T75na5xSgGbUEcQ5HYIWk8ywjynGjzCQMlyG+DTaQVvxOcpNNyKv57sm2quegFzu+c86Q726npspidr8Knl7dJALXF3q8k3eQrscWrRyJEA6vh1PikrNtDwzdB92WoYkAH5dJj3MxuHPJXoX+UbOZ8jWV7dARBT2LXFiS09bJy+7P2QZSa5BVirWFzoRjAD4JlEeaW2OPcujHTe+IjHXale4fjNh0tUDtteMRcwLnfMpTl6M7qgpUXm/IrlJHfAqtPmYPQUiDCVFQ9wntTeF5ph6WM9qk/2BJni5BX44VH root@hadoop103</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsgI3CnXcTkQkSHxvhGvBGY1Fh7gaIXqhI5n7rtEM3fmJ2k8/VoWjLwxE1xqSm7tsGufabIhpLdUJBfj4cpqa+PazgSVF59cPlYArp115YFOCGWv2z9tZ5Cq70i9EEfNCyhWNhNUEd9cqiei/G1by4yQzOwvpiuDhiGlDtQk3pRGvvdjGQV3YVDVjDv6JG3QQkxPY+oYQFjDBy+usGEvcuIFDJXmS4hlB8xDMZCw8R0gcvBEnA9RxIIb0N0jLf0uZt0varFZqlguwJJdT6nBCWJ+NYxu5aggX7PGgHB+F97gCoIRusqjT/scoS+jSK8yx4WzJ6ZfCp1wQEXJ+XgrbX root@hadoop104</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDCfFd837abQYj+trazR8y5OSOc7ET+vzn0o6pR+JF3N1knD5JGKXyB0umMsYehwcU55XkMARHRS+jothz0PAqWUpdV73pVZyy+Nxhu/5rySf+NiaoYd8IYAtcgbw174E5deudPF5Ac7IIUxJAgPxEb/NnrpYEPFLHg31ZCKUvzHkEbP9I1iMgM9LtKN3M/aAbaHY2Pd046joVhOo7DsIlYyd147X1MgFhwTeVThpu+zdjPwNoenQGIhrH1J46thBL8TyTC0Wjui5YVwim9Nxoet7E46BiuqrAS6TBvLOTAZlD/g2UB+6NbGYdQKpOs8k2XQqrEBtPB4Wo/hZ0efg8gvCs4AaOqICaMOUt52lfJHInnsycB99nxh95sLDhkHfQIlqTEvGPQDiJVU8tPS5mo7+oeqpCTsvnIINQTMlCtA6eR6kmNumCdSpwbCMkuwVxHjGgNxMy3ykBRItU0vH9mAv/5OxyfjKQutELHQn+5fb5v0lrDq/WZ60jMJYGpTh8= ceph-81b469b6-662d-11ec-b2eb-000c29c51d96			# 公共SSH密钥</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop104 opt]# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDkEXI7QySiz2VlLNrYW7OypfS9ZtMXS2h725W+pTpv71e4z6YjjxIpt6DvggtuD/UhktL1HxIvAREYKQ5vNYhGuV9jHI4VU+y4evpPEMR8GJ8OTlhfwhwovsik4TfYW0SmHUw01bxBpH2BjX4u/dSpyN9KG9710WXTIGJQ6zbHjxPg0JQX4C1KLuaD1WMVo1z6xscRGs7RAZ7sYAIQdf8LOI4IYVzO1n66NJNY4vpAJx1wCLajoGN0689Do42jX6t0/Qn6RGddXermTbbPW+hcD20pRIHO4f9VCQwqSNdcEVDUS74VMJRuOxd+N0uAxvHz8lTdCSfUnfPeKEvEH+cr root@hadoop102</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9lRXTDUhUKdfu5PznYhoFsJFw1n6qXKJXCgFmuFCBB3T75na5xSgGbUEcQ5HYIWk8ywjynGjzCQMlyG+DTaQVvxOcpNNyKv57sm2quegFzu+c86Q726npspidr8Knl7dJALXF3q8k3eQrscWrRyJEA6vh1PikrNtDwzdB92WoYkAH5dJj3MxuHPJXoX+UbOZ8jWV7dARBT2LXFiS09bJy+7P2QZSa5BVirWFzoRjAD4JlEeaW2OPcujHTe+IjHXale4fjNh0tUDtteMRcwLnfMpTl6M7qgpUXm/IrlJHfAqtPmYPQUiDCVFQ9wntTeF5ph6WM9qk/2BJni5BX44VH root@hadoop103</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsgI3CnXcTkQkSHxvhGvBGY1Fh7gaIXqhI5n7rtEM3fmJ2k8/VoWjLwxE1xqSm7tsGufabIhpLdUJBfj4cpqa+PazgSVF59cPlYArp115YFOCGWv2z9tZ5Cq70i9EEfNCyhWNhNUEd9cqiei/G1by4yQzOwvpiuDhiGlDtQk3pRGvvdjGQV3YVDVjDv6JG3QQkxPY+oYQFjDBy+usGEvcuIFDJXmS4hlB8xDMZCw8R0gcvBEnA9RxIIb0N0jLf0uZt0varFZqlguwJJdT6nBCWJ+NYxu5aggX7PGgHB+F97gCoIRusqjT/scoS+jSK8yx4WzJ6ZfCp1wQEXJ+XgrbX root@hadoop104</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDCfFd837abQYj+trazR8y5OSOc7ET+vzn0o6pR+JF3N1knD5JGKXyB0umMsYehwcU55XkMARHRS+jothz0PAqWUpdV73pVZyy+Nxhu/5rySf+NiaoYd8IYAtcgbw174E5deudPF5Ac7IIUxJAgPxEb/NnrpYEPFLHg31ZCKUvzHkEbP9I1iMgM9LtKN3M/aAbaHY2Pd046joVhOo7DsIlYyd147X1MgFhwTeVThpu+zdjPwNoenQGIhrH1J46thBL8TyTC0Wjui5YVwim9Nxoet7E46BiuqrAS6TBvLOTAZlD/g2UB+6NbGYdQKpOs8k2XQqrEBtPB4Wo/hZ0efg8gvCs4AaOqICaMOUt52lfJHInnsycB99nxh95sLDhkHfQIlqTEvGPQDiJVU8tPS5mo7+oeqpCTsvnIINQTMlCtA6eR6kmNumCdSpwbCMkuwVxHjGgNxMy3ykBRItU0vH9mAv/5OxyfjKQutELHQn+5fb5v0lrDq/WZ60jMJYGpTh8= ceph-81b469b6-662d-11ec-b2eb-000c29c51d96			# 公共SSH密钥</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步，告诉 Ceph，新节点是集群的一部分：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">  ```</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">- s</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Ubuntu 安装 Ceph</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## 节点规划</span></span></span><br><span class="line"></span><br><span class="line">- 各节点规划：</span><br><span class="line"></span><br><span class="line">  | 主机名 | ip           | 磁盘                        | 角色                                      |</span><br><span class="line">  | ------ | ------------ | --------------------------- | ----------------------------------------- |</span><br><span class="line">  | ceph1  | 192.168.1.91 | 系统盘：sda&lt;br/&gt;osd盘：sdb  | cephadm，monitor，mgr，rgw，mds，osd，nfs |</span><br><span class="line">  | ceph2  | 192.168.1.92 | 系统盘：sda&lt;br/&gt;osd盘：sdb  | monitor，mgr，rgw，mds，osd，nfs          |</span><br><span class="line">  | ceph3  | 192.168.1.93 | 系统盘：sda&lt;br/&gt;osd盘：sdb  | monitor，mgr，rgw，mds，osd，nfs          |</span><br><span class="line">  | ceph4  | 192.168.1.94 | 系统盘：sda&lt;br /&gt;osd盘：sdb | monitor，mgr，rgw，mds，osd，nfs          |</span><br><span class="line"></span><br><span class="line">- 各节点版本：</span><br><span class="line"></span><br><span class="line">  ```shell</span><br><span class="line"><span class="meta">  #</span><span class="bash"> 内核版本</span></span><br><span class="line">  root@ceph1:/home# uname -r</span><br><span class="line">  5.4.0-91-generic</span><br><span class="line">  </span><br><span class="line"><span class="meta">  #</span><span class="bash"> Ubuntu版本，方法一</span></span><br><span class="line">  root@ceph1:/home# cat /etc/issue</span><br><span class="line">  Ubuntu 20.04.3 LTS \n \l</span><br><span class="line">  </span><br><span class="line"><span class="meta">  #</span><span class="bash"> Ubuntu版本，方法二，查看所有信息</span></span><br><span class="line">  root@ceph1:/home# lsb_release -a</span><br><span class="line">  No LSB modules are available.</span><br><span class="line">  Distributor ID:	Ubuntu</span><br><span class="line">  Description:	Ubuntu 20.04.3 LTS</span><br><span class="line">  Release:	20.04</span><br><span class="line">  Codename:	focal</span><br><span class="line">  </span><br><span class="line"><span class="meta">  #</span><span class="bash"> Ubuntu版本代号</span></span><br><span class="line">  root@ceph4:/home# lsb_release -c</span><br><span class="line">  Codename:	focal</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点配置 Ubuntu 20.04 apt 阿里云镜像源：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/home# ll /etc/apt/</span><br><span class="line">total 40</span><br><span class="line">drwxr-xr-x   7 root root 4096 Dec 29 15:23 ./</span><br><span class="line">drwxr-xr-x 105 root root 4096 Dec 29 10:52 ../</span><br><span class="line">drwxr-xr-x   2 root root 4096 Aug 24 16:47 apt.conf.d/</span><br><span class="line">drwxr-xr-x   2 root root 4096 Apr  9  2020 auth.conf.d/</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 17 17:04 preferences.d/</span><br><span class="line">-rw-r--r--   1 root root 2777 Dec  8 10:29 sources.list</span><br><span class="line">-rw-r--r--   1 root root 2743 Aug 24 16:47 sources.list.curtin.old</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 17 17:04 sources.list.d/</span><br><span class="line">-rw-r--r--   1 root root 1143 Dec  8 15:43 trusted.gpg</span><br><span class="line">drwxr-xr-x   2 root root 4096 Dec 17 17:04 trusted.gpg.d/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 备份默认的源</span></span><br><span class="line">root@ceph1:/home# cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line"><span class="meta">#</span><span class="bash"> 替换阿里云镜像源，将默认源cn.archive.ubuntu.com替换成mirrors.aliyun.com（先验证下默认apt源是不是cn.archive.ubuntu.com）</span></span><br><span class="line">root@ceph1:/home# sed -i &quot;s/cn.archive.ubuntu.com/mirrors.aliyun.com/g&quot; /etc/apt/sources.list</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新软件包列表</span></span><br><span class="line">root@ceph1:/home# apt update</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新已安装的软件包</span></span><br><span class="line">root@ceph1:/home# apt upgrade</span><br></pre></td></tr></table></figure>

<p><img src="/2021/12/21/ceph/image-20211229155618530.png" alt="image-20211229155618530"></p>
<ul>
<li>说明：生产环境不要随意使用 <code>apt update</code> 和 <code>apt upgrade</code> 命令，因为生产环境下可能要求使用特定的软件版本，不要轻易的更新。</li>
</ul>
</li>
<li><p>各节点配置主机名：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/home# vim /etc/hostname </span><br><span class="line">root@ceph1:/home# cat /etc/hostname </span><br><span class="line">ceph1</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点配置 host 解析：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/home# vim /etc/hosts</span><br><span class="line">root@ceph1:/home# cat /etc/hosts</span><br><span class="line">127.0.0.1 localhost</span><br><span class="line">127.0.0.1 ceph1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The following lines are desirable <span class="keyword">for</span> IPv6 capable hosts</span></span><br><span class="line">::1     ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line"></span><br><span class="line">192.168.1.91 ceph1</span><br><span class="line">192.168.1.92 ceph2</span><br><span class="line">192.168.1.93 ceph3</span><br><span class="line">192.168.1.94 ceph4</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>各节点网络信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 配置文件</span></span><br><span class="line">root@ceph1:/opt# cat /etc/netplan/00-installer-config.yaml </span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the network config written by <span class="string">&#x27;subiquity&#x27;</span></span></span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    ens160:</span><br><span class="line">      dhcp4: false</span><br><span class="line">      addresses:</span><br><span class="line">        - 192.168.1.91/24</span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [114.114.114.114, 8.8.8.8]</span><br><span class="line">  version: 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 网络信息</span></span><br><span class="line">root@ceph1:/opt# ifconfig</span><br><span class="line">docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:31:45:9c:e4  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens160: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.91  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 fe80::250:56ff:fe9e:7c0f  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:50:56:9e:7c:0f  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1493933  bytes 708616888 (708.6 MB)</span><br><span class="line">        RX errors 0  dropped 62  overruns 0  frame 0</span><br><span class="line">        TX packets 215266  bytes 15560179 (15.5 MB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 400  bytes 38180 (38.1 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 400  bytes 38180 (38.1 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 配置文件</span></span><br><span class="line">root@ceph2:/opt# cat /etc/netplan/00-installer-config.yaml </span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the network config written by <span class="string">&#x27;subiquity&#x27;</span></span></span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    ens160:</span><br><span class="line">      dhcp4: false</span><br><span class="line">      addresses:</span><br><span class="line">        - 192.168.1.92/24</span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [114.114.114.114, 8.8.8.8]</span><br><span class="line">  version: 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 网络信息</span></span><br><span class="line">root@ceph2:/opt# ifconfig </span><br><span class="line">docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:07:d8:d7:04  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens160: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.92  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 fe80::250:56ff:fe9e:e4e8  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:50:56:9e:e4:e8  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1474736  bytes 708635562 (708.6 MB)</span><br><span class="line">        RX errors 0  dropped 1  overruns 0  frame 0</span><br><span class="line">        TX packets 219015  bytes 16146130 (16.1 MB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 588  bytes 56542 (56.5 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 588  bytes 56542 (56.5 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 配置文件</span></span><br><span class="line">root@ceph3:/opt# cat /etc/netplan/00-installer-config.yaml </span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the network config written by <span class="string">&#x27;subiquity&#x27;</span></span></span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    ens160:</span><br><span class="line">      dhcp4: false</span><br><span class="line">      addresses:</span><br><span class="line">        - 192.168.1.93/24</span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [114.114.114.114, 8.8.8.8]</span><br><span class="line">  version: 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 网络信息</span></span><br><span class="line">root@ceph3:/opt# ifconfig</span><br><span class="line">docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:e2:11:a5:b9  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens160: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.93  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 fe80::250:56ff:fe9e:7d03  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:50:56:9e:7d:03  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1490677  bytes 706047066 (706.0 MB)</span><br><span class="line">        RX errors 0  dropped 46  overruns 0  frame 0</span><br><span class="line">        TX packets 208014  bytes 14700697 (14.7 MB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 620  bytes 60174 (60.1 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 620  bytes 60174 (60.1 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 配置文件</span></span><br><span class="line">root@ceph4:/opt# cat /etc/netplan/00-installer-config.yaml </span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the network config written by <span class="string">&#x27;subiquity&#x27;</span></span></span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    ens160:</span><br><span class="line">      dhcp4: false</span><br><span class="line">      addresses:</span><br><span class="line">        - 192.168.1.94/24</span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [114.114.114.114, 8.8.8.8]</span><br><span class="line">  version: 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 网络信息</span></span><br><span class="line">root@ceph4:/opt# ifconfig</span><br><span class="line">docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        inet6 fe80::42:78ff:febe:2005  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 02:42:78:be:20:05  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 2  bytes 196 (196.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">ens160: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.94  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 fe80::250:56ff:fe9e:7855  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:50:56:9e:78:55  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1572297  bytes 814622359 (814.6 MB)</span><br><span class="line">        RX errors 0  dropped 50  overruns 0  frame 0</span><br><span class="line">        TX packets 250469  bytes 17903836 (17.9 MB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 826  bytes 84430 (84.4 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 826  bytes 84430 (84.4 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<ul>
<li>Ubuntu 20.04 修改 IP 地址的方法参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38505969/article/details/110501609">https://blog.csdn.net/qq_38505969/article/details/110501609</a></li>
</ul>
</li>
</ul>
<h3 id="关闭防火墙-1"><a href="#关闭防火墙-1" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><ul>
<li><p>各节点关闭防火墙：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装ufw</span></span><br><span class="line">root@ceph1:/opt# apt install -y ufw</span><br><span class="line"><span class="meta">#</span><span class="bash"> 防火墙版本</span></span><br><span class="line">root@ceph1:/home# ufw version</span><br><span class="line">ufw 0.36</span><br><span class="line">Copyright 2008-2015 Canonical Ltd.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 开启防火墙</span></span><br><span class="line">root@ceph1:/home# ufw enable</span><br><span class="line">Command may disrupt existing ssh connections. Proceed with operation (y|n)? y</span><br><span class="line">Firewall is active and enabled on system startup</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看防火墙状态</span></span><br><span class="line">root@ceph1:/home# ufw status</span><br><span class="line">Status: active</span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭防火墙</span></span><br><span class="line">root@ceph1:/home# ufw disable</span><br><span class="line">Firewall stopped and disabled on system startup</span><br><span class="line">root@ceph1:/home# ufw status</span><br><span class="line">Status: inactive</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启防火墙</span></span><br><span class="line">root@ceph1:/home# ufw reload</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="SSH-免密登录-1"><a href="#SSH-免密登录-1" class="headerlink" title="SSH 免密登录"></a>SSH 免密登录</h3><ul>
<li><p>各节点执行如下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/home# sed -i &#x27;/PermitRootLogin/d&#x27; /etc/ssh/sshd_config</span><br><span class="line">root@ceph1:/home# echo &quot;PermitRootLogin yes&quot; &gt;&gt; /etc/ssh/sshd_config</span><br><span class="line">root@ceph1:/home# service sshd reload</span><br><span class="line">root@ceph1:/home# ssh-keygen</span><br><span class="line">root@ceph1:/home# ssh-copy-id -o StrictHostKeyChecking=no root@ceph1</span><br><span class="line">root@ceph1:/home# ssh-copy-id -o StrictHostKeyChecking=no root@ceph2</span><br><span class="line">root@ceph1:/home# ssh-copy-id -o StrictHostKeyChecking=no root@ceph3</span><br><span class="line">root@ceph1:/home# ssh-copy-id -o StrictHostKeyChecking=no root@ceph4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试是否能免密登录其他节点</span></span><br><span class="line">root@ceph1:/home# ssh ceph1</span><br><span class="line">root@ceph1:/home# ssh ceph2</span><br><span class="line">root@ceph1:/home# ssh ceph3</span><br><span class="line">root@ceph1:/home# ssh ceph4</span><br></pre></td></tr></table></figure>

<ul>
<li>ceph2，ceph3 和 ceph4 参考 ceph1 配置。</li>
</ul>
</li>
</ul>
<h3 id="服务器时间同步-1"><a href="#服务器时间同步-1" class="headerlink" title="服务器时间同步"></a>服务器时间同步</h3><ul>
<li><p>NTP 是通过网络来同步时间的一种 TCP/IP 协议。通常客户端向服务器请求当前的时间，并根据结果来设置其时钟。这个描述是挺简单的，实现这一功能却是极为复杂的：首先要有多层 NTP 服务器，第一层 NTP 服务器连接原子时钟，第二层、第三层服务器则担起负载均衡的责任，以处理因特网传来的所有请求。另外，客户端可能也超乎你想象的复杂：它必须排除通讯延迟，调整时间的同时不干扰其它在服务器中运行的进程。幸运的是，所有的这些复杂性都进行了封装，你是不可见也不需要见到的。</p>
</li>
<li><p>在 Ubuntu 中，可以使用 ntpdate 和 ntpd 来同步时间。而在最新的 Ubuntu 版本中，timedatectl 替代了老旧的 ntpdate。默认情况下，timedatectl 在系统启动的时候会立刻同步时间，并在稍后网络连接激活后通过 Socket 再次检查一次。</p>
</li>
<li><p>各节点查看时间：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/home# date</span><br><span class="line">Thu 30 Dec 2021 10:32:19 AM CST</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点设置时间同步服务器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看时间同步服务器状态</span></span><br><span class="line">root@ceph1:/opt# systemctl status systemd-timesyncd.service</span><br><span class="line">● systemd-timesyncd.service - Network Time Synchronization</span><br><span class="line">     Loaded: loaded (/lib/systemd/system/systemd-timesyncd.service; enabled; vendor preset: enabled)</span><br><span class="line">     Active: active (running) since Thu 2021-12-30 11:02:44 CST; 36min ago</span><br><span class="line">       Docs: man:systemd-timesyncd.service(8)</span><br><span class="line">   Main PID: 719 (systemd-timesyn)</span><br><span class="line">     Status: &quot;Initial synchronization to time server 91.189.91.157:123 (ntp.ubuntu.com).&quot;	# 默认ntp.ubuntu.com</span><br><span class="line">      Tasks: 2 (limit: 19110)</span><br><span class="line">     Memory: 1.7M</span><br><span class="line">     CGroup: /system.slice/systemd-timesyncd.service</span><br><span class="line">             └─719 /lib/systemd/systemd-timesyncd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加阿里云NTP服务器地址</span></span><br><span class="line">root@ceph1:/opt# vim /etc/systemd/timesyncd.conf</span><br><span class="line">root@ceph1:/opt# cat /etc/systemd/timesyncd.conf </span><br><span class="line"><span class="meta">#</span><span class="bash">  This file is part of systemd.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  systemd is free software; you can redistribute it and/or modify it</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  under the terms of the GNU Lesser General Public License as published by</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  the Free Software Foundation; either version 2.1 of the License, or</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  (at your option) any later version.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Entries <span class="keyword">in</span> this file show the compile time defaults.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> You can change settings by editing this file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Defaults can be restored by simply deleting this file.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See timesyncd.conf(5) <span class="keyword">for</span> details.</span></span><br><span class="line"></span><br><span class="line">[Time]</span><br><span class="line"><span class="meta">#</span><span class="bash">NTP=</span></span><br><span class="line"><span class="meta">#</span><span class="bash">FallbackNTP=ntp.ubuntu.com</span></span><br><span class="line"><span class="meta">#</span><span class="bash">RootDistanceMaxSec=5</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PollIntervalMinSec=32</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PollIntervalMaxSec=2048</span></span><br><span class="line">NTP=ntp1.aliyun.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启时间同步服务</span></span><br><span class="line">root@ceph1:/opt# systemctl restart systemd-timesyncd.service</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询时间同步服务状态，确认服务是否正常启动，是否从指定的NTP服务器上进行校时</span></span><br><span class="line">root@ceph1:/opt# systemctl status systemd-timesyncd.service</span><br><span class="line">● systemd-timesyncd.service - Network Time Synchronization</span><br><span class="line">     Loaded: loaded (/lib/systemd/system/systemd-timesyncd.service; enabled; vendor preset: enabled)</span><br><span class="line">     Active: active (running) since Thu 2021-12-30 11:50:14 CST; 14s ago</span><br><span class="line">       Docs: man:systemd-timesyncd.service(8)</span><br><span class="line">   Main PID: 3966 (systemd-timesyn)</span><br><span class="line">     Status: &quot;Initial synchronization to time server 120.25.115.20:123 (ntp1.aliyun.com).&quot;	# 修改为阿里云服务器</span><br><span class="line">      Tasks: 2 (limit: 19110)</span><br><span class="line">     Memory: 1.4M</span><br><span class="line">     CGroup: /system.slice/systemd-timesyncd.service</span><br><span class="line">             └─3966 /lib/systemd/systemd-timesyncd</span><br><span class="line"></span><br><span class="line">Dec 30 11:50:14 ceph2 systemd[1]: Starting Network Time Synchronization...</span><br><span class="line">Dec 30 11:50:14 ceph2 systemd[1]: Started Network Time Synchronization.</span><br><span class="line">Dec 30 11:50:14 ceph2 systemd-timesyncd[3966]: Initial synchronization to time server 120.25.115.20:123 (ntp1.aliyun.com).</span><br></pre></td></tr></table></figure>

<ul>
<li><p>系统默认同步的 NTP 服务器为 ntp.ubuntu.com。</p>
</li>
<li><p>添加一个阿里云 NTP 服务器地址，如果需要添加多个 NTP 服务器地址，则中间用空格隔开：</p>
<p><img src="/2021/12/21/ceph/image-20211230114924366.png" alt="image-20211230114924366"></p>
</li>
</ul>
</li>
<li><p>各节点设置时区：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 设置东八区</span></span><br><span class="line">root@ceph1:/home# timedatectl set-timezone Asia/Shanghai</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看时区</span></span><br><span class="line">root@ceph1:/home# cat /etc/timezone </span><br><span class="line">Asia/Shanghai</span><br><span class="line">root@ceph1:/home# timedatectl status | grep &#x27;Time zone&#x27;</span><br><span class="line">                Time zone: Asia/Shanghai (CST, +0800)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点查看时钟是否与互联网同步：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/home# timedatectl </span><br><span class="line">               Local time: Thu 2021-12-30 10:33:17 CST		# 本地时间</span><br><span class="line">           Universal time: Thu 2021-12-30 02:33:17 UTC		# 协调世界时</span><br><span class="line">                 RTC time: Thu 2021-12-30 02:33:17    		# 硬件时间</span><br><span class="line">                Time zone: Asia/Shanghai (CST, +0800) 		# 时区</span><br><span class="line">System clock synchronized: yes                       		# 如果和远程NTP服务器成功同步，则显示为yes </span><br><span class="line">              NTP service: active                     		# NTP时间同步是否开启，systemd-timesyncd服务活跃即开启了NTP时间同步</span><br><span class="line">          RTC in local TZ: no								# no表示硬件时钟设置为协调世界时（UTC），yes表示硬件时钟设置为本地时间</span><br></pre></td></tr></table></figure>

<ul>
<li>timedatectl 命令会显示本地时间、世界时、时区、系统时钟是否与互联网服务器同步，以及 <code>systemd-timesyncd.service</code> 是处于活跃状态还是非活跃状态。</li>
</ul>
</li>
</ul>
<h3 id="安装-Python3-1"><a href="#安装-Python3-1" class="headerlink" title="安装 Python3"></a>安装 Python3</h3><ul>
<li><p>各节点查看 Python3 版本，服务器已安装 Python3，此处省略安装步骤：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# python3 --version</span><br><span class="line">Python 3.8.10</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="安装-Docker-1"><a href="#安装-Docker-1" class="headerlink" title="安装 Docker"></a>安装 Docker</h3><ul>
<li><p>各节点卸载旧版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 卸载旧版本</span></span><br><span class="line">root@ceph1:/opt# apt remove docker docker-engine docker.io containerd runc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除旧版本数据</span></span><br><span class="line">root@ceph1:/opt# rm -rf /var/lib/docker/</span><br><span class="line">root@ceph1:/opt# rm -rf /var/lib/containerd/</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点安装需要的软件包：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# apt install ca-certificates curl gnupg lsb-release</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点添加 Docker 的官方 GPG key：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">OK</span><br><span class="line">W: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点添加 apt 的 Docker 源：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;</span><br><span class="line">Hit:1 http://mirrors.aliyun.com/ubuntu focal InRelease</span><br><span class="line">Hit:2 http://mirrors.aliyun.com/ubuntu focal-updates InRelease                                       </span><br><span class="line">Hit:3 http://mirrors.aliyun.com/ubuntu focal-backports InRelease                                                                                         </span><br><span class="line">Hit:4 http://mirrors.aliyun.com/ubuntu focal-security InRelease                                                                                          </span><br><span class="line">Get:5 https://download.docker.com/linux/ubuntu focal InRelease [57.7 kB]                                                  </span><br><span class="line">Get:6 https://download.docker.com/linux/ubuntu focal/stable amd64 Packages [13.5 kB] </span><br><span class="line">Get:7 https://download.ceph.com/debian-octopus focal InRelease [8,571 B]</span><br><span class="line">Get:8 https://download.ceph.com/debian-octopus focal/main amd64 Packages [15.9 kB]</span><br><span class="line">Fetched 95.7 kB in 2s (50.4 kB/s)     </span><br><span class="line">Reading package lists... Done</span><br><span class="line">W: http://mirrors.aliyun.com/ubuntu/dists/focal/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br><span class="line">W: http://mirrors.aliyun.com/ubuntu/dists/focal-updates/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br><span class="line">W: http://mirrors.aliyun.com/ubuntu/dists/focal-backports/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br><span class="line">W: http://mirrors.aliyun.com/ubuntu/dists/focal-security/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br><span class="line">W: https://download.docker.com/linux/ubuntu/dists/focal/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br><span class="line">W: https://download.ceph.com/debian-octopus/dists/focal/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/ceph.release.gpg are ignored as the file has an unsupported filetype.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>如果提示 <code>bash: add-apt-repository: command not found</code>，执行下面命令安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# apt install -y software-properties-common</span><br><span class="line">root@ceph1:/opt# apt update</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>各节点安装最新版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# apt install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
</li>
<li><p>Docker 安装完成后会自动启动：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看docker状态</span></span><br><span class="line">root@ceph1:/opt# systemctl status docker</span><br><span class="line">● docker.service - Docker Application Container Engine</span><br><span class="line">     Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: enabled)</span><br><span class="line">     Active: active (running) since Thu 2021-12-30 17:28:18 CST; 34s ago</span><br><span class="line">TriggeredBy: ● docker.socket</span><br><span class="line">       Docs: https://docs.docker.com</span><br><span class="line">   Main PID: 24185 (dockerd)</span><br><span class="line">      Tasks: 11</span><br><span class="line">     Memory: 29.1M</span><br><span class="line">     CGroup: /system.slice/docker.service</span><br><span class="line">             └─24185 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看docker版本</span></span><br><span class="line">root@ceph1:/opt# docker --version</span><br><span class="line">Docker version 20.10.12, build e91ed57</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点测试：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# docker run hello-world</span><br><span class="line">Unable to find image &#x27;hello-world:latest&#x27; locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">2db29710123e: Pull complete </span><br><span class="line">Digest: sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f</span><br><span class="line">Status: Downloaded newer image for hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image which runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"><span class="meta"> $</span><span class="bash"> docker run -it ubuntu bash</span></span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br><span class="line"></span><br><span class="line">root@ceph1:/opt# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    feb5d9fea6a5   3 months ago   13.3kB</span><br><span class="line">root@ceph1:/opt# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE         COMMAND    CREATED              STATUS                          PORTS     NAMES</span><br><span class="line">acf9377ed00d   hello-world   &quot;/hello&quot;   About a minute ago   Exited (0) About a minute ago             ecstatic_gould</span><br></pre></td></tr></table></figure>
</li>
<li><p>参考：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/ubuntu/">https://docs.docker.com/engine/install/ubuntu/</a></p>
</li>
</ul>
<h3 id="安装-Cephadm-1"><a href="#安装-Cephadm-1" class="headerlink" title="安装 Cephadm"></a>安装 Cephadm</h3><ul>
<li><p>各节点使用 apt 安装 Cephadm：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装</span></span><br><span class="line">root@ceph1:/opt# apt install -y cephadm</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">Recommended packages:</span><br><span class="line">  podman | docker.io</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  cephadm</span><br><span class="line">0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.</span><br><span class="line">Need to get 53.2 kB of archives.</span><br><span class="line">After this operation, 245 kB of additional disk space will be used.</span><br><span class="line">Get:1 https://download.ceph.com/debian-octopus focal/main amd64 cephadm amd64 15.2.15-1focal [53.2 kB]</span><br><span class="line">Fetched 53.2 kB in 2s (31.4 kB/s)  </span><br><span class="line">Selecting previously unselected package cephadm.</span><br><span class="line">(Reading database ... 115380 files and directories currently installed.)</span><br><span class="line">Preparing to unpack .../cephadm_15.2.15-1focal_amd64.deb ...</span><br><span class="line">Unpacking cephadm (15.2.15-1focal) ...</span><br><span class="line">Setting up cephadm (15.2.15-1focal) ...</span><br><span class="line">Adding system user cephadm....done</span><br><span class="line">Processing triggers for man-db (2.9.1-1) ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点验证 Cephadm 安装成功：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# which cephadm</span><br><span class="line">/usr/sbin/cephadm</span><br><span class="line">root@ceph1:/opt# cephadm version</span><br><span class="line">ceph version 15.2.15 (2dfb18841cfecc2f7eb7eb2afd65986ca4d95985) octopus (stable)</span><br></pre></td></tr></table></figure>
</li>
<li><p>各节点安装 ceph-common 工具：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 添加源</span></span><br><span class="line">root@ceph1:/opt# cephadm add-repo --release octopus</span><br><span class="line">Installing repo GPG key from https://download.ceph.com/keys/release.asc...</span><br><span class="line">Installing repo file at /etc/apt/sources.list.d/ceph.list...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装</span></span><br><span class="line">root@ceph1:/opt# cephadm install ceph-common</span><br><span class="line">Installing packages [&#x27;ceph-common&#x27;]...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 验证</span></span><br><span class="line">root@ceph1:/opt# ceph -v</span><br><span class="line">ceph version 15.2.15 (2dfb18841cfecc2f7eb7eb2afd65986ca4d95985) octopus (stable)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="创建-Ceph-新集群-1"><a href="#创建-Ceph-新集群-1" class="headerlink" title="创建 Ceph 新集群"></a>创建 Ceph 新集群</h3><ul>
<li><p>在 ceph1 上创建一个可以被任何访问 Ceph 集群的主机访问的网络，指定 mon-ip，并将生成的配置文件写进 <code>/etc/ceph</code> 目录里：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# cephadm bootstrap --mon-ip 192.168.1.91</span><br><span class="line">Verifying podman|docker is present...</span><br><span class="line">Verifying lvm2 is present...</span><br><span class="line">Verifying time synchronization is in place...</span><br><span class="line">Unit systemd-timesyncd.service is enabled and running</span><br><span class="line">Repeating the final host check...</span><br><span class="line">podman|docker (/usr/bin/docker) is present</span><br><span class="line">systemctl is present</span><br><span class="line">lvcreate is present</span><br><span class="line">Unit systemd-timesyncd.service is enabled and running</span><br><span class="line">Host looks OK</span><br><span class="line">Cluster fsid: 79a6cb92-6f92-11ec-b1e0-6f6f27397286</span><br><span class="line">Verifying IP 192.168.1.91 port 3300 ...</span><br><span class="line">Verifying IP 192.168.1.91 port 6789 ...</span><br><span class="line">Mon IP 192.168.1.91 is in CIDR network 192.168.1.0/24</span><br><span class="line">Pulling container image quay.io/ceph/ceph:v15...</span><br><span class="line">Extracting ceph user uid/gid from container image...</span><br><span class="line">Creating initial keys...</span><br><span class="line">Creating initial monmap...</span><br><span class="line">Creating mon...</span><br><span class="line">Waiting for mon to start...</span><br><span class="line">Waiting for mon...</span><br><span class="line">mon is available</span><br><span class="line">Assimilating anything we can from ceph.conf...</span><br><span class="line">Generating new minimal ceph.conf...</span><br><span class="line">Restarting the monitor...</span><br><span class="line">Setting mon public_network...</span><br><span class="line">Creating mgr...</span><br><span class="line">Verifying port 9283 ...</span><br><span class="line">Wrote keyring to /etc/ceph/ceph.client.admin.keyring</span><br><span class="line">Wrote config to /etc/ceph/ceph.conf</span><br><span class="line">Waiting for mgr to start...</span><br><span class="line">Waiting for mgr...</span><br><span class="line">mgr not available, waiting (1/10)...</span><br><span class="line">mgr not available, waiting (2/10)...</span><br><span class="line">mgr not available, waiting (3/10)...</span><br><span class="line">mgr not available, waiting (4/10)...</span><br><span class="line">mgr is available</span><br><span class="line">Enabling cephadm module...</span><br><span class="line">Waiting for the mgr to restart...</span><br><span class="line">Waiting for Mgr epoch 5...</span><br><span class="line">Mgr epoch 5 is available</span><br><span class="line">Setting orchestrator backend to cephadm...</span><br><span class="line">Generating ssh key...</span><br><span class="line">Wrote public SSH key to to /etc/ceph/ceph.pub</span><br><span class="line">Adding key to root@localhost&#x27;s authorized_keys...</span><br><span class="line">Adding host ceph1...</span><br><span class="line">Deploying mon service with default placement...</span><br><span class="line">Deploying mgr service with default placement...</span><br><span class="line">Deploying crash service with default placement...</span><br><span class="line">Enabling mgr prometheus module...</span><br><span class="line">Deploying prometheus service with default placement...</span><br><span class="line">Deploying grafana service with default placement...</span><br><span class="line">Deploying node-exporter service with default placement...</span><br><span class="line">Deploying alertmanager service with default placement...</span><br><span class="line">Enabling the dashboard module...</span><br><span class="line">Waiting for the mgr to restart...</span><br><span class="line">Waiting for Mgr epoch 13...</span><br><span class="line">Mgr epoch 13 is available</span><br><span class="line">Generating a dashboard self-signed certificate...</span><br><span class="line">Creating initial admin user...</span><br><span class="line">Fetching dashboard port number...</span><br><span class="line">Ceph Dashboard is now available at:</span><br><span class="line"></span><br><span class="line">	     URL: https://localhost:8443/</span><br><span class="line">	    User: admin</span><br><span class="line">	Password: vzmh8b8mp6</span><br><span class="line"></span><br><span class="line">You can access the Ceph CLI with:</span><br><span class="line"></span><br><span class="line">	sudo /usr/sbin/cephadm shell --fsid 79a6cb92-6f92-11ec-b1e0-6f6f27397286 -c /etc/ceph/ceph.conf -k /etc/ceph/ceph.client.admin.keyring</span><br><span class="line"></span><br><span class="line">Please consider enabling telemetry to help improve Ceph:</span><br><span class="line"></span><br><span class="line">	ceph telemetry on</span><br><span class="line"></span><br><span class="line">For more information see:</span><br><span class="line"></span><br><span class="line">	https://docs.ceph.com/docs/master/mgr/telemetry/</span><br><span class="line"></span><br><span class="line">Bootstrap complete.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>该命令执行如下操作：</p>
<ul>
<li><p>在本地主机上为新集群创建 monitor  和 manager daemon 守护程序。</p>
</li>
<li><p>为 Ceph 集群生成一个新的公共 SSH 密钥，并将其添加到 root 用户的 <code>/root/.ssh/authorized_keys</code> 文件中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC9iDQVKo2J9hNGVjq6XegDCAlLRuweTxbHruBauegj+7i5lTwJx0inpRcnshbPJxqRNimH54lr8mDYzQ2kVuVgFqpftB9Q+Y5VnMnvZWnlzaJgEQ0BOj4RmydRHKztbhay9YNyQebUxmSC/EYPCBRloM86A4gGGEoU4uroV9d6QZZ8memabUQRLuATygXEWK0upU9B5bRtoyEsHg+R9Ypc12/rz9sssOOwABmFd+ushouvF7oIdXmKQ4ehOY8t86YZV4PmOnEmuF/tfTYu+oLRkLro13Q0AmmmtTTjOiI5baekeldxiHf26DlFFxkzpAx7obTl+JrsS9DAiAwc/W51q2J70hRuVfSpA+U+TO7bUip+O8fpMwY3xDv2CZch0i7VN+MF8v/uB89ecW1AGz7Fu4xhaauTqlDXgJ1pG9jw6UnJRXwZI4UdAGaG0/tPUWMqOJ+HSnt8kjFa/U7Jp1t6W6ryHZTZXt+1JeuV4clAL0f3ic1R9d4k1jpnH4QsObM= root@ceph1		# ceph1免密登录</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCnzZyF16dJR8DpOTzyBwd4YbVE60blx7TOjn3VwPhPkU4f2lcJ2uPmFApEwHOTHvFi6Mz9jnE6BymrAHAUIzXPU5D8fasoJ5tNOKODYEtaETsdimEN1hLiLFKET8JLU/EUoy7pgHllxDlCsfwZvFoJ2XUvX1ab5rCs5AB4c/pU3IG24zN/UBsl7pynIA8XLAWFSSg2KHPEAYwNMF/oBLt4+/z5xBGDYBtdLId1lB/UrYyj9RamJywuSMEZckUbEEo8AqZeGzXbXKFwHcy2dxUesCFT0C5B95c71HU6g/3zOu/hYjXLUU/NeX7ggsPwKDr19p18JNxX+iyjpfrupK1PxgALniuZXKaHpiC7geGoosb8P0SR1Cq0RJhs/PWwPFpPqTRI2svUWLskb5WG2xIYVE6uuRhJAdTirKSX/+l8Bw5iau8BEYZ4zCT8g/qMhb+tpYeM7lGh8usr0RtsK/U/Z48zu1HqYMKVvK5olmwFKgRe6Ss5JqJ7GqX3T37UYL0= root@ceph2		# ceph1免密登录</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCiBgLpJH5BcUdTG4tT/6ln++GnCoMIpKlV3rjlYoWAa5efn60d1JKqgTBMRusa79D9kIihGCWjxBio2o0QplrKyHtjLKNLLaNShVOCZESJATrSf2ZwGmj6pS2RT4Bg0xchByZlQXIBwEyeLQ0T4hC45JYoXDeiPEezp+pPYqTIxDoks/wbb4IqUtsdtoXI1m/3GT1KCl1FofWWoc5PaXSiFwg+YZ5QAW2y6i5oRZH2cTyPpcrCtlqPRa1h8V8+C/vN8EcEMMxofW0sS4XCrtqYUcZcoPjcbHofQlC6cTf5/IhSNBME7Re2bMSFvn68n5vdS0z6fITSjCZdkm8I9V4omXpbGoztbbK4J7TDPL2IZWw6bh/LP7L4YuaUFPWmkHAWrckVtNEciYpXBgE9cKWgxpq0/UWXRFmMUgYmejz126/mtSwGpXV+VhjlXlw/wFsIS6k8BYEYsrFZrdYNgQA+6L0DenEwPqcfFb3NEqRH66Urgen3NCibBzYtpI5PlR8= root@ceph3		# ceph3免密登录</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCzntkcguxOqBlvUxBX0S80BzQd36MGxg3TkDLJWq5D/gi6hcUpQOrFwMtXctQWv+8AK708fXssaj07SwF939rxQFBrU83M59ZdrILAFH3dSZNOh4YYj30weHOmsj/uBkH9rQOYoc2JApVDV76OSjTm8Uztez8cQ0r355rd0wwHmX1eVkL1mgCu7PAemD64a4J7fZUOl0eYdz1HyqjGNprYZItAeqldAFwMfi8wQZubyfzeQX2hM5rWehaP5OxhvlCrHUdGhwM3m82fyNWzJcfCexnIfoaJkyYcEXrcjtvWfUeUcoLmYd6jSa19jhr2AkkDSxyxZ43p/73d5tgzJFzX5etjBK33P/zDfIG1HIiD56Tn9jOXJ/Kud9JF+RLGmEaVsvqWwZJLJIN8bin/S+Viv9kVtytOWFpilea1LQGg2Sap2Y/8oQJbDCk24wCHGKbRFmFYOalqEuX9GwM3h0mRwt+UBVv7M3x/JsliyA7tKlN9V+oPH+3LxVpw+Wfq8rU= root@ceph4		# ceph4免密登录</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDGii1dKJdramvUhkqwyix/G39kAEw+CGt1NNdM78QmrumLlWqtToO6TwmfgMqu/2geBafkOs9fhLJB+qV/oQ8mpBaGgzXgBOthtCMyEWBtBB78wJJ+cgn2EkkQLsmJmMfwbp+dnMJMvqWKPKYZoyODyZvhnS4uofFfpBqMI9xLjpnNgVerQbyN1DIH+WkBnrhonirzr78DPlsU3zpEdB5wlVduIqaPNrnW4DUNje5quhFcTd7D40kQeAKZBm5Py94R93BqEUyhRUYaz5dHAF4Wh/dTcD/aA3aq7fiOcdxNjOBD9Z/bCG5B32Eb+4iehzk3O4JoTNnl3FtYMVz50MaPphWQh9yBTbrUY/pxupvvderhDNz7yAxmSzM6MKVPlVaSpSaQf2MKUqWRNzcJDaOw8/aQi6GuJe/Iljpbvse1NO3cTtZF0IRuTjham90DptKyHfDgms9+gmhiDg6uLzM8jLmY74He8W8FOtalXBhALCYFP2lX9IYx1HFSnt42UdE= ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286																						# 公共SSH密钥</span><br></pre></td></tr></table></figure>
</li>
<li><p>将与新群集进行通信所需的最小配置文件保存到 <code>/etc/ceph/ceph.conf</code>。</p>
</li>
<li><p>向 <code>/etc/ceph/ceph.client.admin.keyring</code> 写入 <code>client.admin</code> 管理 secret key 的副本（特权！）。</p>
</li>
<li><p>将 public key 的副本写入 <code>/etc/ceph/ceph.pub</code>。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>查看当前配置文件：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ll /etc/ceph/</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x   2 root root 4096 Jan  7 16:19 ./</span><br><span class="line">drwxr-xr-x 104 root root 4096 Jan  7 16:02 ../</span><br><span class="line">-rw-------   1 root root   63 Jan  7 16:19 ceph.client.admin.keyring</span><br><span class="line">-rw-r--r--   1 root root  175 Jan  7 16:19 ceph.conf</span><br><span class="line">-rw-r--r--   1 root root  595 Jan  7 16:19 ceph.pub</span><br><span class="line">-rw-r--r--   1 root root   92 Oct 20 22:31 rbdmap</span><br><span class="line">root@ceph1:/opt# cat /etc/ceph/ceph.conf </span><br><span class="line"><span class="meta">#</span><span class="bash"> minimal ceph.conf <span class="keyword">for</span> 79a6cb92-6f92-11ec-b1e0-6f6f27397286</span></span><br><span class="line">[global]</span><br><span class="line">	fsid = 79a6cb92-6f92-11ec-b1e0-6f6f27397286</span><br><span class="line">	mon_host = [v2:192.168.1.91:3300/0,v1:192.168.1.91:6789/0]</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前拉取的镜像和启动的容器：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# docker images</span><br><span class="line">REPOSITORY                         TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">quay.io/ceph/ceph                  v15       3437f7bed968   2 months ago    1.08GB</span><br><span class="line">hello-world                        latest    feb5d9fea6a5   3 months ago    13.3kB</span><br><span class="line">quay.io/ceph/ceph-grafana          6.7.4     557c83e11646   5 months ago    486MB</span><br><span class="line">quay.io/prometheus/prometheus      v2.18.1   de242295e225   20 months ago   140MB</span><br><span class="line">quay.io/prometheus/alertmanager    v0.20.0   0881eb8f169f   2 years ago     52.1MB</span><br><span class="line">quay.io/prometheus/node-exporter   v0.18.1   e5a616e4b9cf   2 years ago     22.9MB</span><br><span class="line">root@ceph1:/opt# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE                                      COMMAND                  CREATED          STATUS                   PORTS     NAMES</span><br><span class="line">1fdde1918435   quay.io/prometheus/alertmanager:v0.20.0    &quot;/bin/alertmanager -…&quot;   47 minutes ago   Up 47 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-alertmanager.ceph1</span><br><span class="line">5fc44d4adaa8   quay.io/ceph/ceph-grafana:6.7.4            &quot;/bin/sh -c &#x27;grafana…&quot;   47 minutes ago   Up 47 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-grafana.ceph1</span><br><span class="line">85cac2612c10   quay.io/prometheus/prometheus:v2.18.1      &quot;/bin/prometheus --c…&quot;   47 minutes ago   Up 47 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-prometheus.ceph1</span><br><span class="line">d1aa75b76a39   quay.io/prometheus/node-exporter:v0.18.1   &quot;/bin/node_exporter …&quot;   48 minutes ago   Up 48 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-node-exporter.ceph1</span><br><span class="line">c20775682c08   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-crash…&quot;   48 minutes ago   Up 48 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-crash.ceph1</span><br><span class="line">7c3cf4e445d1   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mgr -…&quot;   54 minutes ago   Up 54 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-mgr.ceph1.tlpgcb</span><br><span class="line">6410679d498a   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mon -…&quot;   55 minutes ago   Up 54 minutes                      ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-mon.ceph1</span><br><span class="line">acf9377ed00d   hello-world                                &quot;/hello&quot;                 6 hours ago      Exited (0) 6 hours ago             ecstatic_gould</span><br></pre></td></tr></table></figure>

<ul>
<li>alertmanager 组件：prometheus 告警组件。</li>
<li>grafana 组件：监控数据展示 dashboard。</li>
<li>prometheus 组件：prometheus 监控组件。</li>
<li>node_exporter 组件：prometheus 节点数据收集组件。</li>
<li>ceph-crash 组件：崩溃数据收集模块。</li>
<li>ceph-mgr 组件：Ceph 管理程序。</li>
<li>ceph-monitor 组件：Ceph 监视器。</li>
</ul>
</li>
<li><p>查看所有组件运行状态：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ceph orch ps</span><br><span class="line">NAME                 HOST   STATUS        REFRESHED  AGE  VERSION  IMAGE NAME                                IMAGE ID      CONTAINER ID  </span><br><span class="line">alertmanager.ceph1   ceph1  running (5h)  8m ago     5h   0.20.0   quay.io/prometheus/alertmanager:v0.20.0   0881eb8f169f  1fdde1918435  </span><br><span class="line">crash.ceph1          ceph1  running (5h)  8m ago     5h   15.2.15  quay.io/ceph/ceph:v15                     3437f7bed968  c20775682c08  </span><br><span class="line">grafana.ceph1        ceph1  running (5h)  8m ago     5h   6.7.4    quay.io/ceph/ceph-grafana:6.7.4           557c83e11646  5fc44d4adaa8  </span><br><span class="line">mgr.ceph1.tlpgcb     ceph1  running (5h)  8m ago     5h   15.2.15  quay.io/ceph/ceph:v15                     3437f7bed968  7c3cf4e445d1  </span><br><span class="line">mon.ceph1            ceph1  running (5h)  8m ago     5h   15.2.15  quay.io/ceph/ceph:v15                     3437f7bed968  6410679d498a  </span><br><span class="line">node-exporter.ceph1  ceph1  running (5h)  8m ago     5h   0.18.1   quay.io/prometheus/node-exporter:v0.18.1  e5a616e4b9cf  d1aa75b76a39  </span><br><span class="line">prometheus.ceph1     ceph1  running (5h)  8m ago     5h   2.18.1   quay.io/prometheus/prometheus:v2.18.1     de242295e225  85cac2612c10</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看某个组件运行状态：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ceph orch ps --daemon-type mgr</span><br><span class="line">NAME              HOST   STATUS        REFRESHED  AGE  VERSION  IMAGE NAME             IMAGE ID      CONTAINER ID  </span><br><span class="line">mgr.ceph1.tlpgcb  ceph1  running (5h)  4m ago     5h   15.2.15  quay.io/ceph/ceph:v15  3437f7bed968  7c3cf4e445d1</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看容器状态：</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# cephadm ls</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;crash.ceph1&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@crash.ceph1&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;c20775682c087aaf8d1dc25802386ac4fbaf40b3ab8a4ae7ef54843e26725d94&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph:v15&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;3437f7bed9688a799444b439e1947a6f00d1f9b1fc986e843aec7e3ac8acd12b&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;15.2.15&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:25:11.762461Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:25:11.702112Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:25:11.318096Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:25:11.702112Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;grafana.ceph1&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@grafana.ceph1&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;5fc44d4adaa8365aa4a290d769fd08b25a2dee4c5235f4ef377aff0ced55ef2b&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph-grafana:6.7.4&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;557c83e11646f123a27b5e4b62ac6c45e7bb8b2e90d6044034d0db5b7019415c&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;6.7.4&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:26:37.418809Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:25:51.875753Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:25:51.487738Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:26:37.229606Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;mgr.ceph1.tlpgcb&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@mgr.ceph1.tlpgcb&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;7c3cf4e445d1113caa67c7502ffd5265961ecba5430e909f34f853b1fc021f1e&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph:v15&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;3437f7bed9688a799444b439e1947a6f00d1f9b1fc986e843aec7e3ac8acd12b&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;15.2.15&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:19:10.362590Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:19:10.279314Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:19:09.911299Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:26:37.749627Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;alertmanager.ceph1&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@alertmanager.ceph1&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;1fdde19184350e4c731b484bf10b3943e95f0ec27a306daa7ff547414e9e587e&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/prometheus/alertmanager:v0.20.0&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;0881eb8f169f5556a292b4e2c01d683172b12830a62a9225a98a8e206bb734f0&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;0.20.0&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:26:38.462159Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:25:09.854037Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:25:09.486022Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:26:38.297650Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;prometheus.ceph1&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@prometheus.ceph1&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;85cac2612c105ec9809a88fa97f99633b50b50ba12ee0a9b2beb95c608be73ff&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/prometheus/prometheus:v2.18.1&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;de242295e2257c37c8cadfd962369228f8f10b2d48a44259b65fef44ad4f6490&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;2.18.1&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:26:35.419299Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:26:35.361530Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:26:34.993515Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:26:35.361530Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;mon.ceph1&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@mon.ceph1&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;6410679d498a31428927c7a532548d39f5261c80f94c867849902a6bea12208b&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/ceph/ceph:v15&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;3437f7bed9688a799444b439e1947a6f00d1f9b1fc986e843aec7e3ac8acd12b&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;15.2.15&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:19:09.667576Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:19:08.539242Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:19:07.699208Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:26:38.785670Z&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;style&quot;: &quot;cephadm:v1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;node-exporter.ceph1&quot;,</span><br><span class="line">        &quot;fsid&quot;: &quot;79a6cb92-6f92-11ec-b1e0-6f6f27397286&quot;,</span><br><span class="line">        &quot;systemd_unit&quot;: &quot;ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286@node-exporter.ceph1&quot;,</span><br><span class="line">        &quot;enabled&quot;: true,</span><br><span class="line">        &quot;state&quot;: &quot;running&quot;,</span><br><span class="line">        &quot;container_id&quot;: &quot;d1aa75b76a39554b9b5cc7b5e9c4cf9c4ca4d00b9401af79b3c8eda6009fc215&quot;,</span><br><span class="line">        &quot;container_image_name&quot;: &quot;quay.io/prometheus/node-exporter:v0.18.1&quot;,</span><br><span class="line">        &quot;container_image_id&quot;: &quot;e5a616e4b9cf68dfcad7782b78e118be4310022e874d52da85c55923fb615f87&quot;,</span><br><span class="line">        &quot;version&quot;: &quot;0.18.1&quot;,</span><br><span class="line">        &quot;started&quot;: &quot;2022-01-07T08:26:02.530410Z&quot;,</span><br><span class="line">        &quot;created&quot;: &quot;2022-01-07T08:25:52.639785Z&quot;,</span><br><span class="line">        &quot;deployed&quot;: &quot;2022-01-07T08:25:52.179766Z&quot;,</span><br><span class="line">        &quot;configured&quot;: &quot;2022-01-07T08:25:52.639785Z&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据初始化完成的提示使用浏览器访问 dashboard：略。</p>
</li>
</ul>
<h3 id="启用-Ceph-命令-1"><a href="#启用-Ceph-命令-1" class="headerlink" title="启用 Ceph 命令"></a>启用 Ceph 命令</h3><ul>
<li><p>在 ceph1 上执行命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# cephadm shell</span><br><span class="line">Inferring fsid 79a6cb92-6f92-11ec-b1e0-6f6f27397286</span><br><span class="line">Inferring config /var/lib/ceph/79a6cb92-6f92-11ec-b1e0-6f6f27397286/mon.ceph1/config</span><br><span class="line">Using recent ceph image quay.io/ceph/ceph@sha256:a2c23b6942f7fbc1e15d8cfacd6655a681fe0e44f288e4a158db22030b8d58e3</span><br><span class="line">root@ceph1:/# alias ceph=&#x27;cephadm shell -- ceph&#x27;</span><br><span class="line">root@ceph1:/# exit</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看集群状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     79a6cb92-6f92-11ec-b1e0-6f6f27397286</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            OSD count 0 &lt; osd_pool_default_size 3</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1 (age 21h)</span><br><span class="line">    mgr: ceph1.tlpgcb(active, since 21h)</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0 B</span><br><span class="line">    usage:   0 B used, 0 B / 0 B avail</span><br><span class="line">    pgs:     </span><br><span class="line"> </span><br><span class="line">root@ceph1:/opt# ceph status</span><br><span class="line">  cluster:</span><br><span class="line">    id:     79a6cb92-6f92-11ec-b1e0-6f6f27397286</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            OSD count 0 &lt; osd_pool_default_size 3</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1 (age 21h)</span><br><span class="line">    mgr: ceph1.tlpgcb(active, since 21h)</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0 B</span><br><span class="line">    usage:   0 B used, 0 B / 0 B avail</span><br><span class="line">    pgs:     </span><br></pre></td></tr></table></figure>
<h3 id="添加新主机到集群中-1"><a href="#添加新主机到集群中-1" class="headerlink" title="添加新主机到集群中"></a>添加新主机到集群中</h3></li>
<li><p>第一步，在 ceph1 上执行命令，将集群的公共 SSH 密钥添加到新主机的根用户 authorized_keys 文件中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph2</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/etc/ceph/ceph.pub&quot;</span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   &quot;ssh &#x27;root@ceph2&#x27;&quot;</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">root@ceph1:/opt# ll /etc/ceph/</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x   2 root root 4096 Jan  7 16:19 ./</span><br><span class="line">drwxr-xr-x 104 root root 4096 Jan  7 16:02 ../</span><br><span class="line">-rw-------   1 root root   63 Jan  7 16:19 ceph.client.admin.keyring</span><br><span class="line">-rw-r--r--   1 root root  175 Jan  7 16:19 ceph.conf</span><br><span class="line">-rw-r--r--   1 root root  595 Jan  7 16:19 ceph.pub</span><br><span class="line">-rw-r--r--   1 root root   92 Oct 20 22:31 rbdmap</span><br><span class="line">root@ceph1:/opt# ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph3</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/etc/ceph/ceph.pub&quot;</span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   &quot;ssh &#x27;root@ceph3&#x27;&quot;</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">root@ceph1:/opt# ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph4</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/etc/ceph/ceph.pub&quot;</span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   &quot;ssh &#x27;root@ceph4&#x27;&quot;</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line">root@ceph1:/opt# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC9iDQVKo2J9hNGVjq6XegDCAlLRuweTxbHruBauegj+7i5lTwJx0inpRcnshbPJxqRNimH54lr8mDYzQ2kVuVgFqpftB9Q+Y5VnMnvZWnlzaJgEQ0BOj4RmydRHKztbhay9YNyQebUxmSC/EYPCBRloM86A4gGGEoU4uroV9d6QZZ8memabUQRLuATygXEWK0upU9B5bRtoyEsHg+R9Ypc12/rz9sssOOwABmFd+ushouvF7oIdXmKQ4ehOY8t86YZV4PmOnEmuF/tfTYu+oLRkLro13Q0AmmmtTTjOiI5baekeldxiHf26DlFFxkzpAx7obTl+JrsS9DAiAwc/W51q2J70hRuVfSpA+U+TO7bUip+O8fpMwY3xDv2CZch0i7VN+MF8v/uB89ecW1AGz7Fu4xhaauTqlDXgJ1pG9jw6UnJRXwZI4UdAGaG0/tPUWMqOJ+HSnt8kjFa/U7Jp1t6W6ryHZTZXt+1JeuV4clAL0f3ic1R9d4k1jpnH4QsObM= root@ceph1</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCnzZyF16dJR8DpOTzyBwd4YbVE60blx7TOjn3VwPhPkU4f2lcJ2uPmFApEwHOTHvFi6Mz9jnE6BymrAHAUIzXPU5D8fasoJ5tNOKODYEtaETsdimEN1hLiLFKET8JLU/EUoy7pgHllxDlCsfwZvFoJ2XUvX1ab5rCs5AB4c/pU3IG24zN/UBsl7pynIA8XLAWFSSg2KHPEAYwNMF/oBLt4+/z5xBGDYBtdLId1lB/UrYyj9RamJywuSMEZckUbEEo8AqZeGzXbXKFwHcy2dxUesCFT0C5B95c71HU6g/3zOu/hYjXLUU/NeX7ggsPwKDr19p18JNxX+iyjpfrupK1PxgALniuZXKaHpiC7geGoosb8P0SR1Cq0RJhs/PWwPFpPqTRI2svUWLskb5WG2xIYVE6uuRhJAdTirKSX/+l8Bw5iau8BEYZ4zCT8g/qMhb+tpYeM7lGh8usr0RtsK/U/Z48zu1HqYMKVvK5olmwFKgRe6Ss5JqJ7GqX3T37UYL0= root@ceph2</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCiBgLpJH5BcUdTG4tT/6ln++GnCoMIpKlV3rjlYoWAa5efn60d1JKqgTBMRusa79D9kIihGCWjxBio2o0QplrKyHtjLKNLLaNShVOCZESJATrSf2ZwGmj6pS2RT4Bg0xchByZlQXIBwEyeLQ0T4hC45JYoXDeiPEezp+pPYqTIxDoks/wbb4IqUtsdtoXI1m/3GT1KCl1FofWWoc5PaXSiFwg+YZ5QAW2y6i5oRZH2cTyPpcrCtlqPRa1h8V8+C/vN8EcEMMxofW0sS4XCrtqYUcZcoPjcbHofQlC6cTf5/IhSNBME7Re2bMSFvn68n5vdS0z6fITSjCZdkm8I9V4omXpbGoztbbK4J7TDPL2IZWw6bh/LP7L4YuaUFPWmkHAWrckVtNEciYpXBgE9cKWgxpq0/UWXRFmMUgYmejz126/mtSwGpXV+VhjlXlw/wFsIS6k8BYEYsrFZrdYNgQA+6L0DenEwPqcfFb3NEqRH66Urgen3NCibBzYtpI5PlR8= root@ceph3</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCzntkcguxOqBlvUxBX0S80BzQd36MGxg3TkDLJWq5D/gi6hcUpQOrFwMtXctQWv+8AK708fXssaj07SwF939rxQFBrU83M59ZdrILAFH3dSZNOh4YYj30weHOmsj/uBkH9rQOYoc2JApVDV76OSjTm8Uztez8cQ0r355rd0wwHmX1eVkL1mgCu7PAemD64a4J7fZUOl0eYdz1HyqjGNprYZItAeqldAFwMfi8wQZubyfzeQX2hM5rWehaP5OxhvlCrHUdGhwM3m82fyNWzJcfCexnIfoaJkyYcEXrcjtvWfUeUcoLmYd6jSa19jhr2AkkDSxyxZ43p/73d5tgzJFzX5etjBK33P/zDfIG1HIiD56Tn9jOXJ/Kud9JF+RLGmEaVsvqWwZJLJIN8bin/S+Viv9kVtytOWFpilea1LQGg2Sap2Y/8oQJbDCk24wCHGKbRFmFYOalqEuX9GwM3h0mRwt+UBVv7M3x/JsliyA7tKlN9V+oPH+3LxVpw+Wfq8rU= root@ceph4</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDGii1dKJdramvUhkqwyix/G39kAEw+CGt1NNdM78QmrumLlWqtToO6TwmfgMqu/2geBafkOs9fhLJB+qV/oQ8mpBaGgzXgBOthtCMyEWBtBB78wJJ+cgn2EkkQLsmJmMfwbp+dnMJMvqWKPKYZoyODyZvhnS4uofFfpBqMI9xLjpnNgVerQbyN1DIH+WkBnrhonirzr78DPlsU3zpEdB5wlVduIqaPNrnW4DUNje5quhFcTd7D40kQeAKZBm5Py94R93BqEUyhRUYaz5dHAF4Wh/dTcD/aA3aq7fiOcdxNjOBD9Z/bCG5B32Eb+4iehzk3O4JoTNnl3FtYMVz50MaPphWQh9yBTbrUY/pxupvvderhDNz7yAxmSzM6MKVPlVaSpSaQf2MKUqWRNzcJDaOw8/aQi6GuJe/Iljpbvse1NO3cTtZF0IRuTjham90DptKyHfDgms9+gmhiDg6uLzM8jLmY74He8W8FOtalXBhALCYFP2lX9IYx1HFSnt42UdE= ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286		# 公共SSH密钥</span><br></pre></td></tr></table></figure>
</li>
<li><p>在新结点上查看密钥是否添加成功：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ceph2:/opt# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC9iDQVKo2J9hNGVjq6XegDCAlLRuweTxbHruBauegj+7i5lTwJx0inpRcnshbPJxqRNimH54lr8mDYzQ2kVuVgFqpftB9Q+Y5VnMnvZWnlzaJgEQ0BOj4RmydRHKztbhay9YNyQebUxmSC/EYPCBRloM86A4gGGEoU4uroV9d6QZZ8memabUQRLuATygXEWK0upU9B5bRtoyEsHg+R9Ypc12/rz9sssOOwABmFd+ushouvF7oIdXmKQ4ehOY8t86YZV4PmOnEmuF/tfTYu+oLRkLro13Q0AmmmtTTjOiI5baekeldxiHf26DlFFxkzpAx7obTl+JrsS9DAiAwc/W51q2J70hRuVfSpA+U+TO7bUip+O8fpMwY3xDv2CZch0i7VN+MF8v/uB89ecW1AGz7Fu4xhaauTqlDXgJ1pG9jw6UnJRXwZI4UdAGaG0/tPUWMqOJ+HSnt8kjFa/U7Jp1t6W6ryHZTZXt+1JeuV4clAL0f3ic1R9d4k1jpnH4QsObM= root@ceph1</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCnzZyF16dJR8DpOTzyBwd4YbVE60blx7TOjn3VwPhPkU4f2lcJ2uPmFApEwHOTHvFi6Mz9jnE6BymrAHAUIzXPU5D8fasoJ5tNOKODYEtaETsdimEN1hLiLFKET8JLU/EUoy7pgHllxDlCsfwZvFoJ2XUvX1ab5rCs5AB4c/pU3IG24zN/UBsl7pynIA8XLAWFSSg2KHPEAYwNMF/oBLt4+/z5xBGDYBtdLId1lB/UrYyj9RamJywuSMEZckUbEEo8AqZeGzXbXKFwHcy2dxUesCFT0C5B95c71HU6g/3zOu/hYjXLUU/NeX7ggsPwKDr19p18JNxX+iyjpfrupK1PxgALniuZXKaHpiC7geGoosb8P0SR1Cq0RJhs/PWwPFpPqTRI2svUWLskb5WG2xIYVE6uuRhJAdTirKSX/+l8Bw5iau8BEYZ4zCT8g/qMhb+tpYeM7lGh8usr0RtsK/U/Z48zu1HqYMKVvK5olmwFKgRe6Ss5JqJ7GqX3T37UYL0= root@ceph2</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCiBgLpJH5BcUdTG4tT/6ln++GnCoMIpKlV3rjlYoWAa5efn60d1JKqgTBMRusa79D9kIihGCWjxBio2o0QplrKyHtjLKNLLaNShVOCZESJATrSf2ZwGmj6pS2RT4Bg0xchByZlQXIBwEyeLQ0T4hC45JYoXDeiPEezp+pPYqTIxDoks/wbb4IqUtsdtoXI1m/3GT1KCl1FofWWoc5PaXSiFwg+YZ5QAW2y6i5oRZH2cTyPpcrCtlqPRa1h8V8+C/vN8EcEMMxofW0sS4XCrtqYUcZcoPjcbHofQlC6cTf5/IhSNBME7Re2bMSFvn68n5vdS0z6fITSjCZdkm8I9V4omXpbGoztbbK4J7TDPL2IZWw6bh/LP7L4YuaUFPWmkHAWrckVtNEciYpXBgE9cKWgxpq0/UWXRFmMUgYmejz126/mtSwGpXV+VhjlXlw/wFsIS6k8BYEYsrFZrdYNgQA+6L0DenEwPqcfFb3NEqRH66Urgen3NCibBzYtpI5PlR8= root@ceph3</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCzntkcguxOqBlvUxBX0S80BzQd36MGxg3TkDLJWq5D/gi6hcUpQOrFwMtXctQWv+8AK708fXssaj07SwF939rxQFBrU83M59ZdrILAFH3dSZNOh4YYj30weHOmsj/uBkH9rQOYoc2JApVDV76OSjTm8Uztez8cQ0r355rd0wwHmX1eVkL1mgCu7PAemD64a4J7fZUOl0eYdz1HyqjGNprYZItAeqldAFwMfi8wQZubyfzeQX2hM5rWehaP5OxhvlCrHUdGhwM3m82fyNWzJcfCexnIfoaJkyYcEXrcjtvWfUeUcoLmYd6jSa19jhr2AkkDSxyxZ43p/73d5tgzJFzX5etjBK33P/zDfIG1HIiD56Tn9jOXJ/Kud9JF+RLGmEaVsvqWwZJLJIN8bin/S+Viv9kVtytOWFpilea1LQGg2Sap2Y/8oQJbDCk24wCHGKbRFmFYOalqEuX9GwM3h0mRwt+UBVv7M3x/JsliyA7tKlN9V+oPH+3LxVpw+Wfq8rU= root@ceph4</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDGii1dKJdramvUhkqwyix/G39kAEw+CGt1NNdM78QmrumLlWqtToO6TwmfgMqu/2geBafkOs9fhLJB+qV/oQ8mpBaGgzXgBOthtCMyEWBtBB78wJJ+cgn2EkkQLsmJmMfwbp+dnMJMvqWKPKYZoyODyZvhnS4uofFfpBqMI9xLjpnNgVerQbyN1DIH+WkBnrhonirzr78DPlsU3zpEdB5wlVduIqaPNrnW4DUNje5quhFcTd7D40kQeAKZBm5Py94R93BqEUyhRUYaz5dHAF4Wh/dTcD/aA3aq7fiOcdxNjOBD9Z/bCG5B32Eb+4iehzk3O4JoTNnl3FtYMVz50MaPphWQh9yBTbrUY/pxupvvderhDNz7yAxmSzM6MKVPlVaSpSaQf2MKUqWRNzcJDaOw8/aQi6GuJe/Iljpbvse1NO3cTtZF0IRuTjham90DptKyHfDgms9+gmhiDg6uLzM8jLmY74He8W8FOtalXBhALCYFP2lX9IYx1HFSnt42UdE= ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286			# 公共SSH密钥</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ceph3:/opt# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC9iDQVKo2J9hNGVjq6XegDCAlLRuweTxbHruBauegj+7i5lTwJx0inpRcnshbPJxqRNimH54lr8mDYzQ2kVuVgFqpftB9Q+Y5VnMnvZWnlzaJgEQ0BOj4RmydRHKztbhay9YNyQebUxmSC/EYPCBRloM86A4gGGEoU4uroV9d6QZZ8memabUQRLuATygXEWK0upU9B5bRtoyEsHg+R9Ypc12/rz9sssOOwABmFd+ushouvF7oIdXmKQ4ehOY8t86YZV4PmOnEmuF/tfTYu+oLRkLro13Q0AmmmtTTjOiI5baekeldxiHf26DlFFxkzpAx7obTl+JrsS9DAiAwc/W51q2J70hRuVfSpA+U+TO7bUip+O8fpMwY3xDv2CZch0i7VN+MF8v/uB89ecW1AGz7Fu4xhaauTqlDXgJ1pG9jw6UnJRXwZI4UdAGaG0/tPUWMqOJ+HSnt8kjFa/U7Jp1t6W6ryHZTZXt+1JeuV4clAL0f3ic1R9d4k1jpnH4QsObM= root@ceph1</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCnzZyF16dJR8DpOTzyBwd4YbVE60blx7TOjn3VwPhPkU4f2lcJ2uPmFApEwHOTHvFi6Mz9jnE6BymrAHAUIzXPU5D8fasoJ5tNOKODYEtaETsdimEN1hLiLFKET8JLU/EUoy7pgHllxDlCsfwZvFoJ2XUvX1ab5rCs5AB4c/pU3IG24zN/UBsl7pynIA8XLAWFSSg2KHPEAYwNMF/oBLt4+/z5xBGDYBtdLId1lB/UrYyj9RamJywuSMEZckUbEEo8AqZeGzXbXKFwHcy2dxUesCFT0C5B95c71HU6g/3zOu/hYjXLUU/NeX7ggsPwKDr19p18JNxX+iyjpfrupK1PxgALniuZXKaHpiC7geGoosb8P0SR1Cq0RJhs/PWwPFpPqTRI2svUWLskb5WG2xIYVE6uuRhJAdTirKSX/+l8Bw5iau8BEYZ4zCT8g/qMhb+tpYeM7lGh8usr0RtsK/U/Z48zu1HqYMKVvK5olmwFKgRe6Ss5JqJ7GqX3T37UYL0= root@ceph2</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCiBgLpJH5BcUdTG4tT/6ln++GnCoMIpKlV3rjlYoWAa5efn60d1JKqgTBMRusa79D9kIihGCWjxBio2o0QplrKyHtjLKNLLaNShVOCZESJATrSf2ZwGmj6pS2RT4Bg0xchByZlQXIBwEyeLQ0T4hC45JYoXDeiPEezp+pPYqTIxDoks/wbb4IqUtsdtoXI1m/3GT1KCl1FofWWoc5PaXSiFwg+YZ5QAW2y6i5oRZH2cTyPpcrCtlqPRa1h8V8+C/vN8EcEMMxofW0sS4XCrtqYUcZcoPjcbHofQlC6cTf5/IhSNBME7Re2bMSFvn68n5vdS0z6fITSjCZdkm8I9V4omXpbGoztbbK4J7TDPL2IZWw6bh/LP7L4YuaUFPWmkHAWrckVtNEciYpXBgE9cKWgxpq0/UWXRFmMUgYmejz126/mtSwGpXV+VhjlXlw/wFsIS6k8BYEYsrFZrdYNgQA+6L0DenEwPqcfFb3NEqRH66Urgen3NCibBzYtpI5PlR8= root@ceph3</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCzntkcguxOqBlvUxBX0S80BzQd36MGxg3TkDLJWq5D/gi6hcUpQOrFwMtXctQWv+8AK708fXssaj07SwF939rxQFBrU83M59ZdrILAFH3dSZNOh4YYj30weHOmsj/uBkH9rQOYoc2JApVDV76OSjTm8Uztez8cQ0r355rd0wwHmX1eVkL1mgCu7PAemD64a4J7fZUOl0eYdz1HyqjGNprYZItAeqldAFwMfi8wQZubyfzeQX2hM5rWehaP5OxhvlCrHUdGhwM3m82fyNWzJcfCexnIfoaJkyYcEXrcjtvWfUeUcoLmYd6jSa19jhr2AkkDSxyxZ43p/73d5tgzJFzX5etjBK33P/zDfIG1HIiD56Tn9jOXJ/Kud9JF+RLGmEaVsvqWwZJLJIN8bin/S+Viv9kVtytOWFpilea1LQGg2Sap2Y/8oQJbDCk24wCHGKbRFmFYOalqEuX9GwM3h0mRwt+UBVv7M3x/JsliyA7tKlN9V+oPH+3LxVpw+Wfq8rU= root@ceph4</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDGii1dKJdramvUhkqwyix/G39kAEw+CGt1NNdM78QmrumLlWqtToO6TwmfgMqu/2geBafkOs9fhLJB+qV/oQ8mpBaGgzXgBOthtCMyEWBtBB78wJJ+cgn2EkkQLsmJmMfwbp+dnMJMvqWKPKYZoyODyZvhnS4uofFfpBqMI9xLjpnNgVerQbyN1DIH+WkBnrhonirzr78DPlsU3zpEdB5wlVduIqaPNrnW4DUNje5quhFcTd7D40kQeAKZBm5Py94R93BqEUyhRUYaz5dHAF4Wh/dTcD/aA3aq7fiOcdxNjOBD9Z/bCG5B32Eb+4iehzk3O4JoTNnl3FtYMVz50MaPphWQh9yBTbrUY/pxupvvderhDNz7yAxmSzM6MKVPlVaSpSaQf2MKUqWRNzcJDaOw8/aQi6GuJe/Iljpbvse1NO3cTtZF0IRuTjham90DptKyHfDgms9+gmhiDg6uLzM8jLmY74He8W8FOtalXBhALCYFP2lX9IYx1HFSnt42UdE= ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286			# 公共SSH密钥</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ceph4:/opt# cat /root/.ssh/authorized_keys </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC9iDQVKo2J9hNGVjq6XegDCAlLRuweTxbHruBauegj+7i5lTwJx0inpRcnshbPJxqRNimH54lr8mDYzQ2kVuVgFqpftB9Q+Y5VnMnvZWnlzaJgEQ0BOj4RmydRHKztbhay9YNyQebUxmSC/EYPCBRloM86A4gGGEoU4uroV9d6QZZ8memabUQRLuATygXEWK0upU9B5bRtoyEsHg+R9Ypc12/rz9sssOOwABmFd+ushouvF7oIdXmKQ4ehOY8t86YZV4PmOnEmuF/tfTYu+oLRkLro13Q0AmmmtTTjOiI5baekeldxiHf26DlFFxkzpAx7obTl+JrsS9DAiAwc/W51q2J70hRuVfSpA+U+TO7bUip+O8fpMwY3xDv2CZch0i7VN+MF8v/uB89ecW1AGz7Fu4xhaauTqlDXgJ1pG9jw6UnJRXwZI4UdAGaG0/tPUWMqOJ+HSnt8kjFa/U7Jp1t6W6ryHZTZXt+1JeuV4clAL0f3ic1R9d4k1jpnH4QsObM= root@ceph1</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCnzZyF16dJR8DpOTzyBwd4YbVE60blx7TOjn3VwPhPkU4f2lcJ2uPmFApEwHOTHvFi6Mz9jnE6BymrAHAUIzXPU5D8fasoJ5tNOKODYEtaETsdimEN1hLiLFKET8JLU/EUoy7pgHllxDlCsfwZvFoJ2XUvX1ab5rCs5AB4c/pU3IG24zN/UBsl7pynIA8XLAWFSSg2KHPEAYwNMF/oBLt4+/z5xBGDYBtdLId1lB/UrYyj9RamJywuSMEZckUbEEo8AqZeGzXbXKFwHcy2dxUesCFT0C5B95c71HU6g/3zOu/hYjXLUU/NeX7ggsPwKDr19p18JNxX+iyjpfrupK1PxgALniuZXKaHpiC7geGoosb8P0SR1Cq0RJhs/PWwPFpPqTRI2svUWLskb5WG2xIYVE6uuRhJAdTirKSX/+l8Bw5iau8BEYZ4zCT8g/qMhb+tpYeM7lGh8usr0RtsK/U/Z48zu1HqYMKVvK5olmwFKgRe6Ss5JqJ7GqX3T37UYL0= root@ceph2</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCiBgLpJH5BcUdTG4tT/6ln++GnCoMIpKlV3rjlYoWAa5efn60d1JKqgTBMRusa79D9kIihGCWjxBio2o0QplrKyHtjLKNLLaNShVOCZESJATrSf2ZwGmj6pS2RT4Bg0xchByZlQXIBwEyeLQ0T4hC45JYoXDeiPEezp+pPYqTIxDoks/wbb4IqUtsdtoXI1m/3GT1KCl1FofWWoc5PaXSiFwg+YZ5QAW2y6i5oRZH2cTyPpcrCtlqPRa1h8V8+C/vN8EcEMMxofW0sS4XCrtqYUcZcoPjcbHofQlC6cTf5/IhSNBME7Re2bMSFvn68n5vdS0z6fITSjCZdkm8I9V4omXpbGoztbbK4J7TDPL2IZWw6bh/LP7L4YuaUFPWmkHAWrckVtNEciYpXBgE9cKWgxpq0/UWXRFmMUgYmejz126/mtSwGpXV+VhjlXlw/wFsIS6k8BYEYsrFZrdYNgQA+6L0DenEwPqcfFb3NEqRH66Urgen3NCibBzYtpI5PlR8= root@ceph3</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCzntkcguxOqBlvUxBX0S80BzQd36MGxg3TkDLJWq5D/gi6hcUpQOrFwMtXctQWv+8AK708fXssaj07SwF939rxQFBrU83M59ZdrILAFH3dSZNOh4YYj30weHOmsj/uBkH9rQOYoc2JApVDV76OSjTm8Uztez8cQ0r355rd0wwHmX1eVkL1mgCu7PAemD64a4J7fZUOl0eYdz1HyqjGNprYZItAeqldAFwMfi8wQZubyfzeQX2hM5rWehaP5OxhvlCrHUdGhwM3m82fyNWzJcfCexnIfoaJkyYcEXrcjtvWfUeUcoLmYd6jSa19jhr2AkkDSxyxZ43p/73d5tgzJFzX5etjBK33P/zDfIG1HIiD56Tn9jOXJ/Kud9JF+RLGmEaVsvqWwZJLJIN8bin/S+Viv9kVtytOWFpilea1LQGg2Sap2Y/8oQJbDCk24wCHGKbRFmFYOalqEuX9GwM3h0mRwt+UBVv7M3x/JsliyA7tKlN9V+oPH+3LxVpw+Wfq8rU= root@ceph4</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDGii1dKJdramvUhkqwyix/G39kAEw+CGt1NNdM78QmrumLlWqtToO6TwmfgMqu/2geBafkOs9fhLJB+qV/oQ8mpBaGgzXgBOthtCMyEWBtBB78wJJ+cgn2EkkQLsmJmMfwbp+dnMJMvqWKPKYZoyODyZvhnS4uofFfpBqMI9xLjpnNgVerQbyN1DIH+WkBnrhonirzr78DPlsU3zpEdB5wlVduIqaPNrnW4DUNje5quhFcTd7D40kQeAKZBm5Py94R93BqEUyhRUYaz5dHAF4Wh/dTcD/aA3aq7fiOcdxNjOBD9Z/bCG5B32Eb+4iehzk3O4JoTNnl3FtYMVz50MaPphWQh9yBTbrUY/pxupvvderhDNz7yAxmSzM6MKVPlVaSpSaQf2MKUqWRNzcJDaOw8/aQi6GuJe/Iljpbvse1NO3cTtZF0IRuTjham90DptKyHfDgms9+gmhiDg6uLzM8jLmY74He8W8FOtalXBhALCYFP2lX9IYx1HFSnt42UdE= ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286			# 公共SSH密钥</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步，在 ceph1 上执行命令，告诉 Ceph，新节点是集群的一部分：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ceph orch host add ceph2</span><br><span class="line">Added host &#x27;ceph2&#x27;</span><br><span class="line">root@ceph1:/opt# ceph orch host add ceph3</span><br><span class="line">Added host &#x27;ceph3&#x27;</span><br><span class="line">root@ceph1:/opt# ceph orch host add ceph4</span><br><span class="line">Added host &#x27;ceph4&#x27;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 Ceph 纳管的所有节点：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ceph orch host ls</span><br><span class="line">HOST   ADDR   LABELS  STATUS  </span><br><span class="line">ceph1  ceph1                  </span><br><span class="line">ceph2  ceph2                  </span><br><span class="line">ceph3  ceph3                  </span><br><span class="line">ceph4  ceph4</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加完成后 Ceph 会自动扩展 monitor 和 manager 到另外 3 个节点，在另外 3 个节点查看，自动运行了以下容器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ceph2:/opt# docker ps</span><br><span class="line">CONTAINER ID   IMAGE                                      COMMAND                  CREATED        STATUS        PORTS     NAMES</span><br><span class="line">9631037be5f4   quay.io/prometheus/node-exporter:v0.18.1   &quot;/bin/node_exporter …&quot;   13 hours ago   Up 13 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-node-exporter.ceph2</span><br><span class="line">08b248e6e233   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mgr -…&quot;   13 hours ago   Up 13 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-mgr.ceph2.nxltpk</span><br><span class="line">9a57743caf61   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-crash…&quot;   13 hours ago   Up 13 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-crash.ceph2</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ceph3:/opt# docker ps</span><br><span class="line">CONTAINER ID   IMAGE                                      COMMAND                  CREATED        STATUS        PORTS     NAMES</span><br><span class="line">f9ed0005d967   quay.io/prometheus/node-exporter:v0.18.1   &quot;/bin/node_exporter …&quot;   14 hours ago   Up 14 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-node-exporter.ceph3</span><br><span class="line">57c0c9ba4221   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mon -…&quot;   14 hours ago   Up 14 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-mon.ceph3</span><br><span class="line">6ad0d2342d96   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-crash…&quot;   14 hours ago   Up 14 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-crash.ceph3</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ceph4:/opt# docker ps</span><br><span class="line">CONTAINER ID   IMAGE                                      COMMAND                  CREATED        STATUS        PORTS     NAMES</span><br><span class="line">fedc448936a7   quay.io/prometheus/node-exporter:v0.18.1   &quot;/bin/node_exporter …&quot;   14 hours ago   Up 14 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-node-exporter.ceph4</span><br><span class="line">028820a77622   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-mon -…&quot;   14 hours ago   Up 14 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-mon.ceph4</span><br><span class="line">d2cee165f5de   quay.io/ceph/ceph:v15                      &quot;/usr/bin/ceph-crash…&quot;   14 hours ago   Up 14 hours             ceph-79a6cb92-6f92-11ec-b1e0-6f6f27397286-crash.ceph4</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 Ceph 集群状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@ceph1:/opt# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     79a6cb92-6f92-11ec-b1e0-6f6f27397286</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            Reduced data availability: 1 pg inactive</span><br><span class="line">            OSD count 0 &lt; osd_pool_default_size 3</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 3 daemons, quorum ceph1,ceph4,ceph3 (age 14h)</span><br><span class="line">    mgr: ceph1.tlpgcb(active, since 2d), standbys: ceph2.nxltpk</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   1 pools, 1 pgs</span><br><span class="line">    objects: 0 objects, 0 B</span><br><span class="line">    usage:   0 B used, 0 B / 0 B avail</span><br><span class="line">    pgs:     100.000% pgs unknown</span><br><span class="line">             1 unknown</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.ceph.com/en/latest/install/#recommended-methods">https://docs.ceph.com/en/latest/install/#recommended-methods</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.ceph.com/en/latest/cephadm/install/">https://docs.ceph.com/en/latest/cephadm/install/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/willseecloud/ceph/1788314">https://www.kancloud.cn/willseecloud/ceph/1788314</a></li>
<li>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/18/python-scientific/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/18/python-scientific/" class="post-title-link" itemprop="url">python 科学计算工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-18 19:41:42" itemprop="dateCreated datePublished" datetime="2021-10-18T19:41:42+08:00">2021-10-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-05 15:01:54" itemprop="dateModified" datetime="2022-01-05T15:01:54+08:00">2022-01-05</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>542</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Numpy"><a href="#Numpy" class="headerlink" title="Numpy"></a>Numpy</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(base) <span class="built_in">PS</span> C:\Users\XiSun&gt; conda env list</span><br><span class="line"><span class="comment"># conda environments:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">base                  *  D:\Program\Miniconda3</span><br><span class="line">py38                     D:\Program\Miniconda3\envs\py38</span><br><span class="line"></span><br><span class="line">(base) <span class="built_in">PS</span> C:\Users\XiSun&gt; conda activate py38</span><br><span class="line">(py38) <span class="built_in">PS</span> C:\Users\XiSun&gt; conda init</span><br><span class="line">(py38) <span class="built_in">PS</span> C:\Users\XiSun&gt; conda install numpy <span class="literal">-y</span></span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h2 id="Pandas"><a href="#Pandas" class="headerlink" title="Pandas"></a>Pandas</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43060552/article/details/104862200">https://blog.csdn.net/qq_43060552/article/details/104862200</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzay/p/13157863.html">https://www.cnblogs.com/zzay/p/13157863.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wenqiangit/p/11252859.html">https://www.cnblogs.com/wenqiangit/p/11252859.html</a></p>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p>正则：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/memect/kg-beijing/wiki/%E7%AC%AC%E4%B8%80%E6%9C%9Fw1%EF%BC%9A%E7%9F%A5%E8%AF%86%E6%8F%90%E5%8F%96">https://github.com/memect/kg-beijing/wiki/%E7%AC%AC%E4%B8%80%E6%9C%9Fw1%EF%BC%9A%E7%9F%A5%E8%AF%86%E6%8F%90%E5%8F%96</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/06/python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/06/python/" class="post-title-link" itemprop="url">Python 入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-06 10:09:24" itemprop="dateCreated datePublished" datetime="2021-09-06T10:09:24+08:00">2021-09-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-25 17:23:05" itemprop="dateModified" datetime="2022-01-25T17:23:05+08:00">2022-01-25</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>106k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:37</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="计算机基础知识"><a href="#计算机基础知识" class="headerlink" title="计算机基础知识"></a>计算机基础知识</h2><h3 id="Windows-的命令行"><a href="#Windows-的命令行" class="headerlink" title="Windows 的命令行"></a>Windows 的命令行</h3><ul>
<li><p>用户界面分成两种：TUI（文本交互界面）和 GUI（图形化交互界面）。</p>
</li>
<li><p>命令行就是文本交互界面，通过命令行可以使用一个一个的指令来操作计算机。</p>
</li>
<li><p>任何计算机的操作系统中都包含有命令行（Windows、Linux、MacOS），命令行有多个不同的名字：命令行、命令行窗口、DOS 窗口、命令提示符、CMD 窗口、Shell、终端、Terminal。</p>
</li>
<li><p>命令行的进入方式：<code>win 键 + R</code>，出现运行窗口，输入cmd，然后回车。</p>
</li>
<li><p>命令行的结构</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Microsoft Windows [版本 <span class="number">10</span>.<span class="number">0</span>.<span class="number">19042</span>.<span class="number">1165</span>]</span><br><span class="line">(c) Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">Xisun</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>上面两行为版本及版权声明（一般没有什么用）</li>
<li>最下面一行为命令提示符<pre><code>  - `C`：当前所在的磁盘根目录，通过 `x:` 来切换盘符（x 表示你的盘符）。
  - `\Users\Xisun`：当前所在磁盘的路径，通过 `cd` 来切换目录。
  - `&gt;`：命令提示符，在符号后边可以直接输入指令。</code></pre>
</li>
</ul>
</li>
<li><p>常用的 DOS 命令</p>
<ul>
<li>语法：<code>命令 [参数] [选项]</code></li>
<li><code>dir</code>：查看当前目录下的所有文件（夹）</li>
<li><code>cd</code>：进入到指定的目录<ul>
<li><code>.</code>：表示当前目录。</li>
<li><code>..</code>：表示上一级目录。</li>
</ul>
</li>
<li><code>md</code>：创建一个目录。</li>
<li><code>rd</code>：删除一个目录。</li>
<li><code>del</code>：删除一个文件。</li>
<li><code>cls</code>：清除屏幕。</li>
<li>小技巧：方向键上下，查看命令的历史记录；tab 键自动补全命令。</li>
</ul>
</li>
</ul>
<h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><ul>
<li>环境变量指的就是操作系统当中的一些变量。可以通过修改环境变量，来对计算机进行配置（主要是来配置一些路径的）。</li>
<li>查看环境变量<ul>
<li>右键计算机（此电脑）—&gt; 选择属性 —&gt; 系统界面左侧选择高级系统设置 —&gt; 选择环境变量。</li>
<li>环境变量界面分成了两个部分，上边是用户环境变量，下边是系统环境变量。</li>
<li>用户环境变量只对当前用户有效，系统环境变量对所有用户有效。</li>
</ul>
</li>
<li>添加环境变量<ul>
<li>通过新建按钮添加环境变量。</li>
<li>一个环境变量可以由多个值，值与值之间使用 <code>;</code> 隔开。</li>
</ul>
</li>
<li>修改环境变量<ul>
<li>通过编辑按钮来修改环境变量。</li>
</ul>
</li>
<li>删除环境变量<ul>
<li>通过删除按钮来删除环境变量。</li>
</ul>
</li>
</ul>
<h3 id="path-环境变量"><a href="#path-环境变量" class="headerlink" title="path 环境变量"></a>path 环境变量</h3><ul>
<li>path 环境变量中保存的是一个一个的路径。当我们在命令行中输入一个命令（或访问一个文件时），系统会首先在当前目录下寻找，如果找到了则直接执行或打开；如果没有找到，则会依次去 path 环境变量的路径中去寻找，直到找到为止；如果 path 环境变量中的路径都没有找到，则报错：<code>&#39;xxx&#39; 不是内部或外部命令，也不是可运行的程序或批处理文件</code>。</li>
<li>将一些经常需要访问到的文件或程序的路径，添加到 path 环境变量中，这样就可以在任意的位置访问到这些文件或程序。</li>
<li>注意事项：<ul>
<li>如果环境变量中没有 path，可以手动添加。</li>
<li>path 环境变量不区分大小写：PATH、Path 或 path。</li>
<li>修改完环境变量必须重新启动命令行窗口。</li>
<li>多个路径之间使用 <code>;</code> 隔开。</li>
</ul>
</li>
</ul>
<h3 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h3><ul>
<li>十进制<ul>
<li>十进制是最常用的进制。</li>
<li>十进制算法：满十进一。</li>
<li>十进制当中一共有 10 个数字：0，1，2，3，4，5，6，7，8，9。</li>
<li>十进制如何计数：0，1，2，3，4，5，6，7，8，9；10，11，12，。。。，19；20，。。。，29；30，…<ul>
<li>个位表示有几个 1，十位表示有几个 10，百位表示有几个 100，千位表示有几个 1000，以此类推。如：5421。</li>
</ul>
</li>
</ul>
</li>
<li>二进制<ul>
<li>二进制是计算机底层使用的进制。<ul>
<li>所有的数据在计算机底层都是以二进制的形式保存的，计算机只认二进制。</li>
<li>可以将内存想象为一个一个的小格子，小格子中可以存储一个 0 或一个 1。</li>
<li>内存中的每一个小格子，我们称为 1 bit（1 位）。<ul>
<li>bit 是计算机中的最小的单位。</li>
<li>byte 是我们可操作的最小的单位。<ul>
<li>8 bit = 1 byte（字节）</li>
<li>1024 byte = 1 kb（千字节）</li>
<li>1024 kb = 1 mb（兆字节）</li>
<li>1024 mb = 1 gb（吉字节）</li>
<li>1024 gb = 1 tb（太字节）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>二进制算法：满二进一。</li>
<li>二进制中一共有 2 个数字：0，1。</li>
<li>二进制如何计数：0，1；10，11；100，101，110，111；1000，…<ul>
<li>第一位表示有几个 1，第二位表示有几个 2，第三位表示有几个 4，第四位表示有几个 8，依次类推。如：1011。</li>
</ul>
</li>
</ul>
</li>
<li>八进制<ul>
<li>一般不用。</li>
<li>八进制算法：满八进一。</li>
<li>八进制中一共有 8 个数字：0，1，2，3，4，5，6，7。</li>
<li>八进制如何计数：0，1，2，3，4，5，6，7；10，11，…，17；20，21，…，27；…</li>
</ul>
</li>
<li>十六进制<ul>
<li>在查看二进制数据时，一般会以十六进制的形式显示。</li>
<li>十六进制算法：满十六进一。</li>
<li>十六进制中一共有 16 个数字：0，1，2，3，4，5，6，7，8，9，a，b，c，d，e，f 。<ul>
<li>由于十六进制是满 16 才进位，所以十六进制中引入了 a，b，c，d，e，f 来表示 10，11，12，13，14，15。</li>
</ul>
</li>
<li>十六进制如何计数：0，1，2，3，4，5，6，7，8，9，a，b，c，d，e，f ；10，11，12 ，…，1a，1b，1c，1d，1e，1f，20，21，22，…，2a，2b，2c，2d，2e，2f；30，…   </li>
</ul>
</li>
</ul>
<h3 id="文本文件和字符集"><a href="#文本文件和字符集" class="headerlink" title="文本文件和字符集"></a>文本文件和字符集</h3><ul>
<li><p>文本分成两种，一种叫做纯文本，还有一种叫做富文本。</p>
</li>
<li><p>纯文本中只能保存单一的文本内容，无法保存内容无关的东西（如字体、颜色、图片等）。常见的纯文本如记事本。</p>
</li>
<li><p>富文本中可以保存文本以外的内容。常见的富文本如 word 文档。</p>
</li>
<li><p>在开发时，编写程序使用的全都是纯文本！</p>
</li>
<li><p>纯文本在计算机底层也会转换为二进制保存：</p>
<ul>
<li>将字符转换为二进制码的过程，称为编码。</li>
<li>将二进制码转换为字符的过程，称为解码。</li>
<li>编码和解码时所采用的规则，称为字符集。</li>
</ul>
</li>
<li><p>常见的字符集：</p>
<ul>
<li>ASCII<ul>
<li>美国人编码，使用 7 位来对美国常用的字符进行编码。</li>
<li>包含 128 个字符。</li>
</ul>
</li>
<li>ISO-8859-1<ul>
<li>欧洲的编码，使用 8 位来对欧洲常用的字符进行编码。</li>
<li>包含 256 个字符。</li>
</ul>
</li>
<li>GB2312，GBK<ul>
<li>国标码，中国的编码。</li>
</ul>
</li>
<li>Unicode<ul>
<li>万国码，包含世界上所有的语言和符号，编写程序时一般都会使用 Unicode 编码。</li>
<li>Unicode 编码有多种实现，如  UTF-8，UTF-16，UTF-32，最常用的就是 UTF-8。</li>
</ul>
</li>
</ul>
</li>
<li><p>乱码：编写程序时，如果发现程序代码出现乱码的情况，就要马上去检查字符集是否正确。</p>
</li>
</ul>
<h3 id="计算机语言"><a href="#计算机语言" class="headerlink" title="计算机语言"></a>计算机语言</h3><ul>
<li>计算机语言就是用来控制计算机的编程语言。</li>
<li>计算机语言发展经历了三个阶段：<ul>
<li>机器语言<ul>
<li>机器语言通过二进制编码来编写程序。</li>
<li>执行效率好，但编写起来太麻烦。</li>
</ul>
</li>
<li>符号语言/汇编语言<ul>
<li>使用符号来代替机器码。</li>
<li>编写程序时，不需要使用二进制，而是直接编写符号。</li>
<li>编写完成后，需要将符号转换为机器码，然后再由计算机执行。</li>
<li>将符号转换为机器码的过程，称为汇编。</li>
<li>将机器码转换为符号的过程，称为反汇编。</li>
<li>汇编语言一般只适用于某些硬件，兼容性比较差。</li>
</ul>
</li>
<li>高级语言<ul>
<li>高级语言的语法基本和现在英语语法类似，并且和硬件的关系没有那么紧密了。</li>
<li>也就是说我们通过高级语言开发的程序，可以在不同的硬件系统中执行。</li>
<li>并且高级语言学习起来也更加的容易，现在我们知道的语言基本都是高级语言。比如：C、C++、C#、Java、JavaScript、Python等。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="编译型语言和解释型语言"><a href="#编译型语言和解释型语言" class="headerlink" title="编译型语言和解释型语言"></a>编译型语言和解释型语言</h3><ul>
<li><p>计算机只能识别二进制编码（机器码），所以任何的语言在交由计算机执行时必须要先转换为机器码，也就是像 <code>print(&#39;hello&#39;)</code> 必需要转换为类似 <code>1010101</code> 这样的机器码。</p>
</li>
<li><p>根据转换时机的不同，语言分成了两大类：</p>
<ul>
<li><p>编译型语言</p>
<ul>
<li>会在代码执行前将代码编译为机器码，然后将机器码交由计算机执行。最典型的就是 C 语言。</li>
<li>过程：a（源码）—&gt; 编译 —&gt; b（编译后的机器码）。</li>
<li>特点：<ul>
<li>执行速度特别快。</li>
<li>跨平台性比较差。</li>
</ul>
</li>
</ul>
</li>
<li><p>解释型语言 </p>
<ul>
<li><p>不会在执行前对代码进行编译，而是在执行的同时一边执行一边编译。比如 Python，JS，Java 等。</p>
</li>
<li><p>过程：a（源码）—&gt; 解释器 —&gt; 解释执行。</p>
</li>
<li><p>特点：</p>
<ul>
<li>执行速度比较慢。</li>
<li>跨平台性比较好  。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Python-简介"><a href="#Python-简介" class="headerlink" title="Python 简介"></a>Python 简介</h2><ul>
<li>现在，全世界差不多有 600 多种编程语言，但流行的编程语言也就那么 20 来种。</li>
<li>总的来说，每种编程语言各有千秋。C 语言是可以用来编写操作系统的贴近硬件的语言，所以，C 语言适合开发那些追求运行速度、充分发挥硬件性能的程序。而 Python 是用来编写应用程序的高级编程语言。</li>
<li>Python 提供了非常完善的基础代码库，覆盖了网络、文件、GUI、数据库、文本等大量内容，被形象地称作“内置电池（batteries included）”。用 Python 开发，许多功能不必从零编写，直接使用现成的即可。</li>
<li>除了内置的库外，Python 还有大量的第三方库，也就是别人开发的，供你直接使用的东西。当然，如果你开发的代码通过很好的封装，也可以作为第三方库给别人使用。</li>
<li>Python 的定位是“优雅”、“明确”、“简单”。Python 的哲学就是简单优雅，尽量写容易看明白的代码，尽量写少的代码。</li>
<li>Python 适合开发的应用类型：<ul>
<li>首选是网络应用，包括网站、后台服务等等。</li>
<li>其次是许多日常需要的小工具，包括系统管理员需要的脚本任务等等。</li>
<li>另外就是把其他语言开发的程序再包装起来，方便使用。</li>
</ul>
</li>
<li>Python 的缺点：<ul>
<li>第一个缺点就是运行速度慢，和 C 程序相比非常慢，因为 Python 是解释型语言，编写的代码在执行时会一行一行地翻译成 CPU 能理解的机器码，这个翻译过程非常耗时，所以很慢。而 C 程序是运行前直接编译成 CPU 能执行的机器码，所以非常快。</li>
<li>第二个缺点就是代码不能加密。如果要发布编写的 Python 程序，实际上就是发布源代码，这一点跟 C 语言不同，C 语言不用发布源代码，只需要把编译后的机器码（也就是在 Windows 上常见的 xxx.exe 文件）发布出去。要从机器码反推出 C 代码是不可能的，所以，凡是编译型的语言，都没有这个问题，而解释型的语言，则必须把源码发布出去。</li>
</ul>
</li>
</ul>
<h2 id="Python-安装"><a href="#Python-安装" class="headerlink" title="Python 安装"></a>Python 安装</h2><ul>
<li><p>Python 是跨平台的，它可以运行在 Windows、Mac 和各种 Linux/Unix 系统上。在 Windows 上写 Python 程序，放到 Linux 上也是能够运行的。</p>
</li>
<li><p>要开始学习 Python 编程，首先就得把 Python 安装到你的电脑里。安装后，你会得到 Python 解释器（就是负责运行 Python 程序的），一个命令行交互环境，还有一个简单的集成开发环境。</p>
</li>
<li><p>目前，Python 有两个版本，一个是 2.x 版，一个是 3.x 版，这两个版本是不兼容的。由于 3.x 版越来越普及，此处选择安装 Windows 系统的 3.8 版本。</p>
</li>
</ul>
<h3 id="官方安装包安装"><a href="#官方安装包安装" class="headerlink" title="官方安装包安装"></a>官方安装包安装</h3><ul>
<li><p>Python 官网：<a target="_blank" rel="noopener" href="https://www.python.org/">https://www.python.org/</a></p>
</li>
<li><p>Python 下载：</p>
<p><img src="/2021/09/06/python/image-20210906103336559.png" alt="image-20210906103336559"></p>
<p><img src="/2021/09/06/python/image-20210906110140935.png" alt="image-20210906110140935"></p>
</li>
<li><p>Python 安装：</p>
<p><img src="/2021/09/06/python/image-20210906111014938.png" alt="image-20210906111014938"></p>
<p><img src="/2021/09/06/python/image-20210906111414435.png" alt="image-20210906111414435"></p>
</li>
<li><p>验证 Python 是否安装完成：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Windows PowerShell</span><br><span class="line">版权所有 (C) Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">尝试新的跨平台 PowerShell https://aka.ms/pscore6</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\Users\Xisun&gt; python</span><br><span class="line">Python <span class="number">3.8</span>.<span class="number">3</span> (default, May <span class="number">19</span> <span class="number">2020</span>, <span class="number">06</span>:<span class="number">50</span>:<span class="number">17</span>) [<span class="type">MSC</span> <span class="type">v.1916</span> <span class="number">64</span> <span class="type">bit</span> (<span class="type">AMD64</span>)] :: Anaconda, Inc. on win32</span><br><span class="line"><span class="built_in">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">exit</span>()</span><br><span class="line"><span class="built_in">PS</span> C:\Users\Xisun&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>提示符 <code>&gt;&gt;&gt;</code> 表示已经处于 Python 的交互模式中，可以输入任何 Python 代码，输入完的指令将会被 Python 的解释器立即执行。</li>
<li>输入 <code>exit()</code> 并回车，可以退出 Python 交互模式（直接关掉命令行窗口也可以）。</li>
</ul>
</li>
<li><p>安装 Python 的同时，会自动安装一个 Python 的开发工具 IDLE，通过 IDLE 也可以进入到交互模式。IDLE 中可以通过 tab 键来查看语句的提示，并且可以将代码保存。</p>
<p><img src="/2021/09/06/python/image-20211008172411453.png" alt="image-20211008172411453"></p>
</li>
<li><p>交互模式下只能输入一行代码，执行一行，所以不适用于我们日常的开发，仅可以用来做一些日常的简单的测试！</p>
</li>
<li><p>我们一般会将 Python 代码编写到一个 <code>.py</code> 文件中，然后通过 python 指令来执行文件中的代码。</p>
</li>
</ul>
<h3 id="Miniconda-安装"><a href="#Miniconda-安装" class="headerlink" title="Miniconda 安装"></a>Miniconda 安装</h3><ul>
<li><p>Miniconda 是一款小巧的 Python 环境管理工具，其安装程序中包含 conda 软件包管理器和 Python。一旦安装了 Miniconda，就可以使用 conda 命令安装任何其他软件工具包并创建环境等。</p>
</li>
<li><p>官网：<a target="_blank" rel="noopener" href="https://conda.io/en/latest/miniconda.html">https://conda.io/en/latest/miniconda.html</a></p>
</li>
</ul>
<h4 id="Windows-环境"><a href="#Windows-环境" class="headerlink" title="Windows 环境"></a>Windows 环境</h4><ul>
<li><p>官网下载 Miniconda：</p>
<p><img src="/2021/09/06/python/image-20211008200831511.png" alt="image-20211008200831511"></p>
</li>
<li><p>安装 Minicoda：</p>
<p><img src="/2021/09/06/python/image-20211008202344037.png" alt="image-20211008202344037"></p>
<p><img src="/2021/09/06/python/image-20211008202554151.png" alt="image-20211008202554151"></p>
</li>
<li><p>添加系统环境变量：</p>
<p><img src="/2021/09/06/python/image-20211008204725711.png" alt="image-20211008204725711"></p>
</li>
<li><p>Windows PowerShell 中创建 Python 3.8 环境：</p>
<ul>
<li><p>打开 Windows PowerShell：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Windows PowerShell</span><br><span class="line">版权所有 (C) Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">尝试新的跨平台 PowerShell https://aka.ms/pscore6</span><br><span class="line"></span><br><span class="line">加载个人及系统配置文件用了 <span class="number">907</span> 毫秒。</span><br><span class="line">(base) <span class="built_in">PS</span> C:\Users\XiSun&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看所有的环境：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(base) <span class="built_in">PS</span> C:\Users\XiSun&gt;conda env list</span><br><span class="line"><span class="comment"># conda environments:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">base                  *  D:\Program\Miniconda3</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个新环境：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\XiSun&gt;conda create <span class="literal">-n</span> py38 python=<span class="number">3.8</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>建议针对不同的 Python 版本，创建不同的环境，<code>-n</code> 参数后是环境的名字，可以自取。</p>
<p>Miniconda 自身的 Python 环境，不建议直接使用，避免污染。</p>
<p>新环境位于 Miniconda 安装目录下，如 <code>D:\miniconda3\envs\py38</code>。</p>
</blockquote>
</li>
<li><p>激活新创建的环境：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\XiSun&gt; conda activate py38</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>安装模块，可以多个一起安装：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\XiSun&gt; conda init</span><br><span class="line"><span class="built_in">PS</span> C:\Users\XiSun&gt; conda install numpy scipy pandas jupyter <span class="literal">-y</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>-y</code> 参数表示安装过程中询问是否继续操作时，默认输入 <code>y</code>。</p>
</blockquote>
<ul>
<li><p>使用 jupyter，首先创建一个目录，用于存放文件，如 <code>D:\notebook</code>：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\XiSun&gt;  jupyter notebook -<span class="literal">-notebook</span><span class="literal">-dir</span> D:\notebook\</span><br></pre></td></tr></table></figure>

<p><img src="/2021/09/06/python/image-20211008232457805.png" alt="image-20211008232457805"></p>
<ul>
<li><p>jupyter 的部分操作：</p>
<p><img src="/2021/09/06/python/image-20211008232723547.png" alt="image-20211008232723547"></p>
<p><img src="/2021/09/06/python/image-20211008232622015.png" alt="image-20211008232622015"></p>
<p><img src="/2021/09/06/python/image-20211008233557395.png" alt="image-20211008233557395"></p>
<p><img src="/2021/09/06/python/image-20211009142625478.png" alt="image-20211009142625478"></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Pycharm 引用创建的 py38 环境：</p>
<p><img src="/2021/09/06/python/image-20211009104033079.png" alt="image-20211009104033079"></p>
<p><img src="/2021/09/06/python/image-20211009104233732.png" alt="image-20211009104233732"></p>
</li>
</ul>
<h4 id="Linux-环境"><a href="#Linux-环境" class="headerlink" title="Linux 环境"></a>Linux 环境</h4><ul>
<li><p>某些时候，可能会存在一些依赖包不支持 Windows 环境下载安装，这时候就需要在 Linux 环境下载安装使用。</p>
</li>
<li><p>WSL 中创建 Python 3.8 环境：</p>
<ul>
<li><p>以管理员身份打开 Windows PowerShell：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Windows PowerShell</span><br><span class="line">版权所有 (C) Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">尝试新的跨平台 PowerShell https://aka.ms/pscore6</span><br><span class="line"></span><br><span class="line">加载个人及系统配置文件用了 <span class="number">869</span> 毫秒。</span><br><span class="line">(base) <span class="built_in">PS</span> C:\XiSun\Ziyoo&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>开启 WSL：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(base) <span class="built_in">PS</span> C:\Users\XiSun&gt; wsl</span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/mnt/c/Users/XiSun<span class="variable">$</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 Miniconda：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/mnt/c/Users/XiSun<span class="variable">$</span> <span class="built_in">cd</span> /mnt/d/Program\ Files/</span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/mnt/d/Program Files<span class="variable">$</span> ll</span><br><span class="line">total <span class="number">380636</span></span><br><span class="line">drwxrwxrwx <span class="number">1</span> xisun xisun      <span class="number">4096</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">29</span>  ./</span><br><span class="line">drwxrwxrwx <span class="number">1</span> xisun xisun      <span class="number">4096</span> Jan <span class="number">19</span> <span class="number">16</span>:<span class="number">16</span>  ../</span><br><span class="line"><span class="literal">-rwxrwxrwx</span> <span class="number">1</span> xisun xisun  <span class="number">85055499</span> Jun <span class="number">10</span>  <span class="number">2020</span>  Miniconda3<span class="literal">-latest</span><span class="literal">-Linux</span><span class="literal">-x86_64</span>.sh*</span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/mnt/d/Program Files<span class="variable">$</span> sh Miniconda3<span class="literal">-latest</span><span class="literal">-Linux</span><span class="literal">-x86_64</span>.sh</span><br></pre></td></tr></table></figure>

<ul>
<li>Miniconda3-latest-Linux-x86_64.sh 是 Miniconda 安装程序。</li>
</ul>
</li>
<li><p>创建一个新环境：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/mnt/c/Users/Ziyoo<span class="variable">$</span> <span class="built_in">cd</span></span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> ll</span><br><span class="line">total <span class="number">108</span></span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">9</span> xisun xisun  <span class="number">4096</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">32</span> ./</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">3</span> root  root   <span class="number">4096</span> Apr <span class="number">26</span>  <span class="number">2021</span> ../</span><br><span class="line"><span class="literal">-rw</span>-------  <span class="number">1</span> xisun xisun <span class="number">19888</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">33</span> .bash_history</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--  <span class="number">1</span> xisun xisun   <span class="number">220</span> Apr <span class="number">26</span>  <span class="number">2021</span> .bash_logout</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--  <span class="number">1</span> xisun xisun  <span class="number">4250</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">32</span> .bashrc</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">2</span> xisun xisun  <span class="number">4096</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">32</span> .conda/</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">8</span> xisun xisun  <span class="number">4096</span> Jun  <span class="number">3</span>  <span class="number">2021</span> .dotnet/</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">2</span> xisun xisun  <span class="number">4096</span> Apr <span class="number">26</span>  <span class="number">2021</span> .landscape/</span><br><span class="line"><span class="literal">-rw</span>-------  <span class="number">1</span> xisun xisun    <span class="number">32</span> May <span class="number">21</span>  <span class="number">2021</span> .lesshst</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--  <span class="number">1</span> xisun xisun     <span class="number">0</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">26</span> .motd_shown</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--  <span class="number">1</span> xisun xisun   <span class="number">807</span> Apr <span class="number">26</span>  <span class="number">2021</span> .profile</span><br><span class="line">drwx------  <span class="number">2</span> xisun xisun  <span class="number">4096</span> Jul <span class="number">13</span>  <span class="number">2021</span> .ssh/</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--  <span class="number">1</span> xisun xisun     <span class="number">0</span> Apr <span class="number">26</span>  <span class="number">2021</span> .sudo_as_admin_successful</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">2</span> xisun xisun  <span class="number">4096</span> Jul  <span class="number">6</span>  <span class="number">2021</span> .vim/</span><br><span class="line"><span class="literal">-rw</span>-------  <span class="number">1</span> xisun xisun  <span class="number">9488</span> Jul <span class="number">22</span>  <span class="number">2021</span> .viminfo</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span>  <span class="number">5</span> xisun xisun  <span class="number">4096</span> Jun  <span class="number">3</span>  <span class="number">2021</span> .vscode<span class="literal">-server</span>/</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--  <span class="number">1</span> xisun xisun   <span class="number">183</span> Jan <span class="number">14</span> <span class="number">10</span>:<span class="number">08</span> .w<span class="built_in">get-hsts</span></span><br><span class="line"><span class="literal">-rw</span><span class="literal">-rw</span><span class="literal">-r</span>--  <span class="number">1</span> xisun xisun <span class="number">14750</span> Jun  <span class="number">3</span>  <span class="number">2021</span> <span class="built_in">get-docker</span>.sh</span><br><span class="line">drwxr<span class="literal">-xr</span><span class="literal">-x</span> <span class="number">15</span> xisun xisun  <span class="number">4096</span> Jan <span class="number">25</span> <span class="number">10</span>:<span class="number">32</span> miniconda3/</span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> conda env list</span><br><span class="line"><span class="comment"># conda environments:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">base                  *  /home/xisun/miniconda3</span><br><span class="line"></span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> conda create <span class="literal">-n</span> py38 python=<span class="number">3.8</span></span><br><span class="line">Collecting package metadata (current_repodata.json): done</span><br><span class="line">Solving environment: done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">==&gt; WARNING: A newer version of conda exists. &lt;==</span><br><span class="line">  current version: <span class="number">4.8</span>.<span class="number">2</span></span><br><span class="line">  latest version: <span class="number">4.11</span>.<span class="number">0</span></span><br><span class="line"></span><br><span class="line">Please update conda by running</span><br><span class="line"></span><br><span class="line">    <span class="variable">$</span> conda update <span class="literal">-n</span> base <span class="literal">-c</span> defaults conda</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## Package Plan ##</span></span><br><span class="line"></span><br><span class="line">  environment location: /home/xisun/miniconda3/envs/py38</span><br><span class="line"></span><br><span class="line">  added / updated specs:</span><br><span class="line">    - python=<span class="number">3.8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The following packages will be downloaded:</span><br><span class="line"></span><br><span class="line">    package                    |            build</span><br><span class="line">    ---------------------------|-----------------</span><br><span class="line">    _openmp_mutex<span class="literal">-4</span>.<span class="number">5</span>          |            <span class="number">1</span>_gnu          <span class="number">22</span> KB</span><br><span class="line">    ca<span class="literal">-certificates</span><span class="literal">-2021</span>.<span class="number">10.26</span> |       h06a4308_2         <span class="number">115</span> KB</span><br><span class="line">    certifi<span class="literal">-2021</span>.<span class="number">10.8</span>          |   py38h06a4308_2         <span class="number">152</span> KB</span><br><span class="line">    ld_impl_linux<span class="literal">-64</span><span class="literal">-2</span>.<span class="number">35.1</span>    |       h7274673_9         <span class="number">586</span> KB</span><br><span class="line">    libffi<span class="literal">-3</span>.<span class="number">3</span>                 |       he6710b0_2          <span class="number">50</span> KB</span><br><span class="line">    libgcc<span class="literal">-ng</span><span class="literal">-9</span>.<span class="number">3.0</span>            |      h5101ec6_17         <span class="number">4.8</span> MB</span><br><span class="line">    libgomp<span class="literal">-9</span>.<span class="number">3.0</span>              |      h5101ec6_17         <span class="number">311</span> KB</span><br><span class="line">    libstdcxx<span class="literal">-ng</span><span class="literal">-9</span>.<span class="number">3.0</span>         |      hd4cf53a_17         <span class="number">3.1</span> MB</span><br><span class="line">    ncurses<span class="literal">-6</span>.<span class="number">3</span>                |       h7f8727e_2         <span class="number">782</span> KB</span><br><span class="line">    openssl<span class="literal">-1</span>.<span class="number">1.1</span>m             |       h7f8727e_0         <span class="number">2.5</span> MB</span><br><span class="line">    pip<span class="literal">-21</span>.<span class="number">2.4</span>                 |   py38h06a4308_0         <span class="number">1.8</span> MB</span><br><span class="line">    python<span class="literal">-3</span>.<span class="number">8.12</span>              |       h12debd9_0        <span class="number">18.3</span> MB</span><br><span class="line">    readline<span class="literal">-8</span>.<span class="number">1.2</span>             |       h7f8727e_1         <span class="number">354</span> KB</span><br><span class="line">    setuptools<span class="literal">-58</span>.<span class="number">0.4</span>          |   py38h06a4308_0         <span class="number">790</span> KB</span><br><span class="line">    sqlite<span class="literal">-3</span>.<span class="number">37.0</span>              |       hc218d9a_0         <span class="number">999</span> KB</span><br><span class="line">    tk<span class="literal">-8</span>.<span class="number">6.11</span>                  |       h1ccaba5_0         <span class="number">3.0</span> MB</span><br><span class="line">    wheel<span class="literal">-0</span>.<span class="number">37.1</span>               |     pyhd3eb1b0_0          <span class="number">33</span> KB</span><br><span class="line">    xz<span class="literal">-5</span>.<span class="number">2.5</span>                   |       h7b6447c_0         <span class="number">341</span> KB</span><br><span class="line">    zlib<span class="literal">-1</span>.<span class="number">2.11</span>                |       h7f8727e_4         <span class="number">108</span> KB</span><br><span class="line">    ------------------------------------------------------------</span><br><span class="line">                                           Total:        <span class="number">38.0</span> MB</span><br><span class="line"></span><br><span class="line">The following NEW packages will be INSTALLED:</span><br><span class="line"></span><br><span class="line">  _libgcc_mutex      pkgs/main/linux<span class="literal">-64</span>::_libgcc_mutex<span class="literal">-0</span>.<span class="number">1</span><span class="literal">-main</span></span><br><span class="line">  _openmp_mutex      pkgs/main/linux<span class="literal">-64</span>::_openmp_mutex<span class="literal">-4</span>.<span class="number">5</span><span class="literal">-1_gnu</span></span><br><span class="line">  ca<span class="literal">-certificates</span>    pkgs/main/linux<span class="literal">-64</span>::ca<span class="literal">-certificates</span><span class="literal">-2021</span>.<span class="number">10.26</span><span class="literal">-h06a4308_2</span></span><br><span class="line">  certifi            pkgs/main/linux<span class="literal">-64</span>::certifi<span class="literal">-2021</span>.<span class="number">10.8</span><span class="literal">-py38h06a4308_2</span></span><br><span class="line">  ld_impl_linux<span class="literal">-64</span>   pkgs/main/linux<span class="literal">-64</span>::ld_impl_linux<span class="literal">-64</span><span class="literal">-2</span>.<span class="number">35.1</span><span class="literal">-h7274673_9</span></span><br><span class="line">  libffi             pkgs/main/linux<span class="literal">-64</span>::libffi<span class="literal">-3</span>.<span class="number">3</span><span class="literal">-he6710b0_2</span></span><br><span class="line">  libgcc<span class="literal">-ng</span>          pkgs/main/linux<span class="literal">-64</span>::libgcc<span class="literal">-ng</span><span class="literal">-9</span>.<span class="number">3.0</span><span class="literal">-h5101ec6_17</span></span><br><span class="line">  libgomp            pkgs/main/linux<span class="literal">-64</span>::libgomp<span class="literal">-9</span>.<span class="number">3.0</span><span class="literal">-h5101ec6_17</span></span><br><span class="line">  libstdcxx<span class="literal">-ng</span>       pkgs/main/linux<span class="literal">-64</span>::libstdcxx<span class="literal">-ng</span><span class="literal">-9</span>.<span class="number">3.0</span><span class="literal">-hd4cf53a_17</span></span><br><span class="line">  ncurses            pkgs/main/linux<span class="literal">-64</span>::ncurses<span class="literal">-6</span>.<span class="number">3</span><span class="literal">-h7f8727e_2</span></span><br><span class="line">  openssl            pkgs/main/linux<span class="literal">-64</span>::openssl<span class="literal">-1</span>.<span class="number">1.1</span>m<span class="literal">-h7f8727e_0</span></span><br><span class="line">  pip                pkgs/main/linux<span class="literal">-64</span>::pip<span class="literal">-21</span>.<span class="number">2.4</span><span class="literal">-py38h06a4308_0</span></span><br><span class="line">  python             pkgs/main/linux<span class="literal">-64</span>::python<span class="literal">-3</span>.<span class="number">8.12</span><span class="literal">-h12debd9_0</span></span><br><span class="line">  readline           pkgs/main/linux<span class="literal">-64</span>::readline<span class="literal">-8</span>.<span class="number">1.2</span><span class="literal">-h7f8727e_1</span></span><br><span class="line">  setuptools         pkgs/main/linux<span class="literal">-64</span>::setuptools<span class="literal">-58</span>.<span class="number">0.4</span><span class="literal">-py38h06a4308_0</span></span><br><span class="line">  sqlite             pkgs/main/linux<span class="literal">-64</span>::sqlite<span class="literal">-3</span>.<span class="number">37.0</span><span class="literal">-hc218d9a_0</span></span><br><span class="line">  tk                 pkgs/main/linux<span class="literal">-64</span>::tk<span class="literal">-8</span>.<span class="number">6.11</span><span class="literal">-h1ccaba5_0</span></span><br><span class="line">  wheel              pkgs/main/noarch::wheel<span class="literal">-0</span>.<span class="number">37.1</span><span class="literal">-pyhd3eb1b0_0</span></span><br><span class="line">  xz                 pkgs/main/linux<span class="literal">-64</span>::xz<span class="literal">-5</span>.<span class="number">2.5</span><span class="literal">-h7b6447c_0</span></span><br><span class="line">  zlib               pkgs/main/linux<span class="literal">-64</span>::zlib<span class="literal">-1</span>.<span class="number">2.11</span><span class="literal">-h7f8727e_4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Proceed ([<span class="type">y</span>]/n)? y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Downloading and Extracting Packages</span><br><span class="line">_openmp_mutex<span class="literal">-4</span>.<span class="number">5</span>    | <span class="number">22</span> KB     | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">libgomp<span class="literal">-9</span>.<span class="number">3.0</span>        | <span class="number">311</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">ld_impl_linux<span class="literal">-64</span><span class="literal">-2</span>.<span class="number">3</span> | <span class="number">586</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">python<span class="literal">-3</span>.<span class="number">8.12</span>        | <span class="number">18.3</span> MB   | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">zlib<span class="literal">-1</span>.<span class="number">2.11</span>          | <span class="number">108</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">openssl<span class="literal">-1</span>.<span class="number">1.1</span>m       | <span class="number">2.5</span> MB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">libstdcxx<span class="literal">-ng</span><span class="literal">-9</span>.<span class="number">3.0</span>   | <span class="number">3.1</span> MB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">tk<span class="literal">-8</span>.<span class="number">6.11</span>            | <span class="number">3.0</span> MB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">wheel<span class="literal">-0</span>.<span class="number">37.1</span>         | <span class="number">33</span> KB     | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">sqlite<span class="literal">-3</span>.<span class="number">37.0</span>        | <span class="number">999</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">setuptools<span class="literal">-58</span>.<span class="number">0.4</span>    | <span class="number">790</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">pip<span class="literal">-21</span>.<span class="number">2.4</span>           | <span class="number">1.8</span> MB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">libffi<span class="literal">-3</span>.<span class="number">3</span>           | <span class="number">50</span> KB     | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">libgcc<span class="literal">-ng</span><span class="literal">-9</span>.<span class="number">3.0</span>      | <span class="number">4.8</span> MB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">ncurses<span class="literal">-6</span>.<span class="number">3</span>          | <span class="number">782</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">certifi<span class="literal">-2021</span>.<span class="number">10.8</span>    | <span class="number">152</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">readline<span class="literal">-8</span>.<span class="number">1.2</span>       | <span class="number">354</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">xz<span class="literal">-5</span>.<span class="number">2.5</span>             | <span class="number">341</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">ca<span class="literal">-certificates</span><span class="literal">-2021</span> | <span class="number">115</span> KB    | <span class="comment">############################################################################# | 100%</span></span><br><span class="line">Preparing transaction: done</span><br><span class="line">Verifying transaction: done</span><br><span class="line">Executing transaction: done</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># To activate this environment, use</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     $ conda activate py38</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># To deactivate an active environment, use</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     $ conda deactivate</span></span><br><span class="line"></span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> conda env list</span><br><span class="line"><span class="comment"># conda environments:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">base                  *  /home/xisun/miniconda3</span><br><span class="line">py38                     /home/xisun/miniconda3/envs/py38</span><br></pre></td></tr></table></figure>
</li>
<li><p>激活新创建的环境：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> conda activate py38</span><br><span class="line">(py38) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>安装模块:</p>
<ul>
<li><p>pip 安装 pip-search：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> pip install pip_search</span><br><span class="line">Collecting pip_search</span><br><span class="line">  Downloading pip_<span class="built_in">search-0</span>.<span class="number">0.10</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">4.4</span> kB)</span><br><span class="line">Collecting bs4</span><br><span class="line">  Downloading bs4<span class="literal">-0</span>.<span class="number">0.1</span>.tar.gz (<span class="number">1.1</span> kB)</span><br><span class="line">Collecting rich</span><br><span class="line">  Downloading rich<span class="literal">-11</span>.<span class="number">0.0</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">215</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">215</span> kB <span class="number">400</span> kB/s</span><br><span class="line">Requirement already satisfied: requests <span class="keyword">in</span> ./miniconda3/lib/python3.<span class="number">7</span>/site<span class="literal">-packages</span> (from pip_search) (<span class="number">2.22</span>.<span class="number">0</span>)</span><br><span class="line">Collecting beautifulsoup4</span><br><span class="line">  Downloading beautifulsoup4<span class="literal">-4</span>.<span class="number">10.0</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">97</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">97</span> kB <span class="number">346</span> kB/s</span><br><span class="line">Collecting colorama&lt;<span class="number">0.5</span>.<span class="number">0</span>,&gt;=<span class="number">0.4</span>.<span class="number">0</span></span><br><span class="line">  Downloading colorama<span class="literal">-0</span>.<span class="number">4.4</span><span class="literal">-py2</span>.py3<span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">16</span> kB)</span><br><span class="line">Collecting commonmark&lt;<span class="number">0.10</span>.<span class="number">0</span>,&gt;=<span class="number">0.9</span>.<span class="number">0</span></span><br><span class="line">  Downloading commonmark<span class="literal">-0</span>.<span class="number">9.1</span><span class="literal">-py2</span>.py3<span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">51</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">51</span> kB <span class="number">315</span> kB/s</span><br><span class="line">Collecting ty<span class="built_in">ping-extensions</span>&lt;<span class="number">5.0</span>,&gt;=<span class="number">3.7</span>.<span class="number">4</span>; python_version &lt; <span class="string">&quot;3.8&quot;</span></span><br><span class="line">  Downloading typing_extensions<span class="literal">-4</span>.<span class="number">0.1</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">22</span> kB)</span><br><span class="line">Collecting pygments&lt;<span class="number">3.0</span>.<span class="number">0</span>,&gt;=<span class="number">2.6</span>.<span class="number">0</span></span><br><span class="line">  Downloading Pygments<span class="literal">-2</span>.<span class="number">11.2</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">1.1</span> MB)</span><br><span class="line">     |████████████████████████████████| <span class="number">1.1</span> MB <span class="number">50</span> kB/s</span><br><span class="line">Requirement already satisfied: certifi&gt;=<span class="number">2017.4</span>.<span class="number">17</span> <span class="keyword">in</span> ./miniconda3/lib/python3.<span class="number">7</span>/site<span class="literal">-packages</span> (from requests-&gt;pip_search) (<span class="number">2019.11</span>.<span class="number">28</span>)</span><br><span class="line">Requirement already satisfied: idna&lt;<span class="number">2.9</span>,&gt;=<span class="number">2.5</span> <span class="keyword">in</span> ./miniconda3/lib/python3.<span class="number">7</span>/site<span class="literal">-packages</span> (from requests-&gt;pip_search) (<span class="number">2.8</span>)</span><br><span class="line">Requirement already satisfied: urllib3!=<span class="number">1.25</span>.<span class="number">0</span>,!=<span class="number">1.25</span>.<span class="number">1</span>,&lt;<span class="number">1.26</span>,&gt;=<span class="number">1.21</span>.<span class="number">1</span> <span class="keyword">in</span> ./miniconda3/lib/python3.<span class="number">7</span>/site<span class="literal">-packages</span> (from requests-&gt;pip_search) (<span class="number">1.25</span>.<span class="number">8</span>)</span><br><span class="line">Requirement already satisfied: chardet&lt;<span class="number">3.1</span>.<span class="number">0</span>,&gt;=<span class="number">3.0</span>.<span class="number">2</span> <span class="keyword">in</span> ./miniconda3/lib/python3.<span class="number">7</span>/site<span class="literal">-packages</span> (from requests-&gt;pip_search) (<span class="number">3.0</span>.<span class="number">4</span>)</span><br><span class="line">Collecting soupsieve&gt;<span class="number">1.2</span></span><br><span class="line">  Downloading soupsieve<span class="literal">-2</span>.<span class="number">3.1</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">37</span> kB)</span><br><span class="line">Building wheels <span class="keyword">for</span> collected packages: bs4</span><br><span class="line">  Building wheel <span class="keyword">for</span> bs4 (setup.py) ... done</span><br><span class="line">  Created wheel <span class="keyword">for</span> bs4: filename=bs4<span class="literal">-0</span>.<span class="number">0.1</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl size=<span class="number">1272</span> sha256=<span class="number">2811</span>fe699e2c14aff05f0bbf8c2339c40e826130828a85461bb19160564c26c2</span><br><span class="line">  Stored <span class="keyword">in</span> directory: /home/xisun/.cache/pip/wheels/<span class="number">0</span>a/<span class="number">9</span>e/ba/<span class="number">20</span>e5bbc1afef3a491f0b3bb74d508f99403aabe76eda2167ca</span><br><span class="line">Successfully built bs4</span><br><span class="line">Installing collected packages: soupsieve, beautifulsoup4, bs4, colorama, commonmark, ty<span class="built_in">ping-extensions</span>, pygments, rich, pip<span class="literal">-search</span></span><br><span class="line">Successfully installed beautifulsoup4<span class="literal">-4</span>.<span class="number">10.0</span> bs4<span class="literal">-0</span>.<span class="number">0.1</span> colorama<span class="literal">-0</span>.<span class="number">4.4</span> commonmark<span class="literal">-0</span>.<span class="number">9.1</span> pip<span class="literal">-search</span><span class="literal">-0</span>.<span class="number">0.10</span> pygments<span class="literal">-2</span>.<span class="number">11.2</span> rich<span class="literal">-11</span>.<span class="number">0.0</span> soupsieve<span class="literal">-2</span>.<span class="number">3.1</span> ty<span class="built_in">ping-extensions</span><span class="literal">-4</span>.<span class="number">0.1</span></span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> pip_search dotenv</span><br><span class="line">                                        🐍 https://pypi.org/search/?q=dotenv 🐍</span><br><span class="line">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓</span><br><span class="line">┃ Package                    ┃ Version ┃ Released     ┃ Description                                                    ┃</span><br><span class="line">┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩</span><br><span class="line">│ 📂 dotenv                  │ <span class="number">0.0</span>.<span class="number">5</span>   │ Mar <span class="number">5</span>, <span class="number">2015</span>  │ Handle .env files                                              │</span><br><span class="line">│ 📂 dotenv<span class="literal">-config</span>           │ <span class="number">0.1</span>.<span class="number">4</span>   │ Feb <span class="number">8</span>, <span class="number">2019</span>  │ Simple dotenv loader with the possibility of casting types     │</span><br><span class="line">│ 📂 typed<span class="literal">-dotenv</span>            │ <span class="number">1.0</span>.<span class="number">1</span>   │ Jul <span class="number">30</span>, <span class="number">2020</span> │ Handle .env files with types                                   │</span><br><span class="line">│ 📂 python<span class="literal">-dotenv</span>           │ <span class="number">0.19</span>.<span class="number">2</span>  │ Nov <span class="number">11</span>, <span class="number">2021</span> │ Read key<span class="literal">-value</span> pairs from a .env file and <span class="built_in">set</span> them as          │</span><br><span class="line">│                            │         │              │ environment variables                                          │</span><br><span class="line">│ 📂 dotenv<span class="literal">-flow</span>             │ <span class="number">0.2</span>.<span class="number">3</span>   │ Jan <span class="number">3</span>, <span class="number">2022</span>  │ Like the dotenv<span class="literal">-flow</span> NodeJS library, <span class="keyword">for</span> Python                │</span><br><span class="line">│ 📂 py<span class="literal">-dotenv</span>               │ <span class="number">0.1</span>     │ Dec <span class="number">13</span>, <span class="number">2016</span> │ Read dotenv file                                               │</span><br><span class="line">│ 📂 dotenv<span class="literal">-cli</span>              │ <span class="number">2.2</span>.<span class="number">0</span>   │ Oct <span class="number">30</span>, <span class="number">2020</span> │ Simple dotenv <span class="built_in">CLI</span>.                                             │</span><br><span class="line">│ 📂 django<span class="literal">-dotenv</span>           │ <span class="number">1.4</span>.<span class="number">2</span>   │ Dec <span class="number">11</span>, <span class="number">2017</span> │ foreman reads from .env. manage.py doesn<span class="string">&#x27;t. Let&#x27;</span>s fix that.    │</span><br><span class="line">│ 📂 pythonsite<span class="literal">-dotenv</span>       │ <span class="number">0.1</span>     │ Jun <span class="number">30</span>, <span class="number">2014</span> │ Extend environment when invoking python                        │</span><br><span class="line">│ 📂 firstclass<span class="literal">-dotenv</span>       │ <span class="number">0.0</span>.<span class="number">6</span>   │ Nov <span class="number">18</span>, <span class="number">2020</span> │ Read value of .env(dotenv) into ENV values                     │</span><br><span class="line">│ 📂 py<span class="built_in">test-dotenv</span>           │ <span class="number">0.5</span>.<span class="number">2</span>   │ Jun <span class="number">16</span>, <span class="number">2020</span> │ A py.test plugin that parses environment files before running  │</span><br><span class="line">│                            │         │              │ tests                                                          │</span><br><span class="line">│ 📂 dotenv<span class="literal">-linter</span>           │ <span class="number">0.3</span>.<span class="number">0</span>   │ Dec <span class="number">13</span>, <span class="number">2021</span> │ Linting dotenv files like a charm!                             │</span><br><span class="line">│ 📂 dotenv<span class="literal">-python</span>           │ <span class="number">0.0</span>.<span class="number">1</span>   │ Jan <span class="number">28</span>, <span class="number">2017</span> │ Read .env(<span class="literal">-ish</span>) configuration file <span class="keyword">for</span> python web              │</span><br><span class="line">│                            │         │              │ applications.                                                  │</span><br><span class="line">│ 📂 xontrib<span class="literal">-dotenv</span>          │ <span class="number">0.1</span>     │ Jun <span class="number">15</span>, <span class="number">2016</span> │ Reads .env files into environment                              │</span><br><span class="line">│ 📂 Flask<span class="literal">-DotEnv</span>            │ <span class="number">0.1</span>.<span class="number">2</span>   │ Apr <span class="number">30</span>, <span class="number">2019</span> │ The .env file support <span class="keyword">for</span> Flask                                │</span><br><span class="line">│ 📂 dotenv<span class="literal">-stripout</span>         │ <span class="number">0.1</span>.<span class="number">0</span>   │ Aug <span class="number">19</span>, <span class="number">2021</span> │ Strip secrets from .env files                                  │</span><br><span class="line">│ 📂 ssm<span class="literal">-dotenv</span>              │ <span class="number">0.1</span>.<span class="number">0</span>   │ Aug <span class="number">8</span>, <span class="number">2019</span>  │ manage project dotenv parameters <span class="keyword">in</span> aws <span class="keyword">parameter</span> store        │</span><br><span class="line">│ 📂 model<span class="literal">-dotenv</span>            │ <span class="number">0.0</span>.<span class="number">0.1</span> │ Aug <span class="number">2</span>, <span class="number">2021</span>  │ A small example package                                        │</span><br><span class="line">│ 📂 enc<span class="literal">-dotenv</span>              │ <span class="number">0.0</span>.<span class="number">3</span>   │ Dec <span class="number">12</span>, <span class="number">2019</span> │ encrypted env                                                  │</span><br><span class="line">│ 📂 json<span class="literal">-dotenv</span>             │ <span class="number">0.0</span>.<span class="number">21</span>  │ Dec <span class="number">19</span>, <span class="number">2019</span> │ json<span class="literal">-dotenv</span>                                                    │</span><br><span class="line">│ 📂 python<span class="literal">-dotenv</span><span class="literal">-yaml</span>      │ <span class="number">0.17</span>.<span class="number">1</span>  │ Jun <span class="number">18</span>, <span class="number">2021</span> │ Read key<span class="literal">-value</span> pairs from a .env file and <span class="built_in">set</span> them as          │</span><br><span class="line">│                            │         │              │ environment variables -&gt; with support <span class="keyword">for</span> yaml syntax          │</span><br><span class="line">│ 📂 dotenv<span class="literal">-settings</span><span class="literal">-handler</span> │ <span class="number">0.0</span>.<span class="number">3</span>   │ Jul <span class="number">5</span>, <span class="number">2019</span>  │ Settings handler to load settings from a DotEnv file or system │</span><br><span class="line">│                            │         │              │ env variables, <span class="keyword">using</span> python-dotenv and pydantic.               │</span><br><span class="line">│ 📂 py<span class="literal">-sync</span><span class="literal">-dotenv</span>          │ <span class="number">0.1</span>.<span class="number">1</span>   │ Mar <span class="number">19</span>, <span class="number">2021</span> │ Python Sync Dotenv is a Python package <span class="keyword">for</span> synchronizing .env  │</span><br><span class="line">│                            │         │              │ files across projects.                                         │</span><br><span class="line">│ 📂 poetry<span class="literal">-dotenv</span><span class="literal">-plugin</span>    │ <span class="number">0.1</span>.<span class="number">0</span>a2 │ May <span class="number">30</span>, <span class="number">2021</span> │ A Poetry plugin to automatically load environment variables    │</span><br><span class="line">│                            │         │              │ from .env files                                                │</span><br><span class="line">│ 📂 msdss<span class="literal">-base</span><span class="literal">-dotenv</span>       │ <span class="number">0.2</span>.<span class="number">9</span>   │ Nov <span class="number">26</span>, <span class="number">2021</span> │ Environmental file management <span class="keyword">for</span> the Modular Spatial Decision │</span><br><span class="line">│                            │         │              │ Support Systems (MSDSS) framework                              │</span><br><span class="line">│ 📂 py<span class="built_in">test-django</span><span class="literal">-dotenv</span>    │ <span class="number">0.1</span>.<span class="number">2</span>   │ Nov <span class="number">26</span>, <span class="number">2019</span> │ Pytest plugin used to setup environment variables with         │</span><br><span class="line">│                            │         │              │ django<span class="literal">-dotenv</span>                                                  │</span><br><span class="line">│ 📂 ssm<span class="literal">-dotenv</span><span class="literal">-config</span>       │ <span class="number">0.1</span>.<span class="number">1</span>   │ Jun <span class="number">7</span>, <span class="number">2019</span>  │                                                                │</span><br><span class="line">│ 📂 python<span class="literal">-dotenv</span><span class="literal">-run</span>       │ <span class="number">0.1</span>.<span class="number">4</span>   │ Dec <span class="number">23</span>, <span class="number">2017</span> │ Run command with environment populated by the .env file.       │</span><br><span class="line">│ 📂 dotenver                │ <span class="number">1.2</span>.<span class="number">1</span>   │ Jun <span class="number">12</span>, <span class="number">2021</span> │ Automatically generate .env files from .env.example template   │</span><br><span class="line">│                            │         │              │ files                                                          │</span><br><span class="line">│ 📂 yaenv                   │ <span class="number">1.6</span>.<span class="number">1</span>   │ Dec <span class="number">14</span>, <span class="number">2021</span> │ Yet another dotenv parser <span class="keyword">for</span> Python.                          │</span><br><span class="line">│ 📂 pypiwrap                │ <span class="number">0.1</span>.<span class="number">0</span>   │ Mar <span class="number">14</span>, <span class="number">2021</span> │ A simple wrapper <span class="keyword">for</span> interfacing with PyPi APIs.               │</span><br><span class="line">│ 📂 env<span class="literal">-validate</span>            │ <span class="number">0.4</span>     │ Jul <span class="number">1</span>, <span class="number">2021</span>  │                                                                │</span><br><span class="line">│ 📂 td<span class="literal">-ameritrade</span><span class="literal">-api</span>       │ <span class="number">1.0</span>.<span class="number">4</span>   │ Oct <span class="number">5</span>, <span class="number">2019</span>  │ A python wrapper <span class="keyword">for</span> the TD ameritrade API                     │</span><br><span class="line">│ 📂 trashy<span class="literal">-poetry</span>           │ <span class="number">1.0</span>.<span class="number">3</span>   │ Mar <span class="number">1</span>, <span class="number">2021</span>  │ Poetry <span class="keyword">for</span> everyday use                                        │</span><br><span class="line">│ 📂 dotenvy                 │ <span class="number">0.2</span>.<span class="number">0</span>   │ Sep <span class="number">20</span>, <span class="number">2017</span> │ Dotenv handler <span class="keyword">for</span> Python                                      │</span><br><span class="line">│ 📂 envirun                 │ <span class="number">0.0</span>.<span class="number">1</span>   │ Sep <span class="number">25</span>, <span class="number">2021</span> │ Run any program with environment read from file                │</span><br><span class="line">│ 📂 TickerStore             │ <span class="number">0.0</span>.<span class="number">8</span>   │ Mar <span class="number">22</span>, <span class="number">2019</span> │ Historical <span class="keyword">data</span> of financial instruments from NSE              │</span><br><span class="line">│ 📂 configureme             │ <span class="number">0.1</span>.<span class="number">2</span>a0 │ Nov <span class="number">4</span>, <span class="number">2018</span>  │ <span class="built_in">Set</span> up configuration <span class="keyword">for</span> your application or library with      │</span><br><span class="line">│                            │         │              │ ease.                                                          │</span><br><span class="line">│ 📂 keyvault                │ <span class="number">0.1</span>.<span class="number">5</span>   │ Sep <span class="number">21</span>, <span class="number">2021</span> │ A small package <span class="keyword">for</span> handling project secrets                   │</span><br><span class="line">│ 📂 envex                   │ <span class="number">1.1</span>.<span class="number">2</span>   │ Oct <span class="number">28</span>, <span class="number">2021</span> │ An extended os.environ interface                               │</span><br><span class="line">└────────────────────────────┴─────────┴──────────────┴────────────────────────────────────────────────────────────────┘</span><br><span class="line">(base) xisun@DESKTOP<span class="literal">-OM8IACS</span>:~<span class="variable">$</span> pip list</span><br><span class="line">Package                Version</span><br><span class="line">---------------------- -------------------</span><br><span class="line">asn1crypto             <span class="number">1.3</span>.<span class="number">0</span></span><br><span class="line">beautifulsoup4         <span class="number">4.10</span>.<span class="number">0</span></span><br><span class="line">bs4                    <span class="number">0.0</span>.<span class="number">1</span></span><br><span class="line">certifi                <span class="number">2019.11</span>.<span class="number">28</span></span><br><span class="line">cffi                   <span class="number">1.14</span>.<span class="number">0</span></span><br><span class="line">chardet                <span class="number">3.0</span>.<span class="number">4</span></span><br><span class="line">colorama               <span class="number">0.4</span>.<span class="number">4</span></span><br><span class="line">commonmark             <span class="number">0.9</span>.<span class="number">1</span></span><br><span class="line">conda                  <span class="number">4.8</span>.<span class="number">2</span></span><br><span class="line">conda<span class="literal">-package</span><span class="literal">-handling</span> <span class="number">1.6</span>.<span class="number">0</span></span><br><span class="line">cryptography           <span class="number">2.8</span></span><br><span class="line">idna                   <span class="number">2.8</span></span><br><span class="line">pip                    <span class="number">20.0</span>.<span class="number">2</span></span><br><span class="line">pycosat                <span class="number">0.6</span>.<span class="number">3</span></span><br><span class="line">pycparser              <span class="number">2.19</span></span><br><span class="line">Pygments               <span class="number">2.11</span>.<span class="number">2</span></span><br><span class="line">pyOpenSSL              <span class="number">19.1</span>.<span class="number">0</span></span><br><span class="line">PySocks                <span class="number">1.7</span>.<span class="number">1</span></span><br><span class="line">requests               <span class="number">2.22</span>.<span class="number">0</span></span><br><span class="line">rich                   <span class="number">11.0</span>.<span class="number">0</span></span><br><span class="line">ruamel<span class="literal">-yaml</span>            <span class="number">0.15</span>.<span class="number">87</span></span><br><span class="line">setuptools             <span class="number">45.2</span>.<span class="number">0</span>.post20200210</span><br><span class="line">six                    <span class="number">1.14</span>.<span class="number">0</span></span><br><span class="line">soupsieve              <span class="number">2.3</span>.<span class="number">1</span></span><br><span class="line">tqdm                   <span class="number">4.42</span>.<span class="number">1</span></span><br><span class="line">ty<span class="built_in">ping-extensions</span>      <span class="number">4.0</span>.<span class="number">1</span></span><br><span class="line">urllib3                <span class="number">1.25</span>.<span class="number">8</span></span><br><span class="line">wheel                  <span class="number">0.34</span>.<span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pipx 安装 pip-search：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">(py38) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/etc/apt<span class="variable">$</span> pip install pipx</span><br><span class="line">Collecting pipx</span><br><span class="line">  Downloading pipx<span class="literal">-1</span>.<span class="number">0.0</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">54</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">54</span> kB <span class="number">47</span> kB/s</span><br><span class="line">Collecting packaging&gt;=<span class="number">20.0</span></span><br><span class="line">  Downloading packaging<span class="literal">-21</span>.<span class="number">3</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">40</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">40</span> kB <span class="number">337</span> kB/s</span><br><span class="line">Collecting userpath&gt;=<span class="number">1.6</span>.<span class="number">0</span></span><br><span class="line">  Downloading userpath<span class="literal">-1</span>.<span class="number">7.0</span><span class="literal">-py2</span>.py3<span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">14</span> kB)</span><br><span class="line">Collecting argcomplete&gt;=<span class="number">1.9</span>.<span class="number">4</span></span><br><span class="line">  Downloading arg<span class="built_in">complete-2</span>.<span class="number">0.0</span><span class="literal">-py2</span>.py3<span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">37</span> kB)</span><br><span class="line">Collecting pyparsing!=<span class="number">3.0</span>.<span class="number">5</span>,&gt;=<span class="number">2.0</span>.<span class="number">2</span></span><br><span class="line">  Downloading pyparsing<span class="literal">-3</span>.<span class="number">0.7</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">98</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">98</span> kB <span class="number">416</span> kB/s</span><br><span class="line">Collecting click</span><br><span class="line">  Downloading click<span class="literal">-8</span>.<span class="number">0.3</span><span class="literal">-py3</span><span class="literal">-none</span><span class="literal">-any</span>.whl (<span class="number">97</span> kB)</span><br><span class="line">     |████████████████████████████████| <span class="number">97</span> kB <span class="number">537</span> kB/s</span><br><span class="line">Installing collected packages: pyparsing, click, userpath, packaging, argcomplete, pipx</span><br><span class="line">Successfully installed arg<span class="built_in">complete-2</span>.<span class="number">0.0</span> click<span class="literal">-8</span>.<span class="number">0.3</span> packaging<span class="literal">-21</span>.<span class="number">3</span> pipx<span class="literal">-1</span>.<span class="number">0.0</span> pyparsing<span class="literal">-3</span>.<span class="number">0.7</span> userpath<span class="literal">-1</span>.<span class="number">7.0</span></span><br><span class="line">(py38) xisun@DESKTOP<span class="literal">-OM8IACS</span>:/etc/apt<span class="variable">$</span> pipx install pip<span class="literal">-search</span></span><br><span class="line">  installed package pip<span class="literal">-search</span> <span class="number">0.0</span>.<span class="number">10</span>, installed <span class="keyword">using</span> Python 3.8.12</span><br><span class="line">  These apps are now globally available</span><br><span class="line">    - pip_search</span><br><span class="line">⚠️  Note: <span class="string">&#x27;/home/xisun/.local/bin&#x27;</span> is not on your PATH environment variable. These apps will not be globally</span><br><span class="line">    accessible <span class="keyword">until</span> your PATH is updated. Run `pipx ensurepath` to automatically add it, or manually modify your PATH</span><br><span class="line">    <span class="keyword">in</span> your shell<span class="string">&#x27;s config file (i.e. ~/.bashrc).</span></span><br><span class="line"><span class="string">done! ✨ 🌟 ✨</span></span><br><span class="line"><span class="string">(py38) xisun@DESKTOP-OM8IACS:/etc/apt$ pipx ensurepath</span></span><br><span class="line"><span class="string">Success! Added /home/xisun/.local/bin to the PATH environment variable.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Consider adding shell completions for pipx. Run &#x27;</span>pipx completions<span class="string">&#x27; for instructions.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">You will need to open a new terminal or re-login for the PATH changes to take effect.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Otherwise pipx is ready to go! ✨ 🌟 ✨</span></span><br></pre></td></tr></table></figure>

<ul>
<li>重新打开 terminal，即可使用 pip-search 命令。</li>
</ul>
</li>
</ul>
</li>
<li><p>pip 设置镜像源：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config <span class="built_in">set</span> global.index<span class="literal">-url</span> https://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="Python-解释器"><a href="#Python-解释器" class="headerlink" title="Python 解释器"></a>Python 解释器</h2><ul>
<li>当编写 Python 代码时，得到的是一个包含 Python 代码的以 <code>.py</code> 为扩展名的文本文件。要运行代码，就需要 Python 解释器去执行 <code>.py </code>文件。</li>
<li>由于整个 Python 语言从规范到解释器都是开源的，所以理论上，只要水平够高，任何人都可以编写 Python 解释器来执行 Python 代码（当然难度很大）。事实上，确实存在多种 Python 解释器。</li>
<li>Python 的解释器很多，但使用最广泛的还是 CPython。如果要和 Java 或 .Net 平台交互，最好的办法不是用 Jython 或 IronPython，而是通过网络调用来交互，确保各程序之间的独立性。</li>
</ul>
<h4 id="CPython"><a href="#CPython" class="headerlink" title="CPython"></a>CPython</h4><ul>
<li>从 Python 官网下载并安装好 Python 3.x 后，我们就直接获得了一个官方版本的解释器：CPython。这个解释器是用 C 语言开发的，所以叫 CPython。在命令行下运行 <code>python</code> 命令就是启动 CPython 解释器。</li>
<li>CPython 是使用最广的 Python 解释器。</li>
</ul>
<h4 id="IPython"><a href="#IPython" class="headerlink" title="IPython"></a>IPython</h4><ul>
<li>IPython 是基于 CPython 之上的一个交互式解释器，也就是说，IPython 只是在交互方式上有所增强，但是执行 Python 代码的功能和 CPython 是完全一样的。好比很多国产浏览器虽然外观不同，但内核其实都是调用了 IE。</li>
<li>CPython 用 <code>&gt;&gt;&gt;</code> 作为提示符，而 IPython 用 <code>In [序号]:</code> 作为提示符。</li>
</ul>
<h4 id="PyPy"><a href="#PyPy" class="headerlink" title="PyPy"></a>PyPy</h4><ul>
<li>PyPy 是另一个 Python 解释器，它的目标是执行速度。PyPy 采用 <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Just-in-time_compilation">JIT 技术</a>，对 Python 代码进行动态编译（注意不是解释），所以可以显著提高 Python 代码的执行速度。</li>
<li>绝大部分 Python 代码都可以在 PyPy 下运行，但是 PyPy 和 CPython 有一些是不同的，这就导致相同的 Python 代码在两种解释器下执行可能会有不同的结果。如果你的代码要放到 PyPy 下执行，就需要了解 <a target="_blank" rel="noopener" href="http://pypy.readthedocs.org/en/latest/cpython_differences.html">PyPy和CPython的不同点</a>。</li>
</ul>
<h4 id="Jython"><a href="#Jython" class="headerlink" title="Jython"></a>Jython</h4><ul>
<li>Jython 是运行在 Java 平台上的 Python 解释器，可以直接把 Python 代码编译成 Java 字节码执行。</li>
</ul>
<h4 id="IronPython"><a href="#IronPython" class="headerlink" title="IronPython"></a>IronPython</h4><ul>
<li>IronPython 和 Jython 类似，只不过 IronPython 是运行在微软 .Net 平台上的 Python 解释器，可以直接把 Python 代码编译成 .Net 字节码。</li>
</ul>
<h2 id="Python-基础"><a href="#Python-基础" class="headerlink" title="Python 基础"></a>Python 基础</h2><ul>
<li><p>Python 的语法比较简单，采用缩进方式，写出来的代码就像下面的样子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># print absolute value of an integer:</span></span><br><span class="line">a = <span class="number">100</span></span><br><span class="line"><span class="keyword">if</span> a &gt;= <span class="number">0</span>:</span><br><span class="line">    print(a)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(-a)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Python 程序是大小写敏感的，如果写错了大小写，程序会报错。</p>
</li>
<li><p>Python 中的每一行就是一条语句，每条语句以换行结束，每一行语句不要过长（规范中建议每行不要超过 80 个字符）。当语句以冒号 <code>:</code> 结尾时，缩进的语句视为代码块。</p>
</li>
<li><p>Python  一条语句可以分多行编写，多行编写时语句后边以 <code>\</code> 结尾。</p>
</li>
<li><p>Python 是缩进严格的语言，所以在 Python 中不要随便写缩进。按照约定俗成的惯例，应该始终坚持使用 4 个空格的缩进。当重构代码时，粘贴过去的代码必须重新检查缩进是否正确。此外，IDE 很难像格式化 Java 代码那样格式化 Python 代码。</p>
</li>
<li><p>Python 中使用 <code>#</code> 来表示注释，<code>#</code> 后的内容都属于注释，注释的内容将会被解释器所忽略。注释要求简单明了，一般习惯上 <code>#</code> 后边会跟着一个空格。</p>
</li>
</ul>
<h3 id="字面量和变量"><a href="#字面量和变量" class="headerlink" title="字面量和变量"></a>字面量和变量</h3><ul>
<li><p>字面量就是一个一个的值，比如：<code>1</code>，<code>2</code>，<code>3</code>，<code>4</code>，<code>5</code>，<code>6</code>，<code>‘HELLO’</code>。字面量所表示的意思就是它的字面的值，在程序中可以直接使用字面量。</p>
</li>
<li><p>变量（variable）可以用来保存字面量，并且变量中保存的字面量是不定的。变量本身没有任何意思，它会根据不同的字面量表示不同的意思。</p>
<ul>
<li><p>在 Python 中，等号是赋值语句，可以把任意数据类型赋值给变量，同一个变量可以反复赋值，而且可以是不同类型的变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">123</span> <span class="comment"># a是整数</span></span><br><span class="line">print(a) <span class="comment"># 123</span></span><br><span class="line">a = <span class="string">&#x27;ABC&#x27;</span> <span class="comment"># a变为字符串</span></span><br><span class="line">print(a) <span class="comment"># ABC</span></span><br></pre></td></tr></table></figure>

<ul>
<li>这种变量本身类型不固定的语言称之为动态语言，与之对应的是静态语言。静态语言在定义变量时必须指定变量类型，如果赋值的时候类型不匹配，就会报错。例如 Java 是静态语言。</li>
</ul>
</li>
<li><p>等号也可以把一个变量 <code>a</code> 赋值给另一个变量 <code>b</code>，这个操作实际上是把变量 <code>b</code> 指向变量 <code>a</code> 所指向的数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;ABC&#x27;</span></span><br><span class="line">b = a</span><br><span class="line">a = <span class="string">&#x27;XYZ&#x27;</span></span><br><span class="line">print(b) <span class="comment"># ABC，不是XYZ</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>常量就是不能变的变量，比如常用的数学常数 π 就是一个常量。在 Python 中，通常用全部大写的变量名表示常量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PI = <span class="number">3.14159265359</span></span><br></pre></td></tr></table></figure>

<ul>
<li>事实上 <code>PI</code> 仍然是一个变量，Python 根本没有任何机制保证 <code>PI</code> 不会被改变，所以，用全部大写的变量名表示常量只是一个习惯上的用法，如果你一定要改变变量 <code>PI</code> 的值，也没人能拦住你。</li>
</ul>
</li>
</ul>
</li>
<li><p>一般在开发时，很少直接使用字面量，都是将字面量保存到变量中，通过变量来引用字面量。</p>
</li>
</ul>
<h3 id="变量和标识符"><a href="#变量和标识符" class="headerlink" title="变量和标识符"></a>变量和标识符</h3><ul>
<li>Python 中使用变量，不需要声明，直接为变量赋值即可。</li>
<li>Python 中不能使用没有进行过赋值的变量，如果使用没有赋值过的变量，会报错 <code>NameError: name &#39;b&#39; is not defined</code>。</li>
<li>Python 是一个动态类型的语言，可以为变量赋任意类型的值，也可以任意修改变量的值。</li>
<li>Python 中所有可以自主命名的内容都属于标识符，比如变量名、函数名、类名。</li>
<li>标识符必须遵循标识符的规范：<ul>
<li>标识符中可以含有字母、数字、<code>_</code>，但是不能使用数字开头。</li>
<li>标识符不能是 Python 中的关键字和保留字，也不建议使用 Python 中的函数名作为标识符，因为这样会导致函数被覆盖。</li>
<li>在 Python 中注意遵循两种命名规范：<ul>
<li>下划线命名法：所有字母小写，单词之间使用 <code>_</code> 分割。如：max_length、min_length、hello_world。</li>
<li>帕斯卡命名法：大驼峰命名法，首字母大写，每个单词开头字母大写，其余字母小写。如：MaxLength、MinLength、HelloWorld。</li>
</ul>
</li>
<li>如果使用不符合标准的标识符，会报错 <code>SyntaxError: invalid syntax</code>。</li>
</ul>
</li>
</ul>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><ul>
<li>数据类型指的就是变量的值的类型，也就是可以为变量赋哪些值。</li>
</ul>
<h4 id="数值"><a href="#数值" class="headerlink" title="数值"></a>数值</h4><ul>
<li>Python 中，数值分成了三种：整数、浮点数（小数）、复数。</li>
</ul>
<h5 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h5><ul>
<li>Python中，所有的整数都是 int 类型。</li>
<li>Python 可以处理任意大小的整数，包括负整数，在程序中的表示方法和数学上的写法一模一样，例如：<code>1</code>，<code>100</code>，<code>-8080</code>，<code>0</code>，等等。<ul>
<li>Python 的整数没有大小限制，而某些语言的整数根据其存储长度是有大小限制的，例如 Java 对 32 位整数的范围限制在 -2147483648 ~ 2147483647。</li>
</ul>
</li>
<li>对于很大的数，例如 <code>10000000000</code>，很难数清楚 0 的个数。Python 允许在数字中间以 <code>_</code> 分隔，因此，写成 <code>10_000_000_000</code> 和 <code>10000000000</code> 是完全一样的。十六进制数也可以写成 <code>0xa1b2_c3d4</code>。</li>
<li>计算机由于使用二进制，所以，有时候用十六进制表示整数比较方便，十六进制用 <code>0x</code> 前缀和 0 - 9，a - f 表示，例如：<code>0xff00</code>，<code>0xa5b4c3d2</code>，等等。<ul>
<li>十进制的数，不能以 0 开头。二进制以 <code>0b</code> 开头，八进制以 <code>0o</code> 开头，十六进制以 <code>0x</code> 开头。</li>
<li>其他进制的整数，只要是数字，打印时一定是以十进制的形式显示的。</li>
</ul>
</li>
</ul>
<h5 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h5><ul>
<li><p>Python 中，所有的浮点数都是 float 类型。</p>
</li>
<li><p>浮点数也就是小数，之所以称为浮点数，是因为按照科学记数法表示时，一个浮点数的小数点位置是可变的，比如，<code>1.23 x 10^9</code> 和 <code>12.3 x 10^8</code> 是完全相等的。浮点数可以用数学写法，如 <code>1.23</code>，<code>3.14</code>，<code>-9.01</code>，等等。但是对于很大或很小的浮点数，就必须用科学计数法表示，把 10 用 e 替代，<code>1.23 x 10^9 </code> 就是 <code>1.23e9</code>，或者 <code>12.3e8</code>，<code>0.000012</code> 可以写成 <code>1.2e-5</code>，等等。</p>
<ul>
<li>Python 的浮点数也没有大小限制，但是超出一定范围就直接表示为 <code>inf</code>（无限大）。</li>
</ul>
</li>
<li><p>整数和浮点数在计算机内部存储的方式是不同的，整数运算永远是精确的（除法难道也是精确的？是的！），而浮点数运算则可能会有四舍五入的误差，得到一个不精确的结果。</p>
<ul>
<li><p>在Python中，有两种除法，一种除法是 <code>/</code>，<code>/</code> 除法的计算结果是浮点数，即使是两个整数恰好整除，结果也是浮点数。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="number">10</span> / <span class="number">3</span></span><br><span class="line"><span class="number">3.3333333333333335</span></span><br><span class="line">&gt;&gt;&gt; <span class="number">9</span> / <span class="number">3</span></span><br><span class="line"><span class="number">3.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>还有一种除法是 <code>//</code>，称为地板除，<code>//</code> 除法只取结果的整数部分。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="number">10</span> // <span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line">&gt;&gt;&gt; <span class="number">9</span> // <span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>相对于取整运算，Python 还提供一个余数运算，可以得到两个整数相除的余数。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="number">10</span> % <span class="number">3</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">&gt;&gt;&gt; <span class="number">9</span> % <span class="number">3</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>无论整数做 <code>//</code> 除法还是取余数，结果永远是整数，所以，整数运算结果永远是精确的。</p>
</li>
</ul>
</li>
</ul>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><ul>
<li><p>字符串用来表示一段文本信息，字符串是程序中使用的最多的数据类型。</p>
</li>
<li><p>字符串是以单引号 <code>&#39;</code> 或双引号 <code>&quot;</code> 括起来的任意文本（不要混用），比如 <code>&#39;abc&#39;</code>，<code>&quot;xyz&quot;</code> 等等。请注意，<code>&#39;&#39;</code> 或 <code>&quot;&quot;</code> 本身只是一种表示方式，不是字符串的一部分，因此，字符串 <code>&#39;abc&#39;</code> 只有 <code>a</code>，<code>b</code>，<code>c </code> 这 3 个字符。如果 <code>&#39;</code> 本身也是一个字符，那就可以用 <code>&quot;&quot;</code> 括起来，比如 <code>&quot;I&#39;m OK&quot;</code> 包含的字符是 <code>I</code>，<code>&#39;</code>，<code>m</code>，<code>空格</code>，<code>O</code>，<code>K</code> 这 6 个字符。</p>
</li>
<li><p>相同的引号之间不能嵌套。如果字符串内部既包含 <code>&#39;</code> 又包含 <code>&quot;</code>，可以用转义字符 <code>\</code> 来标识，比如 <code>&#39;I\&#39;m \&quot;OK\&quot;!&#39;</code>。</p>
</li>
<li><p>转义字符 <code>\</code> 可以转义很多字符。比如：\t 表示制表符，\n 表示换行符，<code>\uxxxx</code> 表示 Unicode 编码，可以打印出一些特殊的符号。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(<span class="string">&#x27;I\&#x27;</span>m ok.<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">I&#x27;</span>m ok.</span><br><span class="line">&gt;&gt;&gt; print(<span class="string">&#x27;I\&#x27;</span>m learning\nPython.<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">I&#x27;</span>m learning</span><br><span class="line">Python.</span><br><span class="line">&gt;&gt;&gt; print(<span class="string">&#x27;\\\n\\&#x27;</span>)</span><br><span class="line">\</span><br><span class="line">\</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果字符串里面有很多字符都需要转义，就需要加很多 <code>\</code>，为了简化，Python 还允许用 <code>r&#39;&#39;</code> 表示 ‘ ‘ 内部的字符串默认不转义。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(<span class="string">&#x27;\\\t\\&#x27;</span>)</span><br><span class="line">\       \</span><br><span class="line">&gt;&gt;&gt; print(<span class="built_in">r</span><span class="string">&#x27;\\\t\\&#x27;</span>)</span><br><span class="line">\\\t\\</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果字符串内部有很多换行，用 <code>\n</code> 写在一行里不好阅读，为了简化，Python 允许用 <code>&#39;&#39;&#39;...&#39;&#39;&#39;</code> 或 <code>&quot;&quot;&quot;...&quot;&quot;&quot;</code> 的格式表示多行内容。三重引号中可以换行，并且会保留字符串中的格式。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(<span class="string">&#x27;&#x27;</span><span class="string">&#x27;line1</span></span><br><span class="line"><span class="string">... line2</span></span><br><span class="line"><span class="string">... line3&#x27;</span><span class="string">&#x27;&#x27;</span>)</span><br><span class="line">line1</span><br><span class="line">line2</span><br><span class="line">line3</span><br><span class="line">&gt;&gt;&gt; print(<span class="built_in">r</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;hello,\n</span></span><br><span class="line"><span class="string">... world&#x27;</span><span class="string">&#x27;&#x27;</span>)</span><br><span class="line">hello,\n</span><br><span class="line">world</span><br></pre></td></tr></table></figure>

<ul>
<li>上面是在交互式命令行内输入，在输入多行内容时，提示符由 <code>&gt;&gt;&gt;</code> 变为 <code>...</code>，提示可以接着上一行输入，注意 <code>...</code> 是提示符，不是代码的一部分。</li>
</ul>
</li>
<li><p>格式化字符串：</p>
<ul>
<li><p>拼串：字符串之间可以进行加法运算，如果将两个字符串进行相加，则会自动将两个字符串拼接为一个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&#x27;孙悟空&#x27;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;欢迎 &#x27;</span> + name + <span class="string">&#x27; 光临！&#x27;</span>)  <span class="comment"># 欢迎 孙悟空 光临！</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>多参数：字符串只能和字符串拼接，不能和其他的类型进行加法运算。<code>print(&quot;a = &quot; + a)</code> 这种写法在 Python 中不常见，因为 a 可能不是字符串，容易出错，常写作 <code>print(&#39;a = &#39;, a)</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&#x27;孙悟空&#x27;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;欢迎&#x27;</span>, name, <span class="string">&#x27;光临！&#x27;</span>)  <span class="comment"># 欢迎 孙悟空 光临！</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>占位符：在创建字符串时，可以在字符串中指定占位符：<code>%s</code> 在字符串中表示任意字符，<code>%f</code> 表示浮点数占位符，<code>%d</code> 表示整数占位符。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="string">&#x27;Hello %s&#x27;</span> % <span class="string">&#x27;孙悟空&#x27;</span>  <span class="comment"># 一个占位符：Hello 孙悟空</span></span><br><span class="line">b = <span class="string">&#x27;hello %s 你好 %s&#x27;</span> % (<span class="string">&#x27;tom&#x27;</span>, <span class="string">&#x27;孙悟空&#x27;</span>)  <span class="comment"># 两个占位符：hello tom 你好 孙悟空</span></span><br><span class="line">b = <span class="string">&#x27;hello %3s&#x27;</span> % <span class="string">&#x27;ab&#x27;</span>  <span class="comment"># 占位符处的字符串长度至少为3，不足3的，在前面填充空格：hello  ab</span></span><br><span class="line">b = <span class="string">&#x27;hello %3.5s&#x27;</span> % <span class="string">&#x27;abcdefg&#x27;</span>  <span class="comment"># 占位符处的字符串的长度限制在3-5之间：hello abcde</span></span><br><span class="line">b = <span class="string">&#x27;hello %.2f&#x27;</span> % <span class="number">123.456</span>  <span class="comment"># 保留2位小数，四舍五入：hello 123.46</span></span><br><span class="line">b = <span class="string">&#x27;hello %d&#x27;</span> % <span class="number">123.95</span>  <span class="comment"># 直接舍弃小数位：hello 123</span></span><br><span class="line"></span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>
</li>
<li><p>格式化字符串：可以通过在字符串前添加一个 <code>f</code> 来创建一个格式化字符串，在格式化字符串中可以直接嵌入变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">123</span></span><br><span class="line">b = <span class="string">&#x27;呵呵&#x27;</span></span><br><span class="line">c = <span class="string">f&#x27;hello <span class="subst">&#123;a&#125;</span> <span class="subst">&#123;b&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)  <span class="comment"># a = 123</span></span><br><span class="line">print(c)  <span class="comment"># hello 123 呵呵</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>字符串的复制：将字符串和数字相乘。<code>*</code> 在语言中表示乘法，如果将字符串和数字相乘，则解释器会将字符串重复指定的次数并返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">a = a * <span class="number">5</span></span><br><span class="line"></span><br><span class="line">print(a)  <span class="comment"># abcabcabcabcabc</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h4><ul>
<li><p>布尔值和布尔代数的表示完全一致，一个布尔值只有 <code>True</code>、<code>False </code> 两种值，要么是 <code>True</code>，要么是 <code>False</code>，在 Python 中，可以直接用 <code>True</code>、<code>False </code>表示布尔值（请注意大小写），也可以通过布尔运算计算出来。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; True</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; False</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; <span class="number">3</span> &gt; <span class="number">2</span></span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; <span class="number">2</span> &gt; <span class="number">5</span></span><br><span class="line">False</span><br></pre></td></tr></table></figure>
</li>
<li><p>布尔值可以用 <code>and</code>、<code>or  </code> 和 <code>not</code> 运算。</p>
<ul>
<li><p><code>and </code> 运算是与运算，只有所有都为 <code>True</code>，<code>and</code> 运算结果才是 <code>True</code>：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; True and True</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; True and False</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; False and True</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; False and False</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; <span class="number">5</span> &gt; <span class="number">3</span> and <span class="number">3</span> &gt; <span class="number">1</span></span><br><span class="line">True</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>or</code> 运算是或运算，只要其中有一个为 <code>True</code>，<code>or</code> 运算结果就是 <code>True</code>：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; True or True</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; True or False</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; False or True</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; False or False</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; <span class="number">5</span> &gt; <span class="number">3</span> or <span class="number">1</span> &gt; <span class="number">3</span></span><br><span class="line">True</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>not </code> 运算是非运算，它是一个单目运算符，把 <code>True</code> 变成 <code>False</code>，<code>False </code> 变成 <code>True</code>：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; not True</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; not False</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; not <span class="number">5</span> &gt; <span class="number">3</span></span><br><span class="line">False</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>布尔值经常用在条件判断中，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> age &gt;= <span class="number">18</span>:</span><br><span class="line">    print(<span class="string">&#x27;adult&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;teenager&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>布尔值实际上也属于整型，<code>True</code> 就相当于 1，<code>False</code> 就相当于 0。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">1</span> + <span class="literal">False</span>)  <span class="comment"># 1</span></span><br><span class="line">print(<span class="number">1</span> + <span class="literal">True</span>)  <span class="comment"># 2</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="空值"><a href="#空值" class="headerlink" title="空值"></a>空值</h4><ul>
<li>空值是 Python 里一个特殊的值，用 <code>None</code> 表示。<code>None</code> 不能理解为 0，因为 0 是有意义的，而 <code>None</code> 是一个特殊的空值。</li>
</ul>
<h3 id="类型检查"><a href="#类型检查" class="headerlink" title="类型检查"></a>类型检查</h3><ul>
<li><p>通过类型检查，可以检查变量对应的值的类型。</p>
</li>
<li><p><code>type()</code> 用来检查值的类型，该函数会将检查的结果作为返回值返回，可以通过变量来接收函数的返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">123</span>  <span class="comment"># 数值</span></span><br><span class="line">b = <span class="string">&#x27;123&#x27;</span>  <span class="comment"># 字符串</span></span><br><span class="line">print(<span class="built_in">type</span>(a))  <span class="comment"># &lt;class &#x27;int&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(b))  <span class="comment"># &lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line">c = <span class="built_in">type</span>(a)</span><br><span class="line">print(c)  <span class="comment"># &lt;class &#x27;int&#x27;&gt;</span></span><br><span class="line">c = <span class="built_in">type</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">print(c)  <span class="comment"># &lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(<span class="number">1</span>))  <span class="comment"># &lt;class &#x27;int&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(<span class="number">1.5</span>))  <span class="comment"># &lt;class &#x27;float&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(<span class="literal">True</span>))  <span class="comment"># &lt;class &#x27;bool&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(<span class="string">&#x27;hello&#x27;</span>))  <span class="comment"># &lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(<span class="literal">None</span>))  <span class="comment"># &lt;class &#x27;NoneType&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><ul>
<li>Python 是一门面向对象的语言。</li>
<li>一切皆对象！</li>
<li>程序运行当中，所有的数据都是存储到内存当中然后再运行的！</li>
<li>对象就是内存中专门用来存储指定数据的一块区域。</li>
<li>对象实际上就是一个容器，专门用来存储数据。</li>
<li>像我们之前学习的数值、字符串、布尔值、None 都是对象。</li>
</ul>
<h4 id="对象的结构"><a href="#对象的结构" class="headerlink" title="对象的结构"></a>对象的结构</h4><ul>
<li><p>每个对象中都要保存三种数据：</p>
<ul>
<li><p>id（标识）</p>
<ul>
<li><p>id 用来标识对象的唯一性，每一个对象都有唯一的 id。</p>
</li>
<li><p>对象的 id 就相当于人的身份证号一样。</p>
</li>
<li><p>可以通过 <code>id()</code> 函数来查看对象的 id。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="built_in">id</span>(<span class="number">123</span>))  <span class="comment"># 140708231919200</span></span><br><span class="line">print(<span class="built_in">id</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># 2270491024176</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>id 是由解析器生成的，在 CPython 中，id 就是对象的内存地址。</p>
</li>
<li><p>对象一旦创建，则它的 id 永远不能再改变。</p>
</li>
</ul>
</li>
<li><p>type（类型）</p>
<ul>
<li><p>类型用来标识当前对象所属的类型，比如：int，str，float，bool。</p>
</li>
<li><p>类型决定了对象有哪些功能。</p>
</li>
<li><p>通过 <code>type()</code> 函数来查看对象的 type。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="built_in">type</span>(<span class="number">123</span>))  <span class="comment"># &lt;class &#x27;int&#x27;&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(<span class="string">&#x27;a&#x27;</span>))  <span class="comment"># &lt;class &#x27;str&#x27;&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Python 是一门强类型的语言，对象一旦创建类型便不能修改。</p>
</li>
</ul>
</li>
<li><p>value（值）</p>
<ul>
<li>值就是对象中存储的具体的数据。</li>
<li>对于有些对象，值是可以改变的。</li>
<li>对象分成两大类：可变对象和不可变对象。<ul>
<li>可变对象的值可以改变。</li>
<li>不可变对象的值不能改变，之前学习的数值、字符串等都是不可变对象。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="变量和对象"><a href="#变量和对象" class="headerlink" title="变量和对象"></a>变量和对象</h4><ul>
<li><p>对象并没有直接存储到变量中，在 Python 中变量更像是给对象起了一个别名。</p>
</li>
<li><p>变量中存储的不是对象的值，而是对象的 id（内存地址），当我们使用变量时，实际上就是在通过对象 id 在查找对象。</p>
</li>
<li><p>变量中保存的对象，只有在为变量重新赋值时才会改变。</p>
</li>
<li><p>变量和变量之间是相互独立的，修改一个变量不会影响另一个变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(a)  <span class="comment"># 10</span></span><br><span class="line">print(b)  <span class="comment"># 10</span></span><br><span class="line">print(<span class="built_in">id</span>(a))  <span class="comment"># 140708432125984</span></span><br><span class="line">print(<span class="built_in">id</span>(b))  <span class="comment"># 140708432125984</span></span><br><span class="line">a = <span class="number">456</span></span><br><span class="line">print(a)  <span class="comment"># 456</span></span><br><span class="line">print(b)  <span class="comment"># 10</span></span><br><span class="line">print(<span class="built_in">id</span>(a))  <span class="comment"># 2898418807216</span></span><br><span class="line">print(<span class="built_in">id</span>(b))  <span class="comment"># 140708432125984</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><ul>
<li><p>所谓的类型转换，是将一个类型的对象转换为其他对象。</p>
</li>
<li><p>类型转换不是改变对象本身的类型，而是根据当前对象的值来创建一个新对象。</p>
</li>
<li><p>类型转换四个函数：<code>int()</code>，<code>float()</code>，<code>str()</code>，<code>bool()</code>。</p>
</li>
<li><p><code>int()</code> 可以用来将其他的对象转换为整型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">True</span></span><br><span class="line">a = <span class="built_in">int</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line">a = <span class="literal">False</span></span><br><span class="line">a = <span class="built_in">int</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 0</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;123&#x27;</span></span><br><span class="line">a = <span class="built_in">int</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 123</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">11.6</span></span><br><span class="line">a = <span class="built_in">int</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 11</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;11.5&#x27;</span></span><br><span class="line">a = <span class="built_in">int</span>(a)  <span class="comment"># ValueError</span></span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">a = <span class="literal">None</span></span><br><span class="line">a = <span class="built_in">int</span>(a)  <span class="comment"># TypeError</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<ul>
<li>布尔值：True —&gt; 1，False —&gt; 0。</li>
<li>浮点数：直接取整，省略小数点后的内容。</li>
<li>字符串：如果是一个合法的整数字符串，则直接转换为对应的数字。如果不是一个合法的整数字符串，则报错 <code>ValueError: invalid literal for int() with base 10: &#39;11.5&#39;</code>。</li>
<li>对于其他不可转换为整型的对象，直接抛出异常 <code>TypeError</code>。</li>
<li><code>int()</code> 函数不会对原来的变量产生影响，他是将对象转换为指定的类型并将其作为返回值返回，如果希望修改原来的变量，则需要对变量进行重新赋值。</li>
</ul>
</li>
<li><p><code>float()</code> 和 <code>int()</code> 基本一致，不同的是它会将对象转换为浮点数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">a = <span class="built_in">float</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 1.0</span></span><br><span class="line"></span><br><span class="line">a = <span class="literal">False</span></span><br><span class="line">a = <span class="built_in">float</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 0.0</span></span><br><span class="line"></span><br><span class="line">a = <span class="literal">True</span></span><br><span class="line">a = <span class="built_in">float</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 1.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>str()</code> 可以将对象转换为字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">123</span></span><br><span class="line">a = <span class="built_in">str</span>(a)</span><br><span class="line">print(a)  <span class="comment"># 123</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">456</span></span><br><span class="line">print(<span class="string">&#x27;hello&#x27;</span> + <span class="built_in">str</span>(b))  <span class="comment"># hello456</span></span><br></pre></td></tr></table></figure>

<ul>
<li>True —&gt; ‘True’。</li>
<li>False —&gt; ‘False’。</li>
<li>123 —&gt; ‘123’ 。</li>
<li>。。。</li>
</ul>
</li>
<li><p><code>bool()</code> 可以将对象转换为布尔值，任何对象都可以转换为布尔值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">None</span></span><br><span class="line">a = <span class="built_in">bool</span>(a)</span><br><span class="line">print(a)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">a = <span class="built_in">bool</span>(a)</span><br><span class="line">print(a)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;&#x27;</span></span><br><span class="line">a = <span class="built_in">bool</span>(a)</span><br><span class="line">print(a)  <span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<ul>
<li>规则：对于所有表示空性的对象都会转换为 False，其余的转换为 True。表示空性的对象：<code>0</code>、<code>None</code>、<code>&#39;&#39;</code> 等。</li>
</ul>
</li>
</ul>
<h3 id="运算符（操作符）"><a href="#运算符（操作符）" class="headerlink" title="运算符（操作符）"></a>运算符（操作符）</h3><ul>
<li>运算符可以对一个值或多个值进行运算或各种操作。比如 <code>+</code>、<code>-</code>、<code>=</code> 都属于运算符。</li>
<li>常用运算符的分类：<ul>
<li>算术运算符</li>
<li>赋值运算符</li>
<li>关系运算符（比较运算符）</li>
<li>逻辑运算符</li>
<li>条件运算符（三元运算符）  </li>
</ul>
</li>
</ul>
<h4 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加法运算符</span></span><br><span class="line">a = <span class="number">10</span> + <span class="number">5</span>  <span class="comment"># 15</span></span><br><span class="line">a = <span class="string">&#x27;hello&#x27;</span> + <span class="string">&#x27; &#x27;</span> + <span class="string">&#x27;world&#x27;</span>  <span class="comment"># hello world，拼串</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 减法运算符</span></span><br><span class="line">a = <span class="number">10</span> - <span class="number">5</span>  <span class="comment"># 5</span></span><br><span class="line">a = <span class="number">5</span> - <span class="literal">True</span>  <span class="comment"># 4</span></span><br><span class="line">a = a - <span class="number">2</span>  <span class="comment"># 2，用变量a的值减去2，然后再赋值给a</span></span><br><span class="line"><span class="comment"># a = &#x27;hello&#x27; - &#x27;h&#x27;  # TypeError</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 乘法运算符</span></span><br><span class="line">a = <span class="number">5</span> * <span class="number">5</span>  <span class="comment"># 25</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 除法运算符</span></span><br><span class="line">a = <span class="number">10</span> / <span class="number">5</span>  <span class="comment"># 2.0</span></span><br><span class="line">a = <span class="number">5</span> / <span class="number">2</span>  <span class="comment"># 2.5</span></span><br><span class="line"><span class="comment"># a = 5 / 0  # ZeroDivisionError: division by zero</span></span><br><span class="line">a = <span class="number">10</span> / <span class="number">3</span>  <span class="comment"># 3.33333...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 幂运算</span></span><br><span class="line">a = <span class="number">2</span> ** <span class="number">2</span>  <span class="comment"># 4</span></span><br><span class="line">a = <span class="number">10</span> ** <span class="number">5</span>  <span class="comment"># 100000</span></span><br><span class="line">a = <span class="number">16</span> ** <span class="number">0.5</span>  <span class="comment"># 4.0，求16的平方根</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整除</span></span><br><span class="line">a = <span class="number">10</span> // <span class="number">3</span>  <span class="comment"># 3</span></span><br><span class="line">a = <span class="number">5</span> // <span class="number">2</span>  <span class="comment"># 2</span></span><br><span class="line">a = <span class="number">10</span> // <span class="number">-3</span>  <span class="comment"># -4</span></span><br><span class="line">a = <span class="number">-5</span> // <span class="number">2</span>  <span class="comment"># -3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取模</span></span><br><span class="line">a = <span class="number">10</span> % <span class="number">5</span>  <span class="comment"># 0</span></span><br><span class="line">a = <span class="number">10</span> % <span class="number">4</span>  <span class="comment"># 2</span></span><br><span class="line">a = <span class="number">10</span> % <span class="number">3</span>  <span class="comment"># 1</span></span><br><span class="line">a = <span class="number">10</span> % <span class="number">2</span>  <span class="comment"># 0</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;a =&quot;</span>, a)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>加法运算符：<code>+</code>。如果是两个字符串之间进行加法运算，则会进行拼串操作。</p>
</li>
<li><p>减法运算符：<code>-</code>。</p>
</li>
<li><p>乘法运算符：<code>*</code>。如果将字符串和数字相乘，则会对字符串进行复制操作，将字符串重复指定次数。</p>
</li>
<li><p>除法运算符：<code>/</code>。运算时结果总会返回一个浮点类型。</p>
</li>
<li><p>幂运算：<code>**</code>。求一个值的几次幂。</p>
</li>
<li><p>整除：<code>//</code>。向下取整，只会保留计算后的整数位，总会返回一个整型。</p>
</li>
<li><p>取模：<code>%</code>。即取余，求两个数相除的余数。</p>
</li>
<li><p>运算时，注意正负号的问题。</p>
</li>
<li><p>在对浮点数做算术运算时，结果也会返回一个浮点数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="number">25.0</span> / <span class="number">5</span></span><br><span class="line">print(b)  <span class="comment"># 5.0</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h4><ul>
<li>赋值运算符 <code>=</code> 可以将等号右侧的值赋值给等号左侧的变量。</li>
<li><code>+=</code>：<code>a += 5</code> 相当于 <code>a = a + 5</code>。</li>
<li><code>-=</code>：<code>a -= 5</code> 相当于 <code>a = a - 5</code>。</li>
<li><code>*=</code>：<code>a *= 5</code> 相当于 <code>a = a * 5</code>。</li>
<li><code>/=</code>：<code>a /= 5</code> 相当于 <code>a = a / 5</code>。</li>
<li><code>**=</code>：<code>a **= 5</code> 相当于 <code>a = a ** 5</code>。</li>
<li><code>//=</code>：<code>a //= 5</code> 相当于 <code>a = a // 5</code>。</li>
<li><code>%=</code>：<code>a %= 5</code> 相当于 <code>a = a % 5</code>。</li>
</ul>
<h4 id="关系运算符（比较运算符）"><a href="#关系运算符（比较运算符）" class="headerlink" title="关系运算符（比较运算符）"></a>关系运算符（比较运算符）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="number">10</span> &gt; <span class="number">20</span>  <span class="comment"># False</span></span><br><span class="line">result = <span class="number">10</span> &gt;= <span class="number">10</span>  <span class="comment"># True</span></span><br><span class="line">result = <span class="number">2</span> &gt; <span class="literal">True</span>  <span class="comment"># True</span></span><br><span class="line"><span class="comment"># result = 2 &gt; &#x27;1&#x27;  # TypeError: &#x27;&gt;&#x27; not supported between instances of &#x27;int&#x27; and &#x27;str&#x27;</span></span><br><span class="line">result = <span class="number">30</span> &lt; <span class="number">20</span>  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在Python中可以对两个字符串进行大于（等于）或小于（等于）的运算，</span></span><br><span class="line"><span class="comment">#   当对字符串进行比较时，实际上比较的是字符串的Unicode编码</span></span><br><span class="line"><span class="comment">#   比较两个字符串的Unicode编码时，是逐位比较的，比较出现结果时，直接返回，后续不再比较</span></span><br><span class="line"><span class="comment">#   利用该特性可以对字符串按照字母顺序进行排序，但是对于中文来说意义不是特别大</span></span><br><span class="line"><span class="comment">#   注意：如果不希望比较两个字符串的Unicode编码，则需要将其转换为数字然后再比较</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;2&#x27;</span> &gt; <span class="string">&#x27;1&#x27;</span>  <span class="comment"># True，2的unicode编码为0032，1的unicode编码为0031</span></span><br><span class="line">result = <span class="string">&#x27;2&#x27;</span> &gt; <span class="string">&#x27;11&#x27;</span>  <span class="comment"># True，逐位比较，先拿2和1比，结果为True，直接返回，后续不再比较</span></span><br><span class="line">result = <span class="string">&#x27;a&#x27;</span> &gt; <span class="string">&#x27;b&#x27;</span>  <span class="comment"># False，a的unicode编码为0061，b的unicode编码为0062</span></span><br><span class="line">result = <span class="string">&#x27;c&#x27;</span> &lt; <span class="string">&#x27;d&#x27;</span>  <span class="comment"># True</span></span><br><span class="line">result = <span class="string">&#x27;ab&#x27;</span> &gt; <span class="string">&#x27;b&#x27;</span>  <span class="comment"># False，逐位比较，先拿a和b比，结果为False，直接返回，后续不再比较</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">int</span>(<span class="string">&#x27;2&#x27;</span>) &gt; <span class="built_in">int</span>(<span class="string">&#x27;11&#x27;</span>))  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">result = <span class="number">1</span> == <span class="number">1</span>  <span class="comment"># True</span></span><br><span class="line">result = <span class="string">&#x27;hello&#x27;</span> == <span class="string">&#x27;hello&#x27;</span>  <span class="comment"># True</span></span><br><span class="line">result = <span class="string">&#x27;abc&#x27;</span> == <span class="string">&#x27;bcd&#x27;</span>  <span class="comment"># False</span></span><br><span class="line">result = <span class="string">&#x27;abc&#x27;</span> != <span class="string">&#x27;bcd&#x27;</span>  <span class="comment"># True</span></span><br><span class="line">result = <span class="number">1</span> == <span class="literal">True</span>  <span class="comment"># True</span></span><br><span class="line">result = <span class="number">1</span> <span class="keyword">is</span> <span class="literal">True</span>  <span class="comment"># False</span></span><br><span class="line">result = <span class="number">1</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">True</span>  <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">id</span>(<span class="number">1</span>), <span class="built_in">id</span>(<span class="literal">True</span>))  <span class="comment"># 140708473153312 140708472870736</span></span><br></pre></td></tr></table></figure>

<ul>
<li>关系运算符用来比较两个值之间的关系，总会返回一个布尔值。如果关系成立，返回 True，否则返回 False。</li>
<li><code>&gt;</code>：比较左侧值是否大于右侧值。</li>
<li><code>&gt;=</code>：比较左侧的值是否大于或等于右侧的值。</li>
<li><code>&lt;</code>：比较左侧值是否小于右侧值。</li>
<li><code>&lt;=</code>：比较左侧的值是否小于或等于右侧的值。</li>
<li><code>==</code>：比较两个对象的值是否相等，比较的是对象的值。</li>
<li><code>!=</code>：比较两个对象的值是否不相等，比较的是对象的值。</li>
<li><code>is</code>：比较两个对象是否是同一个对象，比较的是对象的 id。</li>
<li><code>is not</code>：比较两个对象是否不是同一个对象，比较的是对象的 id。</li>
</ul>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><ul>
<li><p>逻辑运算符主要用来做一些逻辑判断。</p>
</li>
<li><p><code>and</code>：逻辑与。</p>
<ul>
<li><p><code>and</code> 可以对符号两侧的值进行与运算。</p>
</li>
<li><p>只有在符号两侧的值都为 True 时，才会返回 True，只要有一个 False 就返回 False。</p>
</li>
<li><p>Python 中的与运算是短路的与，如果第一个值为 False，则不再看第二个值，直接返回 False。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">True</span> <span class="keyword">and</span> print(<span class="string">&#x27;男：你猜我出来吗？&#x27;</span>)  <span class="comment"># 第一个值是True，会看第二个值，所以print()会执行</span></span><br><span class="line"><span class="literal">False</span> <span class="keyword">and</span> print(<span class="string">&#x27;女：你猜我出来吗？&#x27;</span>)  <span class="comment"># 第一个值是False，不会看第二个值，所以print()不会执行</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>or</code>：逻辑或。</p>
<ul>
<li><p><code>or</code> 可以对符号两侧的值进行或运算。</p>
</li>
<li><p>或运算两个值中只要有一个 True，就会返回 True。</p>
</li>
<li><p>Python 中的或运算是短路的或，如果第一个值为 True，则不再看第二个值，直接返回 True。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">False</span> <span class="keyword">or</span> print(<span class="string">&#x27;男：你猜我出来吗？&#x27;</span>)  <span class="comment"># 第一个值为False，继续看第二个，所以打印语句执行</span></span><br><span class="line"><span class="literal">True</span> <span class="keyword">or</span> print(<span class="string">&#x27;女：你猜我出来吗？&#x27;</span>)  <span class="comment"># 第一个值为True，不看第二个，所以打印语句不执行</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>not</code>：逻辑非。</p>
<ul>
<li><code>not</code> 可以对符号右侧的值进行非运算。</li>
<li>对于布尔值，非运算会对其进行取反操作，True 变 False，False 变 True。</li>
<li>对于非布尔值，非运算会先将其转换为布尔值，然后再取反。</li>
</ul>
</li>
<li><p>非布尔值的与或运算：当我们对非布尔值进行与或运算时，Python 会将其当做布尔值运算，最终会返回原值。</p>
<ul>
<li><p>与运算的规则：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># True and True</span></span><br><span class="line">result = <span class="number">1</span> <span class="keyword">and</span> <span class="number">2</span>  <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># True and False</span></span><br><span class="line">result = <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span>  <span class="comment"># 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># False and True</span></span><br><span class="line">result = <span class="number">0</span> <span class="keyword">and</span> <span class="number">1</span>  <span class="comment"># 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># False and False</span></span><br><span class="line">result = <span class="literal">None</span> <span class="keyword">and</span> <span class="number">0</span>  <span class="comment"># None</span></span><br></pre></td></tr></table></figure>

<ul>
<li>与运算是找 False 的，如果第一个值是 False，则不看第二个值。</li>
<li>如果第一个值是 False，则直接返回第一个值，否则返回第二个值。</li>
</ul>
</li>
<li><p>或运算的规则：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># True or True</span></span><br><span class="line">result = <span class="number">1</span> <span class="keyword">or</span> <span class="number">2</span>  <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># True or False</span></span><br><span class="line">result = <span class="number">1</span> <span class="keyword">or</span> <span class="number">0</span>  <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># False or True</span></span><br><span class="line">result = <span class="number">0</span> <span class="keyword">or</span> <span class="number">1</span>  <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># False or False</span></span><br><span class="line">result = <span class="literal">None</span> <span class="keyword">or</span> <span class="number">0</span>  <span class="comment"># 0</span></span><br></pre></td></tr></table></figure>

<ul>
<li>或运算是找 True 的，如果第一个值是 True，则不看第二个值。</li>
<li>如果第一个值是 True，则直接返回第一个值，否则返回第二个值。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="条件运算符（三元运算符）"><a href="#条件运算符（三元运算符）" class="headerlink" title="条件运算符（三元运算符）"></a>条件运算符（三元运算符）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">30</span></span><br><span class="line">b = <span class="number">50</span></span><br><span class="line">print(<span class="string">&#x27;a的值比较大！&#x27;</span>) <span class="keyword">if</span> a &gt; b <span class="keyword">else</span> print(<span class="string">&#x27;b的值比较大！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取a和b之间的较大值</span></span><br><span class="line">maxNum = a <span class="keyword">if</span> a &gt; b <span class="keyword">else</span> b</span><br><span class="line">print(maxNum)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>语法：<code>语句1 if 条件表达式 else 语句2</code>。</p>
</li>
<li><p>na = input(‘请输入任意内容：’)<br>print(‘用户输入的内容是:’, a)</p>
<h1 id="获取用户输入的用户名"><a href="#获取用户输入的用户名" class="headerlink" title="获取用户输入的用户名"></a>获取用户输入的用户名</h1><p>username = input(‘请输入你的用户名: ‘)</p>
<h1 id="判断用户名是否是admin"><a href="#判断用户名是否是admin" class="headerlink" title="判断用户名是否是admin"></a>判断用户名是否是admin</h1><p>if username == ‘admin’:</p>
<pre><code>print(&#39;欢迎管理员光临！&#39;)</code></pre>
</li>
<li><p>该函数用来获取用户的输入。</p>
</li>
<li><p><code>input()</code> 调用后，程序会立即暂停，等待用户输入，用户输入完内容以后，点击回车程序才会继续向下执行。用户输入完成以后，其所输入的的内容会以返回值的形式返回。</p>
</li>
<li><p>注意：<code>input()</code> 的返回值是一个字符串。</p>
</li>
<li><p><code>input()</code> 函数中可以设置一个字符串作为参数，这个字符串将会作为提示文字显示。</p>
</li>
<li><p><code>input()</code> 也可以用于暂时阻止程序结束。</p>
</li>
</ul>
<h2 id="Python-流程控制语句"><a href="#Python-流程控制语句" class="headerlink" title="Python 流程控制语句"></a>Python 流程控制语句</h2><ul>
<li>Python代码在执行时是按照自上向下顺序执行的。</li>
<li>通过流程控制语句，可以改变程序的执行顺序，也可以让指定的程序反复执行多次。</li>
<li>流程控制语句分成两大类：条件判断语句，循环语句。</li>
</ul>
<h3 id="条件判断语句（if-语句）"><a href="#条件判断语句（if-语句）" class="headerlink" title="条件判断语句（if 语句）"></a>条件判断语句（if 语句）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">num = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> num &gt; <span class="number">10</span>:</span><br><span class="line">    print(<span class="string">&#x27;num比10大！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> num &gt; <span class="number">10</span> <span class="keyword">and</span> num &lt; <span class="number">20</span>:</span><br><span class="line">    print(<span class="string">&#x27;num比10大, num比20小！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">10</span> &lt; num &lt; <span class="number">20</span>:</span><br><span class="line">    print(<span class="string">&#x27;num比10大, num比20小！&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>语法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件表达式: </span><br><span class="line">    代码块</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行的流程：if 语句在执行时，会先对条件表达式进行求值判断，如果为 True，则执行 if 后的语句；如果为 False，则不执行。</p>
</li>
<li><p>默认情况下，if 语句只会控制紧随其后的那条语句，如果希望 if 可以控制多条语句，则可以在 if 后跟着一个代码块。</p>
</li>
<li><p>代码块：</p>
<ul>
<li>代码块中保存着一组代码，同一个代码块中的代码，要么都执行要么都不执行。</li>
<li>代码块就是一种为代码分组的机制。</li>
<li>如果要编写代码块，语句就不能紧随在 <code>:</code> 后边，而是要写在下一行。</li>
<li>代码块以缩进开始，直到代码恢复到之前的缩进级别时结束。</li>
<li>缩进有两种方式，一种是使用 tab 键，一种是使用空格（四个）。<ul>
<li>Python 代码中使用的缩进方式必须统一。</li>
<li>Python 的官方文档中推荐我们使用空格来缩进。</li>
</ul>
</li>
</ul>
</li>
<li><p>可以使用逻辑运算符来连接多个条件，如果希望所有条件同时满足，则需要使用 <code>and</code>；如果希望只要有一个条件满足即可，则需要使用 <code>or</code>。</p>
</li>
</ul>
<h4 id="if-else"><a href="#if-else" class="headerlink" title="if - else"></a>if - else</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">age = <span class="number">7</span></span><br><span class="line"><span class="keyword">if</span> age &gt; <span class="number">17</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经成年了~~&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;你还未成年~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果一个年份可以被4整除不能被100整除，或者可以被400整除，这个年份就是闰年</span></span><br><span class="line">year = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入一个任意的年份:&#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> year % <span class="number">4</span> == <span class="number">0</span> <span class="keyword">and</span> year % <span class="number">100</span> != <span class="number">0</span> <span class="keyword">or</span> year % <span class="number">400</span> == <span class="number">0</span>:</span><br><span class="line">    print(year, <span class="string">&#x27;是闰年&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(year, <span class="string">&#x27;是平年&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>语法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件表达式:</span><br><span class="line">    代码块<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    代码块<span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行流程：if - else 语句在执行时，先对 if 后的条件表达式进行求值判断，如果为 True，则执行 if 后的代码块 1；如果为 False，则执行 else 后的代码块 2。</p>
</li>
</ul>
<h4 id="if-elif-else"><a href="#if-elif-else" class="headerlink" title="if - elif - else"></a>if - elif - else</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">age = <span class="number">210</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> age &gt; <span class="number">200</span>:</span><br><span class="line">    print(<span class="string">&#x27;活的可真久！&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> age &gt; <span class="number">100</span>:</span><br><span class="line">    print(<span class="string">&#x27;你也是老大不小了！&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> age &gt;= <span class="number">60</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经退休了！&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> age &gt;= <span class="number">30</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经是中年了！&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> age &gt;= <span class="number">18</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经成年了！&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;你还是个小孩！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">age = <span class="number">68</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">18</span> &lt;= age &lt; <span class="number">30</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经成年了！&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> <span class="number">30</span> &lt;= age &lt; <span class="number">60</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经中年了！&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;你已经退休了！&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>语法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件表达式:</span><br><span class="line">    代码块</span><br><span class="line"><span class="keyword">elif</span> 条件表达式:</span><br><span class="line">    代码块</span><br><span class="line"><span class="keyword">elif</span> 条件表达式:</span><br><span class="line">    代码块</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    代码块</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行流程：if - elif - else 语句在执行时，会自上向下依次对条件表达式进行求值判断，如果表达式的结果为 True，则执行当前代码块，然后语句结束；如果表达式的结果为 False，则继续向下判断，直到找到 True 为止；如果所有的表达式都是 False，则执行 else 后的代码块。</p>
</li>
<li><p>if - elif - else 中只会有一个代码块会执行。</p>
</li>
</ul>
<h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><ul>
<li>循环语句可以使指定的代码块重复指定的次数。</li>
<li>循环语句分成两种，while 循环和 for 循环。</li>
</ul>
<h4 id="while-循环"><a href="#while-循环" class="headerlink" title="while 循环"></a>while 循环</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个执行十次的循环</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">10</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    print(i, <span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;else中的代码块&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment"># 水仙花数是指一个 n 位数（n≥3 ），它的每个位上的数字的 n 次幂之和等于它本身（例如：1**3 + 5**3 + 3**3 = 153）。</span></span><br><span class="line"><span class="comment"># 求1000以内所有的水仙花数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取1000以内的三位数</span></span><br><span class="line">i = <span class="number">100</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">1000</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 假设，i的百位数是a，十位数b，个位数c</span></span><br><span class="line">    <span class="comment"># 求i的百位数</span></span><br><span class="line">    a = i // <span class="number">100</span></span><br><span class="line">    <span class="comment"># 求i的十位数</span></span><br><span class="line">    <span class="comment"># b = i // 10 % 10</span></span><br><span class="line">    b = (i - a * <span class="number">100</span>) // <span class="number">10</span></span><br><span class="line">    <span class="comment"># 求i的个位数字</span></span><br><span class="line">    c = i % <span class="number">10</span></span><br><span class="line">    <span class="comment"># print(i , a , b , c)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 判断i是否是水仙花数</span></span><br><span class="line">    <span class="keyword">if</span> a**<span class="number">3</span> + b**<span class="number">3</span> + c**<span class="number">3</span> == i :</span><br><span class="line">        print(i)</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>语法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 条件表达式:</span><br><span class="line">    代码块</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    代码块</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行流程：while 语句在执行时，会先对 while 后的条件表达式进行求值判断，如果判断结果为 True，则执行循环体（代码块），循环体执行完毕，继续对条件表达式进行求值判断，以此类推，直到判断结果为 False，则循环终止，如果循环有对应的 else，则执行 else 后的代码块。</p>
</li>
<li><p>条件表达式恒为 True 的循环语句，称为死循环。</p>
</li>
<li><p>循环的三个要件：</p>
<ul>
<li>初始化表达式：通过初始化表达式初始化一个变量。</li>
<li>条件表达式：条件表达式用来设置循环执行的条件。</li>
<li>更新表达式：修改初始化变量的值。</li>
</ul>
</li>
</ul>
<h4 id="循环嵌套"><a href="#循环嵌套" class="headerlink" title="循环嵌套"></a>循环嵌套</h4><ul>
<li><p>打印图形：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在控制台中打印如下图形</span></span><br><span class="line"><span class="comment"># *****</span></span><br><span class="line"><span class="comment"># *****</span></span><br><span class="line"><span class="comment"># *****</span></span><br><span class="line"><span class="comment"># *****</span></span><br><span class="line"><span class="comment"># *****</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个循环来控制图形的高度</span></span><br><span class="line"><span class="comment"># 循环嵌套时，外层循环没执行一次，内存循环就要执行一圈</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">5</span>:</span><br><span class="line">    <span class="comment"># 创建一个内层循环来控制图形的宽度</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">5</span>:</span><br><span class="line">        <span class="comment"># print()默认在结尾打印\n换行符，添加end参数，打印时不要换行</span></span><br><span class="line">        print(<span class="string">&quot;* &quot;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    <span class="comment"># 每一行打印完毕后，再打印一个换行符</span></span><br><span class="line">    print()</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># *     j&lt;1   i=0</span></span><br><span class="line"><span class="comment"># **    j&lt;2   i=1</span></span><br><span class="line"><span class="comment"># ***   j&lt;3   i=2</span></span><br><span class="line"><span class="comment"># ****  j&lt;4   i=3</span></span><br><span class="line"><span class="comment"># ***** j&lt;5   i=4</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># *****</span></span><br><span class="line"><span class="comment"># ****</span></span><br><span class="line"><span class="comment"># ***</span></span><br><span class="line"><span class="comment"># **</span></span><br><span class="line"><span class="comment"># *</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">5</span>:</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; i + <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">&quot;* &quot;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    print()</span><br><span class="line">    i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>99 乘法表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印99乘法表</span></span><br><span class="line"><span class="comment"># 1*1=1</span></span><br><span class="line"><span class="comment"># 1*2=2 2*2=4</span></span><br><span class="line"><span class="comment"># 1*3=3 2*3=6 3*3=9</span></span><br><span class="line"><span class="comment"># ...                 9*9=81</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个外层循环来控制图形的高度</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">9</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建一个内层循环来控制图形的宽度</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; i:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        print(<span class="string">f&quot;<span class="subst">&#123;j&#125;</span>*<span class="subst">&#123;i&#125;</span>=<span class="subst">&#123;i*j&#125;</span> &quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="break-和-continue"><a href="#break-和-continue" class="headerlink" title="break 和 continue"></a>break 和 continue</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(i)  <span class="comment"># 结束循环，结果：0 1 2</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;循环结束&#x27;</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">5</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 跳出当前循环，结果：1 3 4 5 循环结束</span></span><br><span class="line">    print(i)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&#x27;循环结束&#x27;</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> i &lt; <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<ul>
<li>break 可以用来立即退出循环语句（包括 else）。</li>
<li>continue 可以用来跳过当次循环。</li>
<li>break 和 continue 都是只对离他最近的循环起作用。</li>
<li>pass 是用来在判断或循环语句中占位的，无实际意义。如果循环体内容没想好怎么写，可以先用 pass 占位，这样不会影响程序执行。</li>
</ul>
<h4 id="模块引入"><a href="#模块引入" class="headerlink" title="模块引入"></a>模块引入</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模块，通过模块可以对Python进行扩展</span></span><br><span class="line"><span class="comment"># 引入一个time模块，来统计程序执行的时间</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># time()函数可以用来获取当前的时间，返回的单位是秒</span></span><br><span class="line"><span class="comment"># 获取程序开始的时间</span></span><br><span class="line"><span class="comment"># 优化前：</span></span><br><span class="line"><span class="comment">#   10000个数 12.298秒</span></span><br><span class="line"><span class="comment">#   100000个数 没有结果</span></span><br><span class="line"><span class="comment"># 第一次优化：加break</span></span><br><span class="line"><span class="comment">#   10000个数 1.577秒</span></span><br><span class="line"><span class="comment">#   100000个数 170.645秒</span></span><br><span class="line"><span class="comment"># 第二次优化：循环到根号为止</span></span><br><span class="line"><span class="comment">#   10000个数 0.068秒</span></span><br><span class="line"><span class="comment">#   100000个数 1.646秒</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 36的因数</span></span><br><span class="line"><span class="comment">#   2 18</span></span><br><span class="line"><span class="comment">#   3 12</span></span><br><span class="line"><span class="comment">#   4 9</span></span><br><span class="line"><span class="comment">#   6 6</span></span><br><span class="line"><span class="comment">#   </span></span><br><span class="line">begin = time()</span><br><span class="line"></span><br><span class="line">i = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> i &lt;= <span class="number">100000</span>:</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> j &lt;= i ** <span class="number">0.5</span>:</span><br><span class="line">        <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="comment"># 一旦进入判断，则证明i一定不是质数，此时内层循环没有继续执行的必要</span></span><br><span class="line">            <span class="comment"># 使用break来退出内层的循环</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="comment"># print(i)  </span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取程序结束的时间</span></span><br><span class="line">end = time()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算程序执行的时间</span></span><br><span class="line">print(<span class="string">&quot;程序执行花费了：&quot;</span>, end - begin, <span class="string">&quot;秒&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h4><ul>
<li><p>语法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量 <span class="keyword">in</span> 序列 :</span><br><span class="line">       代码块</span><br></pre></td></tr></table></figure>
</li>
<li><p>for 循环除了创建方式以外，其余的都和 while 循环一样，包括 else、break、continue 都可以在 for 循环中使用。</p>
</li>
</ul>
<h2 id="Python-数据结构"><a href="#Python-数据结构" class="headerlink" title="Python 数据结构"></a>Python 数据结构</h2><h3 id="序列（sequence）"><a href="#序列（sequence）" class="headerlink" title="序列（sequence）"></a>序列（sequence）</h3><ul>
<li><p>计算机中数据存储的方式叫数据结构，序列是 Python 中最基本的一种数据结构。</p>
</li>
<li><p>序列用于保存一组有序的数据，所有的数据在序列当中都有一个唯一的位置（索引），并且序列中的数据会按照添加的顺序来分配索引。</p>
</li>
<li><p>序列存储的数据，称为元素。</p>
</li>
<li><p>序列的分类：</p>
<ul>
<li>可变序列（序列中的元素可以改变）<ul>
<li>列表（list）</li>
</ul>
</li>
<li>不可变序列（序列中的元素不能改变）<ul>
<li>元组（tuple）</li>
<li>字符串（str）</li>
</ul>
</li>
</ul>
</li>
<li><p><code>range()</code> 函数：用来生成一个自然数的序列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># range()是一个函数，可以用来生成一个自然数的序列</span></span><br><span class="line"><span class="comment"># 该函数需要三个参数</span></span><br><span class="line"><span class="comment">#   1.起始位置（包含，可以省略，默认是0）</span></span><br><span class="line"><span class="comment">#   2.结束位置（不包含）</span></span><br><span class="line"><span class="comment">#   3.步长（可以省略，默认是1）</span></span><br><span class="line">r = <span class="built_in">range</span>(<span class="number">5</span>)</span><br><span class="line">print(<span class="built_in">list</span>(r))  <span class="comment"># [0, 1, 2, 3, 4]</span></span><br><span class="line">r = <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line">print(<span class="built_in">list</span>(r))  <span class="comment"># [0, 2, 4, 6, 8]</span></span><br><span class="line">r = <span class="built_in">range</span>(<span class="number">10</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">print(<span class="built_in">list</span>(r))  <span class="comment"># [10, 9, 8, 7, 6, 5, 4, 3, 2, 1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过range()可以创建一个执行指定次数的for循环</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="通用操作"><a href="#通用操作" class="headerlink" title="通用操作"></a>通用操作</h4><ul>
<li><code>+</code> 可以将两个序列拼接为一个序列。</li>
<li><code>*</code> 可以将序列重复指定的次数。</li>
<li><code>in </code> 用来检查指定元素是否存在于序列中，如果存在，返回 True，否则返回 False。</li>
<li><code>not in</code> 用来检查指定元素是否不在序列中，如果不在，返回 True，否则返回 False。</li>
<li><code>len()</code> 函数获取序列的长度，即序列中的元素的个数。该长度值，是序列的最大索引加 1。</li>
<li><code>min()</code> 函数获取序列中的最小值。</li>
<li><code>max()</code> 函数获取序列中的最大值。</li>
<li>可以通过索引（index）来获取序列中的元素：<ul>
<li>语法：<code>序列[索引]</code>。</li>
<li>索引是元素在序列中的位置，序列中的每一个元素都有一个索引。</li>
<li>索引是从 0 开始的整数，序列第一个位置索引为 0，第二个位置索引为 1，第三个位置索引为 2，以此类推。</li>
<li>索引可以是负数，表示从后向前获取元素，-1 表示倒数第一个元素，-2 表示倒数第二个元素，以此类推。</li>
<li>如果使用的索引超过了序列最大的范围，会抛出异常 <code>IndexError: list index out of range</code>。</li>
</ul>
</li>
<li><code>s.index()</code> 方法获取指定元素在序列中的第一次出现时索引。<ul>
<li>方法和函数基本上是一样，只不过方法必须通过 <code>对象.方法()</code> 的形式调用，方法实际上就是和对象关系紧密的函数。</li>
<li><code>index()</code> 的第二个参数，表示查找的起始位置，第三个参数，表示查找的结束位置。</li>
<li>如果要获取序列中没有的元素，会抛出异常。</li>
</ul>
</li>
<li><code>s.count()</code> 方法统计指定元素在序列中出现的次数。</li>
</ul>
<h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><ul>
<li>切片指从现有序列中，获取一个子序列。</li>
<li>语法一：<code>序列[起始:结束]</code>。<ul>
<li>通过切片获取元素时，会包括起始位置的元素，不会包括结束位置的元素。</li>
<li>做切片操作时，总会返回一个新的序列，但不会影响原来的序列。</li>
<li>起始和结束位置的索引都可以省略不写。<ul>
<li>如果省略起始位置，则会从第一个元素开始截取。</li>
<li>如果省略结束位置，则会一直截取到最后。</li>
<li>如果起始位置和结束位置全部省略，则相当于创建了一个序列的副本。</li>
</ul>
</li>
</ul>
</li>
<li>语法二：<code>序列[起始:结束:步长]</code>。<ul>
<li>步长表示，每次获取元素的间隔，默认值是 1。</li>
<li>步长不能是 0，但可以是负数。</li>
<li>步长如果是负数，则从序列的后边向前边取元素。</li>
</ul>
</li>
</ul>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><h5 id="列表（list）"><a href="#列表（list）" class="headerlink" title="列表（list）"></a>列表（list）</h5><ul>
<li><p>列表是 Python 中的一个对象。</p>
</li>
<li><p>对象（object）就是内存中专门用来存储数据的一块区域，之前我们学习的对象，像数值，它只能保存一个单一的数据。</p>
</li>
<li><p>列表是用来存储对象的对象，列表中可以保存多个有序的数据。</p>
</li>
<li><p>列表中可以保存任意的对象，但一般不会这样操作，尽可能保证列表中元素属性一致。</p>
</li>
<li><p>列表的创建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">my_list = []  <span class="comment"># 创建了一个空列表</span></span><br><span class="line">print(my_list, <span class="built_in">type</span>(my_list))  <span class="comment"># [] &lt;class &#x27;list&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">my_list = [<span class="number">10</span>]  <span class="comment"># 创建一个只包含一个元素的列表</span></span><br><span class="line"></span><br><span class="line">my_list = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]  <span class="comment"># 创建了一个包含有5个元素的列表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># my_list = [10, &#x27;hello&#x27;, True, None, [1, 2, 3], print]  # 列表可以保存任意对象，但一般不会这样操作</span></span><br><span class="line"></span><br><span class="line">print(my_list[<span class="number">4</span>])  <span class="comment"># 50</span></span><br><span class="line"></span><br><span class="line">print((my_list[<span class="number">-2</span>]))  <span class="comment"># 40</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(my_list))  <span class="comment"># 5</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用 <code>[]</code> 来创建列表。</li>
</ul>
</li>
</ul>
<ul>
<li>一个列表中可以存储多个元素，也可以在创建列表时，来指定列表中的元素。</li>
</ul>
<ul>
<li>当向列表中添加多个元素时，多个元素之间使用 <code>,</code> 隔开。</li>
</ul>
<ul>
<li>列表中的对象都会按照插入的顺序存储到列表中，第一个插入的对象保存到第一个位置，第二个保存到第二个位置，以此类推。</li>
</ul>
<ul>
<li><p>列表的通用操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">my_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">print(<span class="built_in">len</span>(my_list))  <span class="comment"># 6</span></span><br><span class="line"></span><br><span class="line">my_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] * <span class="number">5</span></span><br><span class="line">print(<span class="built_in">len</span>(my_list))  <span class="comment"># 15</span></span><br><span class="line"></span><br><span class="line">stus = [<span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;唐僧&#x27;</span>, <span class="string">&#x27;蜘蛛精&#x27;</span>, <span class="string">&#x27;白骨精&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>]</span><br><span class="line">print(<span class="string">&#x27;牛魔王&#x27;</span> <span class="keyword">in</span> stus)  <span class="comment"># False</span></span><br><span class="line">print(<span class="string">&#x27;牛魔王&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> stus)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">arr = [<span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">100</span>, <span class="number">77</span>]</span><br><span class="line">print(<span class="built_in">min</span>(arr), <span class="built_in">max</span>(arr))  <span class="comment"># 1 100</span></span><br><span class="line"></span><br><span class="line">print(stus.index(<span class="string">&#x27;沙和尚&#x27;</span>))  <span class="comment"># 2</span></span><br><span class="line">print(stus.index(<span class="string">&#x27;沙和尚&#x27;</span>, <span class="number">3</span>, <span class="number">7</span>))  <span class="comment"># 6</span></span><br><span class="line"><span class="comment"># print(stus.index(&#x27;牛魔王&#x27;))  # ValueError: &#x27;牛魔王&#x27; is not in list</span></span><br><span class="line">print(stus.count(<span class="string">&#x27;牛魔王&#x27;</span>))  <span class="comment"># 0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表的切片操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">stus = [<span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;唐僧&#x27;</span>, <span class="string">&#x27;蜘蛛精&#x27;</span>, <span class="string">&#x27;白骨精&#x27;</span>]</span><br><span class="line">print(stus[<span class="number">1</span>:])  <span class="comment"># [&#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line">print(stus[:<span class="number">3</span>])  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;]</span></span><br><span class="line">print(stus[:])  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line"></span><br><span class="line">print(stus[<span class="number">0</span>:<span class="number">5</span>:<span class="number">3</span>])  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;唐僧&#x27;]</span></span><br><span class="line"><span class="comment"># print(stus[::0])  # ValueError: slice step cannot be zero</span></span><br><span class="line">print(stus[::<span class="number">-1</span>])  <span class="comment"># [&#x27;白骨精&#x27;, &#x27;蜘蛛精&#x27;, &#x27;唐僧&#x27;, &#x27;沙和尚&#x27;, &#x27;猪八戒&#x27;, &#x27;孙悟空&#x27;]，列表反转</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表元素的修改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">stus = [<span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;唐僧&#x27;</span>, <span class="string">&#x27;蜘蛛精&#x27;</span>, <span class="string">&#x27;白骨精&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过索引来修改元素</span></span><br><span class="line">stus[<span class="number">0</span>] = <span class="string">&#x27;sunwukong&#x27;</span></span><br><span class="line">stus[<span class="number">2</span>] = <span class="string">&#x27;哈哈&#x27;</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;sunwukong&#x27;, &#x27;猪八戒&#x27;, &#x27;哈哈&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过del来删除元素</span></span><br><span class="line"><span class="keyword">del</span> stus[<span class="number">2</span>]  <span class="comment"># 删除索引为2的元素</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;sunwukong&#x27;, &#x27;猪八戒&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过切片来修改列表</span></span><br><span class="line"><span class="comment"># 在给切片进行赋值时，只能使用序列</span></span><br><span class="line">stus[<span class="number">0</span>:<span class="number">2</span>] = [<span class="string">&#x27;牛魔王&#x27;</span>, <span class="string">&#x27;红孩儿&#x27;</span>]  <span class="comment"># 使用新的元素替换旧元素</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;牛魔王&#x27;, &#x27;红孩儿&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line">stus[<span class="number">0</span>:<span class="number">2</span>] = [<span class="string">&#x27;牛魔王&#x27;</span>, <span class="string">&#x27;红孩儿&#x27;</span>, <span class="string">&#x27;二郎神&#x27;</span>, <span class="string">&quot;sda&quot;</span>]  <span class="comment"># 新元素的个数可以超过旧元素</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;牛魔王&#x27;, &#x27;红孩儿&#x27;, &#x27;二郎神&#x27;, &#x27;sda&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line">stus[<span class="number">0</span>:<span class="number">0</span>] = [<span class="string">&#x27;牛魔王&#x27;</span>]  <span class="comment"># 向索引为0的位置插入元素</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;牛魔王&#x27;, &#x27;牛魔王&#x27;, &#x27;红孩儿&#x27;, &#x27;二郎神&#x27;, &#x27;sda&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当设置了步长时，序列中元素的个数必须和切片中元素的个数一致</span></span><br><span class="line">print(stus[::<span class="number">2</span>])  <span class="comment"># [&#x27;牛魔王&#x27;, &#x27;红孩儿&#x27;, &#x27;sda&#x27;, &#x27;蜘蛛精&#x27;]，指定步长，切片中元素个数为4</span></span><br><span class="line"><span class="comment"># stus[::2] = [&#x27;牛魔王&#x27;, &#x27;红孩儿&#x27;, &#x27;二郎神&#x27;]  # 报错，序列中元素只有3个，ValueError: attempt to assign sequence of size 3 to extended slice of size 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过切片来删除元素</span></span><br><span class="line"><span class="keyword">del</span> stus[<span class="number">0</span>:<span class="number">2</span>]  <span class="comment"># 删除头两个元素</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;红孩儿&#x27;, &#x27;二郎神&#x27;, &#x27;sda&#x27;, &#x27;唐僧&#x27;, &#x27;蜘蛛精&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line"><span class="keyword">del</span> stus[::<span class="number">2</span>]  <span class="comment"># 隔一个删一个</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;二郎神&#x27;, &#x27;唐僧&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line">stus[<span class="number">1</span>:<span class="number">3</span>] = []  <span class="comment"># 修改位置1和2的元素为空</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;二郎神&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以上操作，只适用于可变序列</span></span><br><span class="line">s = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line"><span class="comment"># s[1] = &#x27;a&#x27;  # 不可变序列，无法通过索引来修改</span></span><br><span class="line"><span class="comment"># 可以通过list()函数将其他的序列转换为list</span></span><br><span class="line">s = <span class="built_in">list</span>(s)</span><br><span class="line">print(s)  <span class="comment"># [&#x27;h&#x27;, &#x27;e&#x27;, &#x27;l&#x27;, &#x27;l&#x27;, &#x27;o&#x27;]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表的方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">stus = [<span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;唐僧&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># append() </span></span><br><span class="line"><span class="comment"># 向列表的最后添加一个元素</span></span><br><span class="line">stus.append(<span class="string">&#x27;唐僧1&#x27;</span>)</span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;唐僧1&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># insert()</span></span><br><span class="line"><span class="comment"># 向列表的指定位置插入一个元素</span></span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line"><span class="comment">#   1.要插入的位置</span></span><br><span class="line"><span class="comment">#   2.要插入的元素</span></span><br><span class="line">stus.insert(<span class="number">2</span>, <span class="string">&#x27;唐僧2&#x27;</span>)</span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;唐僧2&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;唐僧1&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># extend()</span></span><br><span class="line"><span class="comment"># 使用新的序列来扩展当前序列</span></span><br><span class="line"><span class="comment"># 需要一个序列作为参数，它会将该序列中的元素添加到当前列表中</span></span><br><span class="line">stus.extend([<span class="string">&#x27;唐僧3&#x27;</span>, <span class="string">&#x27;白骨精&#x27;</span>])  <span class="comment"># 等同于：stus += [&#x27;唐僧3&#x27;,&#x27;白骨精&#x27;]</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;唐僧2&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;唐僧1&#x27;, &#x27;唐僧3&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pop()</span></span><br><span class="line"><span class="comment"># 根据索引删除并返回被删除的元素</span></span><br><span class="line">result = stus.pop(<span class="number">2</span>)</span><br><span class="line">print(result)  <span class="comment"># 唐僧2</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;唐僧1&#x27;, &#x27;唐僧3&#x27;, &#x27;白骨精&#x27;]</span></span><br><span class="line">result = stus.pop()  <span class="comment"># 删除最后一个元素</span></span><br><span class="line">print(result)  <span class="comment"># 白骨精</span></span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;唐僧1&#x27;, &#x27;唐僧3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># remove()</span></span><br><span class="line"><span class="comment"># 删除指定值的元素，如果相同值的元素有多个，只会删除第一个</span></span><br><span class="line">stus.remove(<span class="string">&#x27;猪八戒&#x27;</span>)</span><br><span class="line">print(stus)  <span class="comment"># [&#x27;孙悟空&#x27;, &#x27;沙和尚&#x27;, &#x27;唐僧&#x27;, &#x27;唐僧1&#x27;, &#x27;唐僧3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># reverse()</span></span><br><span class="line"><span class="comment"># 用来反转列表</span></span><br><span class="line">stus.reverse()</span><br><span class="line">print(stus)  <span class="comment"># [&#x27;唐僧3&#x27;, &#x27;唐僧1&#x27;, &#x27;唐僧&#x27;, &#x27;沙和尚&#x27;, &#x27;孙悟空&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clear()</span></span><br><span class="line"><span class="comment"># 清空序列</span></span><br><span class="line">stus.clear()</span><br><span class="line">print(stus)  <span class="comment"># []</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sort()</span></span><br><span class="line"><span class="comment"># 用来对列表中的元素进行排序，默认是升序排列</span></span><br><span class="line"><span class="comment"># 如果需要降序排列，则需要传递一个reverse=True作为参数</span></span><br><span class="line">my_list = <span class="built_in">list</span>(<span class="string">&#x27;asnbdnbasdabd&#x27;</span>)</span><br><span class="line">my_list.sort()</span><br><span class="line">print(my_list)  <span class="comment"># [&#x27;a&#x27;, &#x27;a&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;b&#x27;, &#x27;b&#x27;, &#x27;d&#x27;, &#x27;d&#x27;, &#x27;d&#x27;, &#x27;n&#x27;, &#x27;n&#x27;, &#x27;s&#x27;, &#x27;s&#x27;]</span></span><br><span class="line"></span><br><span class="line">my_list = [<span class="number">10</span>, <span class="number">1</span>, <span class="number">20</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">-2</span>]</span><br><span class="line">my_list.sort()</span><br><span class="line">print(my_list)  <span class="comment"># 升序：[-2, 0, 1, 3, 4, 5, 10, 20]</span></span><br><span class="line">my_list.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">print(my_list)  <span class="comment"># 降序：[20, 10, 5, 4, 3, 1, 0, -2]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表的遍历</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 遍历列表，指的就是将列表中的所有元素取出来</span></span><br><span class="line"><span class="comment"># 创建列表</span></span><br><span class="line">stus = [<span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;唐僧&#x27;</span>, <span class="string">&#x27;白骨精&#x27;</span>, <span class="string">&#x27;蜘蛛精&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历列表</span></span><br><span class="line"><span class="comment"># print(stus[0])</span></span><br><span class="line"><span class="comment"># print(stus[1])</span></span><br><span class="line"><span class="comment"># print(stus[2])</span></span><br><span class="line"><span class="comment"># print(stus[3])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过while循环来遍历列表</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(stus):</span><br><span class="line">    print(stus[i])</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过for循环来遍历列表</span></span><br><span class="line"><span class="comment"># 语法：</span></span><br><span class="line"><span class="comment">#   for 变量 in 序列 :</span></span><br><span class="line"><span class="comment">#       代码块</span></span><br><span class="line"><span class="comment"># for循环的代码块会执行多次，序列中有几个元素就会执行几次</span></span><br><span class="line"><span class="comment">#   每执行一次就会将序列中的一个元素赋值给变量，</span></span><br><span class="line"><span class="comment">#   所以我们可以通过变量，来获取列表中的元素</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> stus:</span><br><span class="line">    print(s)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="元组（tuple）"><a href="#元组（tuple）" class="headerlink" title="元组（tuple）"></a>元组（tuple）</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">my_tuple = ()  <span class="comment"># 创建了一个空元组</span></span><br><span class="line">print(my_tuple, <span class="built_in">type</span>(my_tuple))  <span class="comment"># () &lt;class &#x27;tuple&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">my_tuple = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)  <span class="comment"># 创建了一个5个元素的元组</span></span><br><span class="line"><span class="comment"># 元组是不可变对象，不能尝试为元组中的元素重新赋值</span></span><br><span class="line"><span class="comment"># my_tuple[3] = 10  # TypeError: &#x27;tuple&#x27; object does not support item assignment</span></span><br><span class="line"><span class="comment"># print(my_tuple[3])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当元组不是空元组时，括号可以省略</span></span><br><span class="line"><span class="comment"># 如果元组不是空元组，它里边至少要有一个,</span></span><br><span class="line">my_tuple = <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span></span><br><span class="line">print(my_tuple, <span class="built_in">type</span>(my_tuple))  <span class="comment"># (10, 20, 30, 40) &lt;class &#x27;tuple&#x27;&gt;</span></span><br><span class="line">my_tuple = <span class="number">40</span>,</span><br><span class="line">print(my_tuple, <span class="built_in">type</span>(my_tuple))  <span class="comment"># (40,) &lt;class &#x27;tuple&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">my_tuple = <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 元组的解包（解构）</span></span><br><span class="line"><span class="comment"># 解包指的是将元组当中每一个元素都赋值给一个变量</span></span><br><span class="line">a, b, c, d = my_tuple</span><br><span class="line">print(<span class="string">&quot;a =&quot;</span>, a)  <span class="comment"># a = 10</span></span><br><span class="line">print(<span class="string">&quot;b =&quot;</span>, b)  <span class="comment"># b = 20</span></span><br><span class="line">print(<span class="string">&quot;c =&quot;</span>, c)  <span class="comment"># c = 30</span></span><br><span class="line">print(<span class="string">&quot;d =&quot;</span>, d)  <span class="comment"># d = 40</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用元组的解包特性，可以直接交换a和b的值</span></span><br><span class="line">a = <span class="number">100</span></span><br><span class="line">b = <span class="number">300</span></span><br><span class="line">a, b = b, a  <span class="comment"># b, a 就是一个元组，通过解包赋值给 a, b</span></span><br><span class="line">print(a, b)  <span class="comment"># 300 100</span></span><br><span class="line"></span><br><span class="line">my_tuple = <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在对一个元组进行解包时，变量的数量必须和元组中的元素的数量一致</span></span><br><span class="line"><span class="comment"># 也可以在变量前边添加一个*，这样变量将会获取元组中所有剩余的元素</span></span><br><span class="line">a, b, *c = my_tuple</span><br><span class="line">a, *b, c = my_tuple</span><br><span class="line">*a, b, c = my_tuple</span><br><span class="line">a, b, *c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]  <span class="comment"># 对列表也可以解包</span></span><br><span class="line">a, b, *c = <span class="string">&#x27;hello world&#x27;</span>  <span class="comment"># 对字符串也可以解包</span></span><br><span class="line"><span class="comment"># 不能同时出现两个或以上的*变量</span></span><br><span class="line"><span class="comment"># *a, *b, c = my_tuple  # SyntaxError: two starred expressions in assignment</span></span><br><span class="line">print(<span class="string">&#x27;a =&#x27;</span>, a)  <span class="comment"># a = h</span></span><br><span class="line">print(<span class="string">&#x27;b =&#x27;</span>, b)  <span class="comment"># b = e</span></span><br><span class="line">print(<span class="string">&#x27;c =&#x27;</span>, c)  <span class="comment"># c = [&#x27;l&#x27;, &#x27;l&#x27;, &#x27;o&#x27;, &#x27; &#x27;, &#x27;w&#x27;, &#x27;o&#x27;, &#x27;r&#x27;, &#x27;l&#x27;, &#x27;d&#x27;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>元组是一个不可变的序列，它的操作的方式基本上和列表是一致的。在操作元组时，可以把元组当成是一个不可变的列表。</li>
<li>一般当我们希望数据不改变时，就使用元组，其余情况都使用列表。</li>
<li>使用 <code>()</code> 来创建元组。</li>
<li>元组是不可变对象，不能尝试为元组中的元素重新赋值。</li>
<li>当元组不是空元组时，括号可以省略。如果元组不是空元组，它里边至少要有一个 <code>,</code>。</li>
<li>元组的解包（解构）：指的是将元组当中每一个元素都赋值给一个变量。利用元组的解包特性，可以直接交换 a 和 b 的值。说明：不光是元组，列表和字符串都能解包。</li>
<li>在对一个元组进行解包时，变量的数量必须和元组中的元素的数量一致。也可以在变量前边添加一个 <code>*</code>，这样该变量将会获取元组中所有剩余的元素，但不能同时出现两个或以上的带 <code>*</code> 变量。</li>
</ul>
<h4 id="可变对象说明"><a href="#可变对象说明" class="headerlink" title="可变对象说明"></a>可变对象说明</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表是可变对象</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">print(<span class="string">&#x27;修改前：&#x27;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># 修改前： [1, 2, 3] 1322105181888</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过索引修改列表的值</span></span><br><span class="line">a[<span class="number">0</span>] = <span class="number">10</span></span><br><span class="line">print(<span class="string">&#x27;修改后：&#x27;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># 修改后： [10, 2, 3] 1322105181888</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为变量重新赋值</span></span><br><span class="line">a = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">print(<span class="string">&#x27;重新赋值：&#x27;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># 重新赋值： [4, 5, 6] 1322105180928</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = a  <span class="comment"># a和b指向同一个对象</span></span><br><span class="line">print(<span class="string">&quot;a&quot;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># a [1, 2, 3] 2222727763648</span></span><br><span class="line">print(<span class="string">&quot;b&quot;</span>, b, <span class="built_in">id</span>(b))  <span class="comment"># b [1, 2, 3] 2222727763648</span></span><br><span class="line">b[<span class="number">0</span>] = <span class="number">10</span></span><br><span class="line">print(<span class="string">&quot;a&quot;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># a [10, 2, 3] 2222727763648</span></span><br><span class="line">print(<span class="string">&quot;b&quot;</span>, b, <span class="built_in">id</span>(b))  <span class="comment"># b [10, 2, 3] 2222727763648</span></span><br><span class="line"></span><br><span class="line">b = [<span class="number">10</span>, <span class="number">2</span>, <span class="number">3</span>]  <span class="comment"># b和a指向的不再是同一个对象</span></span><br><span class="line">print(<span class="string">&quot;a&quot;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># a [10, 2, 3] 2222727763648</span></span><br><span class="line">print(<span class="string">&quot;b&quot;</span>, b, <span class="built_in">id</span>(b))  <span class="comment"># b [10, 2, 3] 2222727762688</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>每个对象中都保存了三个数据：id（标识），type（类型）和 value（值）。</p>
</li>
<li><p>列表就是一个可变对象，比如 <code>a = [1, 2, 3]</code>。</p>
</li>
<li><p><code>a[0] = 10</code>：改对象。</p>
<ul>
<li>这个操作是在通过变量去修改对象的值。</li>
<li>这种操作不会改变变量所指向的对象。</li>
<li>当我们去修改对象时，如果有其他变量也指向了该对象，则修改也会在其他的变量中体现。</li>
</ul>
</li>
<li><p><code>a = [4, 5, 6]</code>：改变量。</p>
<ul>
<li>这个操作是在给变量重新赋值。</li>
<li>这种操作会改变变量所指向的对象。</li>
<li>为一个变量重新赋值时，不会影响其他的变量。</li>
</ul>
</li>
<li><p>一般只有在为变量赋值时才是修改变量，其余的都是修改对象。</p>
</li>
</ul>
<h5 id="比较符"><a href="#比较符" class="headerlink" title="比较符"></a>比较符</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">print(a, b)  <span class="comment"># [1, 2, 3] [1, 2, 3]</span></span><br><span class="line">print(<span class="built_in">id</span>(a), <span class="built_in">id</span>(b))  <span class="comment"># 2081830016896 2081830015936</span></span><br><span class="line">print(a == b)  <span class="comment"># a和b的值相等，使用==会返回True</span></span><br><span class="line">print(a <span class="keyword">is</span> b)  <span class="comment"># a和b不是同一个对象，内存地址不同，使用is会返回False</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>==</code> 和 <code>!=</code> 比较的是对象的值是否相等。</li>
<li><code>is</code> 和 <code>is not</code> 比较的是对象的 id 是否相等（比较两个对象是否是同一个对象）。</li>
</ul>
<h3 id="字典（dict）"><a href="#字典（dict）" class="headerlink" title="字典（dict）"></a>字典（dict）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;&#125;  <span class="comment"># 创建了一个空字典</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个包含有数据的字典</span></span><br><span class="line">d = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孙悟空&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">print(d, <span class="built_in">type</span>(d))  <span class="comment"># &#123;&#x27;name&#x27;: &#x27;孙悟空&#x27;, &#x27;age&#x27;: 18, &#x27;gender&#x27;: &#x27;男&#x27;&#125; &lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据键来获取值</span></span><br><span class="line">print(d[<span class="string">&#x27;name&#x27;</span>], d[<span class="string">&#x27;age&#x27;</span>], d[<span class="string">&#x27;gender&#x27;</span>])  <span class="comment"># 孙悟空 18 男</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果使用了字典中不存在的键，会报错</span></span><br><span class="line"><span class="comment"># print(d[&#x27;hello&#x27;])  # KeyError: &#x27;hello&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>字典属于一种新的数据结构，称为映射（mapping）。</p>
</li>
<li><p>字典的作用和列表类似，都是用来存储对象的容器。</p>
</li>
<li><p>列表存储数据的性能很好，但是查询数据的性能的很差。</p>
</li>
<li><p>在字典中每一个元素都有一个唯一的名字，通过这个唯一的名字可以快速的查找到指定的元素。</p>
</li>
<li><p>在查询元素时，字典的效率是非常快的。</p>
</li>
<li><p>在字典中可以保存多个对象，每个对象都会有一个唯一的名字。</p>
<ul>
<li>这个唯一的名字，我们称其为键（key），通过 key 可以快速的查询 value。</li>
<li>这个对象，我们称其为值（value）。</li>
<li>所以字典，我们也称为键值对（key - value）结构。</li>
<li>每个字典中都可以有多个键值对，而每一个键值对我们称其为一项（item）。</li>
</ul>
</li>
<li><p>使用 <code>&#123;&#125;</code> 来创建字典。</p>
<ul>
<li>创建一个包含有数据的字典：<code>&#123;key: value, key: value, key: value&#125;</code>。</li>
<li>字典的键可以是任意的不可变对象（int、str、bool、tuple …），但是一般我们都会使用 str。</li>
<li>字典的值可以是任意对象。</li>
<li>字典的键是不能重复的，如果出现重复，后边的会替换前边的。</li>
</ul>
</li>
</ul>
<h4 id="字典的使用"><a href="#字典的使用" class="headerlink" title="字典的使用"></a>字典的使用</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建字典</span></span><br><span class="line"><span class="comment"># 方式一：使用&#123;&#125;</span></span><br><span class="line"><span class="comment"># 语法：&#123;k1: v1, k2: v2, k3: v3&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二：使用dict()函数来创建字典</span></span><br><span class="line"><span class="comment"># 每一个参数都是一个键值对，参数名就是键，参数名就是值（这种方式创建的字典，key都是字符串）</span></span><br><span class="line">d = <span class="built_in">dict</span>(name=<span class="string">&#x27;孙悟空&#x27;</span>, age=<span class="number">18</span>, gender=<span class="string">&#x27;男&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以将一个包含有双值子序列的序列转换为字典</span></span><br><span class="line"><span class="comment">#   双值序列：序列中只有两个值，比如[1, 2]，(&#x27;a&#x27;, 3)，&#x27;ab&#x27;</span></span><br><span class="line"><span class="comment">#   子序列：如果序列中的元素也是序列，那么我们就称这个元素为子序列，比如[(1, 2), (3, 5)]</span></span><br><span class="line">d = <span class="built_in">dict</span>([(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;孙悟空&#x27;</span>), (<span class="string">&#x27;age&#x27;</span>, <span class="number">18</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################################</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">dict</span>(name=<span class="string">&#x27;孙悟空&#x27;</span>, age=<span class="number">18</span>, gender=<span class="string">&#x27;男&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># len()获取字典中键值对的个数</span></span><br><span class="line">print(<span class="built_in">len</span>(d))  <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># in 检查字典中是否包含指定的键</span></span><br><span class="line"><span class="comment"># not in 检查字典中是否不包含指定的键</span></span><br><span class="line">print(<span class="string">&#x27;hello&#x27;</span> <span class="keyword">in</span> d)  <span class="comment"># False</span></span><br><span class="line">print(<span class="string">&#x27;age&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> d)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取字典中的值，根据键来获取值</span></span><br><span class="line"><span class="comment"># 方式一：语法：d[key]</span></span><br><span class="line"><span class="comment">#   通过[]来获取值时，如果键不存在，会抛出异常KeyError</span></span><br><span class="line">print(d[<span class="string">&#x27;age&#x27;</span>])  <span class="comment"># 18</span></span><br><span class="line">n = <span class="string">&#x27;name&#x27;</span></span><br><span class="line">print(d[n])  <span class="comment"># 孙悟空</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二：get(key[, default]) 该方法用来根据键来获取字典中的值</span></span><br><span class="line"><span class="comment">#   如果获取的键在字典中不存在，会返回None，不会报错</span></span><br><span class="line"><span class="comment">#   也可以指定一个默认值，来作为第二个参数，这样获取不到值时将会返回默认值</span></span><br><span class="line">print(d.get(<span class="string">&#x27;name&#x27;</span>))  <span class="comment"># 孙悟空</span></span><br><span class="line">print(d.get(<span class="string">&#x27;hello&#x27;</span>))  <span class="comment"># None</span></span><br><span class="line">print(d.get(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;默认值&#x27;</span>))  <span class="comment"># 默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改字典</span></span><br><span class="line"><span class="comment"># d[key] = value 如果key存在则覆盖，不存在则添加</span></span><br><span class="line">d[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;sunwukong&#x27;</span>  <span class="comment"># 修改字典的key-value</span></span><br><span class="line">d[<span class="string">&#x27;address&#x27;</span>] = <span class="string">&#x27;花果山&#x27;</span>  <span class="comment"># 向字典中添加key-value</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># setdefault(key[, default]) 可以用来向字典中添加key-value</span></span><br><span class="line"><span class="comment">#   如果key已经存在于字典中，则返回key的值，不会对字典做任何操作</span></span><br><span class="line"><span class="comment">#   如果key不存在，则向字典中添加这个key，并设置value</span></span><br><span class="line">result = d.setdefault(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;result =&#x27;</span>, result)  <span class="comment"># result = sunwukong</span></span><br><span class="line">result = d.setdefault(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>)</span><br><span class="line">print(d)  <span class="comment"># &#123;&#x27;name&#x27;: &#x27;sunwukong&#x27;, &#x27;age&#x27;: 18, &#x27;gender&#x27;: &#x27;男&#x27;, &#x27;address&#x27;: &#x27;花果山&#x27;, &#x27;hello&#x27;: &#x27;猪八戒&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># update([other])</span></span><br><span class="line"><span class="comment">#   将其他的字典中的key-value添加到当前字典中</span></span><br><span class="line"><span class="comment">#   如果有重复的key，则后边的会替换到当前的</span></span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line">d2 = &#123;<span class="string">&#x27;d&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;e&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">6</span>, <span class="string">&#x27;a&#x27;</span>: <span class="number">7</span>&#125;</span><br><span class="line">d.update(d2)</span><br><span class="line">print(d)  <span class="comment"># &#123;&#x27;a&#x27;: 7, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3, &#x27;d&#x27;: 4, &#x27;e&#x27;: 5, &#x27;f&#x27;: 6&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除，可以使用del来删除字典中的key-value</span></span><br><span class="line"><span class="keyword">del</span> d[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> d[<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line">print(d)  <span class="comment"># &#123;&#x27;c&#x27;: 3, &#x27;d&#x27;: 4, &#x27;e&#x27;: 5, &#x27;f&#x27;: 6&#125;</span></span><br><span class="line"><span class="comment"># del d[&#x27;z&#x27;]  # z不存在，报错，KeyError: &#x27;z&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># popitem()</span></span><br><span class="line"><span class="comment"># 随机删除字典中的一个键值对，一般都会删除最后一个键值对</span></span><br><span class="line"><span class="comment">#   删除之后，它会将删除的key-value作为返回值返回</span></span><br><span class="line"><span class="comment">#   返回的是一个元组，元组中有两个元素，第一个元素是删除的key，第二个是删除的value</span></span><br><span class="line"><span class="comment">#   当使用popitem()删除一个空字典时，会抛出异常 KeyError: &#x27;popitem(): dictionary is empty&#x27;</span></span><br><span class="line"><span class="comment"># d.popitem()</span></span><br><span class="line">result = d.popitem()</span><br><span class="line">print(result)  <span class="comment"># (&#x27;f&#x27;, 6)</span></span><br><span class="line">print(d)  <span class="comment"># &#123;&#x27;c&#x27;: 3, &#x27;d&#x27;: 4, &#x27;e&#x27;: 5&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pop(key[, default])</span></span><br><span class="line"><span class="comment"># 根据key删除字典中的key-value</span></span><br><span class="line"><span class="comment">#   会将被删除的value返回！</span></span><br><span class="line"><span class="comment">#   如果删除不存在的key，会抛出异常</span></span><br><span class="line"><span class="comment">#   如果指定了默认值，再删除不存在的key时，不会报错，而是直接返回默认值</span></span><br><span class="line">result = d.pop(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">print(result)  <span class="comment"># 4</span></span><br><span class="line">print(d)  <span class="comment"># &#123;&#x27;c&#x27;: 3, &#x27;e&#x27;: 5&#125;</span></span><br><span class="line">result = d.pop(<span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;这是默认值&#x27;</span>)</span><br><span class="line">print(result)  <span class="comment"># 这是默认值</span></span><br><span class="line">print(d)  <span class="comment"># &#123;&#x27;c&#x27;: 3, &#x27;e&#x27;: 5&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clear()用来清空字典</span></span><br><span class="line">d.clear()</span><br><span class="line">print(d)  <span class="comment"># &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;result =&#x27;,result)</span></span><br><span class="line"><span class="comment"># print(d)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># copy()</span></span><br><span class="line"><span class="comment"># 该方法用于对字典进行浅复制</span></span><br><span class="line"><span class="comment">#   复制以后的对象，和原对象是独立的，修改一个不会影响另一个</span></span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line">d2 = d.copy()  <span class="comment"># d和d2指向的是两个对象，这两个对象的值相同，id不同</span></span><br><span class="line">print(<span class="string">&#x27;d = &#x27;</span>, d, <span class="built_in">id</span>(d))  <span class="comment"># d =  &#123;&#x27;a&#x27;: 1, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 1507616638400</span></span><br><span class="line">print(<span class="string">&#x27;d2 = &#x27;</span>, d2, <span class="built_in">id</span>(d2))  <span class="comment"># d2 =  &#123;&#x27;a&#x27;: 1, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 1507616638464</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意，浅复制会简单复制对象内部的值，如果值也是一个可变对象，这个可变对象不会被复制</span></span><br><span class="line"><span class="comment"># 深复制性能差，使用较少</span></span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>&#125;, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line">d2 = d.copy()</span><br><span class="line">print(<span class="string">&#x27;d = &#x27;</span>, d, <span class="built_in">id</span>(d))  <span class="comment"># d =  &#123;&#x27;a&#x27;: &#123;&#x27;name&#x27;: &#x27;孙悟空&#x27;, &#x27;age&#x27;: 18&#125;, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2538203734848</span></span><br><span class="line">print(<span class="string">&#x27;d2 = &#x27;</span>, d2, <span class="built_in">id</span>(d2))  <span class="comment"># d2 =  &#123;&#x27;a&#x27;: &#123;&#x27;name&#x27;: &#x27;孙悟空&#x27;, &#x27;age&#x27;: 18&#125;, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2538210096768</span></span><br><span class="line"><span class="comment"># d的a值也是一个字典，修改d2中a值列表中name的值，d也会受到影响，说明浅复制不修改是可变对象的值</span></span><br><span class="line">d2[<span class="string">&#x27;a&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;猪八戒&#x27;</span></span><br><span class="line">print(<span class="string">&#x27;d = &#x27;</span>, d, <span class="built_in">id</span>(d))  <span class="comment"># d =  &#123;&#x27;a&#x27;: &#123;&#x27;name&#x27;: &#x27;猪八戒&#x27;, &#x27;age&#x27;: 18&#125;, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2538203734848</span></span><br><span class="line">print(<span class="string">&#x27;d2 = &#x27;</span>, d2, <span class="built_in">id</span>(d2))  <span class="comment"># d2 =  &#123;&#x27;a&#x27;: &#123;&#x27;name&#x27;: &#x27;猪八戒&#x27;, &#x27;age&#x27;: 18&#125;, &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2538210096768</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># d的a值是一个列表</span></span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: [<span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;沙和尚&#x27;</span>], <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line">d2 = d.copy()</span><br><span class="line">print(<span class="string">&#x27;d = &#x27;</span>, d, <span class="built_in">id</span>(d))  <span class="comment"># d =  &#123;&#x27;a&#x27;: [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;], &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2053189928960</span></span><br><span class="line">print(<span class="string">&#x27;d2 = &#x27;</span>, d2, <span class="built_in">id</span>(d2))  <span class="comment"># d2 =  &#123;&#x27;a&#x27;: [&#x27;孙悟空&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;], &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2053187068736</span></span><br><span class="line">d2[<span class="string">&#x27;a&#x27;</span>][<span class="number">0</span>] = <span class="string">&#x27;唐僧&#x27;</span></span><br><span class="line">print(<span class="string">&#x27;d = &#x27;</span>, d, <span class="built_in">id</span>(d))  <span class="comment"># d =  &#123;&#x27;a&#x27;: [&#x27;唐僧&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;], &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2053189928960</span></span><br><span class="line">print(<span class="string">&#x27;d2 = &#x27;</span>, d2, <span class="built_in">id</span>(d2))  <span class="comment"># d2 =  &#123;&#x27;a&#x27;: [&#x27;唐僧&#x27;, &#x27;猪八戒&#x27;, &#x27;沙和尚&#x27;], &#x27;b&#x27;: 2, &#x27;c&#x27;: 3&#125; 2053187068736</span></span><br></pre></td></tr></table></figure>

<h4 id="字典的遍历"><a href="#字典的遍历" class="headerlink" title="字典的遍历"></a>字典的遍历</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;男&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式一：keys()</span></span><br><span class="line"><span class="comment">#   该方法会返回一个序列，序列中是字典中所有的键</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d.keys():</span><br><span class="line">    print(k, d[k])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二：values()</span></span><br><span class="line"><span class="comment">#   该方法会返回一个序列，序列中是字典中所有的值</span></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> d.values():</span><br><span class="line">    print(v)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式三：items()</span></span><br><span class="line"><span class="comment">#   该方法会返回字典中所有的项，它会返回一个序列，序列中是双值子序列</span></span><br><span class="line"><span class="comment">#   双值分别是，字典中的key和value</span></span><br><span class="line">print(d.items())  <span class="comment"># dict_items([(&#x27;name&#x27;, &#x27;孙悟空&#x27;), (&#x27;age&#x27;, 18), (&#x27;gender&#x27;, &#x27;男&#x27;)])</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> d.items(): <span class="comment"># 元组解包特性</span></span><br><span class="line">    print(k, <span class="string">&#x27;=&#x27;</span>, v)</span><br></pre></td></tr></table></figure>

<h3 id="集合（set）"><a href="#集合（set）" class="headerlink" title="集合（set）"></a>集合（set）</h3><ul>
<li>集合和列表非常相似。</li>
<li>不同点：<ul>
<li>集合中只能存储不可变对象。</li>
<li>集合中存储的对象是无序（不是按照元素的插入顺序保存）。</li>
<li>集合中不能出现重复的元素。</li>
</ul>
</li>
</ul>
<h4 id="集合的使用"><a href="#集合的使用" class="headerlink" title="集合的使用"></a>集合的使用</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 集合的创建</span></span><br><span class="line"><span class="comment"># 方式一：使用&#123;&#125;来创建集合</span></span><br><span class="line">s = &#123;<span class="number">10</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;</span><br><span class="line">print(s, <span class="built_in">type</span>(s))  <span class="comment"># &#123;1, 2, 3, 5, 10&#125; &lt;class &#x27;set&#x27;&gt;</span></span><br><span class="line"><span class="comment"># s = &#123;[1, 2, 3], [4, 6, 7]&#125;  # TypeError: unhashable type: &#x27;list&#x27;，集合中只能存储不可变对象</span></span><br><span class="line"><span class="comment"># 方式二：使用set()函数来创建集合</span></span><br><span class="line">s = <span class="built_in">set</span>()  <span class="comment"># 空集合只能通过set()来创建，&#123;&#125;创建的是字典</span></span><br><span class="line"><span class="comment"># 可以通过set()来将序列和字典转换为集合</span></span><br><span class="line">s = <span class="built_in">set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])  <span class="comment"># 转换列表</span></span><br><span class="line">print(s)  <span class="comment"># &#123;1, 2, 3, 4, 5&#125;</span></span><br><span class="line">s = <span class="built_in">set</span>(<span class="string">&#x27;hello&#x27;</span>)  <span class="comment"># 转换字符串</span></span><br><span class="line">print(s)  <span class="comment"># &#123;&#x27;e&#x27;, &#x27;h&#x27;, &#x27;o&#x27;, &#x27;l&#x27;&#125;</span></span><br><span class="line">s = <span class="built_in">set</span>(&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;)  <span class="comment"># 转换字典，使用set()将字典转换为集合时，只会包含字典中的键</span></span><br><span class="line">print(s)  <span class="comment"># &#123;&#x27;b&#x27;, &#x27;a&#x27;, &#x27;c&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################################</span></span><br><span class="line"></span><br><span class="line">s = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>&#125;</span><br><span class="line">print(s)  <span class="comment"># &#123;1, 2, 3, &#x27;a&#x27;, &#x27;b&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用in和not in来检查集合中的元素</span></span><br><span class="line">print(<span class="string">&#x27;a&#x27;</span> <span class="keyword">in</span> s)  <span class="comment"># True</span></span><br><span class="line">print(<span class="string">&#x27;b&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> s)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用len()来获取集合中元素的数量</span></span><br><span class="line">print(<span class="built_in">len</span>(s))  <span class="comment"># 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># add()向集合中添加元素</span></span><br><span class="line">s.add(<span class="number">10</span>)</span><br><span class="line">s.add(<span class="number">30</span>)</span><br><span class="line">s.add(<span class="number">1</span>)  <span class="comment"># 集合中已存在的元素，添加无效</span></span><br><span class="line">print(s)  <span class="comment"># &#123;1, 2, 3, &#x27;a&#x27;, 10, &#x27;b&#x27;, 30&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################################</span></span><br><span class="line">s = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># update()可以将一个集合中的元素添加到当前集合中</span></span><br><span class="line"><span class="comment"># update()也可以传递序列或字典作为参数，字典只会添加键倒集合中</span></span><br><span class="line">s2 = <span class="built_in">set</span>(<span class="string">&#x27;hello&#x27;</span>)  <span class="comment"># 集合</span></span><br><span class="line">s.update(s2)</span><br><span class="line">print(s)  <span class="comment"># &#123;&#x27;a&#x27;, 2, 3, 1, &#x27;h&#x27;, &#x27;o&#x27;, &#x27;l&#x27;, &#x27;e&#x27;, &#x27;b&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line">s = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">s.update((<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>))  <span class="comment"># 元组</span></span><br><span class="line">print(s)  <span class="comment"># &#123;&#x27;a&#x27;, 2, 3, 1, 40, 10, 50, 20, &#x27;b&#x27;, 30&#125;</span></span><br><span class="line"></span><br><span class="line">s = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">s.update(&#123;<span class="number">10</span>: <span class="string">&#x27;ab&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;bc&#x27;</span>, <span class="number">100</span>: <span class="string">&#x27;cd&#x27;</span>, <span class="number">1000</span>: <span class="string">&#x27;ef&#x27;</span>&#125;)  <span class="comment"># 字典</span></span><br><span class="line">print(s)  <span class="comment"># &#123;&#x27;a&#x27;, 2, 3, 1, 100, 1000, 10, 20, &#x27;b&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################################</span></span><br><span class="line">s = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;1, 2, 3, 100, 40, &#x27;o&#x27;, 10, 1000, &#x27;a&#x27;, &#x27;h&#x27;, &#x27;b&#x27;, &#x27;l&#x27;, 20, 50, &#x27;e&#x27;, 30&#125;</span></span><br><span class="line"><span class="comment"># pop()随机删除并返回一个集合中的元素</span></span><br><span class="line">result = s.pop()</span><br><span class="line">print(result)  <span class="comment"># 1</span></span><br><span class="line">print(s)  <span class="comment"># &#123;&#x27;a&#x27;, 3, 2, &#x27;b&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># remove()删除集合中的指定元素</span></span><br><span class="line">s.remove(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">print(s)  <span class="comment"># &#123;2, 3, &#x27;b&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clear()清空集合</span></span><br><span class="line">s.clear()</span><br><span class="line">print(s)  <span class="comment"># set()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># copy()对集合进行浅复制</span></span><br></pre></td></tr></table></figure>

<h4 id="集合的运算"><a href="#集合的运算" class="headerlink" title="集合的运算"></a>集合的运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在对集合做运算时，不会影响原来的集合，而是返回一个运算结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建两个集合</span></span><br><span class="line">s = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">s2 = &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># &amp; 交集运算</span></span><br><span class="line">result = s &amp; s2</span><br><span class="line">print(result)  <span class="comment"># &#123;3, 4, 5&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># | 并集运算</span></span><br><span class="line">result = s | s2</span><br><span class="line">print(result)  <span class="comment"># &#123;1, 2, 3, 4, 5, 6, 7&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># - 差集</span></span><br><span class="line">result = s - s2</span><br><span class="line">print(result)  <span class="comment"># &#123;1, 2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ^ 异或集，获取两个集合中只出现一次的元素</span></span><br><span class="line">result = s ^ s2</span><br><span class="line">print(result)  <span class="comment"># &#123;1, 2, 6, 7&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;= 检查一个集合是否是另一个集合的子集</span></span><br><span class="line"><span class="comment">#   如果a集合中的元素全部都在b集合中出现，那么a集合就是b集合的子集，b集合是a集合超集</span></span><br><span class="line">a = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">b = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">result = a &lt;= b</span><br><span class="line">print(result)  <span class="comment"># True</span></span><br><span class="line">result = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125; &lt;= &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">print(result)  <span class="comment"># True</span></span><br><span class="line">result = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125; &lt;= &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">print(result)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt; 检查一个集合是否是另一个集合的真子集</span></span><br><span class="line"><span class="comment">#   如果超集b中含有子集a中所有元素，并且b中还有a中没有的元素，则b就是a的真超集，a是b的真子集</span></span><br><span class="line">result = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125; &lt; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">print(result)  <span class="comment"># False</span></span><br><span class="line">result = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125; &lt; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">print(result)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &gt;= 检查一个集合是否是另一个的超集</span></span><br><span class="line">result = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125; &gt;= &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">print(result)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &gt; 检查一个集合是否是另一个的真超集</span></span><br><span class="line">result = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125; &gt; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">print(result)  <span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<h2 id="函数（function）"><a href="#函数（function）" class="headerlink" title="函数（function）"></a>函数（function）</h2><h3 id="函数简介"><a href="#函数简介" class="headerlink" title="函数简介"></a>函数简介</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;这是我的第一个函数！&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;今天天气真不错！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印fn</span></span><br><span class="line">print(fn)  <span class="comment"># &lt;function fn at 0x00000175FD0261F0&gt;</span></span><br><span class="line">print(<span class="built_in">type</span>(fn))  <span class="comment"># &lt;class &#x27;function&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fn是函数对象，fn()调用函数</span></span><br><span class="line"><span class="comment"># print是函数对象，print()调用函数</span></span><br><span class="line">fn()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数，可以用来求任意两个数的和</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span>():</span></span><br><span class="line">    a = <span class="number">123</span></span><br><span class="line">    b = <span class="number">456</span></span><br><span class="line">    print(a + b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">sum</span>()  <span class="comment"># 579</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数时指定形参</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    print(a, <span class="string">&quot;+&quot;</span>, b, <span class="string">&quot;=&quot;</span>, a + b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数时，来传递实参</span></span><br><span class="line">fn2(<span class="number">10</span>, <span class="number">20</span>)  <span class="comment"># 10 + 20 = 30</span></span><br><span class="line">fn2(<span class="number">123</span>, <span class="number">456</span>)  <span class="comment"># 123 + 456 = 579</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>函数也是一个对象，对象是内存中专门用来存储数据的一块区域。</p>
</li>
<li><p>函数可以用来保存一些可执行的代码，并且可以在需要时，对这些语句进行多次的调用。</p>
</li>
<li><p>创建函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> 函数名(<span class="params">[形参<span class="number">1</span>, 形参<span class="number">2</span>, ... 形参n]</span>):</span></span><br><span class="line">    代码块</span><br></pre></td></tr></table></figure>

<ul>
<li>函数名必须要符号标识符的规范（可以包含字母、数字、下划线，但是不能以数字开头）。</li>
<li>函数中保存的代码不会立即执行，需要调用函数代码才会执行。</li>
</ul>
</li>
<li><p>调用函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数对象()</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义函数一般都是要实现某种功能的。</p>
</li>
</ul>
<h3 id="函数的参数"><a href="#函数的参数" class="headerlink" title="函数的参数"></a>函数的参数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求任意三个数的乘积</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mul</span>(<span class="params">a, b, c</span>):</span></span><br><span class="line">    print(a * b * c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mul(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)  <span class="comment"># 6</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据不同的用户名显示不同的欢迎信息</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">welcome</span>(<span class="params">username</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;欢迎&#x27;</span>, username, <span class="string">&#x27;光临&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">welcome(<span class="string">&#x27;孙悟空&#x27;</span>)  <span class="comment"># 欢迎 孙悟空 光临</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在定义函数时，可以在函数名后的 <code>()</code> 中定义数量不等的形参，多个形参之间使用 <code>,</code> 隔开。</li>
<li>形参（形式参数），定义形参就相当于在函数内部声明了变量，但是并不赋值。</li>
<li>实参（实际参数）。</li>
<li>如果函数定义时，指定了形参，那么在调用函数时也必须传递实参， 实参将会赋值给对应的形参，简单来说，有几个形参就得传几个实参。</li>
</ul>
<h3 id="参数的传递方式"><a href="#参数的传递方式" class="headerlink" title="参数的传递方式"></a>参数的传递方式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义函数，并为形参指定默认值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">a=<span class="number">5</span>, b=<span class="number">10</span>, c=<span class="number">20</span></span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">fn(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fn()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 位置参数</span></span><br><span class="line">fn(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关键字参数</span></span><br><span class="line">fn(b=<span class="number">1</span>, c=<span class="number">2</span>, a=<span class="number">3</span>)</span><br><span class="line">print(<span class="string">&#x27;hello&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 位置参数和关键字参数混合使用</span></span><br><span class="line">fn(<span class="number">1</span>, c=<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>(<span class="params">a</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数在调用时，解析器不会检查实参的类型</span></span><br><span class="line"><span class="comment"># 实参可以传递任意类型的对象</span></span><br><span class="line">b = <span class="number">123</span></span><br><span class="line">fn2(b)  <span class="comment"># a = 123</span></span><br><span class="line">b = <span class="literal">True</span></span><br><span class="line">fn2(b)  <span class="comment"># a = True</span></span><br><span class="line">b = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">fn2(b)  <span class="comment"># a = hello</span></span><br><span class="line">b = <span class="literal">None</span></span><br><span class="line">fn2(b)  <span class="comment"># a = None</span></span><br><span class="line">b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">fn2(b)  <span class="comment"># a = [1, 2, 3]</span></span><br><span class="line">fn2(fn)  <span class="comment"># a = &lt;function fn at 0x0000025AB8B561F0&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类型不检查的缺陷，在传参时需要额外注意</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    print(a + b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># fn3(123, &quot;456&quot;)  # TypeError: unsupported operand type(s) for +: &#x27;int&#x27; and &#x27;str&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在函数中对形参进行重新赋值，不会影响其他的变量</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn4</span>(<span class="params">a</span>):</span></span><br><span class="line">    a = <span class="number">20</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># a = 20 140708519029120</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">10</span></span><br><span class="line">fn4(c)</span><br><span class="line">print(c)  <span class="comment"># 10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果形参指向的是一个对象，当我们通过形参去修改对象时，会影响到所有指向该对象的变量</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn5</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="comment"># a是一个列表，尝试修改列表中的元素</span></span><br><span class="line">    a[<span class="number">0</span>] = <span class="number">30</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a, <span class="built_in">id</span>(a))  <span class="comment"># a = [30, 2, 3] 2056358531968</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">fn5(c)</span><br><span class="line">print(<span class="string">&#x27;c =&#x27;</span>, c, <span class="built_in">id</span>(c))  <span class="comment"># c = [30, 2, 3] 2056358531968</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过浅复制，或者切片，实现不修改c本身</span></span><br><span class="line">fn4(c.copy())</span><br><span class="line">fn4(c[:])</span><br></pre></td></tr></table></figure>

<ul>
<li>定义形参时，可以为形参指定默认值。指定了默认值以后，如果用户传递了参数，则默认值没有任何作用；如果用户没有传递参数，则默认值就会生效。</li>
<li>位置参数：即将对应位置的实参复制给对应位置的形参。</li>
<li>关键字参数：可以不按照形参定义的顺序去传递，而直接根据参数名去传递参数。</li>
<li>位置参数和关键字参数可以混合使用，混合使用时，必须将位置参数写到前面。</li>
<li>函数在调用时，解析器不会检查实参的类型，实参可以传递任意类型的对象。</li>
<li>在函数中对形参进行重新赋值，不会影响其他的变量。</li>
<li>如果形参指向的是一个对象，当我们通过形参去修改对象时，会影响到所有指向该对象的变量。</li>
</ul>
<h3 id="不定长的参数"><a href="#不定长的参数" class="headerlink" title="不定长的参数"></a>不定长的参数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个函数，可以求任意个数字的和</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span>(<span class="params">*nums</span>):</span></span><br><span class="line">    <span class="comment"># 定义一个变量，来保存结果</span></span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 遍历元组，并将元组中的数进行累加</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">        result += n</span><br><span class="line">    print(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">sum</span>(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>)  <span class="comment"># 100</span></span><br><span class="line"><span class="built_in">sum</span>(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>, <span class="number">70</span>)  <span class="comment"># 280</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *a会接受所有的位置实参，并且会将这些实参统一保存到一个元组中（装包）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">*a</span>):</span></span><br><span class="line">    print(<span class="string">&quot;a =&quot;</span>, a, <span class="built_in">type</span>(a))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)  <span class="comment"># a = (1, 2, 3) &lt;class &#x27;tuple&#x27;&gt;</span></span><br><span class="line">fn(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)  <span class="comment"># a = (1, 2, 3, 4, 5) &lt;class &#x27;tuple&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 带星号的形参只能有一个</span></span><br><span class="line"><span class="comment"># 带星号的参数，可以和其他参数配合使用</span></span><br><span class="line"><span class="comment"># 下面的函数，第一个参数给a，第二个参数给b，剩下的都保存到c的元组中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>(<span class="params">a, b, *c</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn2(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可变参数不是必须写在最后，但是注意，带*的参数后的所有参数，必须以关键字参数的形式传递</span></span><br><span class="line"><span class="comment"># 下面的函数，第一个参数给a，剩下的位置参数给b的元组，c必须使用关键字参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>(<span class="params">a, *b, c</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn3(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, c=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面的函数，所有的位置参数都给a，b和c必须使用关键字参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn4</span>(<span class="params">*a, b, c</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn4(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, b=<span class="number">4</span>, c=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果在形参的开头直接写一个*，则要求我们的所有的参数必须以关键字参数的形式传递</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn5</span>(<span class="params">*, a, b, c</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn5(a=<span class="number">3</span>, b=<span class="number">4</span>, c=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># *形参只能接收位置参数，而不能接收关键字参数</span></span><br><span class="line"><span class="comment"># def fn3(*a) :</span></span><br><span class="line"><span class="comment">#     print(&#x27;a =&#x27;,a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># **形参可以接收其他的关键字参数，它会将这些参数统一保存到一个字典中</span></span><br><span class="line"><span class="comment">#   字典的key就是参数的名字，字典的value就是参数的值</span></span><br><span class="line"><span class="comment"># **形参只能有一个，并且必须写在所有参数的最后</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn6</span>(<span class="params">b, c, **a</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a, <span class="built_in">type</span>(a))</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn6(b=<span class="number">1</span>, c=<span class="number">2</span>, h=<span class="number">3</span>, e=<span class="number">10</span>, f=<span class="number">20</span>)</span><br><span class="line">fn6(<span class="number">6</span>, <span class="number">7</span>, g=<span class="number">1</span>, d=<span class="number">2</span>, h=<span class="number">3</span>, e=<span class="number">10</span>, f=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;##########################################################&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数的解包（拆包）</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn7</span>(<span class="params">a, b, c</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line">    print(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 传递实参时，也可以在序列类型的参数前添加星号，这样他会自动将序列中的元素依次作为参数传递给函数</span></span><br><span class="line"><span class="comment"># 这里要求序列中元素的个数必须和形参的个数的一致</span></span><br><span class="line">t = (<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br><span class="line">fn7(*t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 **来对一个字典进行解包操作</span></span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">100</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">300</span>&#125;</span><br><span class="line">fn7(**d)</span><br></pre></td></tr></table></figure>

<ul>
<li>在定义函数时，可以在形参前边加上一个 <code>*</code>，这样这个形参将会获取到所有的实参，并将所有的实参保存到一个元组中。</li>
<li>带 <code>*</code> 的形参只能有一个。</li>
<li>带 <code>*</code> 的参数，可以和其他参数配合使用。</li>
<li>可变参数不是必须写在最后，但是注意，带 <code>*</code> 的参数后的所有参数，必须以关键字参数的形式传递，否则报错。</li>
<li>如果在形参的开头直接写一个 <code>*</code>，则要求所有的参数必须以关键字参数的形式传递。</li>
<li><code>*</code> 形参只能接收位置参数，而不能接收关键字参数。</li>
<li><code>**</code> 形参可以接收其他的关键字参数，它会将这些参数统一保存到一个字典中。字典的 key 就是参数的名字，字典的 value 就是参数的值。</li>
<li><code>**</code> 形参只能有一个，并且必须写在所有参数的最后。</li>
<li>传递实参时，也可以在序列类型的参数前添加 <code>*</code>，这样会自动将序列中的元素依次作为参数传递给函数，但要求序列中元素的个数必须和形参的个数一致。</li>
<li>如果是字典，通过 <code>**</code> 来进行解包操作。</li>
</ul>
<h3 id="函数的返回值"><a href="#函数的返回值" class="headerlink" title="函数的返回值"></a>函数的返回值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># return 后边跟什么值，函数就会返回什么值</span></span><br><span class="line"><span class="comment"># return 后边可以跟任意的对象，返回值甚至可以是一个函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    <span class="comment"># return &#x27;Hello&#x27;</span></span><br><span class="line">    <span class="comment"># return [1, 2, 3]</span></span><br><span class="line">    <span class="comment"># return &#123;&#x27;k&#x27;: &#x27;v&#x27;&#125;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn1</span>():</span></span><br><span class="line">        print(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fn1  <span class="comment"># 返回值也可以是一个函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = fn()  <span class="comment"># 这个函数的执行结果就是它的返回值</span></span><br><span class="line">print(r)  <span class="comment"># &lt;function fn.&lt;locals&gt;.fn1 at 0x000001F3430BCF70&gt;</span></span><br><span class="line">r()  <span class="comment"># hello</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果仅仅写一个return或者不写return，则相当于return None</span></span><br><span class="line"><span class="comment"># 在函数中，return后的代码都不会执行，return一旦执行函数自动结束</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>():</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    print(<span class="string">&#x27;abc&#x27;</span>)  <span class="comment"># 不会执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = fn2()</span><br><span class="line">print(r)  <span class="comment"># None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">3</span>:</span><br><span class="line">            <span class="comment"># break 用来退出当前循环</span></span><br><span class="line">            <span class="comment"># continue 用来跳过当次循环</span></span><br><span class="line">            <span class="keyword">return</span>  <span class="comment"># return 用来结束函数</span></span><br><span class="line">        print(i)</span><br><span class="line">    print(<span class="string">&#x27;循环执行完毕！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn3()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn4</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># fn4 和 fn4()的区别</span></span><br><span class="line">print(fn4)  <span class="comment"># fn4是函数对象，打印fn4实际是在打印函数对象：&lt;function fn5 at 0x00000229B3CFD670&gt;</span></span><br><span class="line">print(fn4())  <span class="comment"># fn4()是在调用函数，打印fn4()实际上是在打印fn4()函数的返回值：10</span></span><br></pre></td></tr></table></figure>

<ul>
<li>返回值就是函数执行以后返回的结果，可以通过 <code>return</code> 来指定函数的返回值。</li>
<li><code>return</code> 后边可以跟任意的对象，甚至可以是一个函数。<code>return</code> 后边跟什么值，函数就会返回什么值。</li>
<li>如果仅仅写一个 <code>return</code> 或者不写 <code>return</code>，则相当于 <code>return None</code>。</li>
<li>在函数中，<code>return</code> 后的代码都不会执行，<code>return</code> 一旦执行函数自动结束。</li>
</ul>
<h3 id="文档字符串"><a href="#文档字符串" class="headerlink" title="文档字符串"></a>文档字符串</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># help()是Python中的内置函数</span></span><br><span class="line"><span class="comment"># 通过help()函数可以查询python中的函数的用法</span></span><br><span class="line"><span class="comment"># 语法：help(函数对象)</span></span><br><span class="line"><span class="built_in">help</span>(<span class="built_in">print</span>)  <span class="comment"># 获取print()函数的使用说明</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文档字符串（doc str）</span></span><br><span class="line"><span class="comment"># 在定义函数时，可以在函数内部编写文档字符串，文档字符串就是函数的说明</span></span><br><span class="line"><span class="comment">#   当我们编写了文档字符串时，就可以通过help()函数来查看函数的说明</span></span><br><span class="line"><span class="comment">#   文档字符串非常简单，其实直接在函数的第一行写一个字符串就是文档字符串</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">a: <span class="built_in">int</span>, b: <span class="built_in">bool</span>, c: <span class="built_in">str</span> = <span class="string">&#x27;hello&#x27;</span></span>) -&gt; int:</span> <span class="comment"># 函数参数后跟着类型，返回值是一个int</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    这是一个文档字符串的示例</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    函数的作用：。。。。。。</span></span><br><span class="line"><span class="string">    函数的参数：</span></span><br><span class="line"><span class="string">        a，作用，类型，默认值。。。</span></span><br><span class="line"><span class="string">        b，作用，类型，默认值。。。</span></span><br><span class="line"><span class="string">        c，作用，类型，默认值。。。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">help</span>(fn)</span><br></pre></td></tr></table></figure>

<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 作用域（scope）</span></span><br><span class="line"><span class="comment"># 作用域指的是变量生效的区域</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">20</span>  <span class="comment"># 全局变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    a = <span class="number">10</span>  <span class="comment"># a定义在了函数内部，所以他的作用域就是函数内部，函数外部无法访问</span></span><br><span class="line">    print(<span class="string">&#x27;函数内部：&#x27;</span>, <span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line">    print(<span class="string">&#x27;函数内部：&#x27;</span>, <span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn()</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;函数外部：&#x27;, &#x27;a =&#x27;, a)  # NameError: name &#x27;a&#x27; is not defined</span></span><br><span class="line">print(<span class="string">&#x27;函数外部：&#x27;</span>, <span class="string">&#x27;b =&#x27;</span>, b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在Python中一共有两种作用域</span></span><br><span class="line"><span class="comment">#  全局作用域</span></span><br><span class="line"><span class="comment">#   - 全局作用域在程序执行时创建，在程序执行结束时销毁</span></span><br><span class="line"><span class="comment">#   - 所有函数以外的区域都是全局作用域</span></span><br><span class="line"><span class="comment">#   - 在全局作用域中定义的变量，都属于全局变量，全局变量可以在程序的任意位置被访问</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  函数作用域</span></span><br><span class="line"><span class="comment">#   - 函数作用域在函数调用时创建，在调用结束时销毁</span></span><br><span class="line"><span class="comment">#   - 函数每调用一次就会产生一个新的函数作用域</span></span><br><span class="line"><span class="comment">#   - 在函数作用域中定义的变量，都是局部变量，它只能在函数内部被访问</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  变量的查找</span></span><br><span class="line"><span class="comment">#   - 当我们使用变量时，会优先在当前作用域中寻找该变量，如果有则使用，</span></span><br><span class="line"><span class="comment">#       如果没有则继续去上一级作用域中寻找，如果有则使用，</span></span><br><span class="line"><span class="comment">#       如果依然没有则继续去上一级作用域中寻找，以此类推</span></span><br><span class="line"><span class="comment">#       直到找到全局作用域，依然没有找到，则会抛出异常</span></span><br><span class="line"><span class="comment">#           NameError: name &#x27;a&#x27; is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn1</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn2</span>():</span></span><br><span class="line">        print(<span class="string">&#x27;fn3中:&#x27;</span>, <span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line"></span><br><span class="line">    fn2()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># fn1() # fn1中的嵌套函数fn2，找不到a，报错NameError: name &#x27;a&#x27; is not defined</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>():</span></span><br><span class="line">    <span class="comment"># a = 10 # 在函数中为变量赋值时，默认都是为局部变量赋值</span></span><br><span class="line">    <span class="comment"># 如果希望在函数内部修改全局变量，则需要使用global关键字，来声明变量</span></span><br><span class="line">    <span class="keyword">global</span> a  <span class="comment"># 声明在函数内部的使用a是全局变量，此时再去修改a时，就是在修改全局的a</span></span><br><span class="line">    a = <span class="number">10</span>  <span class="comment"># 修改全局变量</span></span><br><span class="line">    print(<span class="string">&#x27;函数内部：&#x27;</span>, <span class="string">&#x27;a =&#x27;</span>, a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn3()</span><br><span class="line">print(<span class="string">&#x27;函数外部：&#x27;</span>, <span class="string">&#x27;a =&#x27;</span>, a)  <span class="comment"># 函数外部： a = 10</span></span><br></pre></td></tr></table></figure>

<h3 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命名空间（namespace）</span></span><br><span class="line"><span class="comment"># 命名空间指的是变量存储的位置，每一个变量都需要存储到指定的命名空间当中</span></span><br><span class="line"><span class="comment"># 每一个作用域都会有一个它对应的命名空间</span></span><br><span class="line"><span class="comment"># 全局命名空间，用来保存全局变量。函数命名空间用来保存函数中的变量</span></span><br><span class="line"><span class="comment"># 命名空间实际上就是一个字典，是一个专门用来存储变量的字典</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># locals()用来获取当前作用域的命名空间</span></span><br><span class="line"><span class="comment"># 如果在全局作用域中调用locals()则获取全局命名空间，如果在函数作用域中调用locals()则获取函数命名空间</span></span><br><span class="line"><span class="comment"># 返回的是一个字典</span></span><br><span class="line">scope = <span class="built_in">locals</span>()  <span class="comment"># 当前命名空间</span></span><br><span class="line">print(<span class="built_in">type</span>(scope))  <span class="comment"># &lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"><span class="comment"># 下面两个打印效果相同</span></span><br><span class="line">a = <span class="number">20</span></span><br><span class="line">print(a)  <span class="comment"># 20</span></span><br><span class="line">print(scope[<span class="string">&#x27;a&#x27;</span>])  <span class="comment"># 20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 向scope中添加一个key-value</span></span><br><span class="line"><span class="comment"># scope[&#x27;c&#x27;] = 1000  # 向字典中添加key-value就相当于在全局中创建了一个变量（一般不建议这么做）</span></span><br><span class="line"><span class="comment"># print(c)  # 1000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line">    scope = <span class="built_in">locals</span>()  <span class="comment"># 在函数内部调用locals()会获取到函数的命名空间</span></span><br><span class="line">    print(<span class="built_in">type</span>(scope))  <span class="comment"># &lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># scope[&#x27;b&#x27;] = 90  # 可以通过scope来操作函数的命名空间，但是也是不建议这么做</span></span><br><span class="line">    <span class="comment"># print(b)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># globals()函数可以用来在任意位置获取全局命名空间</span></span><br><span class="line">    <span class="comment"># 函数外面无法获得函数的命名空间</span></span><br><span class="line">    global_scope = <span class="built_in">globals</span>()</span><br><span class="line">    print(global_scope[<span class="string">&#x27;a&#x27;</span>])  <span class="comment"># 20</span></span><br><span class="line">    <span class="comment"># global_scope[&#x27;a&#x27;] = 30 # 不建议这么做</span></span><br><span class="line">    <span class="comment"># print(global_scope[&#x27;a&#x27;])  # 30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn()</span><br></pre></td></tr></table></figure>

<h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 10的阶乘</span></span><br><span class="line">n = <span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    n *= i</span><br><span class="line"></span><br><span class="line">print(n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个函数，可以用来求任意数的阶乘</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorial</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        该函数用来求任意数的阶乘</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            n 要求阶乘的数字</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个变量，来保存结果</span></span><br><span class="line">    result = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">        result *= i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(factorial(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归简单理解就是自己去引用自己！</span></span><br><span class="line"><span class="comment"># 递归式函数，在函数中自己调用自己！</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面这个是无穷递归，如果这个函数被调用，程序的内存会溢出，效果类似于死循环</span></span><br><span class="line"><span class="comment"># def fn():</span></span><br><span class="line"><span class="comment">#     fn()</span></span><br><span class="line"><span class="comment"># fn()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归是解决问题的一种方式，它和循环很像</span></span><br><span class="line"><span class="comment">#   它的整体思想是，将一个大问题分解为一个个的小问题，直到问题无法分解时，再去解决问题</span></span><br><span class="line"><span class="comment"># 递归式函数的两个要件</span></span><br><span class="line"><span class="comment">#   1.基线条件</span></span><br><span class="line"><span class="comment">#       - 问题可以被分解为的最小问题，当满足基线条件时，递归就不在执行了</span></span><br><span class="line"><span class="comment">#   2.递归条件</span></span><br><span class="line"><span class="comment">#       - 将问题继续分解的条件</span></span><br><span class="line"><span class="comment"># 递归和循环类似，基本是可以互相代替的，</span></span><br><span class="line"><span class="comment">#   循环编写起来比较容易，阅读起来稍难</span></span><br><span class="line"><span class="comment">#   递归编写起来难，但是方便阅读</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorial</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="comment"># 基线条件 判断n是否为1，如果为1则此时不能再继续递归</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 1的阶乘就是1，直接返回1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># 递归条件</span></span><br><span class="line">    <span class="keyword">return</span> n * factorial((n - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(factorial(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个函数power，来为任意数字做幂运算 n ** i</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">power</span>(<span class="params">n, i</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        power()用来为任意的数字做幂运算</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            n 要做幂运算的数字</span></span><br><span class="line"><span class="string">            i 做幂运算的次数</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 基线条件</span></span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 求1次幂</span></span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line">    <span class="comment"># 递归条件</span></span><br><span class="line">    <span class="keyword">return</span> n * power(n, i - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">pow</span>(<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个函数，用来检查一个任意的字符串是否是回文字符串，如果是返回True，否则返回False</span></span><br><span class="line"><span class="comment"># 回文字符串，字符串从前往后念和从后往前念是一样的</span></span><br><span class="line"><span class="comment"># abcba</span></span><br><span class="line"><span class="comment"># abcdefgfedcba</span></span><br><span class="line"><span class="comment"># 先检查第一个字符和最后一个字符是否一致，如果不一致则不是回文字符串</span></span><br><span class="line"><span class="comment">#     如果一致，则看剩余的部分是否是回文字符串</span></span><br><span class="line"><span class="comment"># 检查 abcdefgfedcba 是不是回文</span></span><br><span class="line"><span class="comment"># 检查 bcdefgfedcb 是不是回文</span></span><br><span class="line"><span class="comment"># 检查 cdefgfedc 是不是回文</span></span><br><span class="line"><span class="comment"># 检查 defgfed 是不是回文</span></span><br><span class="line"><span class="comment"># 检查 efgfe 是不是回文</span></span><br><span class="line"><span class="comment"># 检查 fgf 是不是回文</span></span><br><span class="line"><span class="comment"># 检查 g 是不是回文</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hui_wen</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        该函数用来检查指定的字符串是否回文字符串，如果是返回True，否则返回False</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            s：就是要检查的字符串</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 基线条件</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="comment"># 字符串的长度小于2，则字符串一定是回文</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">elif</span> s[<span class="number">0</span>] != s[<span class="number">-1</span>]:</span><br><span class="line">        <span class="comment"># 第一个字符和最后一个字符不相等，不是回文字符串</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># 递归条件</span></span><br><span class="line">    <span class="keyword">return</span> hui_wen(s[<span class="number">1</span>:<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># def hui_wen(s):</span></span><br><span class="line"><span class="comment">#     &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#         该函数用来检查指定的字符串是否回文字符串，如果是返回True，否则返回False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         参数：</span></span><br><span class="line"><span class="comment">#             s：就是要检查的字符串</span></span><br><span class="line"><span class="comment">#     &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#     # 基线条件</span></span><br><span class="line"><span class="comment">#     if len(s) &lt; 2 :</span></span><br><span class="line"><span class="comment">#         # 字符串的长度小于2，则字符串一定是回文</span></span><br><span class="line"><span class="comment">#         return True</span></span><br><span class="line"><span class="comment">#     # 递归条件</span></span><br><span class="line"><span class="comment">#     return s[0] == s[-1] and hui_wen(s[1:-1])</span></span><br><span class="line"></span><br><span class="line">print(hui_wen(<span class="string">&#x27;abba&#x27;</span>))</span><br><span class="line">print(hui_wen(<span class="string">&#x27;abcdefgfedcba&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 高阶函数</span></span><br><span class="line"><span class="comment">#   接收函数作为参数，或者将函数作为返回值的函数是高阶函数</span></span><br><span class="line"><span class="comment">#   当我们使用一个函数作为参数时，实际上是将指定的代码传递进了目标函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数，功能：可以将指定列表中的所有的偶数，保存到一个新的列表中返回</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 待提取列表</span></span><br><span class="line">l = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 常规写法</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">lst</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        fn()函数可以将指定列表中的所有偶数提取出来，并保存到一个新列表中返回</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            lst：指定的要筛选的列表</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    new_list = []</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> lst:</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            new_list.append(n)</span><br><span class="line">    <span class="keyword">return</span> new_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(fn(l))  <span class="comment"># [2, 4, 6, 8, 10]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 高阶函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能1：定义一个函数，用来检查一个任意的数字是否是偶数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn1</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能2：定义一个函数，用来检查指定的数字是否大于5</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能2：定义一个函数，用来检查一个任意的数字是否能被3整除</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">return</span> i % <span class="number">3</span> == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多功能的高阶函数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>(<span class="params">func, lst</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        fn()函数可以将指定列表中的数据按指定函数要求提取出来，并保存到一个新列表中返回</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            func：指定的提取要求</span></span><br><span class="line"><span class="string">            lst：指定的要筛选的列表</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    new_list = []</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> lst:</span><br><span class="line">        <span class="keyword">if</span> func(n):</span><br><span class="line">            new_list.append(n)</span><br><span class="line">    <span class="keyword">return</span> new_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(fn(fn1, l))  <span class="comment"># 获取偶数：[2, 4, 6, 8, 10]</span></span><br><span class="line">print(fn(fn2, l))  <span class="comment"># 获取大于5的数：[6, 7, 8, 9, 10]</span></span><br><span class="line">print(fn(fn3, l))  <span class="comment"># 获取能被3整除的数：[3, 6, 9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># filter()函数的功能，就如上面自定义的fn()函数</span></span><br><span class="line"><span class="comment"># filter()可以从序列中过滤出符合条件的元素，保存到一个新的序列中</span></span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line"><span class="comment">#  1.函数，根据该函数来过滤序列（可迭代的结构）</span></span><br><span class="line"><span class="comment">#  2.需要过滤的序列（可迭代的结构）</span></span><br><span class="line"><span class="comment"># 返回值：</span></span><br><span class="line"><span class="comment">#   过滤后的新序列（可迭代的结构）</span></span><br><span class="line"></span><br><span class="line">iterator = <span class="built_in">filter</span>(fn1, l)</span><br><span class="line"><span class="comment"># for n in iterator:</span></span><br><span class="line"><span class="comment">#     print(n)</span></span><br><span class="line">print(<span class="built_in">list</span>(iterator))  <span class="comment"># 返回的是一个可迭代的结构，需要转换成list才能直接打印出来数据</span></span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">filter</span>(fn2, l)))</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">filter</span>(fn3, l)))</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在 Python 中，函数是一等对象。一等对象一般都会具有如下特点：</p>
<ul>
<li>对象是在运行时创建的。</li>
<li>能赋值给变量或作为数据结构中的元素。</li>
<li>能作为参数传递。</li>
<li>能作为返回值返回。</li>
</ul>
</li>
<li><p>高阶函数至少要符合以下两个特点中的一个：</p>
<ul>
<li>能接收一个或多个函数作为参数。</li>
<li>能将函数作为返回值返回。</li>
</ul>
</li>
<li><p>当我们使用一个函数作为参数时，实际上是将指定的代码传递进了目标函数。</p>
</li>
</ul>
<h4 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h4><ul>
<li><p>匿名函数是将一个或多个函数作为参数来接收。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fn1~fn3是作为参数传递进filter()函数中</span></span><br><span class="line"><span class="comment">#   而fn1~fn3实际上只有一个作用，就是作为filter()的参数</span></span><br><span class="line"><span class="comment">#   filter()调用完毕以后，fn1~fn3就已经没用</span></span><br><span class="line"><span class="comment">#   这种情况可以用匿名函数简化</span></span><br><span class="line"><span class="comment"># 匿名函数lambda函数表达式（语法糖）</span></span><br><span class="line"><span class="comment">#   lambda函数表达式专门用来创建一些简单的函数，他是函数创建的又一种方式</span></span><br><span class="line"><span class="comment">#   语法：lambda 参数列表 : 返回值</span></span><br><span class="line"><span class="comment">#   匿名函数一般都是作为参数使用，其他地方一般不会使用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 待提取列表</span></span><br><span class="line">l = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 常规写法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn5</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(fn5(<span class="number">10</span>, <span class="number">20</span>))  <span class="comment"># 常规写法</span></span><br><span class="line">print((<span class="keyword">lambda</span> a, b: a + b)(<span class="number">10</span>, <span class="number">20</span>))  <span class="comment"># lambad表达式写法</span></span><br><span class="line">fn6 = <span class="keyword">lambda</span> a, b: a + b  <span class="comment"># 也可以将匿名函数赋值给一个变量，一般不会这么做</span></span><br><span class="line">print(fn6(<span class="number">10</span>, <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># filter()函数中可以很方便的使用lambda表达式</span></span><br><span class="line"><span class="comment">#   此时，lambda表达式只会使用一次，使用完后内存中自动回收</span></span><br><span class="line">r = <span class="built_in">filter</span>(<span class="keyword">lambda</span> i: i % <span class="number">2</span> == <span class="number">0</span>, l)</span><br><span class="line">print(<span class="built_in">list</span>(r))  <span class="comment"># [2, 4, 6, 8, 10]</span></span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> i: i &gt; <span class="number">5</span>, l)))  <span class="comment"># [6, 7, 8, 9, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># map()函数可以对可迭代对象中的所有元素做指定的操作，然后将其添加到一个新的对象中返回</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> i: i ** <span class="number">2</span>, l)))  <span class="comment"># 对列表中的每一个元素求平方，[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sort()函数用来对列表中的元素进行排序：</span></span><br><span class="line"><span class="comment">#   sotr()只能排序列表</span></span><br><span class="line"><span class="comment">#   默认是直接比较列表中的元素的大小</span></span><br><span class="line"><span class="comment"># 在sort()可以接收一个关键字参数key：</span></span><br><span class="line"><span class="comment">#   key需要一个函数作为参数，当设置了函数作为参数</span></span><br><span class="line"><span class="comment">#   每次都会以列表中的一个元素作为参数来调用该函数</span></span><br><span class="line"><span class="comment">#   并且使用函数的返回值来比较元素的大小</span></span><br><span class="line">l = [<span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;ddddddddd&#x27;</span>, <span class="string">&#x27;fff&#x27;</span>]</span><br><span class="line">l.sort()</span><br><span class="line">print(l)  <span class="comment"># 默认比较：[&#x27;aaaa&#x27;, &#x27;bb&#x27;, &#x27;c&#x27;, &#x27;ddddddddd&#x27;, &#x27;fff&#x27;]</span></span><br><span class="line"></span><br><span class="line">l = [<span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;ddddddddd&#x27;</span>, <span class="string">&#x27;fff&#x27;</span>]</span><br><span class="line">l.sort(key=<span class="built_in">len</span>)</span><br><span class="line">print(l)  <span class="comment"># 按长度比较：[&#x27;c&#x27;, &#x27;bb&#x27;, &#x27;fff&#x27;, &#x27;aaaa&#x27;, &#x27;ddddddddd&#x27;]</span></span><br><span class="line"></span><br><span class="line">l = [<span class="number">2</span>, <span class="number">5</span>, <span class="string">&#x27;1&#x27;</span>, <span class="number">3</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;4&#x27;</span>]</span><br><span class="line">l.sort(key=<span class="built_in">int</span>)</span><br><span class="line">print(l)  <span class="comment"># 把每一个元素转换成整形后再比较：[&#x27;1&#x27;, 2, 3, &#x27;4&#x27;, 5, &#x27;6&#x27;]</span></span><br><span class="line"></span><br><span class="line">l = [<span class="number">2</span>, <span class="number">5</span>, <span class="string">&#x27;1&#x27;</span>, <span class="number">3</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;4&#x27;</span>]</span><br><span class="line">l.sort(key=<span class="built_in">str</span>)</span><br><span class="line">print(l)  <span class="comment"># 把每一个元素转换成字符串后再比较：[&#x27;1&#x27;, 2, 3, &#x27;4&#x27;, 5, &#x27;6&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sorted()函数和sort()的用法基本一致，但是sorted()可以对任意的序列进行排序</span></span><br><span class="line"><span class="comment">#   并且使用sorted()排序不会影响原来的对象，而是返回一个新对象</span></span><br><span class="line"></span><br><span class="line">l = [<span class="number">2</span>, <span class="number">5</span>, <span class="string">&#x27;1&#x27;</span>, <span class="number">3</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;4&#x27;</span>]  <span class="comment"># 排序列表</span></span><br><span class="line">print(<span class="string">&#x27;排序前:&#x27;</span>, l)  <span class="comment"># 排序前: [2, 5, &#x27;1&#x27;, 3, &#x27;6&#x27;, &#x27;4&#x27;]</span></span><br><span class="line">print(<span class="string">&#x27;排序中:&#x27;</span>, <span class="built_in">sorted</span>(l, key=<span class="built_in">int</span>))  <span class="comment"># 排序中: [&#x27;1&#x27;, 2, 3, &#x27;4&#x27;, 5, &#x27;6&#x27;]</span></span><br><span class="line">print(<span class="string">&#x27;排序后:&#x27;</span>, l)  <span class="comment"># 排序后: [2, 5, &#x27;1&#x27;, 3, &#x27;6&#x27;, &#x27;4&#x27;]</span></span><br><span class="line"></span><br><span class="line">l = <span class="string">&#x27;123765816742634781&#x27;</span>  <span class="comment"># 排序字符串</span></span><br><span class="line">print(<span class="string">&#x27;排序前:&#x27;</span>, l)  <span class="comment"># 排序前: 123765816742634781</span></span><br><span class="line">print(<span class="string">&#x27;排序中:&#x27;</span>, <span class="built_in">sorted</span>(l,</span><br><span class="line">                     key=<span class="built_in">int</span>))  <span class="comment"># 排序中: [&#x27;1&#x27;, &#x27;1&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;6&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;7&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;8&#x27;]</span></span><br><span class="line">print(<span class="string">&#x27;排序后:&#x27;</span>, l)  <span class="comment"># 排序后: 123765816742634781</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><ul>
<li><p>闭包是将函数作为返回值返回。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将函数作为返回值返回，也是一种高阶函数</span></span><br><span class="line"><span class="comment"># 这种高阶函数我们也称为叫做闭包，通过闭包可以创建一些只有当前函数能访问的变量</span></span><br><span class="line"><span class="comment">#   可以将一些私有的数据藏到闭包中</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 函数内部再定义一个函数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        print(<span class="string">&#x27;我是fn2&#x27;</span>, a)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将内部函数 inner作为返回值返回</span></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># r是一个函数，是调用fn()后返回的函数</span></span><br><span class="line"><span class="comment"># 而且这个函数是在fn()内部定义，并不是全局函数</span></span><br><span class="line"><span class="comment"># 所以这个函数总是能访问到fn()函数内的变量</span></span><br><span class="line">r = fn()</span><br><span class="line">print(r)  <span class="comment"># &lt;function fn.&lt;locals&gt;.inner at 0x000001CEC1142430&gt;</span></span><br><span class="line">r()  <span class="comment"># 我是fn2 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求多个数的平均值</span></span><br><span class="line">nums = [<span class="number">50</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">77</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常规写法：sum()用来求一个列表中所有元素的和</span></span><br><span class="line">print(<span class="built_in">sum</span>(nums) / <span class="built_in">len</span>(nums))  <span class="comment"># 37.4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果nums中的数据是变化的，可以使用闭包</span></span><br><span class="line"><span class="comment"># 形成闭包的要件</span></span><br><span class="line"><span class="comment">#   ① 函数嵌套</span></span><br><span class="line"><span class="comment">#   ② 将内部函数作为返回值返回</span></span><br><span class="line"><span class="comment">#   ③ 内部函数必须要使用到外部函数的变量</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_averager</span>():</span></span><br><span class="line">    <span class="comment"># 创建一个列表，用来保存数值</span></span><br><span class="line">    nums = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个函数，用来计算平均值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">averager</span>(<span class="params">n</span>):</span></span><br><span class="line">        <span class="comment"># 将n添加到列表中</span></span><br><span class="line">        nums.append(n)</span><br><span class="line">        <span class="comment"># 求平均值</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(nums) / <span class="built_in">len</span>(nums)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> averager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数返回的是make_averager()中定义的averager()函数</span></span><br><span class="line"><span class="comment"># 并创建了一个nums列表，这个列表外界无法访问，只有averager对象可以访问</span></span><br><span class="line">averager = make_averager()</span><br><span class="line"></span><br><span class="line">print(averager(<span class="number">10</span>))  <span class="comment"># 10/1=10</span></span><br><span class="line">print(averager(<span class="number">20</span>))  <span class="comment"># (10+20)/2=15</span></span><br><span class="line">print(averager(<span class="number">30</span>))  <span class="comment"># (10+20+30)/3=20</span></span><br><span class="line">print(averager(<span class="number">40</span>))  <span class="comment"># (10+20+30+40)/4=25</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建几个函数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        求任意两个数的和</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    r = a + b</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mul</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        求任意两个数的积</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    r = a * b</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(add(<span class="number">123</span>, <span class="number">456</span>))  <span class="comment"># 579</span></span><br><span class="line">print(mul(<span class="number">10</span>, <span class="number">20</span>))  <span class="comment"># 200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 现在，希望函数可以在计算前，打印开始计算，计算结束后打印计算完毕</span></span><br><span class="line"><span class="comment">#  我们可以直接通过修改函数中的代码来完成这个需求，但是会产生以下一些问题</span></span><br><span class="line"><span class="comment">#   ① 如果要修改的函数过多，修改起来会比较麻烦</span></span><br><span class="line"><span class="comment">#   ② 并且不方便后期的维护</span></span><br><span class="line"><span class="comment">#   ③ 并且这样做会违反开闭原则（OCP）</span></span><br><span class="line"><span class="comment">#           程序的设计，要求开发对程序的扩展，要关闭对程序的修改</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们希望在不修改原函数的情况下，来对函数进行扩展</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;我是fn函数....&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只需要根据现有的函数，来创建一个新的函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;函数开始执行~~~&#x27;</span>)</span><br><span class="line">    fn()</span><br><span class="line">    print(<span class="string">&#x27;函数执行结束~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn2()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建新函数，扩展add()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_add</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;计算开始~~~&#x27;</span>)</span><br><span class="line">    r = add(a, b)</span><br><span class="line">    print(<span class="string">&#x27;计算结束~~~&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = new_add(<span class="number">111</span>, <span class="number">222</span>)</span><br><span class="line">print(r)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;##############################################################&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上边的方式，已经可以在不修改源代码的情况下对函数进行扩展了</span></span><br><span class="line"><span class="comment">#   但是，这种方式要求我们每扩展一个函数就要手动创建一个新的函数，实在是太麻烦了</span></span><br><span class="line"><span class="comment">#   为了解决这个问题，我们创建一个函数，让这个函数可以自动的帮助我们生产函数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">begin_end</span>(<span class="params">old</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        用来对其他函数进行扩展，使其他函数可以在执行前打印开始执行，执行后打印执行结束</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            old 要扩展的函数对象</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个新函数，参数的个数是不确定的，使用*和**</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new_function</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;开始执行~~~~&#x27;</span>)</span><br><span class="line">        <span class="comment"># 调用被扩展的函数</span></span><br><span class="line">        result = old(*args, **kwargs)</span><br><span class="line">        print(<span class="string">&#x27;执行结束~~~~&#x27;</span>)</span><br><span class="line">        <span class="comment"># 返回函数的执行结果</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回新函数</span></span><br><span class="line">    <span class="keyword">return</span> new_function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = begin_end(fn)  <span class="comment"># 包装fn()</span></span><br><span class="line">f2 = begin_end(add)  <span class="comment"># 包装add()</span></span><br><span class="line">f3 = begin_end(mul)  <span class="comment"># 包装mul()</span></span><br><span class="line"></span><br><span class="line">r = f()</span><br><span class="line">print(r)</span><br><span class="line">r = f2(<span class="number">123</span>, <span class="number">456</span>)</span><br><span class="line">print(r)</span><br><span class="line">r = f3(<span class="number">123</span>, <span class="number">456</span>)</span><br><span class="line">print(r)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;##############################################################&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 像begin_end()这种函数我们就称它为装饰器</span></span><br><span class="line"><span class="comment">#   通过装饰器，可以在不修改原来函数的情况下来对函数进行扩展</span></span><br><span class="line"><span class="comment">#   在开发中，我们都是通过装饰器来扩展函数的功能的</span></span><br><span class="line"><span class="comment"># 在定义函数时，可以通过@装饰器，来使用指定的装饰器，来装饰当前的函数</span></span><br><span class="line"><span class="comment">#   可以同时为一个函数指定多个装饰器，这样函数将会安装从内向外的顺序被装饰</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>(<span class="params">old</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        用来对其他函数进行扩展，使其他函数可以在执行前打印开始执行，执行后打印执行结束</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">            old 要扩展的函数对象</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个新函数</span></span><br><span class="line">    <span class="comment"># *args：old函数中的位置参数(形如：&#x27;a, b&#x27;)，全都存放其中</span></span><br><span class="line">    <span class="comment"># **kwargs：old函数中的字典参数(形如：&#x27;a=x, b=y&#x27;)，全部存放其中</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new_function</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;fn3装饰~开始执行~~~~&#x27;</span>)</span><br><span class="line">        <span class="comment"># 调用被扩展的函数</span></span><br><span class="line">        result = old(*args, **kwargs)</span><br><span class="line">        print(<span class="string">&#x27;fn3装饰~执行结束~~~~&#x27;</span>)</span><br><span class="line">        <span class="comment"># 返回函数的执行结果</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回新函数</span></span><br><span class="line">    <span class="keyword">return</span> new_function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@fn3  # 第一层：fn3装饰</span></span><br><span class="line"><span class="meta">@begin_end  # ：第二层：begin_end装饰</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say_hello</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;大家好~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">say_hello()</span><br></pre></td></tr></table></figure>

<h2 id="对象（object"><a href="#对象（object" class="headerlink" title="对象（object)"></a>对象（object)</h2><h3 id="什么是对象"><a href="#什么是对象" class="headerlink" title="什么是对象"></a>什么是对象</h3><ul>
<li>对象是内存中专门用来存储数据的一块区域。</li>
<li>对象中可以存放各种数据，比如：数字、布尔值、代码。</li>
<li>对象由三部分组成：<ul>
<li>对象的标识（id）</li>
<li>对象的类型（type）</li>
<li>对象的值（value）</li>
</ul>
</li>
</ul>
<h3 id="面向对象（oop）"><a href="#面向对象（oop）" class="headerlink" title="面向对象（oop）"></a>面向对象（oop）</h3><ul>
<li><p>Python 是一门面向对象的编程语言。</p>
</li>
<li><p>所谓的面向对象的语言，简单理解就是语言中的所有操作都是通过对象来进行的。</p>
</li>
<li><p>面向过程的编程的语言：</p>
<ul>
<li>面向过程指将我们的程序的逻辑分解为一个一个的步骤，通过对每个步骤的抽象，来完成程序。</li>
<li>例子：孩子上学，可能有以下过程。<ol>
<li>妈妈起床。</li>
<li>妈妈洗漱。</li>
<li>妈妈做早饭。</li>
<li>妈妈叫孩子起床。</li>
<li>孩子要洗漱。</li>
<li>孩子吃饭。</li>
<li>孩子背着书包上学校。</li>
</ol>
</li>
<li>面向过程的编程思想将一个功能分解为一个一个小的步骤，我们通过完成一个一个的小的步骤来完成一个程序。</li>
<li>这种编程方式，符合我们人类的思维，编写起来相对比较简单。</li>
<li>但是这种方式编写代码的往往只适用于一个功能，如果要在实现别的功能，即使功能相差极小，也往往要重新编写代码，所以它可复用性比较低，并且难于维护 。</li>
</ul>
</li>
<li><p>面向对象的编程语言：</p>
<ul>
<li>面向对象的编程语言，关注的是对象，而不关注过程。</li>
<li>对于面向对象的语言来说，一切都是对象。</li>
<li>面向对象的编程思想，将所有的功能统一保存到对应的对象中。比如，妈妈的功能保存到妈妈的对象中，孩子的功能保存到孩子对象中，要使用某个功能，直接找到对应的对象即可。</li>
<li>这种方式编写的代码，比较容易阅读，并且比较易于维护，容易复用。</li>
<li>但是这种方式编写，不太符合常规的思维，编写起来稍微麻烦一点。</li>
</ul>
</li>
<li><p>简单归纳一下，面向对象的思想：</p>
<ul>
<li>第一步：创建对象。</li>
<li>第二步：处理对象。</li>
</ul>
</li>
</ul>
<h3 id="类的简介"><a href="#类的简介" class="headerlink" title="类的简介"></a>类的简介</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">int</span>(<span class="number">10</span>)  <span class="comment"># 创建一个int类的实例</span></span><br><span class="line">b = <span class="built_in">str</span>(<span class="string">&#x27;hello&#x27;</span>)  <span class="comment"># 创建一个str类的实例</span></span><br><span class="line">print(a, <span class="built_in">type</span>(a))  <span class="comment"># 10 &lt;class &#x27;int&#x27;&gt;</span></span><br><span class="line">print(b, <span class="built_in">type</span>(b))  <span class="comment"># hello &lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个简单的类</span></span><br><span class="line"><span class="comment"># 使用class关键字来定义类，语法和函数很像！</span></span><br><span class="line"><span class="comment"># class 类名([父类]):</span></span><br><span class="line"><span class="comment">#   代码块</span></span><br><span class="line"><span class="comment"># &lt;class &#x27;__main__.MyClass&#x27;&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>():</span>  <span class="comment"># 如果没有父类，()可以省略</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(MyClass)  <span class="comment"># &lt;class &#x27;__main__.MyClass&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用MyClass创建一个对象</span></span><br><span class="line"><span class="comment"># 使用类来创建对象，就像调用一个函数一样</span></span><br><span class="line">mc = MyClass()  <span class="comment"># mc就是通过MyClass创建的对象，mc是MyClass的实例</span></span><br><span class="line">print(mc, <span class="built_in">type</span>(mc))  <span class="comment"># &lt;__main__.MyClass object at 0x000001B009813E50&gt; &lt;class &#x27;__main__.MyClass&#x27;&gt;</span></span><br><span class="line">mc_2 = MyClass()</span><br><span class="line">mc_3 = MyClass()</span><br><span class="line">mc_4 = MyClass()</span><br><span class="line"><span class="comment"># mc mc_2 mc_3 mc_4 都是MyClass的实例，他们都是一类对象</span></span><br><span class="line"><span class="comment"># isinstance()用来检查一个对象是否是一个类的实例</span></span><br><span class="line">result = <span class="built_in">isinstance</span>(mc_2, MyClass)</span><br><span class="line">print(result)  <span class="comment"># True</span></span><br><span class="line">result = <span class="built_in">isinstance</span>(mc_2, <span class="built_in">str</span>)</span><br><span class="line">print(result)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类是一个type类型的对象</span></span><br><span class="line">print(<span class="built_in">id</span>(MyClass), <span class="built_in">type</span>(MyClass))  <span class="comment"># 1560257906784 &lt;class &#x27;type&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 现在我们通过MyClass这个类创建的对象都是一个空对象</span></span><br><span class="line"><span class="comment"># 也就是对象中实际上什么都没有，就相当于是一个空的盒子</span></span><br><span class="line"><span class="comment"># 可以向对象中添加变量，对象中的变量称为属性</span></span><br><span class="line"><span class="comment"># 语法：对象.属性名 = 属性值</span></span><br><span class="line">mc.name = <span class="string">&#x27;孙悟空&#x27;</span></span><br><span class="line">print(mc.name)  <span class="comment"># 孙悟空</span></span><br><span class="line">mc_2.name = <span class="string">&#x27;猪八戒&#x27;</span></span><br><span class="line">print(mc_2.name)  <span class="comment"># 猪八戒</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>我们目前所学习的对象都是 Python 内置的对象。</p>
</li>
<li><p>但是内置对象并不能满足所有的需求，所以我们在开发中经常需要自定义一些对象。</p>
</li>
<li><p>类，简单理解它就相当于一个图纸。在程序中我们需要根据类来创建对象。</p>
</li>
<li><p>类就是对象的图纸！</p>
</li>
<li><p>我们也称对象是类的实例（instance）。</p>
</li>
<li><p>如果多个对象是通过一个类创建的，我们称这些对象是一类对象。</p>
</li>
<li><p>像 <code>int()</code>，<code>float()</code>，<code>bool()</code>，<code>str()</code>，<code>list()</code>，<code>dict()</code> 等，这些都是类。</p>
</li>
<li><p><code>a = int(10) # 创建一个int类的实例</code> 等价于 <code>a = 10</code>。</p>
</li>
<li><p>我们自定义的类都需要使用大写字母开头，使用大驼峰命名法（帕斯卡命名法）来对类命名。</p>
</li>
<li><p>类也是一个对象！</p>
</li>
<li><p>类就是一个用来创建对象的对象！</p>
</li>
<li><p>类是 type 类型的对象，定义类实际上就是定义了一个 type 类型的对象。</p>
</li>
<li><p>使用类创建对象的流程：</p>
<img src="/2021/09/06/python/image-20210926155702330.png" alt="image-20210926155702330" style="zoom:80%;">

<ul>
<li>第一步：创建一个变量。</li>
<li>第二步：在内存中创建一个新对象。</li>
<li>第三步：将对象的 id 赋值给变量。</li>
</ul>
</li>
</ul>
<h3 id="类的定义"><a href="#类的定义" class="headerlink" title="类的定义"></a>类的定义</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 尝试定义一个表示人的类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="comment"># 在类的代码块中，我们可以定义变量和函数</span></span><br><span class="line">    <span class="comment"># 在类中我们所定义的变量，将会成为所有的实例的公共属性</span></span><br><span class="line">    <span class="comment"># 所有实例都可以访问这些变量</span></span><br><span class="line">    name = <span class="string">&#x27;swk&#x27;</span>  <span class="comment"># 公共属性，所有实例都可以访问</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 在类中也可以定义函数，类中的定义的函数，我们称为方法</span></span><br><span class="line">    <span class="comment"># 这些方法可以通过该类的所有实例来访问</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 方法每次被调用时，解析器都会自动传递第一个实参</span></span><br><span class="line">        <span class="comment"># 第一个参数，就是调用方法的对象本身，</span></span><br><span class="line">        <span class="comment">#   如果是p1调的，则第一个参数就是p1对象</span></span><br><span class="line">        <span class="comment">#   如果是p2调的，则第一个参数就是p2对象</span></span><br><span class="line">        <span class="comment"># 一般我们都会将这个参数命名为self</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># say_hello()这个方法，可以显示如下格式的数据：</span></span><br><span class="line">        <span class="comment">#   你好！我是 xxx</span></span><br><span class="line">        <span class="comment">#   在方法中不能直接访问类中的属性</span></span><br><span class="line">        print(<span class="string">&#x27;你好！我是 %s&#x27;</span> % self.name) <span class="comment"># 类似Java中的this</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Person的实例</span></span><br><span class="line">p1 = Person()</span><br><span class="line">p2 = Person()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用属性：对象.属性名</span></span><br><span class="line">print(p1.name)  <span class="comment"># swk</span></span><br><span class="line">print(p2.name)  <span class="comment"># swk</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用方法：对象.方法名()</span></span><br><span class="line"><span class="comment"># 方法调用和函数调用的区别</span></span><br><span class="line"><span class="comment">#   如果是函数调用，则调用时传几个参数，就会有几个实参</span></span><br><span class="line"><span class="comment">#   但是如果是方法调用，默认传递一个参数，所以方法中至少要定义一个形参</span></span><br><span class="line">p1.say_hello()  <span class="comment"># 你好！我是 swk</span></span><br><span class="line">p2.say_hello()  <span class="comment"># 你好！我是 swk</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改p1的name属性</span></span><br><span class="line">p1.name = <span class="string">&#x27;猪八戒&#x27;</span></span><br><span class="line">p2.name = <span class="string">&#x27;沙和尚&#x27;</span></span><br><span class="line">print(p1.name)</span><br><span class="line">print(p2.name)</span><br><span class="line">p1.say_hello()  <span class="comment"># 你好！我是 猪八戒</span></span><br><span class="line">p2.say_hello()  <span class="comment"># 你好！我是 沙和尚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> p2.name  <span class="comment"># 删除p2的name属性</span></span><br><span class="line">print(p2.name)  <span class="comment"># swk</span></span><br></pre></td></tr></table></figure>

<ul>
<li>类和对象都是对现实生活中的事物或程序中的内容的抽象。</li>
<li>实际上所有的事物都由两部分构成：<ul>
<li>数据（属性）</li>
<li>行为（方法）</li>
</ul>
</li>
<li>在类的代码块中，我们可以定义变量和函数：<ul>
<li>变量会成为该类实例的公共属性，所有的该类实例都可以通过 <code>对象.属性名</code> 的形式访问。</li>
<li>函数会成为该类实例的公共方法，所有该类实例都可以通过 <code>对象.方法名()</code> 的形式调用方法。</li>
</ul>
</li>
<li>注意：方法调用时，默认第一个参数由解析器自动传递，所以定义方法时，至少要定义一个形参！ </li>
<li>实例为什么能访问到类中的属性和方法：<ul>
<li>类中定义的属性和方法都是公共的，任何该类实例都可以访问。</li>
<li>属性和方法查找的流程：<ul>
<li>当我们调用一个对象的属性时，解析器会先在当前对象中寻找是否含有该属性，如果有，则直接返回当前的对象的属性值；如果没有，则去当前对象的类对象中去寻找，如果有，则返回类对象的属性值，如果类对象中依然没有，则报错！</li>
</ul>
</li>
<li>类对象和实例对象中都可以保存属性（方法）：<ul>
<li>如果这个属性（方法）是所有的实例共享的，则应该将其保存到类对象中。</li>
<li>如果这个属性（方法）是某个实例独有，则应该保存到实例对象中。</li>
<li>比如，Person 类中，name 属性每个对象都不同，应该保存到各个实例对象中，而国籍假设都是中国人，是一样的，则应该保存到类对象中。</li>
<li>一般情况下，属性保存到实例对象中，而方法需要保存到类对象中。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="对象的初始化"><a href="#对象的初始化" class="headerlink" title="对象的初始化"></a>对象的初始化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="comment"># 在类中可以定义一些特殊方法（魔术方法）</span></span><br><span class="line">    <span class="comment"># 特殊方法都是以__开头，__结尾的方法</span></span><br><span class="line">    <span class="comment"># 特殊方法不需要我们自己调用，不要尝试去调用特殊方法</span></span><br><span class="line">    <span class="comment"># 特殊方法将会在特殊的时刻自动调用</span></span><br><span class="line">    <span class="comment"># 学习特殊方法：</span></span><br><span class="line">    <span class="comment">#   1.特殊方法什么时候调用</span></span><br><span class="line">    <span class="comment">#   2.特殊方法有什么作用</span></span><br><span class="line">    <span class="comment"># 创建对象的流程</span></span><br><span class="line">    <span class="comment"># p1 = Person()的运行流程</span></span><br><span class="line">    <span class="comment">#   1.创建一个变量</span></span><br><span class="line">    <span class="comment">#   2.在内存中创建一个新对象</span></span><br><span class="line">    <span class="comment">#   3.__init__(self)方法执行</span></span><br><span class="line">    <span class="comment">#   4.将对象的id赋值给变量</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># init会在对象创建以后立刻执行</span></span><br><span class="line">    <span class="comment"># init可以用来向新创建的对象中初始化属性</span></span><br><span class="line">    <span class="comment"># 调用类创建对象时，类后边的所有参数都会依次传递到init()中</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="comment"># print(self)</span></span><br><span class="line">        <span class="comment"># 通过self向新建的对象中初始化属性</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;大家好，我是%s&#x27;</span> % self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目前来讲，对于Person类来说name是必须的，并且每一个对象中的name属性基本上都是不同</span></span><br><span class="line"><span class="comment"># 而我们现在是将name属性在定义为对象以后，手动添加到对象中，这种方式很容易出现错误</span></span><br><span class="line"><span class="comment"># 我们希望，在创建对象时，必须设置name属性，如果不设置对象将无法创建</span></span><br><span class="line"><span class="comment">#   并且属性的创建应该是自动完成的，而不是在创建对象以后手动完成</span></span><br><span class="line"><span class="comment"># p1 = Person()</span></span><br><span class="line"><span class="comment"># 手动向对象添加name属性</span></span><br><span class="line"><span class="comment"># p1.name = &#x27;孙悟空&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p2 = Person()</span></span><br><span class="line"><span class="comment"># p2.name = &#x27;猪八戒&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p3 = Person()</span></span><br><span class="line"><span class="comment"># p3.name = &#x27;沙和尚&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p3.say_hello()</span></span><br><span class="line"></span><br><span class="line">p1 = Person(<span class="string">&#x27;孙悟空&#x27;</span>)</span><br><span class="line">p2 = Person(<span class="string">&#x27;猪八戒&#x27;</span>)</span><br><span class="line">p3 = Person(<span class="string">&#x27;沙和尚&#x27;</span>)</span><br><span class="line">p4 = Person(<span class="string">&#x27;唐僧&#x27;</span>)</span><br><span class="line"><span class="comment"># p1.__init__() 不要这么做</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p1.name)</span></span><br><span class="line"><span class="comment"># print(p2.name)</span></span><br><span class="line"><span class="comment"># print(p3.name)</span></span><br><span class="line"><span class="comment"># print(p4.name)</span></span><br><span class="line"></span><br><span class="line">p4.say_hello()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        表示狗的类</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age, gender, height</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.gender = gender</span><br><span class="line">        self.height = height</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jiao</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            狗叫的方法</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;汪汪汪~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">yao</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            狗咬的方法</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;我咬你~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;%s 快乐的奔跑着~~&#x27;</span> % self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = Dog(<span class="string">&#x27;小黑&#x27;</span>, <span class="number">8</span>, <span class="string">&#x27;male&#x27;</span>, <span class="number">30</span>)</span><br><span class="line">print(d.name, d.age, d.gender, d.height)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目前我们可以直接通过 对象.属性 的方式来修改属性的值，这种方式导致对象中的属性可以随意修改</span></span><br><span class="line"><span class="comment">#   非常的不安全，值可以任意修改，不论对错</span></span><br><span class="line"><span class="comment"># 现在我们就需要一种方式来增强数据的安全性</span></span><br><span class="line"><span class="comment">#   1.属性不能随意修改（我让你改你才能改，不让你改你就不能改）</span></span><br><span class="line"><span class="comment">#   2.属性不能修改为任意的值（年龄不能是负数）</span></span><br><span class="line">d.name = <span class="string">&#x27;阿黄&#x27;</span></span><br><span class="line">d.age = <span class="number">-10</span></span><br><span class="line">d.run()</span><br><span class="line"></span><br><span class="line">print(d.age)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>类的基本结构：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> 类名(<span class="params">[父类]</span>) :</span></span><br><span class="line"></span><br><span class="line">        公共的属性... </span><br><span class="line"></span><br><span class="line">        <span class="comment"># 对象的初始化方法</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,...</span>):</span></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 其他的方法    </span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">method_1</span>(<span class="params">self,...</span>):</span></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">method_2</span>(<span class="params">self,...</span>):</span></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建对象的流程，<code>p1 = Person()</code>：</p>
<ul>
<li>第一步：创建一个变量。</li>
<li>第二步：在内存中创建一个新对象。</li>
<li>第三步：<code>__init__(self) </code>方法执行。</li>
<li>第四步：将对象的 id 赋值给变量。</li>
</ul>
</li>
</ul>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 封装是面向对象的三大特性之一</span></span><br><span class="line"><span class="comment"># 封装指的是隐藏对象中一些不希望被外部所访问到的属性或方法</span></span><br><span class="line"><span class="comment"># 如何隐藏一个对象中的属性？</span></span><br><span class="line"><span class="comment">#   - 将对象的属性名，修改为一个外部不知道的名字</span></span><br><span class="line"><span class="comment"># 如何获取（修改）对象中的属性？</span></span><br><span class="line"><span class="comment">#   - 需要提供一个getter和setter方法使外部可以访问到属性</span></span><br><span class="line"><span class="comment">#   - getter 获取对象中的指定属性（get_属性名）</span></span><br><span class="line"><span class="comment">#   - setter 用来设置对象的指定属性（set_属性名）</span></span><br><span class="line"><span class="comment"># 使用封装，确实增加了类的定义的复杂程度，但是它也确保了数据的安全性</span></span><br><span class="line"><span class="comment">#   1.隐藏了属性名，使调用者无法随意的修改对象中的属性</span></span><br><span class="line"><span class="comment">#   2.增加了getter和setter方法，很好的控制的属性是否是只读的</span></span><br><span class="line"><span class="comment">#       如果希望属性是只读的，则可以直接去掉setter方法</span></span><br><span class="line"><span class="comment">#       如果希望属性不能被外部访问，则可以直接去掉getter方法</span></span><br><span class="line"><span class="comment">#   3.使用setter方法设置属性，可以增加数据的验证，确保数据的值是正确的</span></span><br><span class="line"><span class="comment">#   4.使用getter方法获取属性，使用setter方法设置属性</span></span><br><span class="line"><span class="comment">#       可以在读取属性和修改属性的同时做一些其他的处理</span></span><br><span class="line"><span class="comment">#   5.使用getter方法可以表示一些计算的属性</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        表示狗的类</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.hidden_name = name</span><br><span class="line">        self.hidden_age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;大家好，我是 %s&#x27;</span> % self.hidden_name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            get_name()用来获取对象的name属性</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># print(&#x27;用户读取了属性&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> self.hidden_name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="comment"># print(&#x27;用户修改了属性&#x27;)</span></span><br><span class="line">        self.hidden_name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.hidden_age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_age</span>(<span class="params">self, age</span>):</span></span><br><span class="line">        <span class="keyword">if</span> age &gt; <span class="number">0</span>:</span><br><span class="line">            self.hidden_age = age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = Dog(<span class="string">&#x27;旺财&#x27;</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d.say_hello()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用setter来修改name属性 </span></span><br><span class="line">d.set_name(<span class="string">&#x27;小黑&#x27;</span>)</span><br><span class="line">d.set_age(<span class="number">-10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d.say_hello()</span></span><br><span class="line">print(d.get_age())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span>:</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        表示矩形的类</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, width, height</span>):</span></span><br><span class="line">        self.hidden_width = width</span><br><span class="line">        self.hidden_height = height</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_width</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.hidden_width</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_height</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.hidden_height</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_width</span>(<span class="params">self, width</span>):</span></span><br><span class="line">        self.hidden_width = width</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_height</span>(<span class="params">self, height</span>):</span></span><br><span class="line">        self.hidden_height = height</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_area</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.hidden_width * self.hidden_height</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试</span></span><br><span class="line">r = Rectangle(<span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line">print(r.get_area())  <span class="comment"># 10</span></span><br><span class="line">r.set_width(<span class="number">10</span>)</span><br><span class="line">r.set_height(<span class="number">20</span>)</span><br><span class="line">print(r.get_area())  <span class="comment"># 200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以为对象的属性使用双下划线开头，__xxx</span></span><br><span class="line"><span class="comment"># 双下划线开头的属性，是对象的隐藏属性，隐藏属性只能在类的内部访问，无法通过对象访问</span></span><br><span class="line"><span class="comment"># 其实隐藏属性只不过是Python自动为属性改了一个名字</span></span><br><span class="line"><span class="comment">#   实际上是将名字修改为了，_类名__属性名 比如 __name -&gt; _Person__name</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = Person(<span class="string">&#x27;孙悟空&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p.__name)  # __开头的属性是隐藏属性，无法通过对象访问</span></span><br><span class="line">print(p._Person__name)  <span class="comment"># 能直接访问，孙悟空</span></span><br><span class="line">p._Person__name = <span class="string">&#x27;猪八戒&#x27;</span></span><br><span class="line">print(p.get_name())  <span class="comment"># 也能直接更改，猪八戒</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面使用__开头的属性，实际上依然可以在外部访问，所以这种方式我们一般不用</span></span><br><span class="line"><span class="comment">#   一般我们会将一些私有属性（不希望被外部访问的属性）以_开头（实际上也可以直接访问和修改）</span></span><br><span class="line"><span class="comment">#   一般情况下，使用_开头的属性都是私有属性，没有特殊需要不要修改私有属性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = Person(<span class="string">&#x27;孙悟空&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(p._name)  <span class="comment"># 能直接访问</span></span><br><span class="line">p._name = <span class="string">&#x27;猪八戒&#x27;</span></span><br><span class="line">print(p._name)  <span class="comment"># 也能直接修改，猪八戒</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    <span class="comment"># property装饰器，用来将一个get方法，转换为对象的属性</span></span><br><span class="line">    <span class="comment"># 添加为property装饰器以后，我们就可以像调用属性一样使用get方法</span></span><br><span class="line">    <span class="comment"># 使用property装饰的方法，必须和属性名是一样的</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;get方法执行了~~~&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># setter方法的装饰器：@属性名.setter</span></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;setter方法调用了&#x27;</span>)</span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self, age</span>):</span></span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = Person(<span class="string">&#x27;猪八戒&#x27;</span>, <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">print(p.name, p.age)  <span class="comment"># 调用的就是装饰器装饰的setter和get方法</span></span><br><span class="line"></span><br><span class="line">p.name = <span class="string">&#x27;孙悟空&#x27;</span></span><br><span class="line">p.age = <span class="number">28</span></span><br><span class="line"></span><br><span class="line">print(p.name, p.age)</span><br></pre></td></tr></table></figure>

<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 继承</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个类 Animal（动物）</span></span><br><span class="line"><span class="comment">#   这个类中需要两个方法：run() sleep()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;动物会跑~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sleep</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;动物睡觉~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># def bark(self):</span></span><br><span class="line">    <span class="comment">#     print(&#x27;动物嚎叫~~~&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个类 Dog（狗）</span></span><br><span class="line"><span class="comment">#   这个类中需要三个方法：run() sleep() bark()</span></span><br><span class="line"><span class="comment"># class Dog:</span></span><br><span class="line"><span class="comment">#     def run(self):</span></span><br><span class="line"><span class="comment">#         print(&#x27;狗会跑~~~&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     def sleep(self):</span></span><br><span class="line"><span class="comment">#         print(&#x27;狗睡觉~~~&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     def bark(self):</span></span><br><span class="line"><span class="comment">#         print(&#x27;汪汪汪~~~&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 有一个类，能够实现我们需要的大部分功能，但是不能实现全部功能</span></span><br><span class="line"><span class="comment"># 如何能让这个类来实现全部的功能呢？</span></span><br><span class="line"><span class="comment">#   ① 直接修改这个类，在这个类中添加我们需要的功能</span></span><br><span class="line"><span class="comment">#       - 修改起来会比较麻烦，并且会违反OCP原则</span></span><br><span class="line"><span class="comment">#   ② 直接创建一个新的类</span></span><br><span class="line"><span class="comment">#       - 创建一个新的类比较麻烦，并且需要大量的进行复制粘贴，会出现大量的重复性代码</span></span><br><span class="line"><span class="comment">#   ③ 直接从Animal类中来继承它的属性和方法</span></span><br><span class="line"><span class="comment">#       - 继承是面向对象三大特性之一</span></span><br><span class="line"><span class="comment">#       - 通过继承我们可以使一个类获取到其他类中的属性和方法</span></span><br><span class="line"><span class="comment">#       - 在定义类时，可以在类名后的括号中指定当前类的父类（超类、基类、super）</span></span><br><span class="line"><span class="comment">#           子类（衍生类）可以直接继承父类中的所有的属性和方法</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  通过继承可以直接让子类获取到父类的方法或属性，避免编写重复性的代码，并且也符合OCP原则</span></span><br><span class="line"><span class="comment">#   所以我们经常需要通过继承来对一个类进行扩展</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">Animal</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;狗跑~~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bark</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;汪汪汪~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hashiqi</span>(<span class="params">Dog</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fan_sha</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;我是一只傻傻的哈士奇&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = Dog()</span><br><span class="line">d.run()  <span class="comment"># 狗跑~~~~</span></span><br><span class="line">d.sleep()  <span class="comment"># 动物睡觉~~~</span></span><br><span class="line">d.bark()  <span class="comment"># 汪汪汪~~~</span></span><br><span class="line">print(<span class="built_in">isinstance</span>(d, Dog))  <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">isinstance</span>(d, Animal))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">h = Hashiqi()</span><br><span class="line">h.run()  <span class="comment"># 狗跑~~~~</span></span><br><span class="line">h.fan_sha()  <span class="comment"># 我是一只傻傻的哈士奇</span></span><br><span class="line">print(<span class="built_in">isinstance</span>(h, Hashiqi))  <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">isinstance</span>(h, Dog))  <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">isinstance</span>(h, Animal))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;######################################&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在创建类时，如果省略了父类，则默认父类为object</span></span><br><span class="line"><span class="comment">#   object是所有类的父类，所有类都继承自object</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># issubclass() 检查一个类是否是另一个类的子类</span></span><br><span class="line">print(<span class="built_in">issubclass</span>(Animal, Dog))  <span class="comment"># False</span></span><br><span class="line">print(<span class="built_in">issubclass</span>(Animal, <span class="built_in">object</span>))  <span class="comment"># True</span></span><br><span class="line">print(<span class="built_in">issubclass</span>(Person, <span class="built_in">object</span>))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># isinstance()用来检查一个对象是否是一个类的实例</span></span><br><span class="line"><span class="comment">#   如果这个类是这个对象的父类，也会返回True</span></span><br><span class="line"><span class="comment">#   所有的对象都是object的实例</span></span><br><span class="line">print(<span class="built_in">isinstance</span>(<span class="built_in">print</span>, <span class="built_in">object</span>))  <span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;动物会跑~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sleep</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;动物睡觉~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 父类中的所有方法都会被子类继承，包括特殊方法，也可以重写特殊方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">Animal</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        <span class="comment"># 希望可以直接调用父类的__init__来初始化父类中定义的属性</span></span><br><span class="line">        <span class="comment"># super() 可以用来获取当前类的父类，</span></span><br><span class="line">        <span class="comment">#   并且通过super()返回对象调用父类方法时，不需要传递self</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name)</span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;狗跑~~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bark</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;汪汪汪~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self, age</span>):</span></span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = Dog(<span class="string">&#x27;旺财&#x27;</span>, <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">print(d.name)  <span class="comment"># 旺财</span></span><br><span class="line">print(d.age)  <span class="comment"># 18</span></span><br></pre></td></tr></table></figure>

<h4 id="重写"><a href="#重写" class="headerlink" title="重写"></a>重写</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 继承</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个类 Animal（动物）</span></span><br><span class="line"><span class="comment">#   这个类中需要两个方法：run() sleep()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;动物会跑~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sleep</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;动物睡觉~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">Animal</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bark</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;汪汪汪~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;狗跑~~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果在子类中如果有和父类同名的方法，则通过子类实例去调用方法时，</span></span><br><span class="line"><span class="comment">#   会调用子类的方法而不是父类的方法，这个特点我们成为叫做方法的重写（覆盖，override）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Dog类的实例</span></span><br><span class="line">d = Dog()</span><br><span class="line"></span><br><span class="line">d.run()  <span class="comment"># 狗跑~~~~</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当我们调用一个对象的方法时，</span></span><br><span class="line"><span class="comment">#   会优先去当前对象中寻找是否具有该方法，如果有则直接调用</span></span><br><span class="line"><span class="comment">#   如果没有，则去当前对象的父类中寻找，如果父类中有则直接调用父类中的方法，</span></span><br><span class="line"><span class="comment">#   如果没有，则去父类的父类中寻找，以此类推，直到找到object，如果依然没有找到，则报错</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;AAA&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">A</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;BBB&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">B</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;CCC&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个c的实例</span></span><br><span class="line">c = C()</span><br><span class="line">c.test()  <span class="comment"># CCC</span></span><br></pre></td></tr></table></figure>

<h4 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;AAA&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;B中的test()方法~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test2</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;BBB&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在Python中是支持多重继承的，也就是我们可以为一个类同时指定多个父类</span></span><br><span class="line"><span class="comment">#   可以在类名的()后边添加多个类，来实现多重继承</span></span><br><span class="line"><span class="comment">#   多重继承，会使子类同时拥有多个父类，并且会获取到所有父类中的方法</span></span><br><span class="line"><span class="comment"># 在开发中没有特殊的情况，应该尽量避免使用多重继承，因为多重继承会让我们的代码过于复杂</span></span><br><span class="line"><span class="comment"># 如果多个父类中有同名的方法，则会先在第一个父类中寻找，然后找第二个，然后找第三个。。。</span></span><br><span class="line"><span class="comment">#   前边父类的方法会覆盖后边父类的方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">A, B</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = C()</span><br><span class="line">c.test()  <span class="comment"># AAA</span></span><br><span class="line">c.test2()  <span class="comment"># BBB</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类名.__bases__ 这个属性可以用来获取当前类的所有父类，返回的是一个元组</span></span><br><span class="line">print(B.__bases__)  <span class="comment"># (&lt;class &#x27;object&#x27;&gt;,)</span></span><br><span class="line">print(C.__bases__)  <span class="comment"># (&lt;class &#x27;__main__.A&#x27;&gt;, &lt;class &#x27;__main__.B&#x27;&gt;)</span></span><br></pre></td></tr></table></figure>

<h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多态是面向对象的三大特征之一</span></span><br><span class="line"><span class="comment"># 多态从字面上理解是多种形态</span></span><br><span class="line"><span class="comment"># 狗（狼狗、藏獒、哈士奇、古牧 。。。）</span></span><br><span class="line"><span class="comment"># 一个对象可以以不同的形态去呈现</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义两个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self._name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = A(<span class="string">&#x27;孙悟空&#x27;</span>)</span><br><span class="line">b = B(<span class="string">&#x27;猪八戒&#x27;</span>)</span><br><span class="line">c = C()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数</span></span><br><span class="line"><span class="comment"># 对于say_hello()这个函数来说，只要对象中含有name属性，它就可以作为参数传递</span></span><br><span class="line"><span class="comment">#   这个函数并不会考虑对象的类型，只要有name属性即可 ---&gt; 多态的提现</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say_hello</span>(<span class="params">obj</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;你好 %s&#x27;</span> % obj.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在say_hello_2中我们做了一个类型检查，也就是只有obj是A类型的对象时，才可以正常使用，</span></span><br><span class="line"><span class="comment">#   其他类型的对象都无法使用该函数，这个函数就违反了多态</span></span><br><span class="line"><span class="comment"># 违反了多态的函数，只适用于一种类型的对象，无法处理其他类型对象，这样导致函数的适应性非常的差</span></span><br><span class="line"><span class="comment"># 注意，像isinstance()这种函数，在开发中一般是不会使用的！（使用这个函数，就表示可能违反了多态）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say_hello_2</span>(<span class="params">obj</span>):</span></span><br><span class="line">    <span class="comment"># 做类型检查</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, A):</span><br><span class="line">        print(<span class="string">&#x27;你好 %s&#x27;</span> % obj.name)</span><br><span class="line">    <span class="comment"># say_hello(b)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># say_hello_2(b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 鸭子类型（多态理论）：</span></span><br><span class="line"><span class="comment">#   如果一个东西，走路像鸭子，叫声像鸭子，那么它就是鸭子</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># len()</span></span><br><span class="line"><span class="comment"># 之所以一个对象能通过len()来获取长度，是因为对象中具有一个特殊方法__len__</span></span><br><span class="line"><span class="comment"># 换句话说，只要对象中具有__len__特殊方法，就可以通过len()来获取它的长度</span></span><br><span class="line"><span class="comment"># 这就是多态的体现</span></span><br><span class="line">l = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">s = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(l))  <span class="comment"># 3</span></span><br><span class="line">print(<span class="built_in">len</span>(s))  <span class="comment"># 5</span></span><br><span class="line">print(<span class="built_in">len</span>(b))  <span class="comment"># 10</span></span><br><span class="line"><span class="comment"># print(len(c))  # 报错，object of type &#x27;C&#x27; has no len()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 面向对象的三大特征：</span></span><br><span class="line"><span class="comment">#   封装</span></span><br><span class="line"><span class="comment">#       - 确保对象中的数据安全</span></span><br><span class="line"><span class="comment">#   继承</span></span><br><span class="line"><span class="comment">#       - 保证了对象的可扩展性</span></span><br><span class="line"><span class="comment">#   多态</span></span><br><span class="line"><span class="comment">#       - 保证了程序的灵活性</span></span><br></pre></td></tr></table></figure>

<h3 id="类中的属性和方法"><a href="#类中的属性和方法" class="headerlink" title="类中的属性和方法"></a>类中的属性和方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="comment"># 类属性---所有实例公用的</span></span><br><span class="line">    <span class="comment"># 实例属性---每个实例私有的</span></span><br><span class="line">    <span class="comment"># 类方法</span></span><br><span class="line">    <span class="comment"># 实例方法</span></span><br><span class="line">    <span class="comment"># 静态方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 类属性，直接在类中定义的属性是类属性</span></span><br><span class="line">    <span class="comment">#   类属性可以通过类或类的实例访问到</span></span><br><span class="line">    <span class="comment">#   但是类属性只能通过类对象来修改，无法通过实例对象修改</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># __init__也是实例方法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 实例属性，通过实例对象添加的属性属于实例属性</span></span><br><span class="line">        <span class="comment">#   实例属性只能通过实例对象来访问和修改，类对象无法访问修改</span></span><br><span class="line">        self.name = <span class="string">&#x27;孙悟空&#x27;</span>  <span class="comment"># name也是实例属性</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实例方法</span></span><br><span class="line">    <span class="comment">#   在类中定义，以self为第一个参数的方法都是实例方法</span></span><br><span class="line">    <span class="comment">#   实例方法在调用时，Python会将调用对象作为self传入</span></span><br><span class="line">    <span class="comment">#   实例方法可以通过实例和类去调用</span></span><br><span class="line">    <span class="comment">#       当通过实例调用时，会自动将当前调用对象作为self传入</span></span><br><span class="line">    <span class="comment">#       当通过类调用时，不会自动传递self，此时我们必须手动传递self</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;这是test方法~~~ &#x27;</span>, self)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 类方法</span></span><br><span class="line">    <span class="comment">#   在类内部使用 @classmethod 来修饰的方法属于类方法</span></span><br><span class="line">    <span class="comment">#   类方法的第一个参数是cls，也会被自动传递，cls就是当前的类对象</span></span><br><span class="line">    <span class="comment">#   类方法和实例方法的区别，实例方法的第一个参数是self，而类方法的第一个参数是cls</span></span><br><span class="line">    <span class="comment">#   类方法可以通过类去调用，也可以通过实例调用，没有区别</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_2</span>(<span class="params">cls</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;这是test_2方法，他是一个类方法~~~ &#x27;</span>, cls)</span><br><span class="line">        print(cls.count)  <span class="comment"># 这个访问的是类属性，与实例对象无关</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 静态方法</span></span><br><span class="line">    <span class="comment">#   在类中使用 @staticmethod 来修饰的方法属于静态方法</span></span><br><span class="line">    <span class="comment">#   静态方法不需要指定任何的默认参数，静态方法可以通过类和实例去调用</span></span><br><span class="line">    <span class="comment">#   静态方法，基本上是一个和当前类无关的方法，它只是一个保存到当前类中的函数</span></span><br><span class="line">    <span class="comment">#   静态方法一般都是一些工具方法，和当前类无关（建议静态方法不要放到某个类中，或者全部放到一个工具类中）</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_3</span>():</span></span><br><span class="line">        print(<span class="string">&#x27;test_3执行了~~~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;A &#x27;</span>, A.count)  <span class="comment"># 类访问类属性：0</span></span><br><span class="line">a = A()</span><br><span class="line">print(<span class="string">&#x27;a &#x27;</span>, a.count)  <span class="comment"># 类的实例访问类属性：0</span></span><br><span class="line"></span><br><span class="line">a.count = <span class="number">10</span>  <span class="comment"># 类的实例无法修改类属性，此操作是给a这个实例对象，添加了一个实例属性count</span></span><br><span class="line">print(<span class="string">&#x27;A &#x27;</span>, A.count)  <span class="comment"># 0</span></span><br><span class="line">print(<span class="string">&#x27;a &#x27;</span>, a.count)  <span class="comment"># 10</span></span><br><span class="line">A.count = <span class="number">100</span>  <span class="comment"># 类可以修改类属性，但不影响类的实例中已存在的同名属性</span></span><br><span class="line">print(<span class="string">&#x27;A &#x27;</span>, A.count)  <span class="comment"># 100</span></span><br><span class="line">print(<span class="string">&#x27;a &#x27;</span>, a.count)  <span class="comment"># 10</span></span><br><span class="line">b = A()  <span class="comment"># b这个实例对象中，没有count实例属性，访问的是A类的属性</span></span><br><span class="line">print(<span class="string">&#x27;b &#x27;</span>, b.count)  <span class="comment"># 100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&#x27;A &#x27;, A.name) # 类无法访问实例属性，AttributeError: type object &#x27;A&#x27; has no attribute &#x27;name&#x27;</span></span><br><span class="line">print(<span class="string">&#x27;a &#x27;</span>, a.name)  <span class="comment"># 孙悟空</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类和类的实例，都可以访问实例方法</span></span><br><span class="line">a.test()  <span class="comment"># 等价于 A.test(a)：这是test方法~~~  &lt;__main__.A object at 0x000002631BC28310&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类和类的实例，都可以访问类方法</span></span><br><span class="line">A.test_2()  <span class="comment"># 等价于 a.test_2()：这是test_2方法，他是一个类方法~~~  &lt;class &#x27;__main__.A&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 静态方法，与类和类的实例无关</span></span><br><span class="line">A.test_3()  <span class="comment"># test_3执行了~~~</span></span><br><span class="line">a.test_3()  <span class="comment"># test_3执行了~~~</span></span><br><span class="line">b.test_3()  <span class="comment"># test_3执行了~~~</span></span><br></pre></td></tr></table></figure>

<h3 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 就像我们生活中会产生垃圾一样，程序在运行过程当中也会产生垃圾</span></span><br><span class="line"><span class="comment"># 程序运行过程中产生的垃圾会影响到程序的运行的运行性能，所以这些垃圾必须被及时清理</span></span><br><span class="line"><span class="comment"># 没用的东西就是垃圾</span></span><br><span class="line"><span class="comment"># 在程序中没有被引用的对象就是垃圾，这种垃圾对象过多以后会影响到程序的运行的性能</span></span><br><span class="line"><span class="comment">#   所以我们必须进行及时的垃圾回收，所谓的垃圾回收就是将垃圾对象从内存中删除</span></span><br><span class="line"><span class="comment"># 在Python中有自动的垃圾回收机制，它会自动将这些没有被引用的对象删除，</span></span><br><span class="line"><span class="comment">#   所以我们不用手动处理垃圾回收</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.name = <span class="string">&#x27;A类&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># del是一个特殊方法，它会在垃圾对象被回收前调用</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;A()对象被回收了~~~&#x27;</span>, self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">print(a.name)</span><br><span class="line"><span class="comment"># a = None  # 将a设置为None，此时没有任何的变量对A()对象进行引用，A()对象变成了垃圾</span></span><br><span class="line"><span class="comment"># 变成垃圾的A()对象会被回收，回收前调用__del__()方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># del a # del 会把a变量删除，也会导致A()对象变成垃圾</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>(<span class="string">&#x27;回车键退出程序...&#x27;</span>)  <span class="comment"># 程序结束后，A()对象即使还在被a变量引用，仍然会被回收</span></span><br></pre></td></tr></table></figure>

<h3 id="特殊方法"><a href="#特殊方法" class="headerlink" title="特殊方法"></a>特殊方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 特殊方法，也称为魔术方法</span></span><br><span class="line"><span class="comment"># 特殊方法都是使用__开头和结尾的</span></span><br><span class="line"><span class="comment"># 特殊方法一般不需要我们手动调用，需要在一些特殊情况下自动执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个Person类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;人类&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="comment"># __str__()这个特殊方法会在尝试将对象转换为字符串的时候调用</span></span><br><span class="line">    <span class="comment"># 它的作用可以用来指定对象转换为字符串的结果（print函数）</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Person [name=%s , age=%d]&#x27;</span> % (self.name, self.age)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># __repr__()这个特殊方法会在对当前对象使用repr()函数时调用</span></span><br><span class="line">    <span class="comment"># 它的作用是指定对象在‘交互模式’中直接输出的效果</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Hello, this is repr&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 重写以下方法，让对象支持比较，以__gt__()为例说明</span></span><br><span class="line">    <span class="comment"># object.__lt__(self, other) 小于 &lt;</span></span><br><span class="line">    <span class="comment"># object.__le__(self, other) 小于等于 &lt;=</span></span><br><span class="line">    <span class="comment"># object.__eq__(self, other) 等于 ==</span></span><br><span class="line">    <span class="comment"># object.__ne__(self, other) 不等于 !=</span></span><br><span class="line">    <span class="comment"># object.__gt__(self, other) 大于 &gt;</span></span><br><span class="line">    <span class="comment"># object.__ge__(self, other) 大于等于 &gt;=</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># __gt__（）会在对象做大于比较的时候调用，该方法的返回值将会作为比较的结果</span></span><br><span class="line">    <span class="comment"># 他需要两个参数，一个self表示当前对象，other表示和当前对象比较的对象</span></span><br><span class="line">    <span class="comment"># self &gt; other</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__gt__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.age &gt; other.age  <span class="comment"># 以年龄作为比较的指标</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># __len__() # 获取对象的长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># object.__bool__(self)</span></span><br><span class="line">    <span class="comment"># 可以通过bool来指定对象转换为布尔值的情况</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__bool__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.age &gt; <span class="number">17</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 运算的方法</span></span><br><span class="line">    <span class="comment"># object.__add__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__sub__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__mul__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__matmul__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__truediv__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__floordiv__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__mod__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__divmod__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__pow__(self, other[, modulo])</span></span><br><span class="line">    <span class="comment"># object.__lshift__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__rshift__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__and__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__xor__(self, other)</span></span><br><span class="line">    <span class="comment"># object.__or__(self, other)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建两个Person类的实例</span></span><br><span class="line">p1 = Person(<span class="string">&#x27;孙悟空&#x27;</span>, <span class="number">18</span>)</span><br><span class="line">p2 = Person(<span class="string">&#x27;猪八戒&#x27;</span>, <span class="number">28</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印p1</span></span><br><span class="line"><span class="comment"># 当我们打印一个对象时，实际上打印的是对象的中特殊方法 __str__()的返回值</span></span><br><span class="line"><span class="comment"># print(p1)  # 不改写__str__()方法的输出结果：&lt;__main__.Person object at 0x04E95090&gt;</span></span><br><span class="line">print(p1)  <span class="comment"># 改写__str__()方法后的输出结果：Person [name=孙悟空 , age=18]</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">repr</span>(p1))  <span class="comment"># Hello, this is repr</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 大于比较方法</span></span><br><span class="line">print(p1 &gt; p2)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">print(<span class="built_in">bool</span>(p1))  <span class="comment"># True</span></span><br><span class="line"><span class="comment"># 条件不清晰，p1调用的就是__bool__()方法，一般不这样写</span></span><br><span class="line"><span class="comment"># if p1:</span></span><br><span class="line"><span class="comment">#     print(p1.name, &#x27;已经成年了&#x27;)</span></span><br><span class="line"><span class="comment"># else:</span></span><br><span class="line"><span class="comment">#     print(p1.name, &#x27;还未成年了&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><ul>
<li><p>简介：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模块（module）</span></span><br><span class="line"><span class="comment"># 模块化，模块化指将一个完整的程序分解为一个一个小的模块</span></span><br><span class="line"><span class="comment">#   通过将模块组合，来搭建出一个完整的程序</span></span><br><span class="line"><span class="comment"># 不采用模块化：统一将所有的代码编写到一个文件中</span></span><br><span class="line"><span class="comment"># 采用模块化：将程序分别编写到多个文件中</span></span><br><span class="line"><span class="comment"># 模块化的优点：</span></span><br><span class="line"><span class="comment">#     ① 方便开发</span></span><br><span class="line"><span class="comment">#     ② 方便维护</span></span><br><span class="line"><span class="comment">#     ③ 模块可以复用！</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在Python中一个py文件就是一个模块，要想创建模块，实际上就是创建一个python文件</span></span><br><span class="line"><span class="comment"># 注意：模块名要符号标识符的规范</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在一个模块中引入外部模块：</span></span><br><span class="line"><span class="comment"># ① import 模块名 （模块名，就是python文件的名字，注意不要.py后缀）</span></span><br><span class="line"><span class="comment"># ② import 模块名 as 模块别名</span></span><br><span class="line"><span class="comment">#   - 可以引入同一个模块多次，但是模块的实例只会创建一个</span></span><br><span class="line"><span class="comment">#   - import可以在程序的任意位置调用，但是一般情况下，import语句都会统一写在程序的开头</span></span><br><span class="line"><span class="comment">#   - 在每一个模块内部都有一个__name__属性，通过这个属性可以获取到模块的名字</span></span><br><span class="line"><span class="comment">#   - __name__属性值为 __main__的模块是主模块，一个程序中只会有一个主模块</span></span><br><span class="line"><span class="comment">#       主模块就是我们直接通过 python 执行的模块（当前程序所在的模块）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> test_module <span class="keyword">as</span> test</span><br><span class="line"></span><br><span class="line">print(__name__)  <span class="comment"># 主模块：__main__</span></span><br><span class="line">print(test.__name__)  <span class="comment"># 引入的外部模块：test_module</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>m.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以在模块中定义变量，在模块中定义的变量，在引入该模块后，就可以直接使用了</span></span><br><span class="line">a = <span class="number">10</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加了_的变量，只能在模块内部访问，在通过 import * 方式引入时，不会引入_开头的变量</span></span><br><span class="line">_c = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以在模块中定义函数，同样可以通过模块访问到</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;test&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;test2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以定义类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.name = <span class="string">&#x27;孙悟空&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编写测试代码：</span></span><br><span class="line"><span class="comment">#   这部分代码，只有当前模块作为主模块的时候才需要被执行</span></span><br><span class="line"><span class="comment">#   而当前模块被其他模块引入时，不需要被执行</span></span><br><span class="line"><span class="comment">#   此时，我们就必须要检查当前模块是否是主模块</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br><span class="line">    test2()</span><br><span class="line">    p = Person()</span><br><span class="line">    print(p.name)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>main.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> m</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问模块中的变量：模块名.变量名</span></span><br><span class="line">print(m.a, m.b)  <span class="comment"># 10 20.</span></span><br><span class="line"><span class="comment"># print(m._c)  # 此方式可以访问_c属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问模块中的方法：模块名.方法名</span></span><br><span class="line">m.test()  <span class="comment"># test</span></span><br><span class="line">m.test2()  <span class="comment"># test2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问模块中的类：模块名.类名，创建类的实例</span></span><br><span class="line">p = m.Person()</span><br><span class="line">print(p.name)  <span class="comment"># 孙悟空</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以只引入模块中的部分内容</span></span><br><span class="line"><span class="comment"># 语法： from 模块名 import 变量, 变量....</span></span><br><span class="line"><span class="comment"># from m import Person # 只引入Person</span></span><br><span class="line"><span class="comment"># from m import test # 只引入test</span></span><br><span class="line"><span class="keyword">from</span> m <span class="keyword">import</span> Person, test  <span class="comment"># 引入多个</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过上面方式引入后，可以直接使用</span></span><br><span class="line">p1 = Person()</span><br><span class="line">print(p1)  <span class="comment"># &lt;m.Person object at 0x00000115DD088160&gt;</span></span><br><span class="line">test()  <span class="comment"># test</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># test2() # test2()没有引入，不能直接使用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from m import *  # 引入模块中所有内容，一般不会使用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前模块中，会覆盖被引入模块中的同名方法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;这是主模块中的test2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test2()  <span class="comment"># 这是主模块中的test2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以为引入的变量使用别名</span></span><br><span class="line"><span class="comment"># 语法：from 模块名 import 变量 as 别名</span></span><br><span class="line"><span class="keyword">from</span> m <span class="keyword">import</span> test2 <span class="keyword">as</span> new_test2</span><br><span class="line"></span><br><span class="line">test2()  <span class="comment"># 这是主模块中的test2</span></span><br><span class="line">new_test2()  <span class="comment"># test2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from m import *</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(_c) # _c属性无法访问</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 总结：</span></span><br><span class="line"><span class="comment"># import xxx</span></span><br><span class="line"><span class="comment"># import xxx as yyy</span></span><br><span class="line"><span class="comment"># from xxx import yyy , zzz , fff</span></span><br><span class="line"><span class="comment"># from xxx import *</span></span><br><span class="line"><span class="comment"># from xxx import yyy as zz</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="包"><a href="#包" class="headerlink" title="包"></a>包</h3><ul>
<li><p>结构：</p>
<p><img src="/2021/09/06/python/image-20210929171722079.png" alt="image-20210929171722079"></p>
<p><img src="/2021/09/06/python/image-20210929171809531.png" alt="image-20210929171809531"></p>
<p><img src="/2021/09/06/python/image-20210929171835707.png" alt="image-20210929171835707"></p>
</li>
<li><p><code>hello/__init__.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;test&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>hello/a.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">30</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>hello/b.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="number">40</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>main.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 包 Package</span></span><br><span class="line"><span class="comment"># 包也是一个模块</span></span><br><span class="line"><span class="comment"># 当我们模块中代码过多时，或者一个模块需要被分解为多个模块时，这时就需要使用到包</span></span><br><span class="line"><span class="comment"># 普通的模块就是一个py文件，而包是一个文件夹</span></span><br><span class="line"><span class="comment">#   包中必须要有一个 __init__.py 文件，这个文件中可以包含有包中的主要内容</span></span><br><span class="line"><span class="keyword">from</span> hello <span class="keyword">import</span> a, b</span><br><span class="line"></span><br><span class="line">print(a.c)</span><br><span class="line">print(b.d)</span><br><span class="line"></span><br><span class="line"><span class="comment"># __pycache__ 是模块的缓存文件</span></span><br><span class="line"><span class="comment"># .py代码在执行前，需要被解析器先转换为机器码，然后再执行</span></span><br><span class="line"><span class="comment">#   所以我们在使用模块（包）时，也需要将模块的代码先转换为机器码，然后再交由计算机执行</span></span><br><span class="line"><span class="comment">#   而为了提高程序运行的性能，python会在编译过一次以后，将代码保存到一个缓存文件中</span></span><br><span class="line"><span class="comment">#   这样在下次加载这个模块（包）时，就可以不再重新编译而是直接加载缓存中编译好的代码即可</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Python-标准库"><a href="#Python-标准库" class="headerlink" title="Python 标准库"></a>Python 标准库</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 思想：开箱即用</span></span><br><span class="line"><span class="comment"># 为了实现开箱即用的思想，Python中为我们提供了一个模块的标准库</span></span><br><span class="line"><span class="comment"># 在这个标准库中，有很多很强大的模块我们可以直接使用，并且标准库会随Python的安装一同安装</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sys模块：</span></span><br><span class="line"><span class="comment">#   它里面提供了一些变量和函数，使我们可以获取到Python解析器的信息</span></span><br><span class="line"><span class="comment">#   或者通过函数来操作Python解析器</span></span><br><span class="line"><span class="comment"># 引入sys模块：</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">print(sys)  <span class="comment"># &lt;module &#x27;sys&#x27; (built-in)&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.argv：</span></span><br><span class="line"><span class="comment">#   命令行执行代码时，获取命令行中所包含的参数</span></span><br><span class="line"><span class="comment">#   该属性是一个列表，列表中保存了当前命令的所有参数</span></span><br><span class="line"><span class="comment">#   参考IDEA中Java程序main()方法模块参数的引入，注意第一个参数</span></span><br><span class="line">print(sys.argv)  <span class="comment"># [&#x27;D:/JetBrainsWorkSpace/PycharmProjects/main.py&#x27;, &#x27;aaa&#x27;, &#x27;bbb&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.modules：</span></span><br><span class="line"><span class="comment">#   获取当前程序中引入的所有模块</span></span><br><span class="line"><span class="comment">#   modules是一个字典，字典的key是模块的名字，字典的value是模块对象</span></span><br><span class="line">print(sys.modules)  <span class="comment"># &#123;&#x27;sys&#x27;: &lt;module &#x27;sys&#x27; (built-in)&gt;, &#x27;builtins&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, ......&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pprint模块：</span></span><br><span class="line"><span class="comment">#   print()打印不会格式化数据</span></span><br><span class="line"><span class="comment">#   它给我们提供了一个方法pprint()，该方法可以用来对打印的数据做简单的格式化</span></span><br><span class="line"><span class="comment"># 引入pprint模块：</span></span><br><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">pprint.pprint(sys.modules)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.path：</span></span><br><span class="line"><span class="comment">#   他是一个列表，列表中保存的是模块的搜索路径，不要轻易更改</span></span><br><span class="line"><span class="comment"># [&#x27;D:\\JetBrainsWorkSpace\\PycharmProjects&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\JetBrainsWorkSpace\\PycharmProjects&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program Files\\PyCharm Professional Edition with Anaconda plugin &#x27;</span></span><br><span class="line"><span class="comment">#  &#x27;2020.1.2\\plugins\\python\\helpers\\pycharm_display&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\python38.zip&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\DLLs&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\lib&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\lib\\site-packages&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\lib\\site-packages\\win32&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\lib\\site-packages\\win32\\lib&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program\\Miniconda3\\lib\\site-packages\\Pythonwin&#x27;,</span></span><br><span class="line"><span class="comment">#  &#x27;D:\\Program Files\\PyCharm Professional Edition with Anaconda plugin &#x27;</span></span><br><span class="line"><span class="comment">#  &#x27;2020.1.2\\plugins\\python\\helpers\\pycharm_matplotlib_backend&#x27;]</span></span><br><span class="line">pprint.pprint(sys.path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.platform：</span></span><br><span class="line"><span class="comment">#   表示当前Python运行的平台</span></span><br><span class="line">print(sys.platform)  <span class="comment"># win32</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sys.exit()：</span></span><br><span class="line"><span class="comment">#   函数用来退出程序</span></span><br><span class="line"><span class="comment"># sys.exit(&#x27;程序出现异常，结束！&#x27;)  # 后面的print(&#x27;hello&#x27;)语句不再执行</span></span><br><span class="line"><span class="comment"># print(&#x27;hello&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os模块：</span></span><br><span class="line"><span class="comment">#   让我们可以对操作系统进行访问</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.environ：</span></span><br><span class="line"><span class="comment">#   通过这个属性可以获取到系统的环境变量</span></span><br><span class="line">pprint.pprint(os.environ)  <span class="comment"># 所有的</span></span><br><span class="line">pprint.pprint(os.environ[<span class="string">&#x27;path&#x27;</span>])  <span class="comment"># 只查看path环境变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.system()：</span></span><br><span class="line"><span class="comment">#   可以用来执行操作系统的命令</span></span><br><span class="line">os.system(<span class="string">&#x27;dir&#x27;</span>)  <span class="comment"># dir命令</span></span><br><span class="line">os.system(<span class="string">&#x27;notepad&#x27;</span>)  <span class="comment"># 打开记事本名令</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>命令行执行代码时的参数：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> D:\JetBrainsWorkSpace\PycharmProjects&gt; python main.py aaa bbb</span><br><span class="line">[<span class="string">&#x27;main.py&#x27;</span>, <span class="string">&#x27;aaa&#x27;</span>, <span class="string">&#x27;bbb&#x27;</span>]</span><br></pre></td></tr></table></figure>
</blockquote>
<p><img src="/2021/09/06/python/image-20210930161242203.png" alt="image-20210930161242203"></p>
<h2 id="异常和文件"><a href="#异常和文件" class="headerlink" title="异常和文件"></a>异常和文件</h2><h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><ul>
<li> 程序在运行过程当中，不可避免的会出现一些错误，比如：使用了没有赋值过的变量，使用了不存在的索引，除 0 等。这些错误在程序中，我们称其为异常。</li>
<li>程序运行过程中，一旦出现异常将会导致程序立即终止，异常以后的代码全部都不会执行！</li>
</ul>
<h4 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h4><ul>
<li><p>程序运行时出现异常，目的并不是让我们的程序直接终止！Python 是希望在出现异常时，我们可以编写代码来对异常进行处理！</p>
</li>
<li><p>try 语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    代码块（可能出现错误的语句）</span><br><span class="line"><span class="keyword">except</span> 异常类型 <span class="keyword">as</span> 异常名:</span><br><span class="line">    代码块（出现错误以后的处理方式）</span><br><span class="line"><span class="keyword">except</span> 异常类型 <span class="keyword">as</span> 异常名:</span><br><span class="line">    代码块（出现错误以后的处理方式）</span><br><span class="line"><span class="keyword">except</span> 异常类型 <span class="keyword">as</span> 异常名:</span><br><span class="line">    代码块（出现错误以后的处理方式）</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    代码块（没出错时要执行的语句）</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    代码块（该代码块总会执行）</span><br></pre></td></tr></table></figure>
</li>
<li><p> try 是必须的，else 语句有没有都行，except 和 finally 至少有一个。</p>
</li>
<li><p>可以将可能出错的代码放入到 try 语句，这样如果代码没有错误，则会正常执行，如果出现错误，则会执行 expect 子句中的代码，这样我们就可以通过代码来处理异常，避免因为一个异常导致整个程序的终止。</p>
</li>
</ul>
<h4 id="异常的传播"><a href="#异常的传播" class="headerlink" title="异常的传播"></a>异常的传播</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello fn&#x27;</span>)</span><br><span class="line">    print(a)</span><br><span class="line">    print(<span class="number">10</span> / <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello fn2&#x27;</span>)</span><br><span class="line">    fn()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn3</span>():</span></span><br><span class="line">    print(<span class="string">&#x27;Hello fn3&#x27;</span>)</span><br><span class="line">    fn2()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fn3()</span><br></pre></td></tr></table></figure>

<ul>
<li>当在函数中出现异常时，如果在函数中对异常进行了处理，则异常不会再继续传播，如果函数中没有对异常进行处理，则异常会继续向函数调用处传播，如果函数调用处处理了异常，则不再传播，如果没有处理则继续向调用处传播，直到传递到全局作用域（主模块），如果依然没有处理，则程序终止，并且显示异常信息。</li>
<li>当程序运行过程中出现异常以后，所有的异常信息会被保存一个专门的异常对象中，而异常传播时，实际上就是异常对象抛给了调用处。比如：<ul>
<li>ZeroDivisionError 类的对象专门用来表示除 0 的异常。</li>
<li>NameError 类的对象专门用来处理变量错误的异常。</li>
</ul>
</li>
<li>在 Python 为我们提供了多个异常对象。</li>
</ul>
<h4 id="异常对象"><a href="#异常对象" class="headerlink" title="异常对象"></a>异常对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;异常出现前&#x27;</span>)</span><br><span class="line">l = []</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># print(c)</span></span><br><span class="line">    <span class="comment"># l[10]</span></span><br><span class="line">    <span class="comment"># 1 + &#x27;hello&#x27;</span></span><br><span class="line">    print(<span class="number">10</span> / <span class="number">0</span>)</span><br><span class="line"><span class="keyword">except</span> NameError:</span><br><span class="line">    <span class="comment"># 如果except后不跟任何的内容，则此时它会捕获到所有的异常</span></span><br><span class="line">    <span class="comment"># 如果在except后跟着一个异常的类型，那么此时它只会捕获该类型的异常</span></span><br><span class="line">    print(<span class="string">&#x27;出现 NameError 异常&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">    print(<span class="string">&#x27;出现 ZeroDivisionError 异常&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> IndexError:</span><br><span class="line">    print(<span class="string">&#x27;出现 IndexError 异常&#x27;</span>)</span><br><span class="line"><span class="comment"># Exception 是所有异常类的父类，所以如果except后跟的是Exception，他也会捕获到所有的异常</span></span><br><span class="line"><span class="comment"># 可以在异常类后边跟着一个 as xx 此时xx就是异常对象</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e: <span class="comment"># 等同于 except:</span></span><br><span class="line">    print(<span class="string">&#x27;未知异常&#x27;</span>, e, <span class="built_in">type</span>(e))</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    print(<span class="string">&#x27;无论是否出现异常，该子句都会执行&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;异常出现后&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="抛出异常"><a href="#抛出异常" class="headerlink" title="抛出异常"></a>抛出异常</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 也可以自定义异常类，只需要创建一个类继承Exception即可</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyError</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="comment"># 如果a和b中有负数，就向调用处抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> a &lt; <span class="number">0</span> <span class="keyword">or</span> b &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># raise用于向外部抛出异常，后边可以跟一个异常类，或异常类的实例</span></span><br><span class="line">        <span class="comment"># raise ExceptioUS20190040060A1-20190207.XMLn</span></span><br><span class="line">        <span class="comment"># 抛出异常的目的，告诉调用者这里调用时出现问题，希望你自己处理一下</span></span><br><span class="line">        <span class="comment"># raise Exception(&#x27;两个参数中不能有负数！&#x27;)</span></span><br><span class="line">        <span class="keyword">raise</span> MyError(<span class="string">&#x27;自定义的异常&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 也可以通过if else来代替异常的处理，但无法考虑到所有可能出异常的条件，难以控制</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(add(<span class="number">-123</span>, <span class="number">456</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li> 可以使用 raise 语句来抛出异常，raise 语句后需要跟一个异常类或异常的实例。</li>
</ul>
<h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><ul>
<li>通过 Python 程序来对计算机中的各种文件进行增删改查的操作。</li>
<li>操作文件的步骤：<ul>
<li>打开文件。</li>
<li>对文件进行各种操作（读、写），然后保存。</li>
<li>关闭文件。</li>
</ul>
</li>
</ul>
<h4 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># open(file, mode=&#x27;r&#x27;, buffering=-1, encoding_=None, errors=None, newline=None, closefd=True, opener=None)</span></span><br><span class="line"><span class="comment"># 使用open函数来打开一个文件</span></span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line"><span class="comment">#   file 要打开的文件的名字（路径）</span></span><br><span class="line"><span class="comment"># 返回值：</span></span><br><span class="line"><span class="comment">#   返回一个对象，这个对象就代表了当前打开的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个变量，来保存文件的名字</span></span><br><span class="line"><span class="comment"># 如果目标文件和当前文件在同一级目录下，则直接使用文件名即可</span></span><br><span class="line">file_name = <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在windows系统使用路径时，可以使用/来代替 \</span></span><br><span class="line"><span class="comment"># 或者可以使用 \\ 来代替 \</span></span><br><span class="line"><span class="comment"># 或者也可以使用原始字符串</span></span><br><span class="line"><span class="comment"># file_name = &#x27;hello\\demo.txt&#x27;</span></span><br><span class="line"><span class="comment"># file_name = r&#x27;hello\demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 表示路径，可以使用..来返回一级目录</span></span><br><span class="line"><span class="comment"># file_name = &#x27;../hello/demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果目标文件距离当前文件比较远，此时可以使用绝对路径</span></span><br><span class="line"><span class="comment"># 绝对路径应该从磁盘的根目录开始书写</span></span><br><span class="line"><span class="comment"># file_name = r&#x27;C:\Users\XiSun\Desktop\hello.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">file_obj = <span class="built_in">open</span>(file_name)  <span class="comment"># 打开 file_name 对应的文件</span></span><br><span class="line">print(file_obj)  <span class="comment"># &lt;_io.TextIOWrapper name=&#x27;demo.txt&#x27; mode=&#x27;r&#x27; encoding=&#x27;cp936&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="关闭文件"><a href="#关闭文件" class="headerlink" title="关闭文件"></a>关闭文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开文件</span></span><br><span class="line">file_name = <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用open()来打开文件</span></span><br><span class="line"><span class="comment"># file_obj = open(file_name)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当我们获取了文件对象以后，所有的对文件的操作都应该通过对象来进行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取文件中的内容：</span></span><br><span class="line"><span class="comment">#   read()方法，用来读取文件中的内容，它会将内容全部保存为一个字符串返回</span></span><br><span class="line"><span class="comment"># content = file_obj.read()</span></span><br><span class="line"><span class="comment"># print(content)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭文件：</span></span><br><span class="line"><span class="comment">#   调用close()方法来关闭文件</span></span><br><span class="line"><span class="comment"># file_obj.close()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面的open()和close()是常规写法，可以用下面的方式简化操作</span></span><br><span class="line"><span class="comment"># with ... as 语句：</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_name) <span class="keyword">as</span> file_obj:</span><br><span class="line">    <span class="comment"># 在with语句中可以直接使用file_obj来做文件操作</span></span><br><span class="line">    <span class="comment"># 此时这个文件只能在with中使用，一旦with结束则文件会自动close()</span></span><br><span class="line">    print(file_obj.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进一步完善，添加文件读取异常处理</span></span><br><span class="line"><span class="comment"># 文件处理的标准格式：</span></span><br><span class="line">file_name = <span class="string">&#x27;hello.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name) <span class="keyword">as</span> file_obj:</span><br><span class="line">        print(file_obj.read())</span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;file_name&#125;</span> 文件不存在~~&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">file_name = <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># 调用open()来打开一个文件，可以将文件分成两种类型</span></span><br><span class="line">    <span class="comment"># 一种，是纯文本文件（使用utf-8等编码编写的文本文件）</span></span><br><span class="line">    <span class="comment"># 一种，是二进制文件（图片、mp3、ppt等这些文件）</span></span><br><span class="line">    <span class="comment"># open()打开文件时，默认是以文本文件的形式打开的，但是open()默认的编码为None</span></span><br><span class="line">    <span class="comment">#   所以处理文本文件时，必须要指定文件的编码</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">        <span class="comment"># 通过 read() 来读取文件中的内容</span></span><br><span class="line">        <span class="comment"># 如果直接调用read()它会将文本文件的所有内容全部都读取出来</span></span><br><span class="line">        <span class="comment">#   如果要读取的文件较大的话，会一次性将文件的内容加载到内存中，容易导致内存泄漏</span></span><br><span class="line">        <span class="comment">#   所以对于较大的文件，不要直接调用read()</span></span><br><span class="line">        <span class="comment"># help(file_obj.read)查看帮助信息</span></span><br><span class="line">        <span class="comment"># read()可以接收一个size作为参数，该参数用来指定要读取的字符的数量</span></span><br><span class="line">        <span class="comment">#   默认值为-1，它会读取文件中的所有字符</span></span><br><span class="line">        <span class="comment">#   可以为size指定一个值，这样read()会读取指定数量的字符，</span></span><br><span class="line">        <span class="comment">#       每一次读取都是从上次读取到位置开始读取的</span></span><br><span class="line">        <span class="comment">#       如果字符的数量小于size，则会读取剩余所有的</span></span><br><span class="line">        <span class="comment">#       如果已经读取到了文件的最后了，则会返回&#x27;&#x27;空串</span></span><br><span class="line">        <span class="comment"># content = file_obj.read(-1)</span></span><br><span class="line">        content = file_obj.read(<span class="number">6</span>)</span><br><span class="line">        content = file_obj.read(<span class="number">6</span>)</span><br><span class="line">        content = file_obj.read(<span class="number">6</span>)</span><br><span class="line">        content = file_obj.read(<span class="number">6</span>)</span><br><span class="line">        <span class="comment"># print(content)</span></span><br><span class="line">        <span class="comment"># print(len(content))</span></span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;file_name&#125;</span> 这个文件不存在！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取大文件的方式</span></span><br><span class="line">file_name = <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">        <span class="comment"># 定义一个变量，来保存文件的内容</span></span><br><span class="line">        file_content = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># 定义一个变量，来指定每次读取的大小</span></span><br><span class="line">        chunk = <span class="number">100</span></span><br><span class="line">        <span class="comment"># 创建一个循环来读取文件内容</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 读取chunk大小的内容</span></span><br><span class="line">            content = file_obj.read(chunk)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 检查是否读取到了内容</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> content:</span><br><span class="line">                <span class="comment"># 内容读取完毕，退出循环</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 输出内容</span></span><br><span class="line">            <span class="comment"># print(content, end=&#x27;&#x27;)</span></span><br><span class="line">            file_content += content</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;file_name&#125;</span> 这个文件不存在！&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(file_content)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">file_name = <span class="string">&#x27;demo.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">        <span class="comment"># readline()：</span></span><br><span class="line">        <span class="comment">#   该方法可以用来读取一行内容</span></span><br><span class="line">        <span class="comment"># print(file_obj.readline(), end=&#x27;&#x27;)  # print()打印自带换行符</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># readlines()：</span></span><br><span class="line">        <span class="comment">#   该方法用于一行一行的读取内容，它会一次性将读取到的内容封装到一个列表中返回</span></span><br><span class="line">        <span class="comment"># r = file_obj.readlines()</span></span><br><span class="line">        <span class="comment"># pprint.pprint(r[0])  # &#x27;aaa\n&#x27;</span></span><br><span class="line">        <span class="comment"># pprint.pprint(r[1])  # &#x27;bbb\n&#x27;</span></span><br><span class="line">        <span class="comment"># pprint.pprint(r[2])  # &#x27;ccc\n&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 简化写法</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> file_obj:</span><br><span class="line">            print(t, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    print(<span class="string">f&#x27;<span class="subst">&#123;file_name&#125;</span> 这个文件不存在！&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">file_name = <span class="string">&#x27;demo1.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用open()打开文件时必须要指定打开文件所要做的操作：读、写、追加</span></span><br><span class="line"><span class="comment">#   如果不指定操作类型，则默认是 `读取文件` ，而读取文件时是不能向文件中写入的</span></span><br><span class="line"><span class="comment"># r：表示只读的</span></span><br><span class="line"><span class="comment"># w：表示是可写的，使用w来写入文件时，如果文件不存在会创建文件，如果文件存在则会截断文件</span></span><br><span class="line"><span class="comment">#       截断文件指删除原来文件中的所有内容（覆盖原文件内容）</span></span><br><span class="line"><span class="comment"># a：表示追加内容，如果文件不存在会创建文件，如果文件存在则会向文件中追加内容</span></span><br><span class="line"><span class="comment"># x：用来新建文件，如果文件不存在则创建，存在则报错</span></span><br><span class="line"><span class="comment"># +：为操作符增加功能</span></span><br><span class="line"><span class="comment">#   r+：即可读又可写，文件不存在会报错</span></span><br><span class="line"><span class="comment">#   w+：即可写又可读</span></span><br><span class="line"><span class="comment">#   a+：即可追加又可读</span></span><br><span class="line"><span class="comment"># with open(file_name , &#x27;w&#x27; , encoding=&#x27;utf-8&#x27;) as file_obj:</span></span><br><span class="line"><span class="comment"># with open(file_name , &#x27;r+&#x27; , encoding=&#x27;utf-8&#x27;) as file_obj:</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&#x27;x&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">    <span class="comment"># write()来向文件中写入内容</span></span><br><span class="line">    <span class="comment"># 如果操作的是一个文本文件的话，则write()需要传递一个字符串作为参数</span></span><br><span class="line">    <span class="comment"># 该方法会可以分多次向文件中写入内容</span></span><br><span class="line">    <span class="comment"># 写入完成以后，该方法会返回写入的字符的个数</span></span><br><span class="line">    file_obj.write(<span class="string">&#x27;aaa\n&#x27;</span>)</span><br><span class="line">    file_obj.write(<span class="string">&#x27;bbb\n&#x27;</span>)</span><br><span class="line">    file_obj.write(<span class="string">&#x27;ccc\n&#x27;</span>)</span><br><span class="line">    file_obj.write(<span class="built_in">str</span>(<span class="number">123</span>) + <span class="string">&#x27;123123\n&#x27;</span>)  <span class="comment"># 要转换为字符串，且不会自动换行</span></span><br><span class="line">    r = file_obj.write(<span class="string">&#x27;今天天气真不错&#x27;</span>)</span><br><span class="line">    print(r)  <span class="comment"># 7</span></span><br></pre></td></tr></table></figure>

<h4 id="二进制文件操作"><a href="#二进制文件操作" class="headerlink" title="二进制文件操作"></a>二进制文件操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">file_name = <span class="string">&#x27;F:/QQMusic/FLOW - Go!!!.flac&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取模式：</span></span><br><span class="line"><span class="comment">#   t：读取文本文件（默认值）</span></span><br><span class="line"><span class="comment">#   b：读取二进制文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">    <span class="comment"># 读取文本文件时，size是以字符为单位的</span></span><br><span class="line">    <span class="comment"># 读取二进制文件时，size是以字节为单位</span></span><br><span class="line">    <span class="comment"># print(file_obj.read(100))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将读取到的内容写出来</span></span><br><span class="line">    <span class="comment"># 定义一个新的文件</span></span><br><span class="line">    new_name = <span class="string">&#x27;aa.flac&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(new_name, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> new_obj:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义每次读取的大小</span></span><br><span class="line">        chunk = <span class="number">1024</span> * <span class="number">100</span>  <span class="comment"># 100 KB</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 从已有的对象中读取数据</span></span><br><span class="line">            content = file_obj.read(chunk)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 内容读取完毕，终止循环</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> content:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 将读取到的数据写入到新对象中</span></span><br><span class="line">            new_obj.write(content)</span><br></pre></td></tr></table></figure>

<h4 id="seek-和-tell"><a href="#seek-和-tell" class="headerlink" title="seek() 和 tell()"></a><code>seek()</code> 和 <code>tell()</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二进制文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">    <span class="comment"># print(file_obj.read(30))</span></span><br><span class="line">    <span class="comment"># print(file_obj.read(100))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># tell()方法用来查看当前读取的位置</span></span><br><span class="line">    print(<span class="string">&#x27;当前读取到了 --&gt;&#x27;</span>, file_obj.tell())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># seek()方法可以修改当前读取的位置</span></span><br><span class="line">    <span class="comment"># seek()需要两个参数：</span></span><br><span class="line">    <span class="comment">#   第一个：要切换到的位置</span></span><br><span class="line">    <span class="comment">#   第二个：计算位置的方式</span></span><br><span class="line">    <span class="comment">#       可选值：</span></span><br><span class="line">    <span class="comment">#           0 从头计算，默认值</span></span><br><span class="line">    <span class="comment">#           1 从当前位置计算</span></span><br><span class="line">    <span class="comment">#           2 从最后位置开始计算</span></span><br><span class="line">    <span class="comment"># file_obj.seek(55)</span></span><br><span class="line">    <span class="comment"># file_obj.seek(80, 0)</span></span><br><span class="line">    <span class="comment"># file_obj.seek(70, 1)</span></span><br><span class="line">    file_obj.seek(<span class="number">-10</span>, <span class="number">2</span>)  <span class="comment"># 从文件的最后往前读10个字符</span></span><br><span class="line">    print(file_obj.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文本文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.txt&#x27;</span>, <span class="string">&#x27;rt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">    print(<span class="string">&#x27;当前读取到了 --&gt;&#x27;</span>, file_obj.tell())</span><br><span class="line"></span><br><span class="line">    file_obj.seek(<span class="number">9</span>)  <span class="comment"># 从头开始计算，切换到第9个字节开始读取</span></span><br><span class="line">    print(file_obj.read())</span><br></pre></td></tr></table></figure>

<h4 id="文件的其他操作"><a href="#文件的其他操作" class="headerlink" title="文件的其他操作"></a>文件的其他操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.listdir()：获取指定目录的目录结构</span></span><br><span class="line"><span class="comment">#   需要一个路径作为参数，会获取到该路径下的目录结构，默认路径为 . ，即当前目录</span></span><br><span class="line"><span class="comment">#   该方法会返回一个列表，目录中的每一个文件（夹）的名字都是列表中的一个元素</span></span><br><span class="line">r = os.listdir()</span><br><span class="line">pprint(r)  <span class="comment"># [&#x27;.idea&#x27;, &#x27;aa.flac&#x27;, &#x27;demo.txt&#x27;, &#x27;hello&#x27;, &#x27;main.py&#x27;, &#x27;__pycache__&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.getcwd()：获取当前所在的目录</span></span><br><span class="line">r = os.getcwd()</span><br><span class="line">pprint(r)  <span class="comment"># &#x27;D:\\JetBrainsWorkSpace\\PycharmProjects&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.chdir()：切换当前所在的目录 作用相当于cd命令</span></span><br><span class="line"><span class="comment"># os.chdir(&#x27;c:/&#x27;)</span></span><br><span class="line"><span class="comment"># r = os.getcwd()</span></span><br><span class="line"><span class="comment"># pprint(r)  # &#x27;c:\\&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.mkdir()；创建目录</span></span><br><span class="line">os.mkdir(<span class="string">&quot;aaa&quot;</span>)  <span class="comment"># 在当前目录下创建一个名字为 aaa 的目录，如果已存在，则报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># os.rmdir()：删除目录</span></span><br><span class="line">os.rmdir(<span class="string">&#x27;aaa&#x27;</span>)  <span class="comment"># 在当前目录下删除一个名字为 aaa 的目录，如果不存在，则报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># open()；打开文件</span></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;aa.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.remove()：删除文件</span></span><br><span class="line">os.remove(<span class="string">&#x27;aa.flac&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.rename(&#x27;旧名字&#x27;,&#x27;新名字&#x27;)：可以对一个文件进行重命名，也可以用来移动一个文件</span></span><br><span class="line">os.rename(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;bb.txt&#x27;</span>)</span><br><span class="line"><span class="comment"># os.rename(&#x27;bb.txt&#x27;, &#x27;c:/users/lilichao/desktop/bb.txt&#x27;)</span></span><br><span class="line"></span><br><span class="line">pprint(r)</span><br></pre></td></tr></table></figure>

<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1016959663602400">https://www.liaoxuefeng.com/wiki/1016959663602400</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1hW41197sB?from=search&amp;seid=1852797992981366365&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1hW41197sB?from=search&amp;seid=1852797992981366365&amp;spm_id_from=333.337.0.0</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/26/linux-virtualmachine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/26/linux-virtualmachine/" class="post-title-link" itemprop="url">虚拟机安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-26 11:14:14" itemprop="dateCreated datePublished" datetime="2021-08-26T11:14:14+08:00">2021-08-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-31 10:21:11" itemprop="dateModified" datetime="2021-08-31T10:21:11+08:00">2021-08-31</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="VMware-安装"><a href="#VMware-安装" class="headerlink" title="VMware 安装"></a>VMware 安装</h2><ul>
<li><p>下载地址：<a target="_blank" rel="noopener" href="https://my.vmware.com/cn/web/vmware/downloads">https://my.vmware.com/cn/web/vmware/downloads</a></p>
</li>
<li><p>下载版本：VMware Workstation Pro</p>
</li>
<li><p>VMware 15 秘钥：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/liuqun/p/11737327.html">https://www.cnblogs.com/liuqun/p/11737327.html</a></p>
</li>
<li><p>Vmware 创建新的虚拟机，首先配置硬件清单，重要步骤如下：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826132716290.png" alt="image-20210826132716290"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826132815834.png" alt="image-20210826132815834"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826133045467.png" alt="image-20210826133045467"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826133304018.png" alt="image-20210826133304018"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826153752970.png" alt="image-20210826153752970"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826153909369.png" alt="image-20210826153909369"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826154006619.png" alt="image-20210826154006619"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826155036506.png" alt="image-20210826155036506"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826155217418.png" alt="image-20210826155217418"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826155358396.png" alt="image-20210826155358396"></p>
</li>
</ul>
<h2 id="CentOS-安装"><a href="#CentOS-安装" class="headerlink" title="CentOS 安装"></a>CentOS 安装</h2><ul>
<li><p>准备工作，检查 BIOS 虚拟化支持：</p>
<ul>
<li><p>打开任务管理器，进入性能，查看虚拟化是否启用。</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826114631117.png" alt="image-20210826114631117"></p>
</li>
<li><p>若虚拟化未启用，重启电脑，F2 进入 BIOS 模式（不同主板快捷键不同），进入高级模式页面，Advanced —&gt; CPU Configuration，开启虚拟化支持。</p>
</li>
</ul>
</li>
<li><p>下载地址：<a target="_blank" rel="noopener" href="https://developer.aliyun.com/mirror/centos?spm=a2c6h.13651102.0.0.3e221b11se5c1r">https://developer.aliyun.com/mirror/centos?spm=a2c6h.13651102.0.0.3e221b11se5c1r</a></p>
</li>
<li><p>下载版本：dvd 标准安装版。</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210826132225940.png" alt="image-20210826132225940"></p>
</li>
<li><p>安装参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44714603/article/details/88829423">https://blog.csdn.net/qq_44714603/article/details/88829423</a></p>
</li>
<li><p>Vmware 配置 CentOS 软件，即，向虚拟机插入系统盘：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828143341232.png" alt="image-20210828143341232"></p>
</li>
<li><p>开启虚拟机，安装系统盘并配置：</p>
<ul>
<li><p>语言环境：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828143835803.png" alt="image-20210828143835803"></p>
</li>
<li><p>日期和时间：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828144044232.png" alt="image-20210828144044232"></p>
</li>
<li><p>软件选择：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828144401900.png" alt="image-20210828144401900"></p>
</li>
<li><p>安装位置，自定义磁盘分区，配置 boot，swap 和根目录：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828230742891.png" alt="image-20210828230742891"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828145303732.png" alt="image-20210828145303732"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828145447647.png" alt="image-20210828145447647"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828145847360.png" alt="image-20210828145847360"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828230512829.png" alt="image-20210828230512829"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828231006455.png" alt="image-20210828231006455"></p>
</li>
<li><p>禁用 kdump 设置，如果是正式开发阶段，应该启用 kdump 设置：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828231358785.png" alt="image-20210828231358785"></p>
</li>
<li><p>网络和主机名：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828232134005.png" alt="image-20210828232134005"></p>
</li>
<li><p>安全策略：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828232312406.png" alt="image-20210828232312406"></p>
</li>
<li><p>等上面配置完成之后，开始安装系统盘：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828232519213.png" alt="image-20210828232519213"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828232922462.png" alt="image-20210828232922462"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234105781.png" alt="image-20210828234105781"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234207374.png" alt="image-20210828234207374"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234408166.png" alt="image-20210828234408166"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234514646.png" alt="image-20210828234514646"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234649230.png" alt="image-20210828234649230"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234747576.png" alt="image-20210828234747576"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234839063.png" alt="image-20210828234839063"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828234935663.png" alt="image-20210828234935663"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828235029894.png" alt="image-20210828235029894"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828235204876.png" alt="image-20210828235204876"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828235429417.png" alt="image-20210828235429417"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210828235642980.png" alt="image-20210828235642980"></p>
</li>
</ul>
</li>
</ul>
<h2 id="配置-IP-地址和主机名称"><a href="#配置-IP-地址和主机名称" class="headerlink" title="配置 IP 地址和主机名称"></a>配置 IP 地址和主机名称</h2><ul>
<li><p>VMware：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829220432882.png" alt="image-20210829220432882"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829220525207.png" alt="image-20210829220525207"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829220827200.png" alt="image-20210829220827200"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829221133759.png" alt="image-20210829221133759"></p>
</li>
<li><p>Window 10（即本机）：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829221518857.png" alt="image-20210829221518857"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829221544041.png" alt="image-20210829221544041"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829221730077.png" alt="image-20210829221730077"></p>
<blockquote>
<p>如果没有出现 VMnet 8 选项，回到 VMware 的虚拟网络编辑器，点击“更改设置” —&gt; “还原默认设置”，即可。</p>
</blockquote>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829221917341.png" alt="image-20210829221917341"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829222140699.png" alt="image-20210829222140699"></p>
</li>
<li><p>虚拟机：</p>
<ul>
<li><p>切换 root 用户：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  [xisun@centos7 ~]$ su root</span><br><span class="line">  密码：</span><br><span class="line">  [root@centos7 xisun]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line">- 设置虚拟机 IP 地址：</span><br><span class="line"></span><br><span class="line">  ```sh</span><br><span class="line">  [root@centos7 xisun]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>ifcfg-ens33 文件原内容：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TYPE=&quot;Ethernet&quot;</span><br><span class="line">PROXY_METHOD=&quot;none&quot;</span><br><span class="line">BROWSER_ONLY=&quot;no&quot;</span><br><span class="line">BOOTPROTO=&quot;dhcp&quot;		# 动态获取IP地址，服务器每次开机时，IP地址可能发生改变</span><br><span class="line">DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV4_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6INIT=&quot;yes&quot;</span><br><span class="line">IPV6_AUTOCONF=&quot;yes&quot;</span><br><span class="line">IPV6_DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV6_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6_ADDR_GEN_MODE=&quot;stable-privacy&quot;</span><br><span class="line">NAME=&quot;ens33&quot;</span><br><span class="line">UUID=&quot;eb503f88-96af-455d-b8f9-dbda02ca79d4&quot;</span><br><span class="line">DEVICE=&quot;ens33&quot;</span><br><span class="line">ONBOOT=&quot;yes&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ifcfg-ens33 文件新内容：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">TYPE=&quot;Ethernet&quot;</span><br><span class="line">PROXY_METHOD=&quot;none&quot;</span><br><span class="line">BROWSER_ONLY=&quot;no&quot;</span><br><span class="line">BOOTPROTO=&quot;static&quot;			# 修改为静态IP地址</span><br><span class="line">DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV4_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6INIT=&quot;yes&quot;</span><br><span class="line">IPV6_AUTOCONF=&quot;yes&quot;</span><br><span class="line">IPV6_DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV6_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6_ADDR_GEN_MODE=&quot;stable-privacy&quot;</span><br><span class="line">NAME=&quot;ens33&quot;</span><br><span class="line">UUID=&quot;eb503f88-96af-455d-b8f9-dbda02ca79d4&quot;</span><br><span class="line">DEVICE=&quot;ens33&quot;</span><br><span class="line">ONBOOT=&quot;yes&quot;</span><br><span class="line"></span><br><span class="line"># 新增</span><br><span class="line">IPADDR=192.168.10.99		# 静态IP地址，按需自定义</span><br><span class="line">GATEWAY=192.168.10.2		# 网关</span><br><span class="line">DNS1=192.168.10.2			# 域名解析器</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改虚拟机的主机名称：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 xisun]<span class="comment"># vim /etc/hostname</span></span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">centos7				# 主机名称按需求自定义</span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改虚拟机主机的名称映射：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 xisun]<span class="comment"># vim /etc/hosts</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>原文件内容：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br></pre></td></tr></table></figure>
</li>
<li><p>新内容：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"></span><br><span class="line"># 按需求添加主机名称映射</span><br><span class="line">192.168.10.99 centos7</span><br><span class="line">192.168.10.100 hadoop100</span><br><span class="line">192.168.10.101 hadoop101</span><br><span class="line">192.168.10.102 hadoop102</span><br><span class="line">192.168.10.103 hadoop103</span><br><span class="line">192.168.10.104 hadoop104</span><br><span class="line">192.168.10.105 hadoop105</span><br><span class="line">192.168.10.106 hadoop106</span><br><span class="line">192.168.10.107 hadoop107</span><br><span class="line">192.168.10.108 hadoop108</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改 Windows 10 主机的名称映射：<code>C:\Windows\System32\drivers\etc\hosts</code></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829232429026.png" alt="image-20210829232429026"></p>
<ul>
<li><p>如果操作系统是 Window7，可以直接修改 hosts 文件；如果操作系统是 Window10，需要先将 hosts 文件拷贝出来，修改保存以后，再覆盖原文件即可。</p>
</li>
<li><p>hosts 文件新增如下主机映射：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">192.168.10.99 centos7</span><br><span class="line">192.168.10.100 hadoop100</span><br><span class="line">192.168.10.101 hadoop101</span><br><span class="line">192.168.10.102 hadoop102</span><br><span class="line">192.168.10.103 hadoop103</span><br><span class="line">192.168.10.104 hadoop104</span><br><span class="line">192.168.10.105 hadoop105</span><br><span class="line">192.168.10.106 hadoop106</span><br><span class="line">192.168.10.107 hadoop107</span><br><span class="line">192.168.10.108 hadoop108</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>重启：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 xisun]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>重启之后，以 root 用户重新登陆。</p>
<ul>
<li><p>验证虚拟机 IP 地址：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]<span class="comment"># ifconfig</span></span><br><span class="line">ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.10.99  netmask 255.255.255.0  broadcast 192.168.10.255</span><br><span class="line">        inet6 fe80::ac1e:7fe1:a566:2670  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:1c:d5:13  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 2033  bytes 2797234 (2.6 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 924  bytes 61834 (60.3 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 48  bytes 4080 (3.9 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 48  bytes 4080 (3.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255</span><br><span class="line">        ether 52:54:00:97:ed:a7  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证是否能连通外网：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]<span class="comment"># ping www.baidu.com </span></span><br><span class="line">PING www.a.shifen.com (14.215.177.39) 56(84) bytes of data.</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=1 ttl=128 time=38.4 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=2 ttl=128 time=38.6 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=3 ttl=128 time=38.4 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=4 ttl=128 time=39.3 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=5 ttl=128 time=38.3 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=6 ttl=128 time=38.6 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=7 ttl=128 time=38.3 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=8 ttl=128 time=38.4 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=9 ttl=128 time=38.9 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=10 ttl=128 time=38.3 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=11 ttl=128 time=38.7 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=12 ttl=128 time=38.3 ms</span><br><span class="line">^C</span><br><span class="line">--- www.a.shifen.com ping statistics ---</span><br><span class="line">12 packets transmitted, 12 received, 0% packet loss, time 11035ms</span><br><span class="line">rtt min/avg/max/mdev = 38.357/38.606/39.328/0.332 ms</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看主机地址：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]<span class="comment"># hostname</span></span><br><span class="line">centos7</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Xshell-远程连接虚拟机"><a href="#Xshell-远程连接虚拟机" class="headerlink" title="Xshell 远程连接虚拟机"></a>Xshell 远程连接虚拟机</h2><ul>
<li><p>安装过程略。</p>
</li>
<li><p>远程连接配置：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829231009322.png" alt="image-20210829231009322"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829231122803.png" alt="image-20210829231122803"></p>
</li>
<li><p>连接成功：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210829231402711.png" alt="image-20210829231402711"></p>
</li>
<li><p>数据传输：安装 Xftp 工具，或者使用 <code>rz</code> 和 <code>sz</code> 命令。</p>
</li>
</ul>
<h2 id="克隆虚拟机"><a href="#克隆虚拟机" class="headerlink" title="克隆虚拟机"></a>克隆虚拟机</h2><ul>
<li><p>新配置的 centos7 虚拟机，可以作为一个纯净的虚拟机，在此基础上，克隆出新的虚拟机，在新虚拟机上安装软件，而纯净的虚拟机留作备用。</p>
</li>
<li><p>克隆虚拟机之前，需要正确的关闭虚拟机：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830151900185.png" alt="image-20210830151900185"></p>
</li>
<li><p>克隆：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830152407112.png" alt="image-20210830152407112"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830152532017.png" alt="image-20210830152532017"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830153137306.png" alt="image-20210830153137306"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830153347287.png" alt="image-20210830153347287"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830153523350.png" alt="image-20210830153523350"></p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830154101255.png" alt="image-20210830154101255"></p>
</li>
<li><p>常规操作：</p>
<ul>
<li><p>移除，此操作只会在 VMware 列表中移除虚拟机，但不会删除磁盘上的虚拟机：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830154158479.png" alt="image-20210830154158479"></p>
</li>
<li><p>添加，通过打开操作，可以添加磁盘上的虚拟机到 VMware 列表中：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830154443435.png" alt="image-20210830154443435"></p>
</li>
<li><p>删除，此操作会将磁盘上的虚拟机删除：</p>
<p><img src="/2021/08/26/linux-virtualmachine/image-20210830154727908.png" alt="image-20210830154727908"></p>
</li>
</ul>
</li>
</ul>
<h2 id="修改克隆机的-IP-地址和主机名称"><a href="#修改克隆机的-IP-地址和主机名称" class="headerlink" title="修改克隆机的 IP 地址和主机名称"></a>修改克隆机的 IP 地址和主机名称</h2><ul>
<li><p>克隆机的信息，和被克隆机相同，需要修改 IP 地址，以及主机名称。</p>
</li>
<li><p>开启克隆机，以 root 用户登录。</p>
</li>
<li><p>修改 IP 地址：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改 ifcfg-ens33 文件中的 IPADDR：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">TYPE=&quot;Ethernet&quot;</span><br><span class="line">PROXY_METHOD=&quot;none&quot;</span><br><span class="line">BROWSER_ONLY=&quot;no&quot;</span><br><span class="line">BOOTPROTO=&quot;static&quot;</span><br><span class="line">DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV4_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6INIT=&quot;yes&quot;</span><br><span class="line">IPV6_AUTOCONF=&quot;yes&quot;</span><br><span class="line">IPV6_DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV6_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6_ADDR_GEN_MODE=&quot;stable-privacy&quot;</span><br><span class="line">NAME=&quot;ens33&quot;</span><br><span class="line">UUID=&quot;eb503f88-96af-455d-b8f9-dbda02ca79d4&quot;</span><br><span class="line">DEVICE=&quot;ens33&quot;</span><br><span class="line">ONBOOT=&quot;yes&quot;</span><br><span class="line"></span><br><span class="line">IPADDR=192.168.10.100		# 只需要将IP地址按需修改即可</span><br><span class="line">GATEWAY=192.168.10.2</span><br><span class="line">DNS1=192.168.10.2</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改主机名称：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]<span class="comment"># vim /etc/hostname</span></span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop100</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看新的 IP 地址和主机名称：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># ifconfig</span></span><br><span class="line">ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.10.100  netmask 255.255.255.0  broadcast 192.168.10.255</span><br><span class="line">        inet6 fe80::ac1e:7fe1:a566:2670  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:1d:f8:56  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 604  bytes 804811 (785.9 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 279  bytes 21418 (20.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 48  bytes 4080 (3.9 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 48  bytes 4080 (3.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255</span><br><span class="line">        ether 52:54:00:97:ed:a7  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@hadoop100 ~]<span class="comment"># hostname</span></span><br><span class="line">hadoop100</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="JDK-说明"><a href="#JDK-说明" class="headerlink" title="JDK 说明"></a>JDK 说明</h2><ul>
<li><p>安装的 centos7 模板机，有自带的 JDK，某些情况，需要删除，按照需求自行安装。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@centos7 ~]$ su root</span><br><span class="line">密码：</span><br><span class="line">[root@centos7 ~]<span class="comment"># rpm -qa | grep -i java</span></span><br><span class="line">javapackages-tools-3.4.1-11.el7.noarch</span><br><span class="line">tzdata-java-2019c-1.el7.noarch</span><br><span class="line">java-1.8.0-openjdk-headless-1.8.0.242.b08-1.el7.x86_64</span><br><span class="line">java-1.8.0-openjdk-1.8.0.242.b08-1.el7.x86_64</span><br><span class="line">java-1.7.0-openjdk-headless-1.7.0.251-2.6.21.1.el7.x86_64</span><br><span class="line">python-javapackages-3.4.1-11.el7.noarch</span><br><span class="line">java-1.7.0-openjdk-1.7.0.251-2.6.21.1.el7.x86_64</span><br><span class="line">[root@centos7 ~]<span class="comment"># rpm -qa | grep -i java | xargs -n1 rpm -e --nodeps</span></span><br><span class="line">[root@centos7 ~]<span class="comment"># rpm -qa | grep -i java</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Qp4y1n7EN">https://www.bilibili.com/video/BV1Qp4y1n7EN</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/25/hadoop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/25/hadoop/" class="post-title-link" itemprop="url">Hadoop 入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-25 15:53:38" itemprop="dateCreated datePublished" datetime="2021-08-25T15:53:38+08:00">2021-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-12 10:55:26" itemprop="dateModified" datetime="2022-01-12T10:55:26+08:00">2022-01-12</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>168k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2:33</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="大数据"><a href="#大数据" class="headerlink" title="大数据"></a>大数据</h2><h3 id="大数据概念"><a href="#大数据概念" class="headerlink" title="大数据概念"></a>大数据概念</h3><ul>
<li>大数据（Big Data）：指无法在一定时间范围内用常规软件工具进行捕捉、管理和处理的数据集合，是需要新处理模式才能具有更强的决策力、洞察发现力和流程优化能力的海量、高增长率和多样化的信息资产。</li>
<li><strong>大数据主要解决，海量数据的采集、存储和分析计算问题。</strong></li>
<li>按顺序给出数据存储单位：bit、Byte、KB、MB、GB、TB、PB、EB、ZB、YB、BB、NB、DB。<ul>
<li><code>1 Byte = 8 bit</code>，<code>1 KB = 1024 Byte</code>，<code>1 MB = 1024 KB</code>，<code>1 GB = 1024 MB</code>，<code>1 TB = 1024 GB</code>，<code>1 PB= 1024 TB</code></li>
</ul>
</li>
</ul>
<h3 id="大数据特点"><a href="#大数据特点" class="headerlink" title="大数据特点"></a>大数据特点</h3><ul>
<li>Volume（大量）<ul>
<li>截至目前，人类生产的所有印刷材料的数据量是 200 PB，而历史上全人类总共说过的话的数据量大约是 5 EB。当前，典型个人计算机硬盘的容量为 TB 量级，而一些大企业的数据量已经接近 EB 量级。</li>
</ul>
</li>
<li>Velocity（高速）<ul>
<li>这是大数据区分于传统数据挖掘的最显著特征。根据 IDC 的“数字宇宙”的报告，预计到 2025 年，全球数据使用量将达到 163 ZB。在如此海量的数据面前，处理数据的效率就是企业的生命。</li>
<li>天猫双十一：2017 年，3 分 01 秒，天猫交易额超过 100 亿；2020 年，96 秒，天猫交易额超过 100 亿。</li>
</ul>
</li>
<li>Variety（多样）<ul>
<li>这种类型的多样性也让数据被分为结构化数据和非结构化数据。相对于以往便于存储的以数据库/文本为主的结构化数据，非结构化数据越来越多，包括网络日志、音频、视频、图片、地理位置信息等，这些多类型的数据对数据的处理能力提出了更高要求。</li>
</ul>
</li>
<li>Value（低价值密度）<ul>
<li>价值密度的高低与数据总量的大小成反比。比如，在一天的监控视频中，我们只关心宋老师晚上在床上健身那一分钟，如何快速对有价值数据“提纯”，成为目前大数据背景下待解决的难题。</li>
</ul>
</li>
</ul>
<h2 id="Hadoop-概述"><a href="#Hadoop-概述" class="headerlink" title="Hadoop 概述"></a>Hadoop 概述</h2><h3 id="Hadoop-是什么"><a href="#Hadoop-是什么" class="headerlink" title="Hadoop 是什么"></a>Hadoop 是什么</h3><ul>
<li><p>Hadoop 是一个由 Apache 基金会所开发的<strong>分布式系统基础架构</strong>。</p>
</li>
<li><p><strong>主要解决，海量数据的存储和海量数据的分析计算问题。</strong></p>
</li>
<li><p>广义上来说，Hadoop 通常是指一个更广泛的概念 — Hadoop 生态圈。</p>
<p><img src="/2021/08/25/hadoop/image-20210825170020065.png" alt="image-20210825170020065"></p>
</li>
</ul>
<h3 id="Hadoop-发展历史"><a href="#Hadoop-发展历史" class="headerlink" title="Hadoop 发展历史"></a>Hadoop 发展历史</h3><ul>
<li><p>Hadoop 创始人 Doug Cutting，为了实现与 Google 类似的全文搜索功能，他在 Lucene 框架基础上进行优化升级，查询引擎和索引引擎。</p>
</li>
<li><p>2001 年年底，Lucene 成为 Apache 基金会的一个子项目。</p>
</li>
<li><p>对于海量数据的场景，Lucene 框架面对与 Google 同样的困难，存储海量数据困难，检索海量速度慢。</p>
</li>
<li><p>学习和模仿 Google 解决这些问题的办法：微型版 Nutch。</p>
</li>
<li><p>可以说 Google 是 Hadoop 的思想之源（Google 在大数据方面的三篇论文）：</p>
<ul>
<li>GFS —&gt; HDFS</li>
<li>MapReduce —&gt; MR</li>
<li>BigTable —&gt; HBase</li>
</ul>
</li>
<li><p>2003 - 2004 年，Google 公开了部分 GFS 和 MapReduce 思想的细节，以此为基础，Doug Cutting 等人用了 2 年业余时间实现了 DFS 和 MapReduce 机制，使 Nutch 性能飙升。</p>
</li>
<li><p>2005 年，Hadoop 作为 Lucene 的子项目 Nutch 的一部分正式引入 Apache 基金会。</p>
</li>
<li><p>2006 年 3 月份，MapReduce 和 Nutch Distributed File System（NDFS）分别被纳入到 Hadoop 项目中，Hadoop 就此正式诞生，标志着大数据时代来临。</p>
</li>
<li><p>名字来源于 Doug Cutting 儿子的玩具大象：</p>
<p><img src="/2021/08/25/hadoop/image-20210825170536329.png" alt="image-20210825170536329"></p>
</li>
</ul>
<h3 id="Hadoop-三大发行版本"><a href="#Hadoop-三大发行版本" class="headerlink" title="Hadoop 三大发行版本"></a>Hadoop 三大发行版本</h3><ul>
<li>Hadoop 三大发行版本：Apache、Cloudera、Hortonworks。</li>
<li>Apache 版本是最原始（最基础）的版本，对于入门学习最好。— 2006 年</li>
<li>Cloudera 内部集成了很多大数据框架，对应产品 CDH。— 2008 年</li>
<li>Hortonworks 文档较好，对应产品 HDP。— 2011 年<ul>
<li>Hortonworks 现在已经被 Cloudera 公司收购，推出新的品牌 CDP。</li>
</ul>
</li>
</ul>
<h4 id="Apache-Hadoop"><a href="#Apache-Hadoop" class="headerlink" title="Apache Hadoop"></a>Apache Hadoop</h4><ul>
<li>官网地址：<a target="_blank" rel="noopener" href="http://hadoop.apache.org/">http://hadoop.apache.org</a></li>
<li>下载地址：<a target="_blank" rel="noopener" href="https://hadoop.apache.org/releases.html">https://hadoop.apache.org/releases.html</a></li>
</ul>
<h4 id="Cloudera-Hadoop"><a href="#Cloudera-Hadoop" class="headerlink" title="Cloudera Hadoop"></a>Cloudera Hadoop</h4><ul>
<li>官网地址：<a target="_blank" rel="noopener" href="https://www.cloudera.com/downloads/cdh">https://www.cloudera.com/downloads/cdh</a></li>
<li>下载地址：<a target="_blank" rel="noopener" href="https://docs.cloudera.com/documentation/enterprise/6/release-notes/topics/rg_cdh_6_download.html">https://docs.cloudera.com/documentation/enterprise/6/release-notes/topics/rg_cdh_6_download.html</a></li>
</ul>
<h4 id="Hortonworks-Hadoop"><a href="#Hortonworks-Hadoop" class="headerlink" title="Hortonworks Hadoop"></a>Hortonworks Hadoop</h4><ul>
<li>官网地址：<a target="_blank" rel="noopener" href="https://hortonworks.com/products/data-center/hdp/">https://hortonworks.com/products/data-center/hdp/</a></li>
<li>下载地址：<a target="_blank" rel="noopener" href="https://hortonworks.com/downloads/#data-platform">https://hortonworks.com/downloads/#data-platform</a></li>
</ul>
<h3 id="Hadoop-优势"><a href="#Hadoop-优势" class="headerlink" title="Hadoop 优势"></a>Hadoop 优势</h3><ul>
<li><p>高可靠性：Hadoop 底层维护多个数据副本，所以即使 Hadoop 某个计算元素或存储出现故障，也不会导致数据的丢失。</p>
<p><img src="/2021/08/25/hadoop/image-20210825171613059.png" alt="image-20210825171613059"></p>
</li>
<li><p>高扩展性：在集群间分配任务数据，可方便的扩展数以千计的节点。</p>
<p><img src="/2021/08/25/hadoop/image-20210825171705459.png" alt="image-20210825171705459"></p>
</li>
<li><p>高效性：在 MapReduce 的思想下，Hadoop 是并行工作的，以加快任务处理速度。</p>
<p><img src="/2021/08/25/hadoop/image-20210825171731759.png" alt="image-20210825171731759"></p>
</li>
<li><p>高容错性：能够自动将失败的任务重新分配。</p>
<p><img src="/2021/08/25/hadoop/image-20210825171816855.png" alt="image-20210825171816855"></p>
</li>
</ul>
<h3 id="Hadoop-组成"><a href="#Hadoop-组成" class="headerlink" title="Hadoop 组成"></a>Hadoop 组成</h3><p><img src="/2021/08/25/hadoop/image-20210825173206311.png" alt="image-20210825173206311"></p>
<ul>
<li>Hadoop 1.x 时 代 ，Hadoop 中的 MapReduce 同时处理业务逻辑运算和资源的调度，耦合性较大。</li>
<li>Hadoop 2.x 时代，增加了 Yarn。Yarn 只负责资源的调度，MapReduce 只负责运算。</li>
<li>Hadoop 3.x 时代，在组成上没有变化。</li>
</ul>
<h4 id="HDFS-架构概述"><a href="#HDFS-架构概述" class="headerlink" title="HDFS 架构概述"></a>HDFS 架构概述</h4><ul>
<li>Hadoop Distributed File System，简称 HDFS，是一个分布式文件系统。包含三个模块：<ul>
<li>NameNode：简称 nn，存储文件的元数据，如文件名，文件目录结构，文件属性（生成时间、副本数、文件权限），以及每个文件的块列表和块所在的 DataNode 等。</li>
<li>DataNode：简称 dn，在本地文件系统存储文件块数据，以及块数据的校验和。</li>
<li>Secondary NameNode：简称 2nn，每隔一段时间对 NameNode 元数据备份。</li>
</ul>
</li>
</ul>
<h4 id="YARN-架构概述"><a href="#YARN-架构概述" class="headerlink" title="YARN 架构概述"></a>YARN 架构概述</h4><ul>
<li><p>Yet Another Resource Negotiator，简称 YARN ，另一种资源协调者，是 Hadoop 的资源管理器。有两大组件：</p>
<p><img src="/2021/08/25/hadoop/image-20210826101511233.png" alt="image-20210826101511233"></p>
<ul>
<li>ResourceManager：简称 RM，整个集群资源（内存、CPU 等）的管理者。</li>
<li>NodeManager：简称 NM，单个节点服务器资源的管理者。每个 NodeManager 上可以有多个 Container。<ul>
<li>Container：容器，相当于一台独立的服务器，里面封装了任务运行所需要的资源，如内存、CPU、磁盘、网络等。</li>
<li>ApplicationMaster：简称 AM，单个任务运行的管理者。</li>
</ul>
</li>
</ul>
</li>
<li><p>客户端 client 可以有多个。</p>
</li>
<li><p>集群上可以运行多个 ApplicationMaster。</p>
</li>
</ul>
<h4 id="MapReduce-架构概述"><a href="#MapReduce-架构概述" class="headerlink" title="MapReduce 架构概述"></a>MapReduce 架构概述</h4><ul>
<li><p>MapReduce 将计算过程分为两个阶段：Map 和 Reduce。</p>
<p><img src="/2021/08/25/hadoop/image-20210825232032562.png" alt="image-20210825232032562"></p>
<ul>
<li>Map 阶段并行处理输入数据。</li>
<li>Reduce 阶段对 Map 结果进行汇总。</li>
</ul>
</li>
</ul>
<h4 id="HDFS-、YARN-、MapReduce-三者关系"><a href="#HDFS-、YARN-、MapReduce-三者关系" class="headerlink" title="HDFS 、YARN 、MapReduce 三者关系"></a>HDFS 、YARN 、MapReduce 三者关系</h4><p><img src="/2021/08/25/hadoop/image-20210825232856313.png" alt="image-20210825232856313"></p>
<h3 id="大数据技术生态体系"><a href="#大数据技术生态体系" class="headerlink" title="大数据技术生态体系"></a>大数据技术生态体系</h3><p><img src="/2021/08/25/hadoop/image-20210825233533121.png" alt="image-20210825233533121"></p>
<ul>
<li>Sqoop：Sqoop 是一款开源的工具，主要用于在 Hadoop、Hive 与传统的数据库（MySQL）间进行数据的传递，可以将一个关系型数据库（例如：MySQL，Oracle 等）中的数据导进到 Hadoop 的 HDFS 中，也可以将 HDFS 的数据导进到关系型数据库中。</li>
<li>Flume：Flume 是一个高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统，Flume 支持在日志系统中定制各类数据发送方，用于收集数据。</li>
<li>Kafka：Kafka 是一种高吞吐量的分布式发布订阅消息系统。</li>
<li>Spark：Spark 是当前最流行的开源大数据内存计算框架。可以基于 Hadoop 上存储的大数据进行计算。</li>
<li>Flink：Flink 是当前最流行的开源大数据内存计算框架。用于实时计算的场景较多。</li>
<li>Oozie：Oozie 是一个管理 Hadoop 作业（job）的工作流程调度管理系统。</li>
<li>Hbase：HBase 是一个分布式的、面向列的开源数据库。HBase 不同于一般的关系数据库，它是一个适合于非结构化数据存储的数据库。</li>
<li>Hive：Hive 是基于 Hadoop 的一个数据仓库工具，可以将结构化的数据文件映射为一张数据库表，并提供简单的 SQL 查询功能，可以将 SQL 语句转换为 MapReduce 任务进行运行。其优点是学习成本低，可以通过类 SQL 语句快速实现简单的 MapReduce 统计，不必开发专门的 MapReduce 应用，十分适合数据仓库的统计分析。</li>
<li>ZooKeeper：它是一个针对大型分布式系统的可靠协调系统，提供的功能包括：配置维护、名字服务、分布式同步、组服务等。</li>
</ul>
<h3 id="推荐系统框架图"><a href="#推荐系统框架图" class="headerlink" title="推荐系统框架图"></a>推荐系统框架图</h3><p><img src="/2021/08/25/hadoop/image-20210826110750495.png" alt="image-20210826110750495"></p>
<h2 id="Hadoop-运行环境搭建"><a href="#Hadoop-运行环境搭建" class="headerlink" title="Hadoop 运行环境搭建"></a>Hadoop 运行环境搭建</h2><h3 id="模板虚拟机环境准备"><a href="#模板虚拟机环境准备" class="headerlink" title="模板虚拟机环境准备"></a>模板虚拟机环境准备</h3><ul>
<li><p>安装模板虚拟机，IP 地址 192.168.10.100、主机名称 hadoop100、内存 2 G、硬盘 50 G。</p>
<ul>
<li>主机名称不要起 hadoop，hadoop000 等特殊名称。</li>
</ul>
</li>
<li><p>开启虚拟机，切换到 root 用户操作下面得命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop100 ~]$ su root</span><br><span class="line">密码：</span><br></pre></td></tr></table></figure>
</li>
<li><p>确保虚拟机可以正常上网：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># ping www.baidu.com</span></span><br><span class="line">PING www.a.shifen.com (14.215.177.39) 56(84) bytes of data.</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=1 ttl=128 time=41.0 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=2 ttl=128 time=40.9 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=3 ttl=128 time=41.3 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=4 ttl=128 time=42.5 ms</span><br><span class="line">^C</span><br><span class="line">--- www.a.shifen.com ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3007ms</span><br><span class="line">rtt min/avg/max/mdev = 40.987/41.495/42.582/0.674 ms</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 epel-release：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># yum install -y epel-release</span></span><br><span class="line">已加载插件：fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.njupt.edu.cn</span><br><span class="line"> * extras: mirrors.njupt.edu.cn</span><br><span class="line"> * updates: mirrors.njupt.edu.cn</span><br><span class="line">base                                                                                                                                                                                        | 3.6 kB  00:00:00     </span><br><span class="line">extras                                                                                                                                                                                      | 2.9 kB  00:00:00     </span><br><span class="line">updates                                                                                                                                                                                     | 2.9 kB  00:00:00     </span><br><span class="line">正在解决依赖关系</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 epel-release.noarch.0.7-11 将被 安装</span><br><span class="line">--&gt; 解决依赖关系完成</span><br><span class="line"></span><br><span class="line">依赖关系解决</span><br><span class="line"></span><br><span class="line">===================================================================================================================================================================================================================</span><br><span class="line"> Package                                                 架构                                              版本                                            源                                                 大小</span><br><span class="line">===================================================================================================================================================================================================================</span><br><span class="line">正在安装:</span><br><span class="line"> epel-release                                            noarch                                            7-11                                            extras                                             15 k</span><br><span class="line"></span><br><span class="line">事务概要</span><br><span class="line">===================================================================================================================================================================================================================</span><br><span class="line">安装  1 软件包</span><br><span class="line"></span><br><span class="line">总下载量：15 k</span><br><span class="line">安装大小：24 k</span><br><span class="line">Downloading packages:</span><br><span class="line">警告：/var/cache/yum/x86_64/7/extras/packages/epel-release-7-11.noarch.rpm: 头V3 RSA/SHA256 Signature, 密钥 ID f4a80eb5: NOKEY</span><br><span class="line">epel-release-7-11.noarch.rpm 的公钥尚未安装</span><br><span class="line">epel-release-7-11.noarch.rpm                                                                                                                                                                |  15 kB  00:00:00     </span><br><span class="line">从 file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7 检索密钥</span><br><span class="line">导入 GPG key 0xF4A80EB5:</span><br><span class="line"> 用户ID     : <span class="string">&quot;CentOS-7 Key (CentOS 7 Official Signing Key) &lt;security@centos.org&gt;&quot;</span></span><br><span class="line"> 指纹       : 6341 ab27 53d7 8a78 a7c2 7bb1 24c6 a8a7 f4a8 0eb5</span><br><span class="line"> 软件包     : centos-release-7-8.2003.0.el7.centos.x86_64 (@anaconda)</span><br><span class="line"> 来自       : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  正在安装    : epel-release-7-11.noarch                                                                                                                                                                       1/1 </span><br><span class="line">  验证中      : epel-release-7-11.noarch                                                                                                                                                                       1/1 </span><br><span class="line"></span><br><span class="line">已安装:</span><br><span class="line">  epel-release.noarch 0:7-11                                                                                                                                                                                       </span><br><span class="line"></span><br><span class="line">完毕！</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Extra Packages for Enterprise Linux 是为“红帽系”的操作系统提供额外的软件包，适用于 RHEL、CentOS 和 Scientific Linux。相当于是一个软件仓库，大多数 rpm 包在官方 repository 中是找不到的。</p>
</li>
<li><p>如果 Linux 安装的是最小系统版，还需要安装如下工具，如果安装的是 Linux 桌面标准版，不需要执行如下操作（本机安装的是桌面版）：</p>
<ul>
<li><p>net-tool：工具包集合，包含 ifconfig 等命令。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># yum install -y net-tools</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>vim：编辑器。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># yum install -y vim</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>关闭防火墙，关闭防火墙开机自启：</p>
<ul>
<li><p>查看防火墙状态：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># firewall-cmd --state</span></span><br><span class="line">running</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># systemctl stop firewalld.service</span></span><br><span class="line">[root@hadoop100 xisun]<span class="comment"># firewall-cmd --state</span></span><br><span class="line">not running</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙开机自启：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># systemctl disable firewalld.service </span></span><br><span class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span><br><span class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span><br></pre></td></tr></table></figure>
</li>
<li><p>在企业开发时，通常单个服务器的防火墙是关闭的，公司整体对外访问时会设置非常安全的防火墙。</p>
</li>
</ul>
</li>
<li><p>创建新用户，并修改新用户的密码（可省略）：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># useradd xisun</span></span><br><span class="line">[root@hadoop100 xisun]<span class="comment"># passwd xisun</span></span><br></pre></td></tr></table></figure>

<ul>
<li>生产环境下，应避免使用 root 用户直接操作。</li>
</ul>
</li>
<li><p>配置刚创建的新用户具有 root 权限，方便后期加 sudo 执行 root 权限的命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># vim /etc/sudoers</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改 <code>/etc/sudoers</code> 文件，在 %wheel 这行下面添加一行，将新用户 xisun 设置为免密使用 root 权限，如下所示：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## Allow root to run any commands anywhere </span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line"></span><br><span class="line">## Allows members of the &#x27;sys&#x27; group to run networking, software, </span><br><span class="line">## service management apps and more.</span><br><span class="line"># %sys ALL = NETWORKING, SOFTWARE, SERVICES, STORAGE, DELEGATING, PROCESSES, LOCATE, DRIVERS</span><br><span class="line"></span><br><span class="line">## Allows people in group wheel to run all commands</span><br><span class="line">%wheel  ALL=(ALL)       ALL</span><br><span class="line"></span><br><span class="line">xisun   ALL=(ALL)     NOPASSWD:ALL</span><br></pre></td></tr></table></figure>

<ul>
<li>xisun 这一行不要直接放到 root 行下面，因为所有用户都属于 wheel 组，如果放在 root 行下面，则是先配置了 xisun 用户在使用 sudo 命令时具有免输入密码功能，但是程序执行到 %wheel 行时，该功能又会被覆盖回需要密码。所以 xisun 这一行要放到 %wheel 这行下面。</li>
</ul>
</li>
</ul>
</li>
<li><p>从 root 用户退回到 xisun 用户：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 xisun]<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>/opt</code> 目录下创建文件夹：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop100 ~]$ <span class="built_in">cd</span> /opt/</span><br><span class="line">[xisun@hadoop100 opt]$ sudo mkdir module</span><br><span class="line">[xisun@hadoop100 opt]$ sudo mkdir software</span><br><span class="line">[xisun@hadoop100 opt]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxr-xr-x. 2 root root 6 8月  30 22:08 module</span><br><span class="line">drwxr-xr-x. 2 root root 6 10月 31 2018 rh</span><br><span class="line">drwxr-xr-x. 2 root root 6 8月  30 22:09 software</span><br><span class="line">[xisun@hadoop100 opt]$ sudo rm -r rh</span><br><span class="line">[xisun@hadoop100 opt]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxr-xr-x. 2 root root 6 8月  30 22:08 module</span><br><span class="line">drwxr-xr-x. 2 root root 6 8月  30 22:09 software</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>/opt</code> 目录下，需要使用 sudo 命令才能创建和删除文件夹：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop100 opt]$ mkdir <span class="built_in">test</span></span><br><span class="line">mkdir: 无法创建目录<span class="string">&quot;test&quot;</span>: 权限不够</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改创建的文件夹所属主和所属组为 xisun 用户：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop100 opt]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxr-xr-x. 2 root root 6 8月  30 22:08 module</span><br><span class="line">drwxr-xr-x. 2 root root 6 8月  30 22:09 software</span><br><span class="line">[xisun@hadoop100 opt]$ sudo chown xisun:xisun module/</span><br><span class="line">[xisun@hadoop100 opt]$ sudo chown xisun:xisun software/</span><br><span class="line">[xisun@hadoop100 opt]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  30 22:08 module</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  30 22:09 software</span><br></pre></td></tr></table></figure>
</li>
<li><p>卸载虚拟机自带的 JDK，以 root 用户执行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop100 opt]$ su root</span><br><span class="line">密码：</span><br><span class="line">[root@hadoop100 opt]<span class="comment"># rpm -qa | grep -i java</span></span><br><span class="line">javapackages-tools-3.4.1-11.el7.noarch</span><br><span class="line">tzdata-java-2019c-1.el7.noarch</span><br><span class="line">java-1.8.0-openjdk-headless-1.8.0.242.b08-1.el7.x86_64</span><br><span class="line">java-1.8.0-openjdk-1.8.0.242.b08-1.el7.x86_64</span><br><span class="line">java-1.7.0-openjdk-headless-1.7.0.251-2.6.21.1.el7.x86_64</span><br><span class="line">python-javapackages-3.4.1-11.el7.noarch</span><br><span class="line">java-1.7.0-openjdk-1.7.0.251-2.6.21.1.el7.x86_64</span><br><span class="line">[root@hadoop100 opt]<span class="comment"># rpm -qa | grep -i java | xargs -n1 rpm -e --nodeps</span></span><br><span class="line">[root@hadoop100 opt]<span class="comment"># rpm -qa | grep -i java</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果你的虚拟机是最小化安装不需要执行这一步。</li>
<li><code>rpm -qa</code>：查询所安装的所有 rpm 软件包。</li>
<li><code>grep -i</code>：忽略大小写。</li>
<li><code>xargs -n1</code>：表示每次只传递一个参数。</li>
<li><code>rpm -e –nodeps</code>：强制卸载软件。</li>
</ul>
</li>
<li><p>重启虚拟机：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 opt]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="克隆虚拟机"><a href="#克隆虚拟机" class="headerlink" title="克隆虚拟机"></a>克隆虚拟机</h3><ul>
<li><p>利用模板机 hadoop100，克隆三台虚拟机：hadoop102，hadoop103，hadoop104。</p>
<ul>
<li>注意：克隆时，要先关闭 hadoop100。</li>
</ul>
</li>
<li><p>修改克隆机的 IP 地址和主机名，以 hadoop102 为例，进行说明：</p>
<ul>
<li><p>开启 hadoop102，以 root 账户登录。</p>
</li>
<li><p>修改 IP 地址：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改 ifcfg-ens33 文件中的 IPADDR：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">TYPE=&quot;Ethernet&quot;</span><br><span class="line">PROXY_METHOD=&quot;none&quot;</span><br><span class="line">BROWSER_ONLY=&quot;no&quot;</span><br><span class="line">BOOTPROTO=&quot;static&quot;</span><br><span class="line">DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV4_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6INIT=&quot;yes&quot;</span><br><span class="line">IPV6_AUTOCONF=&quot;yes&quot;</span><br><span class="line">IPV6_DEFROUTE=&quot;yes&quot;</span><br><span class="line">IPV6_FAILURE_FATAL=&quot;no&quot;</span><br><span class="line">IPV6_ADDR_GEN_MODE=&quot;stable-privacy&quot;</span><br><span class="line">NAME=&quot;ens33&quot;</span><br><span class="line">UUID=&quot;eb503f88-96af-455d-b8f9-dbda02ca79d4&quot;</span><br><span class="line">DEVICE=&quot;ens33&quot;</span><br><span class="line">ONBOOT=&quot;yes&quot;</span><br><span class="line"></span><br><span class="line">IPADDR=192.168.10.102		# 修改IP地址为192.168.10.102</span><br><span class="line">GATEWAY=192.168.10.2</span><br><span class="line">DNS1=192.168.10.2</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改主机名：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># vim /etc/hostname</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop102</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证 IP 地址和主机名，以及网络是否正常：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 ~]<span class="comment"># ifconfig</span></span><br><span class="line">ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.10.102  netmask 255.255.255.0  broadcast 192.168.10.255</span><br><span class="line">        inet6 fe80::ac1e:7fe1:a566:2670  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:c5:1d:96  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1025  bytes 878131 (857.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 442  bytes 35254 (34.4 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 48  bytes 4080 (3.9 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 48  bytes 4080 (3.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255</span><br><span class="line">        ether 52:54:00:97:ed:a7  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">[root@hadoop102 ~]<span class="comment"># hostname</span></span><br><span class="line">hadoop102</span><br><span class="line">[root@hadoop102 ~]<span class="comment"># ping www.baidu.com</span></span><br><span class="line">PING www.a.shifen.com (14.215.177.39) 56(84) bytes of data.</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=1 ttl=128 time=42.9 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=2 ttl=128 time=42.6 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=3 ttl=128 time=42.7 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=4 ttl=128 time=42.8 ms</span><br><span class="line">64 bytes from 14.215.177.39 (14.215.177.39): icmp_seq=5 ttl=128 time=42.8 ms</span><br><span class="line">^C</span><br><span class="line">--- www.a.shifen.com ping statistics ---</span><br><span class="line">5 packets transmitted, 5 received, 0% packet loss, time 4012ms</span><br><span class="line">rtt min/avg/max/mdev = 42.689/42.814/42.930/0.276 ms</span><br></pre></td></tr></table></figure>
</li>
<li><p>按照相同的步骤，修改 hadoop103 的 IP 地址为 192.168.10.103，主机名为 hadoop103，hadoop104 的 IP 地址为 192.168.10.104，主机名为 hadoop104，并验证。</p>
</li>
</ul>
</li>
</ul>
<h3 id="安装-JDK"><a href="#安装-JDK" class="headerlink" title="安装 JDK"></a>安装 JDK</h3><ul>
<li><p>下面步骤以 hadoop102 为例，进行说明。</p>
</li>
<li><p>安装 JDK 前，一定确保提前删除了虚拟机自带的 JDK，此步骤在前面已执行。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ rpm -qa | grep -i java</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop100 ~]$ rpm -qa | grep -i java | xargs -n1 sudo rpm -e --nodeps</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ java -version</span><br><span class="line">bash: java: 未找到命令...</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 OpenJDK 8。</p>
</li>
</ul>
<ul>
<li><p>下载地址：<a target="_blank" rel="noopener" href="https://openjdk.java.net/%EF%BC%8Chttps://openjdk.java.net/install/index.html">https://openjdk.java.net/，https://openjdk.java.net/install/index.html</a></p>
<p><img src="/2021/08/25/hadoop/image-20210831115613196.png" alt="image-20210831115613196"></p>
</li>
<li><p>使用 root 权限，以命令行安装：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ sudo yum install -y java-1.8.0-openjdk-devel</span><br><span class="line">已加载插件：fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.cqu.edu.cn</span><br><span class="line"> * epel: mirror.sjtu.edu.cn</span><br><span class="line"> * extras: mirrors.cn99.com</span><br><span class="line"> * updates: mirrors.cn99.com</span><br><span class="line">正在解决依赖关系</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 java-1.8.0-openjdk-devel.x86_64.1.1.8.0.302.b08-0.el7_9 将被 安装</span><br><span class="line">--&gt; 正在处理依赖关系 java-1.8.0-openjdk(x86-64) = 1:1.8.0.302.b08-0.el7_9，它被软件包 1:java-1.8.0-openjdk-devel-1.8.0.302.b08-0.el7_9.x86_64 需要</span><br><span class="line">--&gt; 正在处理依赖关系 libjvm.so()(64bit)，它被软件包 1:java-1.8.0-openjdk-devel-1.8.0.302.b08-0.el7_9.x86_64 需要</span><br><span class="line">--&gt; 正在处理依赖关系 libjava.so()(64bit)，它被软件包 1:java-1.8.0-openjdk-devel-1.8.0.302.b08-0.el7_9.x86_64 需要</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 java-1.8.0-openjdk.x86_64.1.1.8.0.302.b08-0.el7_9 将被 安装</span><br><span class="line">---&gt; 软件包 java-1.8.0-openjdk-headless.x86_64.1.1.8.0.302.b08-0.el7_9 将被 安装</span><br><span class="line">--&gt; 正在处理依赖关系 tzdata-java &gt;= 2021a，它被软件包 1:java-1.8.0-openjdk-headless-1.8.0.302.b08-0.el7_9.x86_64 需要</span><br><span class="line">--&gt; 正在处理依赖关系 jpackage-utils，它被软件包 1:java-1.8.0-openjdk-headless-1.8.0.302.b08-0.el7_9.x86_64 需要</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 javapackages-tools.noarch.0.3.4.1-11.el7 将被 安装</span><br><span class="line">--&gt; 正在处理依赖关系 python-javapackages = 3.4.1-11.el7，它被软件包 javapackages-tools-3.4.1-11.el7.noarch 需要</span><br><span class="line">---&gt; 软件包 tzdata-java.noarch.0.2021a-1.el7 将被 安装</span><br><span class="line">--&gt; 正在检查事务</span><br><span class="line">---&gt; 软件包 python-javapackages.noarch.0.3.4.1-11.el7 将被 安装</span><br><span class="line">--&gt; 解决依赖关系完成</span><br><span class="line"></span><br><span class="line">依赖关系解决</span><br><span class="line"></span><br><span class="line">===================================================================================================================================================================================================================</span><br><span class="line"> Package                                                       架构                                     版本                                                       源                                         大小</span><br><span class="line">===================================================================================================================================================================================================================</span><br><span class="line">正在安装:</span><br><span class="line"> java-1.8.0-openjdk-devel                                      x86_64                                   1:1.8.0.302.b08-0.el7_9                                    updates                                   9.8 M</span><br><span class="line">为依赖而安装:</span><br><span class="line"> java-1.8.0-openjdk                                            x86_64                                   1:1.8.0.302.b08-0.el7_9                                    updates                                   311 k</span><br><span class="line"> java-1.8.0-openjdk-headless                                   x86_64                                   1:1.8.0.302.b08-0.el7_9                                    updates                                    33 M</span><br><span class="line"> javapackages-tools                                            noarch                                   3.4.1-11.el7                                               base                                       73 k</span><br><span class="line"> python-javapackages                                           noarch                                   3.4.1-11.el7                                               base                                       31 k</span><br><span class="line"> tzdata-java                                                   noarch                                   2021a-1.el7                                                updates                                   191 k</span><br><span class="line"></span><br><span class="line">事务概要</span><br><span class="line">===================================================================================================================================================================================================================</span><br><span class="line">安装  1 软件包 (+5 依赖软件包)</span><br><span class="line"></span><br><span class="line">总下载量：43 M</span><br><span class="line">安装大小：152 M</span><br><span class="line">Downloading packages:</span><br><span class="line">(1/6): python-javapackages-3.4.1-11.el7.noarch.rpm                                                                                                                                          |  31 kB  00:00:00     </span><br><span class="line">(2/6): java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64.rpm                                                                                                                                  | 311 kB  00:00:00     </span><br><span class="line">(3/6): javapackages-tools-3.4.1-11.el7.noarch.rpm                                                                                                                                           |  73 kB  00:00:00     </span><br><span class="line">(4/6): tzdata-java-2021a-1.el7.noarch.rpm                                                                                                                                                   | 191 kB  00:00:01     </span><br><span class="line">(5/6): java-1.8.0-openjdk-headless-1.8.0.302.b08-0.el7_9.x86_64.rpm                                                                                                                         |  33 MB  00:00:07     </span><br><span class="line">(6/6): java-1.8.0-openjdk-devel-1.8.0.302.b08-0.el7_9.x86_64.rpm                                                                                                                            | 9.8 MB  00:00:13     </span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">总计                                                                                                                                                                               3.1 MB/s |  43 MB  00:00:13     </span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">警告：RPM 数据库已被非 yum 程序修改。</span><br><span class="line">** 发现 9 个已存在的 RPM 数据库问题， <span class="string">&#x27;yum check&#x27;</span> 输出如下：</span><br><span class="line">icedtea-web-1.7.1-2.el7_6.x86_64 有缺少的需求 java-1.8.0-openjdk</span><br><span class="line">icedtea-web-1.7.1-2.el7_6.x86_64 有缺少的需求 jpackage-utils</span><br><span class="line">icedtea-web-1.7.1-2.el7_6.x86_64 有缺少的需求 jpackage-utils</span><br><span class="line">jline-1.0-8.el7.noarch 有缺少的需求 java &gt;= (<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1.5&#x27;</span>, None)</span><br><span class="line">jline-1.0-8.el7.noarch 有缺少的需求 jpackage-utils</span><br><span class="line">rhino-1.7R5-1.el7.noarch 有缺少的需求 jpackage-utils</span><br><span class="line">rhino-1.7R5-1.el7.noarch 有缺少的需求 jpackage-utils</span><br><span class="line">tagsoup-1.2.1-8.el7.noarch 有缺少的需求 jpackage-utils</span><br><span class="line">tagsoup-1.2.1-8.el7.noarch 有缺少的需求 jpackage-utils &gt;= (<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1.6&#x27;</span>, None)</span><br><span class="line">  正在安装    : tzdata-java-2021a-1.el7.noarch                                                                                                                                                                 1/6 </span><br><span class="line">  正在安装    : python-javapackages-3.4.1-11.el7.noarch                                                                                                                                                        2/6 </span><br><span class="line">  正在安装    : javapackages-tools-3.4.1-11.el7.noarch                                                                                                                                                         3/6 </span><br><span class="line">  正在安装    : 1:java-1.8.0-openjdk-headless-1.8.0.302.b08-0.el7_9.x86_64                                                                                                                                     4/6 </span><br><span class="line">  正在安装    : 1:java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64                                                                                                                                              5/6 </span><br><span class="line">  正在安装    : 1:java-1.8.0-openjdk-devel-1.8.0.302.b08-0.el7_9.x86_64                                                                                                                                        6/6 </span><br><span class="line">  验证中      : 1:java-1.8.0-openjdk-headless-1.8.0.302.b08-0.el7_9.x86_64                                                                                                                                     1/6 </span><br><span class="line">  验证中      : python-javapackages-3.4.1-11.el7.noarch                                                                                                                                                        2/6 </span><br><span class="line">  验证中      : tzdata-java-2021a-1.el7.noarch                                                                                                                                                                 3/6 </span><br><span class="line">  验证中      : 1:java-1.8.0-openjdk-devel-1.8.0.302.b08-0.el7_9.x86_64                                                                                                                                        4/6 </span><br><span class="line">  验证中      : 1:java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64                                                                                                                                              5/6 </span><br><span class="line">  验证中      : javapackages-tools-3.4.1-11.el7.noarch                                                                                                                                                         6/6 </span><br><span class="line"></span><br><span class="line">已安装:</span><br><span class="line">  java-1.8.0-openjdk-devel.x86_64 1:1.8.0.302.b08-0.el7_9                                                                                                                                                          </span><br><span class="line"></span><br><span class="line">作为依赖被安装:</span><br><span class="line">  java-1.8.0-openjdk.x86_64 1:1.8.0.302.b08-0.el7_9     java-1.8.0-openjdk-headless.x86_64 1:1.8.0.302.b08-0.el7_9     javapackages-tools.noarch 0:3.4.1-11.el7     python-javapackages.noarch 0:3.4.1-11.el7    </span><br><span class="line">  tzdata-java.noarch 0:2021a-1.el7                     </span><br><span class="line"></span><br><span class="line">完毕！</span><br></pre></td></tr></table></figure>

<blockquote>
<p>公司生产环境使用的是 OpenJDK 8，此处保持一致。</p>
</blockquote>
</li>
<li><p>验证 JDK 是否安装成功：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ java -version</span><br><span class="line">openjdk version <span class="string">&quot;1.8.0_302&quot;</span></span><br><span class="line">OpenJDK Runtime Environment (build 1.8.0_302-b08)</span><br><span class="line">OpenJDK 64-Bit Server VM (build 25.302-b08, mixed mode)</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 JDK 环境变量：</p>
<ul>
<li><p>查看 jre/bin 路径：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ dirname $(readlink $(readlink $(<span class="built_in">which</span> java)))</span><br><span class="line">/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64/jre/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建 <code>/etc/profile.d/my_env.sh</code> 文件，添加 Java 环境变量：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># JAVA_HOME</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure>

<ul>
<li><p>正常情况下，会将 Java 环境变量添加在 <code>/etc/profile</code> 文件的最后，但该文件有如下设置，因此，可以在 <code>/etc/profile.d</code> 路径下自定义一个以 sh 结尾的文件，能达到同样的效果：</p>
<p><img src="/2021/08/25/hadoop/image-20210831143510629.png" alt="image-20210831143510629"></p>
</li>
</ul>
</li>
<li><p>source 一下 <code>/etc/profile</code> 文件，让新的环境变量 PATH 生效：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 etc]$ <span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看配置是否生效：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 etc]$ <span class="built_in">echo</span> <span class="variable">$JAVA_HOME</span></span><br><span class="line">/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="安装-Hadoop"><a href="#安装-Hadoop" class="headerlink" title="安装 Hadoop"></a>安装 Hadoop</h3><ul>
<li><p>下面步骤以 hadoop102 为例，进行说明。</p>
</li>
<li><p>下载地址：<a target="_blank" rel="noopener" href="https://hadoop.apache.org/releases.html">https://hadoop.apache.org/releases.html</a></p>
<p><img src="/2021/08/25/hadoop/image-20210831114058447.png" alt="image-20210831114058447"></p>
<p><img src="/2021/08/25/hadoop/image-20210831144645384.png" alt="image-20210831144645384"></p>
<blockquote>
<p>公司生产环境使用的是 hadoop-3.2.1，此处保持一致。</p>
</blockquote>
</li>
<li><p>在 <code>opt/software</code> 路径下，使用 wget 命令下载安装包：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 software]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/software</span><br><span class="line">[xisun@hadoop102 software]$ wget https://archive.apache.org/dist/hadoop/common/hadoop-3.2.1/hadoop-3.2.1.tar.gz</span><br><span class="line">--2021-08-31 11:44:19--  https://archive.apache.org/dist/hadoop/common/hadoop-3.2.1/hadoop-3.2.1.tar.gz</span><br><span class="line">正在解析主机 archive.apache.org (archive.apache.org)... 138.201.131.134, 2a01:4f8:172:2ec5::2</span><br><span class="line">正在连接 archive.apache.org (archive.apache.org)|138.201.131.134|:443... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 200 OK</span><br><span class="line">长度：359196911 (343M) [application/x-gzip]</span><br><span class="line">正在保存至: “hadoop-3.2.1.tar.gz”</span><br><span class="line"></span><br><span class="line">100%[=========================================================================================================================================================================&gt;] 359,196,911 57.8KB/s 用时 57m 32s</span><br><span class="line"></span><br><span class="line">2021-08-31 12:41:54 (102 KB/s) - 已保存 “hadoop-3.2.1.tar.gz” [359196911/359196911])</span><br><span class="line">[xisun@hadoop102 software]$ ll</span><br><span class="line">总用量 350780</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 359196911 7月   3 2020 hadoop-3.2.1.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>解压安装包到 <code>/opt/module</code> 路径下面：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 software]$ tar -zxvf hadoop-3.2.1.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 software]$ ll ../module/</span><br><span class="line">总用量 0</span><br><span class="line">drwxr-xr-x. 9 xisun xisun 149 9月  11 2019 hadoop-3.2.1</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 Hadoop 添加到环境变量：</p>
<ul>
<li><p>获取 Hadoop 安装路径：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 <code>etc/profile.d/my_env.sh</code> 文件，添加 Hadoop 环境变量：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/module/hadoop-3.2.1</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure>
</li>
<li><p>source 一下 <code>/etc/profile</code> 文件，让新的环境变量 PATH 生效：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ <span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看配置是否生效：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ <span class="built_in">echo</span> <span class="variable">$HADOOP_HOME</span></span><br><span class="line">/opt/module/hadoop-3.2.1</span><br><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ hadoop version</span><br><span class="line">Hadoop 3.2.1</span><br><span class="line">Source code repository https://gitbox.apache.org/repos/asf/hadoop.git -r b3cbbb467e22ea829b3808f4b7b01d07e0bf3842</span><br><span class="line">Compiled by rohithsharmaks on 2019-09-10T15:56Z</span><br><span class="line">Compiled with protoc 2.5.0</span><br><span class="line">From <span class="built_in">source</span> with checksum 776eaf9eee9c0ffc370bcbc1888737</span><br><span class="line">This <span class="built_in">command</span> was run using /opt/module/hadoop-3.2.1/share/hadoop/common/hadoop-common-3.2.1.jar</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="Hadoop-目录结构"><a href="#Hadoop-目录结构" class="headerlink" title="Hadoop 目录结构"></a>Hadoop 目录结构</h3><ul>
<li><p>查看 Hadoop 的目录结构：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1</span><br><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ ll</span><br><span class="line">总用量 180</span><br><span class="line">drwxr-xr-x. 2 xisun xisun    203 9月  11 2019 bin</span><br><span class="line">drwxr-xr-x. 3 xisun xisun     20 9月  10 2019 etc</span><br><span class="line">drwxr-xr-x. 2 xisun xisun    106 9月  11 2019 include</span><br><span class="line">drwxr-xr-x. 3 xisun xisun     20 9月  11 2019 lib</span><br><span class="line">drwxr-xr-x. 4 xisun xisun    288 9月  11 2019 libexec</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 150569 9月  10 2019 LICENSE.txt</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  22125 9月  10 2019 NOTICE.txt</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1361 9月  10 2019 README.txt</span><br><span class="line">drwxr-xr-x. 3 xisun xisun   4096 9月  10 2019 sbin</span><br><span class="line">drwxr-xr-x. 4 xisun xisun     31 9月  11 2019 share</span><br></pre></td></tr></table></figure>
</li>
<li><p>重要目录</p>
<ul>
<li><p>bin 目录：存放对 Hadoop 相关服务（hdfs，yarn，mapred）进行操作的脚本。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ ls bin/</span><br><span class="line">container-executor  hadoop  hadoop.cmd  hdfs  hdfs.cmd  mapred  mapred.cmd  oom-listener  test-container-executor  yarn  yarn.cmd</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/25/hadoop/image-20210831153016702.png" alt="image-20210831153016702"></p>
</li>
<li><p>etc 目录：Hadoop 的配置文件目录，存放 Hadoop 的配置文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ ls etc/</span><br><span class="line">hadoop</span><br><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ ls etc/hadoop/</span><br><span class="line">capacity-scheduler.xml  hadoop-env.sh                     httpfs-env.sh            kms-env.sh            mapred-env.sh               ssl-server.xml.example         yarnservice-log4j.properties</span><br><span class="line">configuration.xsl       hadoop-metrics2.properties        httpfs-log4j.properties  kms-log4j.properties  mapred-queues.xml.template  user_ec_policies.xml.template  yarn-site.xml</span><br><span class="line">container-executor.cfg  hadoop-policy.xml                 httpfs-signature.secret  kms-site.xml          mapred-site.xml             workers</span><br><span class="line">core-site.xml           hadoop-user-functions.sh.example  httpfs-site.xml          log4j.properties      shellprofile.d              yarn-env.cmd</span><br><span class="line">hadoop-env.cmd          hdfs-site.xml                     kms-acls.xml             mapred-env.cmd        ssl-client.xml.example      yarn-env.sh</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/25/hadoop/image-20210831153058005.png" alt="image-20210831153058005"></p>
</li>
<li><p>lib 目录：存放 Hadoop 的本地库（对数据进行压缩解压缩功能）。</p>
</li>
<li><p>sbin 目录：存放启动或停止 Hadoop 相关服务的脚本。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ ls sbin/</span><br><span class="line">distribute-exclude.sh  hadoop-daemons.sh  mr-jobhistory-daemon.sh  start-all.sh       start-dfs.sh         start-yarn.sh  stop-balancer.sh  stop-secure-dns.sh  workers.sh</span><br><span class="line">FederationStateStore   httpfs.sh          refresh-namenodes.sh     start-balancer.sh  start-secure-dns.sh  stop-all.cmd   stop-dfs.cmd      stop-yarn.cmd       yarn-daemon.sh</span><br><span class="line">hadoop-daemon.sh       kms.sh             start-all.cmd            start-dfs.cmd      start-yarn.cmd       stop-all.sh    stop-dfs.sh       stop-yarn.sh        yarn-daemons.sh</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/25/hadoop/image-20210831153154765.png" alt="image-20210831153154765"></p>
</li>
<li><p>share 目录：存放 Hadoop 的依赖 JAR 包、文档、和官方案例。</p>
</li>
</ul>
</li>
</ul>
<h2 id="Hadoop-运行模式"><a href="#Hadoop-运行模式" class="headerlink" title="Hadoop 运行模式"></a>Hadoop 运行模式</h2><ul>
<li><p>Hadoop 官方网站：<a target="_blank" rel="noopener" href="http://hadoop.apache.org/">http://hadoop.apache.org/</a></p>
</li>
<li><p>Hadoop 运行模式包括：本地模式、伪分布式模式以及完全分布式模式。</p>
<p><img src="/2021/08/25/hadoop/image-20210831154042555.png" alt="image-20210831154042555"></p>
<ul>
<li>本地模式：单机运行，只是用来演示一下官方案例。<ul>
<li>数据存储在 Linux 本地，偶尔测试时使用。</li>
</ul>
</li>
<li>伪分布式模式：也是单机运行，但是具备 Hadoop 集群的所有功能，一台服务器模拟一个分布式的环境。<ul>
<li>数据存储在 HDFS 上，个别缺钱的公司用来测试，生产环境一般不用。</li>
</ul>
</li>
<li>完全分布式模式：多台服务器组成分布式环境。<ul>
<li>数据存储在 HDFS 上，企业生产环境大量使用。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="本地模式"><a href="#本地模式" class="headerlink" title="本地模式"></a>本地模式</h3><ul>
<li><p>以官方 WordCount 进行说明。</p>
</li>
<li><p>第一步：在 hadoop-3.2.1 文件下面创建一个 wcinput 文件夹。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ mkdir wcinput</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：在 wcinput 文件下创建一个 word.txt 文件，并输入一些单词做测试。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 wcinput]$ vim word.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">xisun</span><br><span class="line">xisun</span><br></pre></td></tr></table></figure>
</li>
<li><p>第三步：回到 Hadoop 目录 <code>/opt/module/hadoop-3.2.1</code>。</p>
</li>
<li><p>第四步：执行 wordcount 程序，统计 word.txt 文件中各单词的个数。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount wcinput/ ./wcoutput</span><br></pre></td></tr></table></figure>

<blockquote>
<p>本地模式下，输入路径 <code>/wcinput</code> 和输出路径 <code>./wcoutput</code> 都是本地路径。</p>
<p>注意：结果输出路径 wcoutput 不能已经存在，否则程序会报错 <code>org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory file:/opt/module/hadoop-3.2.1/wcoutput already exists</code>。</p>
</blockquote>
</li>
<li><p>第五步：查看结果。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop-3.2.1]$ <span class="built_in">cd</span> wcoutput/</span><br><span class="line">[xisun@hadoop102 wcoutput]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">-rw-r--r--. 1 xisun xisun 36 8月  31 16:04 part-r-00000</span><br><span class="line">-rw-r--r--. 1 xisun xisun  0 8月  31 16:04 _SUCCESS</span><br><span class="line">[xisun@hadoop102 wcoutput]$ cat part-r-00000 </span><br><span class="line">hadoop	2</span><br><span class="line">mapreduce	1</span><br><span class="line">xisun	2</span><br><span class="line">yarn	1</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="完全分布式模式"><a href="#完全分布式模式" class="headerlink" title="完全分布式模式"></a>完全分布式模式</h3><h4 id="虚拟机准备"><a href="#虚拟机准备" class="headerlink" title="虚拟机准备"></a>虚拟机准备</h4><ul>
<li><p>虚拟机 hadoop102 已准备好，参考前面章节。</p>
</li>
<li><p>在 hadoop103 和 hadoop104 安装 OpenJDK：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ sudo yum install -y java-1.8.0-openjdk-devel</span><br></pre></td></tr></table></figure>
</li>
<li><p>hadoop102，hadoop103 和 hadoop104 三台虚拟机，安装的 JDK 环境和 Hadoop 版本相同，因此，环境变量配置也相同。对于这种情况，不需要在每台虚拟机上再配置环境变量，可以使用 scp 或 rsync 命令等，直接拷贝模板虚拟机 hadoop102 上的配置文件到 hadoop103 和 hadoop104 上。在后面章节，也可以使用集群分发脚本 xsync 拷贝。</p>
<ul>
<li><p>如果使用 scp 命令，拷贝 hadoop102 上环境变量配置的 <code>etc/profile.d/my_env.sh</code> 文件到 hadoop103 和 hadoop104 的 <code>etc/profile.d</code> 路径下，方式如下。</p>
<ul>
<li><p>方式一，在 hadoop102 上使用 scp 命令，拷贝本地文件到 hadoop103 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 profile.d]$ sudo scp /etc/profile.d/my_env.sh root@hadoop103:/etc/profile.d/</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop103 (192.168.10.103)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop103,192.168.10.103<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@hadoop103&#x27;</span>s password: </span><br><span class="line">my_env.sh      </span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二，在 hadoop104 上使用 scp 命令，拷贝 hadoop102 上的文件到本地：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 profile.d]$ sudo scp root@hadoop102:/etc/profile.d/my_env.sh /etc/profile.d/</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop102 (192.168.10.102)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop102,192.168.10.102<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@hadoop102&#x27;</span>s password: </span><br><span class="line">my_env.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式三，在 hadoop103 上使用 scp 命令，拷贝 hadoop102 上的文件到 hadoop104 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 profile.d]$ sudo scp root@hadoop102:/etc/profile.d/my_env.sh root@hadoop104:/etc/profile.d/</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如果使用集群分发脚本 xsync 拷贝，需要注意，my_env.sh 文件是 root 权限的，需要给脚本添加 sudo 命令，同时，xsync 脚本需要补全路径，否则 sudo 识别不出来：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ sudo /home/xisun/bin/xsync /etc/profile.d/my_env.sh </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">root@hadoop102<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">root@hadoop102&#x27;</span>s password: </span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 48 bytes  received 12 bytes  24.00 bytes/sec</span><br><span class="line">total size is 253  speedup is 4.22</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">root@hadoop103<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">root@hadoop103&#x27;</span>s password: </span><br><span class="line">sending incremental file list</span><br><span class="line">my_env.sh</span><br><span class="line"></span><br><span class="line">sent 348 bytes  received 35 bytes  153.20 bytes/sec</span><br><span class="line">total size is 253  speedup is 0.66</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop104 (192.168.10.104)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop104,192.168.10.104<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@hadoop104&#x27;</span>s password: </span><br><span class="line">root@hadoop104<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">sending incremental file list</span></span><br><span class="line"><span class="string">my_env.sh</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sent 348 bytes  received 35 bytes  153.20 bytes/sec</span></span><br><span class="line"><span class="string">total size is 253  speedup is 0.66</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意，需要输入的是各主机 root 用户的密码。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>在 hadoop103 和 hadoop104 上 source 一下 <code>/etc/profile</code> 文件，让新的环境变量 PATH 生效：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ <span class="built_in">source</span> /etc/profile</span><br><span class="line">[xisun@hadoop103 ~]$ <span class="built_in">echo</span> <span class="variable">$JAVA_HOME</span></span><br><span class="line">/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 ~]$ <span class="built_in">source</span> /etc/profile</span><br><span class="line">[xisun@hadoop104 ~]$ <span class="built_in">echo</span> <span class="variable">$JAVA_HOME</span></span><br><span class="line">/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="编写集群分发脚本-xsync"><a href="#编写集群分发脚本-xsync" class="headerlink" title="编写集群分发脚本 xsync"></a>编写集群分发脚本 xsync</h4><h5 id="scp（secure-copy）安全拷贝"><a href="#scp（secure-copy）安全拷贝" class="headerlink" title="scp（secure copy）安全拷贝"></a>scp（secure copy）安全拷贝</h5><ul>
<li><p>scp 可以实现服务器与服务器之间的数据拷贝。（from server1 to server2）</p>
</li>
<li><p>基本语法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp    -r        <span class="variable">$pdir</span>/<span class="variable">$fname</span>         <span class="variable">$user</span>@<span class="variable">$host</span>:<span class="variable">$pdir</span>/<span class="variable">$fname</span></span><br><span class="line">命令   递归     要拷贝的文件路径/名称   	 目的地用户@主机:目的地路径/名称</span><br></pre></td></tr></table></figure>
</li>
<li><p>实例：拷贝 hadoop102 上的 Hadoop 安装包到 hadoop103 和 hadoop104 上。</p>
<ul>
<li><p>前提：在 hadoop102、hadoop103、hadoop104 三台虚拟机上，都已经创建好 <code>/opt/module</code> 和 <code>/opt/software</code> 两个路径，并且已经把这两个路径的权限修改为 xisun:xisun。</p>
</li>
<li><p>方式一，在 hadoop102 上使用 scp 命令，拷贝本地文件到 hadoop103 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 opt]$ scp -r /opt/module/hadoop-3.2.1/ xisun@hadoop103:/opt/module/</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop103 (192.168.10.103)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop103,192.168.10.103<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">xisun@hadoop103&#x27;</span>s password:</span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
<ul>
<li><p>方式二，在 hadoop104 上使用 scp 命令，拷贝 hadoop102 上的文件到本地：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 opt]$ scp -r xisun@hadoop102:/opt/module/hadoop-3.2.1/ /opt/module/</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop102 (192.168.10.102)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop104,192.168.10.102<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">xisun@hadoop102&#x27;</span>s password:</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式三，在 hadoop103 上使用 scp 命令，拷贝 hadoop102 上的文件到 hadoop104 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 opt]$ scp -r xisun@hadoop102:/opt/module/hadoop-3.2.1/ xisun@hadoop104:/opt/module/</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="rsync-远程同步工具"><a href="#rsync-远程同步工具" class="headerlink" title="rsync 远程同步工具"></a>rsync 远程同步工具</h5><ul>
<li><p>rsync 主要用于备份和镜像。具有速度快、避免复制相同内容和支持符号链接的优点。</p>
</li>
<li><p>rsync 和 scp 的区别：用 rsync 做文件的复制要比 scp 的速度快，rsync 只对差异文件做更新。scp 是把所有文件都复制过去。</p>
</li>
<li><p>rsync 第一次使用，等同于 scp。</p>
</li>
<li><p>基本语法：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rsync    -av       <span class="variable">$pdir</span>/<span class="variable">$fname</span>          <span class="variable">$user</span>@<span class="variable">$host</span>:<span class="variable">$pdir</span>/<span class="variable">$fname</span></span><br><span class="line">命令    选项参数    要拷贝的文件路径/名称     目的地用户@主机:目的地路径/名称</span><br></pre></td></tr></table></figure>

<ul>
<li><p>参数说明：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>归档拷贝</td>
</tr>
<tr>
<td>-v</td>
<td>显示复制过程</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>实例：</p>
<ul>
<li><p>删除 hadoop103 和 hadoop104 上 <code>/opt/module/hadoop-3.2.1</code> 路径下的 wcinput 和 wcoutput 文件夹。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 hadoop-3.2.1]$ rm -r wcinput/ wcoutput/</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 hadoop-3.2.1]$ rm -r wcinput/ wcoutput/</span><br></pre></td></tr></table></figure>
</li>
<li><p>同步 hadoop102 上的 <code>/opt/module/hadoop-3.2.1</code> 到 hadoop103 和 hadoop104 上。</p>
<ul>
<li><p>方式一，在 hadoop102 上使用  rsync 命令，同步本地文件到 hadoop103 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ rsync -av /opt/module/hadoop-3.2.1/ xisun@hadoop103:/opt/module/hadoop-3.2.1/</span><br><span class="line">xisun@hadoop103<span class="string">&#x27;s password: </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二，在 hadoop104 上使用 rsync 命令，同步 hadoop102 上的文件到本地：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 ~]$ rsync -av xisun@hadoop102:/opt/module/hadoop-3.2.1/ /opt/module/hadoop-3.2.1/</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop102 (192.168.10.102)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop102,192.168.10.102<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">xisun@hadoop102&#x27;</span>s password: </span><br></pre></td></tr></table></figure>
</li>
<li><p>方式三，在 hadoop103 上使用 rsync 命令，同步 hadoop102 上的文件到 hadoop104 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ rsync -av xisun@hadoop102:/opt/module/hadoop-3.2.1/ xisun@hadoop104:/opt/module/hadoop-3.2.1/</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="xsync-集群分发脚本"><a href="#xsync-集群分发脚本" class="headerlink" title="xsync 集群分发脚本"></a>xsync 集群分发脚本</h5><ul>
<li><p>需求：编写脚本，指定需要同步的文件路径参数，能够循环复制该路径下的所有文件到所有节点的相同路径下。</p>
</li>
<li><p>需求分析：</p>
<ul>
<li><p>使用 rsync 命令，实现同步拷贝。</p>
</li>
<li><p>期望脚本格式：<code>xsync 需要同步的文件名称</code></p>
</li>
<li><p>期望脚本在任何路径都能使用：将脚本放在声明了全局环境变量的路径下。</p>
<ul>
<li><p>查看全局变量的路径：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">/usr/<span class="built_in">local</span>/bin:/usr/bin:/usr/<span class="built_in">local</span>/sbin:/usr/sbin:/home/xisun/.<span class="built_in">local</span>/bin:/home/xisun/bin:/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.302.b08-0.el7_9.x86_64/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以看出，在全局变量的路径中，有一个 <code>/home/xisun/bin:</code>，如果把编写的脚本 xsync 放在此路径下，即可在任何路径都能使用。或者，直接把脚本 xsync 所在的路径，配置到全局环境变量中也可以。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>脚本实现：</p>
<ul>
<li><p>在 <code>/home/xisun</code> 路径下，创建 bin 目录：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">pwd</span></span><br><span class="line">/home/xisun</span><br><span class="line">[xisun@hadoop102 ~]$ mkdir bin</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 6 9月   1 11:43 bin</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun 6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>/home/xisun/bin</code> 路径下，创建 xsync 文件，并添加脚本代码：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 bin]$ <span class="built_in">pwd</span></span><br><span class="line">/home/xisun/bin</span><br><span class="line">[xisun@hadoop102 bin]$ vim xsync</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"># 1.判断参数个数，如果参数个数小于1，直接退出，$#是获得参数个数</span><br><span class="line">if [ $# -lt 1 ]</span><br><span class="line">then</span><br><span class="line">    echo Not Enough Arguement!</span><br><span class="line">    exit;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># 2.遍历集群所有机器</span><br><span class="line">for host in hadoop102 hadoop103 hadoop104</span><br><span class="line">do</span><br><span class="line">    echo ====================  $host  ====================</span><br><span class="line">    # 3.遍历所有目录，挨个发送，$@是脚本的参数，可以有多个</span><br><span class="line">    for file in $@</span><br><span class="line">    do</span><br><span class="line">        # 4.判断文件是否存在</span><br><span class="line">        if [ -e $file ]</span><br><span class="line">            then</span><br><span class="line">                # 5.获取父目录</span><br><span class="line">                pdir=$(cd -P $(dirname $file); pwd)</span><br><span class="line">                # 6.获取当前文件的名称</span><br><span class="line">                fname=$(basename $file)</span><br><span class="line">                # 7.在目标主机上，创建目录</span><br><span class="line">                ssh $host &quot;mkdir -p $pdir&quot;</span><br><span class="line">                # 8.同步拷贝</span><br><span class="line">                rsync -av $pdir/$fname $host:$pdir</span><br><span class="line">            else</span><br><span class="line">                echo $file does not exists!</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/25/hadoop/image-20210901133253592.png" alt="image-20210901133253592"></p>
</li>
<li><p>修改脚本 xsync，使其具有可执行权限：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 bin]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 908 9月   1 13:33 xsync</span><br><span class="line">[xisun@hadoop102 bin]$ chmod 777 xsync </span><br><span class="line">[xisun@hadoop102 bin]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">-rwxrwxrwx. 1 xisun xisun 908 9月   1 13:33 xsync</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试脚本，将 hadoop102 上的 <code>/home/xisun/bin</code> 目录，同步到 hadoop103 和 hadoop104 上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">pwd</span></span><br><span class="line">/home/xisun</span><br><span class="line">[xisun@hadoop102 ~]$ xsync /home/xisun/bin/</span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">The authenticity of host <span class="string">&#x27;hadoop102 (192.168.10.102)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:AOkUHU40E6uekNRiFpZkT4R2gfoE+s9ujdYTZ5e8kwM.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:dd:80:45:3e:83:75:92:fe:57:d3:78:fa:af:5a:ca:1b.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>hadoop102,192.168.10.102<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">xisun@hadoop102&#x27;</span>s password: </span><br><span class="line">xisun@hadoop102<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">sending incremental file list</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sent 90 bytes  received 17 bytes  16.46 bytes/sec</span></span><br><span class="line"><span class="string">total size is 908  speedup is 8.49</span></span><br><span class="line"><span class="string">==================== hadoop103 ====================</span></span><br><span class="line"><span class="string">xisun@hadoop103&#x27;</span>s password: </span><br><span class="line">xisun@hadoop103<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">sending incremental file list</span></span><br><span class="line"><span class="string">bin/</span></span><br><span class="line"><span class="string">bin/xsync</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sent 1,044 bytes  received 39 bytes  196.91 bytes/sec</span></span><br><span class="line"><span class="string">total size is 908  speedup is 0.84</span></span><br><span class="line"><span class="string">==================== hadoop104 ====================</span></span><br><span class="line"><span class="string">xisun@hadoop104&#x27;</span>s password: </span><br><span class="line">xisun@hadoop104<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">sending incremental file list</span></span><br><span class="line"><span class="string">bin/</span></span><br><span class="line"><span class="string">bin/xsync</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">sent 1,044 bytes  received 39 bytes  240.67 bytes/sec</span></span><br><span class="line"><span class="string">total size is 908  speedup is 0.84</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="ssh-免密登录配置"><a href="#ssh-免密登录配置" class="headerlink" title="ssh 免密登录配置"></a>ssh 免密登录配置</h4><ul>
<li><p>ssh 命令可以在当前主机上，连接另一台主机，在连接过程中，需要另一台主机的通行密码。</p>
<ul>
<li><p>基本语法：<code>ssh 另一台主机的IP地址</code></p>
</li>
<li><p>ssh 连接时出现 Host key verification failed 的解决方法：输入 yes 并回车。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Are you sure you want to <span class="built_in">continue</span> connecting (yes/no)? </span><br></pre></td></tr></table></figure>
</li>
<li><p>ssh 连接到另一台主机后，使用 exit 命令可以回到原来的主机：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ ssh hadoop103</span><br><span class="line">xisun@hadoop103<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Last login: Tue Aug 31 16:47:43 2021 from 192.168.10.1</span></span><br><span class="line"><span class="string">[xisun@hadoop103 ~]$ exit </span></span><br><span class="line"><span class="string">登出</span></span><br><span class="line"><span class="string">Connection to hadoop103 closed.</span></span><br><span class="line"><span class="string">[xisun@hadoop102 ~]$ </span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>免密钥配置</p>
<ul>
<li><p>免密登录原理：</p>
<p><img src="/2021/08/25/hadoop/image-20210901151616233.png" alt="image-20210901151616233"></p>
</li>
<li><p>在 hadoop102 生成公钥和私钥：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 .ssh]$ <span class="built_in">pwd</span></span><br><span class="line">/home/xisun/.ssh</span><br><span class="line">[xisun@hadoop102 .ssh]$ ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/xisun/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/xisun/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/xisun/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:j9G3rd2/lBjPliez4vXcinw0R5CJy8mja0u7wBWgPDU xisun@hadoop102</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|        E    . o |</span></span><br><span class="line"><span class="string">|     . o o  . +  |</span></span><br><span class="line"><span class="string">|      +   .o o . |</span></span><br><span class="line"><span class="string">|       . . .*   .|</span></span><br><span class="line"><span class="string">|        S o..o . |</span></span><br><span class="line"><span class="string">|       . =.. oB +|</span></span><br><span class="line"><span class="string">|        + o..o=X.|</span></span><br><span class="line"><span class="string">|         ooo.=+Bo|</span></span><br><span class="line"><span class="string">|         .++=o+oO|</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">[xisun@hadoop102 .ssh]$ ll</span></span><br><span class="line"><span class="string">总用量 12</span></span><br><span class="line"><span class="string">-rw-------. 1 xisun xisun 1675 9月   1 15:59 id_rsa</span></span><br><span class="line"><span class="string">-rw-r--r--. 1 xisun xisun  397 9月   1 15:59 id_rsa.pub</span></span><br><span class="line"><span class="string">-rw-r--r--. 1 xisun xisun  558 9月   1 14:29 known_hosts</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在 <code>/home/xisun/.ssh</code> 路径下，执行 <code>ssh-keygen -t rsa</code> 命令，敲三次回车，即可生成两个文件，私钥和公钥。</li>
<li>id_rsa 为 hadoop102 的私钥，id_rsa.pub 为 hadoop102 的公钥。</li>
</ul>
</li>
<li><p>将 hadoop102 的公钥，拷贝到要免密登录的目标机器上，即 hadoop102，hadoop103 和 hadoop104：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ ssh-copy-id hadoop102</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">&quot;/home/xisun/.ssh/id_rsa.pub&quot;</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">xisun@hadoop102<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Number of key(s) added: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now try logging into the machine, with:   &quot;ssh &#x27;</span>hadoop102<span class="string">&#x27;&quot;</span></span><br><span class="line"><span class="string">and check to make sure that only the key(s) you wanted were added.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[xisun@hadoop102 ~]$ ssh hadoop102</span></span><br><span class="line"><span class="string">Last login: Wed Sep  1 16:11:59 2021 from hadoop102</span></span><br><span class="line"><span class="string">[xisun@hadoop102 ~]$ exit</span></span><br><span class="line"><span class="string">登出</span></span><br><span class="line"><span class="string">Connection to hadoop102 closed.</span></span><br><span class="line"><span class="string">[xisun@hadoop102 ~]$ </span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 .ssh]$ ssh-copy-id hadoop103</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">&quot;/home/xisun/.ssh/id_rsa.pub&quot;</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">xisun@hadoop103<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Number of key(s) added: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now try logging into the machine, with:   &quot;ssh &#x27;</span>hadoop103<span class="string">&#x27;&quot;</span></span><br><span class="line"><span class="string">and check to make sure that only the key(s) you wanted were added.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[xisun@hadoop102 .ssh]$ ssh hadoop103</span></span><br><span class="line"><span class="string">Last login: Wed Sep  1 15:02:49 2021 from hadoop102</span></span><br><span class="line"><span class="string">[xisun@hadoop103 ~]$ exit</span></span><br><span class="line"><span class="string">登出</span></span><br><span class="line"><span class="string">Connection to hadoop103 closed.</span></span><br><span class="line"><span class="string">[xisun@hadoop102 .ssh]$ </span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 .ssh]$ ssh-copy-id hadoop104</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">&quot;/home/xisun/.ssh/id_rsa.pub&quot;</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">xisun@hadoop104<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Number of key(s) added: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now try logging into the machine, with:   &quot;ssh &#x27;</span>hadoop104<span class="string">&#x27;&quot;</span></span><br><span class="line"><span class="string">and check to make sure that only the key(s) you wanted were added.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[xisun@hadoop102 .ssh]$ ssh hadoop104</span></span><br><span class="line"><span class="string">Last failed login: Wed Sep  1 14:43:15 CST 2021 from hadoop102 on ssh:notty</span></span><br><span class="line"><span class="string">There was 1 failed login attempt since the last successful login.</span></span><br><span class="line"><span class="string">Last login: Tue Aug 31 16:48:06 2021 from 192.168.10.1</span></span><br><span class="line"><span class="string">[xisun@hadoop104 ~]$ exit</span></span><br><span class="line"><span class="string">登出</span></span><br><span class="line"><span class="string">Connection to hadoop104 closed.</span></span><br><span class="line"><span class="string">[xisun@hadoop102 .ssh]$ </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>按上面同样的步骤，对 hadoop103 和 hadoop104 进行 ssh 免密登录配置。</p>
</li>
<li><p>注意：上面的配置只对 xisun 用户有效，如果希望 root 用户也能免密 ssh 登录，需要切换到 root 账号，做同样的配置：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ su root</span><br><span class="line">密码：</span><br><span class="line">[root@hadoop102 xisun]<span class="comment"># cd .ssh/</span></span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># pwd</span></span><br><span class="line">/home/xisun/.ssh</span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># ll</span></span><br><span class="line">总用量 16</span><br><span class="line">-rw-------. 1 xisun xisun 1191 9月   1 16:32 authorized_keys</span><br><span class="line">-rw-------. 1 xisun xisun 1675 9月   1 15:59 id_rsa</span><br><span class="line">-rw-r--r--. 1 xisun xisun  397 9月   1 15:59 id_rsa.pub</span><br><span class="line">-rw-r--r--. 1 xisun xisun  558 9月   1 14:29 known_hosts</span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># ssh-keygen -t rsa</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:AQtFVBbgnBrY8u/vIGgxFUxqHtKOYzKFIVRbHNJoMEw root@hadoop102</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|*Eo=B*Bo+.       |</span></span><br><span class="line"><span class="string">|.=.*=B =         |</span></span><br><span class="line"><span class="string">|o X.+ = .        |</span></span><br><span class="line"><span class="string">| B = o   .       |</span></span><br><span class="line"><span class="string">|=.= o   S        |</span></span><br><span class="line"><span class="string">|oo + .           |</span></span><br><span class="line"><span class="string">|  o . o          |</span></span><br><span class="line"><span class="string">| .   o .         |</span></span><br><span class="line"><span class="string">|      .oo        |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">[root@hadoop102 .ssh]# ssh-copy-id hadoop102</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/root/.ssh/id_rsa.pub&quot;</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span></span><br><span class="line"><span class="string">root@hadoop102&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   <span class="string">&quot;ssh &#x27;hadoop102&#x27;&quot;</span></span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># ssh hadoop102</span></span><br><span class="line">Last login: Wed Sep  1 16:41:01 2021</span><br><span class="line">[root@hadoop102 ~]<span class="comment"># exit</span></span><br><span class="line">登出</span><br><span class="line">Connection to hadoop102 closed.</span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># ssh-copy-id hadoop103</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">&quot;/root/.ssh/id_rsa.pub&quot;</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">root@hadoop103<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Number of key(s) added: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now try logging into the machine, with:   &quot;ssh &#x27;</span>hadoop103<span class="string">&#x27;&quot;</span></span><br><span class="line"><span class="string">and check to make sure that only the key(s) you wanted were added.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[root@hadoop102 .ssh]# ssh hadoop103</span></span><br><span class="line"><span class="string">Last failed login: Wed Sep  1 14:48:11 CST 2021 from hadoop102 on ssh:notty</span></span><br><span class="line"><span class="string">There was 1 failed login attempt since the last successful login.</span></span><br><span class="line"><span class="string">Last login: Tue Aug 31 10:02:38 2021</span></span><br><span class="line"><span class="string">exi[root@hadoop103 ~]# exit</span></span><br><span class="line"><span class="string">登出</span></span><br><span class="line"><span class="string">Connection to hadoop103 closed.</span></span><br><span class="line"><span class="string">[root@hadoop102 .ssh]# ssh-copy-id hadoop104</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &quot;/root/.ssh/id_rsa.pub&quot;</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span></span><br><span class="line"><span class="string">root@hadoop104&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   <span class="string">&quot;ssh &#x27;hadoop104&#x27;&quot;</span></span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># ssh hadoop104</span></span><br><span class="line">Last login: Wed Sep  1 16:39:50 2021</span><br><span class="line">[root@hadoop104 ~]<span class="comment"># exit</span></span><br><span class="line">登出</span><br><span class="line">Connection to hadoop104 closed.</span><br><span class="line">[root@hadoop102 .ssh]<span class="comment"># </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置完免密登录后，测试可以看出，使用 xsync 脚本分发文件时，不需要输入密码：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ xsync a.txt </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 58 bytes  received 12 bytes  46.67 bytes/sec</span><br><span class="line">total size is 0  speedup is 0.00</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">a.txt</span><br><span class="line"></span><br><span class="line">sent 101 bytes  received 35 bytes  272.00 bytes/sec</span><br><span class="line">total size is 0  speedup is 0.00</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">a.txt</span><br><span class="line"></span><br><span class="line">sent 101 bytes  received 35 bytes  272.00 bytes/sec</span><br><span class="line">total size is 0  speedup is 0.00</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>/home/xisun/.ssh</code> 路径下的文件功能解释：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 .ssh]$ ll</span><br><span class="line">总用量 16</span><br><span class="line">-rw-------. 1 xisun xisun  397 9月   1 16:12 authorized_keys</span><br><span class="line">-rw-------. 1 xisun xisun 1675 9月   1 15:59 id_rsa</span><br><span class="line">-rw-r--r--. 1 xisun xisun  397 9月   1 15:59 id_rsa.pub</span><br><span class="line">-rw-r--r--. 1 xisun xisun  558 9月   1 14:29 known_hosts</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>文件名</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>known_hosts</td>
<td>记录当前主机ssh访问过的计算机的公钥（public  key）</td>
</tr>
<tr>
<td>id_rsa</td>
<td>当前主机生成的私钥</td>
</tr>
<tr>
<td>id_rsa.pub</td>
<td>当前主机生成的公钥</td>
</tr>
<tr>
<td>authorized_keys</td>
<td>存放授权过的无密登录服务器公钥</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
</ul>
<h4 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h4><h5 id="集群部署规划"><a href="#集群部署规划" class="headerlink" title="集群部署规划"></a>集群部署规划</h5><table>
<thead>
<tr>
<th></th>
<th>hadoop102</th>
<th>hadoop103</th>
<th>hadoop104</th>
</tr>
</thead>
<tbody><tr>
<td>HDFS</td>
<td><strong>NameNode</strong><br>DataNode</td>
<td><br>DataNode</td>
<td><strong>SecondaryNameNode</strong><br>DataNode</td>
</tr>
<tr>
<td>YARN</td>
<td><br>NodeManager</td>
<td><strong>ResourceManager</strong><br>NodeManager</td>
<td><br>NodeManager</td>
</tr>
</tbody></table>
<ul>
<li>NameNode 和 SecondaryNameNode 都比较消耗内存，不要安装在同一台服务器上。</li>
<li>ResourceManager 也很消耗内存，不要和 NameNode、SecondaryNameNode 配置在同一台服务器上。</li>
</ul>
<h5 id="配置文件说明"><a href="#配置文件说明" class="headerlink" title="配置文件说明"></a>配置文件说明</h5><ul>
<li><p>Hadoop 配置文件分两类：默认配置文件和自定义配置文件。只有用户想修改某一默认配置值时，才需要修改自定义配置文件，更改相应属性值。</p>
</li>
<li><p>默认配置文件</p>
<table>
<thead>
<tr>
<th>要获取的默认文件</th>
<th>文件存放在Hadoop的JAR包中的位置</th>
</tr>
</thead>
<tbody><tr>
<td>[core-default.xml]</td>
<td>hadoop-common-3.2.1.jar/core-default.xml</td>
</tr>
<tr>
<td>[hdfs-default.xml]</td>
<td>hadoop-hdfs-3.2.1.jar/hdfs-default.xml</td>
</tr>
<tr>
<td>[yarn-default.xml]</td>
<td>hadoop-yarn-common-3.2.1.jar/yarn-default.xml</td>
</tr>
<tr>
<td>[mapred-default.xml]</td>
<td>hadoop-mapreduce-client-core-3.2.1.jar/mapred-default.xml</td>
</tr>
</tbody></table>
<ul>
<li><p>core-default.xml：</p>
<p><img src="/2021/08/25/hadoop/image-20210909161942025.png" alt="image-20210909161942025"></p>
</li>
<li><p>hdfs-default.xml：</p>
<p><img src="/2021/08/25/hadoop/image-20210909163524558.png" alt="image-20210909163524558"></p>
<ul>
<li><p>需要添加依赖才能看到：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-hdfs<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>yarn-default.xml：</p>
<p><img src="/2021/08/25/hadoop/image-20210909162213537.png" alt="image-20210909162213537"></p>
</li>
<li><p>mapred-default.xml：</p>
<p><img src="/2021/08/25/hadoop/image-20210909162538370.png" alt="image-20210909162538370"></p>
</li>
</ul>
</li>
<li><p>自定义配置文件</p>
<ul>
<li><p>Hadoop 的四个默认配置文件，分别对应以下四个自定义配置文件：core-site.xml、hdfs-site.xml、yarn-site.xml、mapred-site.xml。这四个自定义配置文件，存放在 <code>$HADOOP_HOME/etc/hadoop</code> 这个路径上，用户可以根据项目需求重新进行修改配置。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop</span><br><span class="line">[xisun@hadoop102 hadoop]$ ll</span><br><span class="line">总用量 172</span><br><span class="line">-rw-r--r--. 1 xisun xisun  8260 9月  11 2019 capacity-scheduler.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1335 9月  11 2019 configuration.xsl</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1940 9月  11 2019 container-executor.cfg</span><br><span class="line">-rw-r--r--. 1 xisun xisun   774 9月  10 2019 core-site.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun  3999 9月  10 2019 hadoop-env.cmd</span><br><span class="line">-rw-r--r--. 1 xisun xisun 16235 9月  11 2019 hadoop-env.sh</span><br><span class="line">-rw-r--r--. 1 xisun xisun  3321 9月  10 2019 hadoop-metrics2.properties</span><br><span class="line">-rw-r--r--. 1 xisun xisun 11392 9月  10 2019 hadoop-policy.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun  3414 9月  10 2019 hadoop-user-functions.sh.example</span><br><span class="line">-rw-r--r--. 1 xisun xisun   775 9月  11 2019 hdfs-site.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1484 9月  11 2019 httpfs-env.sh</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1657 9月  11 2019 httpfs-log4j.properties</span><br><span class="line">-rw-r--r--. 1 xisun xisun    21 9月  11 2019 httpfs-signature.secret</span><br><span class="line">-rw-r--r--. 1 xisun xisun   620 9月  11 2019 httpfs-site.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun  3518 9月  10 2019 kms-acls.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1351 9月  10 2019 kms-env.sh</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1860 9月  10 2019 kms-log4j.properties</span><br><span class="line">-rw-r--r--. 1 xisun xisun   682 9月  10 2019 kms-site.xml</span><br><span class="line">-rw-r--r--. 1 xisun xisun 13326 9月  10 2019 log4j.properties</span><br><span class="line">-rw-r--r--. 1 xisun xisun   951 9月  11 2019 mapred-env.cmd</span><br><span class="line">-rw-r--r--. 1 xisun xisun  1764 9月  11 2019 mapred-env.sh</span><br><span class="line">-rw-r--r--. 1 xisun xisun  4113 9月  11 2019 mapred-queues.xml.template</span><br><span class="line">-rw-r--r--. 1 xisun xisun   758 9月  11 2019 mapred-site.xml</span><br><span class="line">drwxr-xr-x. 2 xisun xisun    24 9月  10 2019 shellprofile.d</span><br><span class="line">-rw-r--r--. 1 xisun xisun  2316 9月  10 2019 ssl-client.xml.example</span><br><span class="line">-rw-r--r--. 1 xisun xisun  2697 9月  10 2019 ssl-server.xml.example</span><br><span class="line">-rw-r--r--. 1 xisun xisun  2642 9月  11 2019 user_ec_policies.xml.template</span><br><span class="line">-rw-r--r--. 1 xisun xisun    10 9月  10 2019 workers</span><br><span class="line">-rw-r--r--. 1 xisun xisun  2250 9月  11 2019 yarn-env.cmd</span><br><span class="line">-rw-r--r--. 1 xisun xisun  6056 9月  11 2019 yarn-env.sh</span><br><span class="line">-rw-r--r--. 1 xisun xisun  2591 9月  11 2019 yarnservice-log4j.properties</span><br><span class="line">-rw-r--r--. 1 xisun xisun   690 9月  11 2019 yarn-site.xml</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h5 id="配置集群"><a href="#配置集群" class="headerlink" title="配置集群"></a>配置集群</h5><ul>
<li><p>第一步：核心配置文件 — 配置 core-site.xml。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop</span><br><span class="line">[xisun@hadoop102 hadoop]$ vim core-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment">  you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment">  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">  See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">  limitations under the License. See accompanying LICENSE file.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定NameNode的地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定Hadoop数据的存储目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.2.1/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：HDFS 配置文件 — 配置 hdfs-site.xml。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop</span><br><span class="line">[xisun@hadoop102 hadoop]$ vim hdfs-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment">  you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment">  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">  See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">  limitations under the License. See accompanying LICENSE file.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- nn web端访问地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:9870<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 2nn web端访问地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop104:9868<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第三步：YARN 配置文件 — 配置 yarn-site.xml。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop</span><br><span class="line">[xisun@hadoop102 hadoop]$ vim yarn-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment">  you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment">  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">  See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">  limitations under the License. See accompanying LICENSE file.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Site specific YARN configuration properties --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定MapReduce走shuffle --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定ResourceManager的地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop103<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第四步：MapReduce 配置文件 — 配置 mapred-site.xml。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop</span><br><span class="line">[xisun@hadoop102 hadoop]$ vim mapred-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment">  you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment">  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">  See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">  limitations under the License. See accompanying LICENSE file.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定MapReduce程序运行在Yarn上 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第五步：在集群上分发在 hadoop102 上配置好的 Hadoop 配置文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ xsync /opt/module/hadoop-3.2.1/etc/hadoop/</span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 972 bytes  received 18 bytes  1,980.00 bytes/sec</span><br><span class="line">total size is 107,791  speedup is 108.88</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">hadoop/</span><br><span class="line">hadoop/core-site.xml</span><br><span class="line">hadoop/hdfs-site.xml</span><br><span class="line">hadoop/mapred-site.xml</span><br><span class="line">hadoop/yarn-site.xml</span><br><span class="line"></span><br><span class="line">sent 3,165 bytes  received 139 bytes  2,202.67 bytes/sec</span><br><span class="line">total size is 107,791  speedup is 32.62</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">hadoop/</span><br><span class="line">hadoop/core-site.xml</span><br><span class="line">hadoop/hdfs-site.xml</span><br><span class="line">hadoop/mapred-site.xml</span><br><span class="line">hadoop/yarn-site.xml</span><br><span class="line"></span><br><span class="line">sent 3,165 bytes  received 139 bytes  6,608.00 bytes/sec</span><br><span class="line">total size is 107,791  speedup is 32.62</span><br></pre></td></tr></table></figure>
</li>
<li><p>第六步：到 hadoop103 和 hadoop104 上查看文件分发情况。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ cat /opt/module/hadoop-3.2.1/etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 ~]$ cat /opt/module/hadoop-3.2.1/etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="群起集群"><a href="#群起集群" class="headerlink" title="群起集群"></a>群起集群</h4><h5 id="配置-workers"><a href="#配置-workers" class="headerlink" title="配置 workers"></a>配置 workers</h5><ul>
<li><p>打开 workers 文件，删除默认值 localhost，然后向 workers 文件中添加如下内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop</span><br><span class="line">[xisun@hadoop102 hadoop]$ vim workers</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop102</span><br><span class="line">hadoop103</span><br><span class="line">hadoop104</span><br></pre></td></tr></table></figure>
</li>
<li><p>workers 文件中添加的主机名，即是 Hadoop 集群中的各个节点。</p>
</li>
<li><p>注意：workers 文件中添加的内容结尾不允许有空格，文件中不允许有空行。</p>
</li>
<li><p>同步所有节点配置文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ xsync /opt/module/hadoop-3.2.1/etc/hadoop/workers </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 59 bytes  received 12 bytes  142.00 bytes/sec</span><br><span class="line">total size is 30  speedup is 0.42</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">workers</span><br><span class="line"></span><br><span class="line">sent 136 bytes  received 41 bytes  354.00 bytes/sec</span><br><span class="line">total size is 30  speedup is 0.17</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">workers</span><br><span class="line"></span><br><span class="line">sent 136 bytes  received 41 bytes  354.00 bytes/sec</span><br><span class="line">total size is 30  speedup is 0.17</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="启动集群"><a href="#启动集群" class="headerlink" title="启动集群"></a>启动集群</h5><ul>
<li><p>第一步：如果集群是第一次启动，需要在配置了 NameNode 的节点（hadoop102）上格式化 NameNode。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hdfs namenode -format</span><br><span class="line">WARNING: /opt/module/hadoop-3.2.1/logs does not exist. Creating.</span><br><span class="line">2021-09-01 22:39:39,794 INFO namenode.NameNode: STARTUP_MSG: </span><br><span class="line">/************************************************************</span><br><span class="line">STARTUP_MSG: Starting NameNode</span><br><span class="line">STARTUP_MSG:   host = hadoop102/192.168.10.102</span><br><span class="line">STARTUP_MSG:   args = [-format]</span><br><span class="line">STARTUP_MSG:   version = 3.2.1</span><br><span class="line">STARTUP_MSG:   classpath = /opt/module/hadoop-3.2.1/etc/hadoop:…… ……</span><br><span class="line">STARTUP_MSG:   build = https://gitbox.apache.org/repos/asf/hadoop.git -r b3cbbb467e22ea829b3808f4b7b01d07e0bf3842; compiled by <span class="string">&#x27;rohithsharmaks&#x27;</span> on 2019-09-10T15:56Z</span><br><span class="line">STARTUP_MSG:   java = 1.8.0_302</span><br><span class="line">************************************************************/</span><br><span class="line">2021-09-01 22:39:40,092 INFO namenode.NameNode: registered UNIX signal handlers <span class="keyword">for</span> [TERM, HUP, INT]</span><br><span class="line">2021-09-01 22:39:42,475 INFO namenode.NameNode: createNameNode [-format]</span><br><span class="line">Formatting using clusterid: CID-ffd49d0a-1e29-4912-91a7-0d6ce7121fda</span><br><span class="line">2021-09-01 22:39:49,477 INFO namenode.FSEditLog: Edit logging is async:<span class="literal">true</span></span><br><span class="line">2021-09-01 22:39:52,982 INFO namenode.FSNamesystem: KeyProvider: null</span><br><span class="line">2021-09-01 22:39:53,002 INFO namenode.FSNamesystem: fsLock is fair: <span class="literal">true</span></span><br><span class="line">2021-09-01 22:39:53,037 INFO namenode.FSNamesystem: Detailed lock hold time metrics enabled: <span class="literal">false</span></span><br><span class="line">2021-09-01 22:39:53,112 INFO namenode.FSNamesystem: fsOwner             = xisun (auth:SIMPLE)</span><br><span class="line">2021-09-01 22:39:53,112 INFO namenode.FSNamesystem: supergroup          = supergroup</span><br><span class="line">2021-09-01 22:39:53,113 INFO namenode.FSNamesystem: isPermissionEnabled = <span class="literal">true</span></span><br><span class="line">2021-09-01 22:39:53,113 INFO namenode.FSNamesystem: HA Enabled: <span class="literal">false</span></span><br><span class="line">2021-09-01 22:39:54,396 INFO common.Util: dfs.datanode.fileio.profiling.sampling.percentage <span class="built_in">set</span> to 0. Disabling file IO profiling</span><br><span class="line">2021-09-01 22:39:54,448 INFO blockmanagement.DatanodeManager: dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000</span><br><span class="line">2021-09-01 22:39:54,448 INFO blockmanagement.DatanodeManager: dfs.namenode.datanode.registration.ip-hostname-check=<span class="literal">true</span></span><br><span class="line">2021-09-01 22:39:54,617 INFO blockmanagement.BlockManager: dfs.namenode.startup.delay.block.deletion.sec is <span class="built_in">set</span> to 000:00:00:00.000</span><br><span class="line">2021-09-01 22:39:54,618 INFO blockmanagement.BlockManager: The block deletion will start around 2021 九月 01 22:39:54</span><br><span class="line">2021-09-01 22:39:54,621 INFO util.GSet: Computing capacity <span class="keyword">for</span> map BlocksMap</span><br><span class="line">2021-09-01 22:39:54,621 INFO util.GSet: VM <span class="built_in">type</span>       = 64-bit</span><br><span class="line">2021-09-01 22:39:54,654 INFO util.GSet: 2.0% max memory 441 MB = 8.8 MB</span><br><span class="line">2021-09-01 22:39:54,654 INFO util.GSet: capacity      = 2^20 = 1048576 entries</span><br><span class="line">2021-09-01 22:39:54,679 INFO blockmanagement.BlockManager: Storage policy satisfier is disabled</span><br><span class="line">2021-09-01 22:39:54,679 INFO blockmanagement.BlockManager: dfs.block.access.token.enable = <span class="literal">false</span></span><br><span class="line">2021-09-01 22:39:54,707 INFO Configuration.deprecation: No unit <span class="keyword">for</span> dfs.namenode.safemode.extension(30000) assuming MILLISECONDS</span><br><span class="line">2021-09-01 22:39:54,707 INFO blockmanagement.BlockManagerSafeMode: dfs.namenode.safemode.threshold-pct = 0.9990000128746033</span><br><span class="line">2021-09-01 22:39:54,708 INFO blockmanagement.BlockManagerSafeMode: dfs.namenode.safemode.min.datanodes = 0</span><br><span class="line">2021-09-01 22:39:54,708 INFO blockmanagement.BlockManagerSafeMode: dfs.namenode.safemode.extension = 30000</span><br><span class="line">2021-09-01 22:39:54,708 INFO blockmanagement.BlockManager: defaultReplication         = 3</span><br><span class="line">2021-09-01 22:39:54,709 INFO blockmanagement.BlockManager: maxReplication             = 512</span><br><span class="line">2021-09-01 22:39:54,709 INFO blockmanagement.BlockManager: minReplication             = 1</span><br><span class="line">2021-09-01 22:39:54,709 INFO blockmanagement.BlockManager: maxReplicationStreams      = 2</span><br><span class="line">2021-09-01 22:39:54,709 INFO blockmanagement.BlockManager: redundancyRecheckInterval  = 3000ms</span><br><span class="line">2021-09-01 22:39:54,709 INFO blockmanagement.BlockManager: encryptDataTransfer        = <span class="literal">false</span></span><br><span class="line">2021-09-01 22:39:54,709 INFO blockmanagement.BlockManager: maxNumBlocksToLog          = 1000</span><br><span class="line">2021-09-01 22:39:54,794 INFO namenode.FSDirectory: GLOBAL serial map: bits=29 maxEntries=536870911</span><br><span class="line">2021-09-01 22:39:54,794 INFO namenode.FSDirectory: USER serial map: bits=24 maxEntries=16777215</span><br><span class="line">2021-09-01 22:39:54,794 INFO namenode.FSDirectory: GROUP serial map: bits=24 maxEntries=16777215</span><br><span class="line">2021-09-01 22:39:54,794 INFO namenode.FSDirectory: XATTR serial map: bits=24 maxEntries=16777215</span><br><span class="line">2021-09-01 22:39:54,831 INFO util.GSet: Computing capacity <span class="keyword">for</span> map INodeMap</span><br><span class="line">2021-09-01 22:39:54,832 INFO util.GSet: VM <span class="built_in">type</span>       = 64-bit</span><br><span class="line">2021-09-01 22:39:54,832 INFO util.GSet: 1.0% max memory 441 MB = 4.4 MB</span><br><span class="line">2021-09-01 22:39:54,832 INFO util.GSet: capacity      = 2^19 = 524288 entries</span><br><span class="line">2021-09-01 22:39:54,833 INFO namenode.FSDirectory: ACLs enabled? <span class="literal">false</span></span><br><span class="line">2021-09-01 22:39:54,834 INFO namenode.FSDirectory: POSIX ACL inheritance enabled? <span class="literal">true</span></span><br><span class="line">2021-09-01 22:39:54,834 INFO namenode.FSDirectory: XAttrs enabled? <span class="literal">true</span></span><br><span class="line">2021-09-01 22:39:54,834 INFO namenode.NameNode: Caching file names occurring more than 10 <span class="built_in">times</span></span><br><span class="line">2021-09-01 22:39:54,847 INFO snapshot.SnapshotManager: Loaded config captureOpenFiles: <span class="literal">false</span>, skipCaptureAccessTimeOnlyChange: <span class="literal">false</span>, snapshotDiffAllowSnapRootDescendant: <span class="literal">true</span>, maxSnapshotLimit: 65536</span><br><span class="line">2021-09-01 22:39:54,859 INFO snapshot.SnapshotManager: SkipList is disabled</span><br><span class="line">2021-09-01 22:39:54,868 INFO util.GSet: Computing capacity <span class="keyword">for</span> map cachedBlocks</span><br><span class="line">2021-09-01 22:39:54,868 INFO util.GSet: VM <span class="built_in">type</span>       = 64-bit</span><br><span class="line">2021-09-01 22:39:54,868 INFO util.GSet: 0.25% max memory 441 MB = 1.1 MB</span><br><span class="line">2021-09-01 22:39:54,868 INFO util.GSet: capacity      = 2^17 = 131072 entries</span><br><span class="line">2021-09-01 22:39:54,899 INFO metrics.TopMetrics: NNTop conf: dfs.namenode.top.window.num.buckets = 10</span><br><span class="line">2021-09-01 22:39:54,899 INFO metrics.TopMetrics: NNTop conf: dfs.namenode.top.num.users = 10</span><br><span class="line">2021-09-01 22:39:54,899 INFO metrics.TopMetrics: NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25</span><br><span class="line">2021-09-01 22:39:54,914 INFO namenode.FSNamesystem: Retry cache on namenode is enabled</span><br><span class="line">2021-09-01 22:39:54,914 INFO namenode.FSNamesystem: Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis</span><br><span class="line">2021-09-01 22:39:54,917 INFO util.GSet: Computing capacity <span class="keyword">for</span> map NameNodeRetryCache</span><br><span class="line">2021-09-01 22:39:54,917 INFO util.GSet: VM <span class="built_in">type</span>       = 64-bit</span><br><span class="line">2021-09-01 22:39:54,917 INFO util.GSet: 0.029999999329447746% max memory 441 MB = 135.5 KB</span><br><span class="line">2021-09-01 22:39:54,917 INFO util.GSet: capacity      = 2^14 = 16384 entries</span><br><span class="line">2021-09-01 22:39:55,000 INFO namenode.FSImage: Allocated new BlockPoolId: BP-288566776-192.168.10.102-1630507194979</span><br><span class="line">2021-09-01 22:39:55,144 INFO common.Storage: Storage directory /opt/module/hadoop-3.2.1/data/dfs/name has been successfully formatted.</span><br><span class="line">2021-09-01 22:39:57,641 INFO namenode.FSImageFormatProtobuf: Saving image file /opt/module/hadoop-3.2.1/data/dfs/name/current/fsimage.ckpt_0000000000000000000 using no compression</span><br><span class="line">2021-09-01 22:39:58,078 INFO namenode.FSImageFormatProtobuf: Image file /opt/module/hadoop-3.2.1/data/dfs/name/current/fsimage.ckpt_0000000000000000000 of size 400 bytes saved <span class="keyword">in</span> 0 seconds .</span><br><span class="line">2021-09-01 22:39:58,126 INFO namenode.NNStorageRetentionManager: Going to retain 1 images with txid &gt;= 0</span><br><span class="line">2021-09-01 22:39:58,206 INFO namenode.FSImage: FSImageSaver clean checkpoint: txid=0 when meet shutdown.</span><br><span class="line">2021-09-01 22:39:58,208 INFO namenode.NameNode: SHUTDOWN_MSG: </span><br><span class="line">/************************************************************</span><br><span class="line">SHUTDOWN_MSG: Shutting down NameNode at hadoop102/192.168.10.102</span><br><span class="line">************************************************************/</span><br><span class="line">[xisun@hadoop102 ~]$ ll /opt/module/hadoop-3.2.1/</span><br><span class="line">总用量 180</span><br><span class="line">drwxr-xr-x. 2 xisun xisun    203 9月  11 2019 bin</span><br><span class="line">drwxrwxr-x. 3 xisun xisun     17 9月   1 22:39 data</span><br><span class="line">drwxr-xr-x. 3 xisun xisun     20 9月  10 2019 etc</span><br><span class="line">drwxr-xr-x. 2 xisun xisun    106 9月  11 2019 include</span><br><span class="line">drwxr-xr-x. 3 xisun xisun     20 9月  11 2019 lib</span><br><span class="line">drwxr-xr-x. 4 xisun xisun    288 9月  11 2019 libexec</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 150569 9月  10 2019 LICENSE.txt</span><br><span class="line">drwxrwxr-x. 2 xisun xisun     38 9月   1 22:39 logs</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  22125 9月  10 2019 NOTICE.txt</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1361 9月  10 2019 README.txt</span><br><span class="line">drwxr-xr-x. 3 xisun xisun   4096 9月  10 2019 sbin</span><br><span class="line">drwxr-xr-x. 4 xisun xisun     31 9月  11 2019 share</span><br><span class="line">drwxrwxr-x. 2 xisun xisun     22 8月  31 16:00 wcinput</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     88 8月  31 16:04 wcoutput</span><br></pre></td></tr></table></figure>

<ul>
<li><p>格式化 NameNode 完毕后，会在 Hadoop 安装路径下，生成两个新目录 data 和 logs。</p>
</li>
<li><p>注意：第一次格式化 NameNode 之后，如果再次格式化 NameNode 时，会产生新的集群 id，这会导致与前一次生成的 NameNode 和 DataNode 的集群 id 不一致，集群会找不到已往数据。如果集群在运行过程中发生异常，需要重新格式化 NameNode 的话，一定要先停止 namenode 和 datanode 进程（停止 YARN 和 HDFS），并且删除集群上所有机器的 data 和 logs 目录，然后再进行格式化。最后，重新启动集群。原因如下：</p>
<ul>
<li><p>NameNode 的版本号：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">cd</span> /opt/module/hadoop-3.2.1/data/dfs/</span><br><span class="line">[xisun@hadoop102 dfs]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwx------. 3 xisun xisun 40 9月   2 14:05 data</span><br><span class="line">drwxrwxr-x. 3 xisun xisun 40 9月   2 14:05 name</span><br><span class="line">[xisun@hadoop102 dfs]$ <span class="built_in">cd</span> name/current/</span><br><span class="line">[xisun@hadoop102 current]$ ll</span><br><span class="line">总用量 4196</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   1 22:59 edits_0000000000000000001-0000000000000000002</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   1 23:59 edits_0000000000000000003-0000000000000000004</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 00:59 edits_0000000000000000005-0000000000000000006</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 01:59 edits_0000000000000000007-0000000000000000008</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 02:59 edits_0000000000000000009-0000000000000000010</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 03:59 edits_0000000000000000011-0000000000000000012</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 04:59 edits_0000000000000000013-0000000000000000014</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 05:59 edits_0000000000000000015-0000000000000000016</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 06:59 edits_0000000000000000017-0000000000000000018</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 07:59 edits_0000000000000000019-0000000000000000020</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 08:59 edits_0000000000000000021-0000000000000000022</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 09:59 edits_0000000000000000023-0000000000000000024</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    1500 9月   2 10:59 edits_0000000000000000025-0000000000000000045</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 1048576 9月   2 11:34 edits_0000000000000000046-0000000000000000110</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 11:51 edits_0000000000000000111-0000000000000000112</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    8888 9月   2 12:51 edits_0000000000000000113-0000000000000000185</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 1048576 9月   2 12:51 edits_0000000000000000186-0000000000000000186</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 13:11 edits_0000000000000000187-0000000000000000188</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 1048576 9月   2 13:18 edits_0000000000000000189-0000000000000000271</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      42 9月   2 14:06 edits_0000000000000000272-0000000000000000273</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 1048576 9月   2 14:10 edits_inprogress_0000000000000000274</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    2460 9月   2 13:11 fsimage_0000000000000000188</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      62 9月   2 13:11 fsimage_0000000000000000188.md5</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    2955 9月   2 14:06 fsimage_0000000000000000273</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      62 9月   2 14:06 fsimage_0000000000000000273.md5</span><br><span class="line">-rw-rw-r--. 1 xisun xisun       4 9月   2 14:06 seen_txid</span><br><span class="line">-rw-rw-r--. 1 xisun xisun     217 9月   1 22:39 VERSION</span><br><span class="line">[xisun@hadoop102 current]$ cat VERSION </span><br><span class="line"><span class="comment">#Wed Sep 01 22:39:55 CST 2021</span></span><br><span class="line">namespaceID=817173371</span><br><span class="line">clusterID=CID-ffd49d0a-1e29-4912-91a7-0d6ce7121fda</span><br><span class="line">cTime=1630507194979</span><br><span class="line">storageType=NAME_NODE</span><br><span class="line">blockpoolID=BP-288566776-192.168.10.102-1630507194979</span><br><span class="line">layoutVersion=-65</span><br></pre></td></tr></table></figure>
</li>
<li><p>DataNode 的版本号：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">cd</span> /opt/module/hadoop-3.2.1/data/dfs/</span><br><span class="line">[xisun@hadoop102 dfs]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwx------. 3 xisun xisun 40 9月   2 14:05 data</span><br><span class="line">drwxrwxr-x. 3 xisun xisun 40 9月   2 14:05 name</span><br><span class="line">[xisun@hadoop102 dfs]$ <span class="built_in">cd</span> data/current/</span><br><span class="line">[xisun@hadoop102 current]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwx------. 4 xisun xisun  54 9月   2 14:05 BP-288566776-192.168.10.102-1630507194979</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 229 9月   2 14:05 VERSION</span><br><span class="line">[xisun@hadoop102 current]$ cat VERSION </span><br><span class="line"><span class="comment">#Thu Sep 02 14:05:31 CST 2021</span></span><br><span class="line">storageID=DS-7c2f6c8b-80be-44b0-9905-f1621843d7a3</span><br><span class="line">clusterID=CID-ffd49d0a-1e29-4912-91a7-0d6ce7121fda</span><br><span class="line">cTime=0</span><br><span class="line">datanodeUuid=32411bd2-079d-42fb-874a-8e5b492824af</span><br><span class="line">storageType=DATA_NODE</span><br><span class="line">layoutVersion=-57</span><br></pre></td></tr></table></figure>
</li>
<li><p>集群正常情况下，DataNode 版本与 NameNode 的版本是对应的，如果重新格式化了 NameNode，NameNode 的版本号发生改变，集群上之前存储的 DataNode 下的数据，版本对应不上新的 NameNode，集群也就无法正常启动。因此，格式化 NameNode 之前，需要先删除集群所有机器的 data 和 logs 目录。</p>
<p><img src="/2021/08/25/hadoop/image-20210903165511703.png" alt="image-20210903165511703"></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>第二步：在 hadoop102 上启动 HDFS。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ /opt/module/hadoop-3.2.1/sbin/start-dfs.sh </span><br><span class="line">Starting namenodes on [hadoop102]</span><br><span class="line">Starting datanodes</span><br><span class="line">hadoop103: WARNING: /opt/module/hadoop-3.2.1/logs does not exist. Creating.</span><br><span class="line">hadoop104: WARNING: /opt/module/hadoop-3.2.1/logs does not exist. Creating.</span><br><span class="line">Starting secondary namenodes [hadoop104]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以直接使用 start-dfs.sh （脚本存放的位置配置在了环境变量里，因此可以在任何路径使用）启动 HDFS。 </p>
</blockquote>
<ul>
<li><p>在 hadoop102 上查看集群进程启动情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">29008 DataNode</span><br><span class="line">28885 NameNode</span><br><span class="line">29365 Jps</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 hadoop103 上查看集群进程启动情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ jps</span><br><span class="line">23137 DataNode</span><br><span class="line">23283 Jps</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 hadoop104 上查看集群进程启动情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 ~]$ jps</span><br><span class="line">23146 SecondaryNameNode</span><br><span class="line">23259 Jps</span><br><span class="line">23023 DataNode</span><br></pre></td></tr></table></figure>
</li>
<li><p>Web 端查看 HDFS 的 NameNode，浏览器输入 <a target="_blank" rel="noopener" href="http://192.168.10.102:9870/">http://192.168.10.102:9870/</a> 或者  <a target="_blank" rel="noopener" href="http://hadoop102:9870/%EF%BC%88%E8%A6%81%E6%B1%82">http://hadoop102:9870/（要求</a> Windows 电脑上配置了 hadoop102 的主机映射）。</p>
<p><img src="/2021/08/25/hadoop/image-20210901231013153.png" alt="image-20210901231013153"></p>
<p><img src="/2021/08/25/hadoop/image-20210901231122710.png" alt="image-20210901231122710"></p>
</li>
</ul>
</li>
<li><p>第三步：在配置了 ResourceManager 的节点（hadoop103）上启动 YARN。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ /opt/module/hadoop-3.2.1/sbin/start-yarn.sh </span><br><span class="line">Starting resourcemanager</span><br><span class="line">Starting nodemanagers</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在 hadoop102 上也可以启动 YARN。</p>
<p>可以直接使用 start-yarn.sh （脚本存放的位置配置在了环境变量里，因此可以在任何路径使用）启动 YARN。</p>
</blockquote>
<ul>
<li><p>在 hadoop102 上查看集群进程启动情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">29008 DataNode</span><br><span class="line">28885 NameNode</span><br><span class="line">29671 Jps</span><br><span class="line">29563 NodeManager</span><br></pre></td></tr></table></figure>

<blockquote>
<p>hadoop102 是 NameNode 所在的节点。</p>
</blockquote>
</li>
<li><p>在 hadoop103 上查看集群进程启动情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 ~]$ jps</span><br><span class="line">23137 DataNode</span><br><span class="line">23523 ResourceManager</span><br><span class="line">23646 NodeManager</span><br><span class="line">23998 Jps</span><br></pre></td></tr></table></figure>

<blockquote>
<p>hadoop103 是 ResourceManager 所在的节点。</p>
</blockquote>
</li>
<li><p>在 hadoop104 上查看集群进程启动情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 ~]$ jps</span><br><span class="line">23602 Jps</span><br><span class="line">23480 NodeManager</span><br><span class="line">23146 SecondaryNameNode</span><br><span class="line">23023 DataNode</span><br></pre></td></tr></table></figure>

<blockquote>
<p>hadoop104 是 SecondaryNameNode 所在的节点。</p>
</blockquote>
</li>
<li><p>Web 端查看 YARN 的 ResourceManager，浏览器输入 <a target="_blank" rel="noopener" href="http://192.168.10.103:8088/">http://192.168.10.103:8088/</a> 或者 <a target="_blank" rel="noopener" href="http://hadoop103:8088/%EF%BC%88%E8%A6%81%E6%B1%82">http://hadoop103:8088/（要求</a> Windows 电脑上配置了 hadoop103 的主机映射）。</p>
<p><img src="/2021/08/25/hadoop/image-20210901232124548.png" alt="image-20210901232124548"></p>
</li>
</ul>
</li>
</ul>
<h5 id="集群基本测试"><a href="#集群基本测试" class="headerlink" title="集群基本测试"></a>集群基本测试</h5><ul>
<li><p>上传文件到集群</p>
<ul>
<li><p>上传小文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hdfs dfs -mkdir /wcinput</span><br><span class="line">[xisun@hadoop102 ~]$ hdfs dfs -put /opt/module/hadoop-3.2.1/wcinput/word.txt /wcinput</span><br><span class="line">2021-09-02 10:14:15,604 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>在 Web 端查看 HDFS，根目录下新建了一个 wcinput 目录，wcinput 目录下也上传了一个 word.txt 文件：</p>
<p><img src="/2021/08/25/hadoop/image-20210902101737216.png" alt="image-20210902101737216"></p>
<p><img src="/2021/08/25/hadoop/image-20210902101938588.png" alt="image-20210902101938588"></p>
<p><img src="/2021/08/25/hadoop/image-20210902102355046.png" alt="image-20210902102355046"></p>
</li>
<li><p>说明：如果需要在 Web 页面上删除 HDFS 上的文件，需要配置 core-site.xml，添加如下配置，然后集群分发 core-site.xml 文件，并重新启动集群。否则没有权限删除。</p>
<p><img src="/2021/08/25/hadoop/image-20210903145651737.png" alt="image-20210903145651737"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置HDFS网页登录使用的静态用户为atguigu --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.http.staticuser.user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>xisun<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>上传大文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hdfs dfs -put /opt/software/hadoop-3.2.1.tar.gz /</span><br><span class="line">2021-09-02 10:41:41,346 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-02 10:43:40,782 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-02 10:44:58,477 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/25/hadoop/image-20210902104359318.png" alt="image-20210902104359318"></p>
</li>
</ul>
</li>
<li><p>集群上文件的存储位置</p>
<ul>
<li><p>查看 HDFS 文件存储路径</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">cd</span> /opt/module/hadoop-3.2.1/data/</span><br><span class="line">[xisun@hadoop102 data]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data</span><br><span class="line">[xisun@hadoop102 data]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxrwxr-x. 4 xisun xisun 30 9月   1 22:58 dfs</span><br><span class="line">drwxr-xr-x. 5 xisun xisun 57 9月   1 23:15 nm-local-dir</span><br><span class="line">[xisun@hadoop102 data]$ <span class="built_in">cd</span> dfs/</span><br><span class="line">[xisun@hadoop102 dfs]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwx------. 3 xisun xisun 40 9月   1 22:58 data</span><br><span class="line">drwxrwxr-x. 3 xisun xisun 40 9月   1 22:58 name</span><br><span class="line">[xisun@hadoop102 dfs]$ <span class="built_in">cd</span> data/</span><br><span class="line">[xisun@hadoop102 data]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxr-x. 3 xisun xisun 70 9月   1 22:58 current</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 15 9月   1 22:58 in_use.lock</span><br><span class="line">[xisun@hadoop102 data]$ <span class="built_in">cd</span> current/BP-288566776-192.168.10.102-1630507194979/</span><br><span class="line">current/ tmp/     </span><br><span class="line">[xisun@hadoop102 data]$ <span class="built_in">cd</span> current/BP-288566776-192.168.10.102-1630507194979/current/</span><br><span class="line">finalized/ rbw/       </span><br><span class="line">[xisun@hadoop102 data]$ <span class="built_in">cd</span> current/BP-288566776-192.168.10.102-1630507194979/current/finalized/subdir0/subdir0/</span><br><span class="line">[xisun@hadoop102 subdir0]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data/dfs/data/current/BP-288566776-192.168.10.102-1630507194979/current/finalized/subdir0/subdir0</span><br><span class="line">[xisun@hadoop102 subdir0]$ ll</span><br><span class="line">总用量 353540</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        41 9月   2 10:14 blk_1073741825</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        11 9月   2 10:14 blk_1073741825_1001.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:43 blk_1073741826</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:43 blk_1073741826_1002.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:44 blk_1073741827</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:44 blk_1073741827_1003.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  90761455 9月   2 10:45 blk_1073741828</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    709083 9月   2 10:45 blk_1073741828_1004.meta</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 HDFS 在磁盘存储的 word.txt 文件的内容，可以看出，blk_1073741825 就是之前上传的 word.txt 文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 subdir0]$ cat blk_1073741825</span><br><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">xisun</span><br><span class="line">xisun</span><br></pre></td></tr></table></figure>
</li>
<li><p>拼接 HDFS 在磁盘存储的 hadoop-3.2.1.tar.gz 文件的内容，追加到临时的压缩文件中，解压之后可以看出，blk_1073741826，blk_1073741827 和 blk_1073741828 就是之前上传的 hadoop-3.2.1.tar.gz 压缩文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 subdir0]$ cat blk_1073741826 &gt;&gt; ~/tmp.tar.gz</span><br><span class="line">[xisun@hadoop102 subdir0]$ cat blk_1073741827 &gt;&gt; ~/tmp.tar.gz</span><br><span class="line">[xisun@hadoop102 subdir0]$ cat blk_1073741828 &gt;&gt; ~/tmp.tar.gz</span><br><span class="line">[xisun@hadoop102 subdir0]$ <span class="built_in">cd</span> ~</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 393216</span><br><span class="line">drwxrwxr-x. 2 xisun xisun        19 9月   1 13:33 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 359196911 9月   2 11:00 tmp.tar.gz</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ tar -zxf tmp.tar.gz </span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 393216</span><br><span class="line">drwxrwxr-x. 2 xisun xisun        19 9月   1 13:33 bin</span><br><span class="line">drwxr-xr-x. 9 xisun xisun       149 9月  11 2019 hadoop-3.2.1</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 359196911 9月   2 11:00 tmp.tar.gz</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun         6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>

<ul>
<li><p>说明：HDFS 在磁盘上存储的文件，可能是分散的，需要了解分散到哪些文件了，才能追加拼接。</p>
<p><img src="/2021/08/25/hadoop/image-20210903150350257.png" alt="image-20210903150350257"></p>
<p><img src="/2021/08/25/hadoop/image-20210903150602428.png" alt="image-20210903150602428"></p>
</li>
</ul>
</li>
<li><p>HDFS 上的文件是备份在集群的每一台服务器上的（也就是集群的每一台服务器，都是 DataNode），在 hadoop102，hadoop103 和 hadoop104 上相同的路径下，都有相同的数据备份。</p>
<p><img src="/2021/08/25/hadoop/image-20210902111343188.png" alt="image-20210902111343188"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 subdir0]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data/dfs/data/current/BP-288566776-192.168.10.102-1630507194979/current/finalized/subdir0/subdir0</span><br><span class="line">[xisun@hadoop102 subdir0]$ ll</span><br><span class="line">总用量 353540</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        41 9月   2 10:14 blk_1073741825</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        11 9月   2 10:14 blk_1073741825_1001.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:43 blk_1073741826</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:43 blk_1073741826_1002.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:44 blk_1073741827</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:44 blk_1073741827_1003.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  90761455 9月   2 10:45 blk_1073741828</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    709083 9月   2 10:45 blk_1073741828_1004.meta</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop103 subdir0]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data/dfs/data/current/BP-288566776-192.168.10.102-1630507194979/current/finalized/subdir0/subdir0</span><br><span class="line">[xisun@hadoop103 subdir0]$ ll</span><br><span class="line">总用量 353540</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        41 9月   2 10:14 blk_1073741825</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        11 9月   2 10:14 blk_1073741825_1001.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:43 blk_1073741826</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:43 blk_1073741826_1002.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:44 blk_1073741827</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:44 blk_1073741827_1003.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  90761455 9月   2 10:45 blk_1073741828</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    709083 9月   2 10:45 blk_1073741828_1004.meta</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop104 subdir0]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data/dfs/data/current/BP-288566776-192.168.10.102-1630507194979/current/finalized/subdir0/subdir0</span><br><span class="line">[xisun@hadoop104 subdir0]$ ll</span><br><span class="line">总用量 353540</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        41 9月   2 10:14 blk_1073741825</span><br><span class="line">-rw-rw-r--. 1 xisun xisun        11 9月   2 10:14 blk_1073741825_1001.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:43 blk_1073741826</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:43 blk_1073741826_1002.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 134217728 9月   2 10:44 blk_1073741827</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   1048583 9月   2 10:44 blk_1073741827_1003.meta</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  90761455 9月   2 10:45 blk_1073741828</span><br><span class="line">-rw-rw-r--. 1 xisun xisun    709083 9月   2 10:45 blk_1073741828_1004.meta</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>从集群下载文件到本地</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">pwd</span></span><br><span class="line">/home/xisun</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 19 9月   1 13:33 bin</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -get /wcinput/word.txt ./</span><br><span class="line">2021-09-02 11:24:37,690 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 19 9月   1 13:33 bin</span><br><span class="line">-rw-r--r--. 1 xisun xisun 41 9月   2 11:24 word.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ cat word.txt </span><br><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">xisun</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行 wordcount 程序，查看 YARN 的执行情况。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop jar /opt/module/hadoop-3.2.1/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /wcinput /wcoutput</span><br><span class="line">2021-09-02 13:15:36,538 INFO client.RMProxy: Connecting to ResourceManager at hadoop103/192.168.10.103:8032</span><br><span class="line">2021-09-02 13:15:36,985 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding <span class="keyword">for</span> path: /tmp/hadoop-yarn/staging/xisun/.staging/job_1630509320297_0004</span><br><span class="line">2021-09-02 13:15:37,189 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-02 13:15:38,237 INFO input.FileInputFormat: Total input files to process : 1</span><br><span class="line">2021-09-02 13:15:38,317 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-02 13:15:38,407 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-02 13:15:38,456 INFO mapreduce.JobSubmitter: number of splits:1</span><br><span class="line">2021-09-02 13:15:38,608 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-02 13:15:38,673 INFO mapreduce.JobSubmitter: Submitting tokens <span class="keyword">for</span> job: job_1630509320297_0004</span><br><span class="line">2021-09-02 13:15:38,673 INFO mapreduce.JobSubmitter: Executing with tokens: []</span><br><span class="line">2021-09-02 13:15:38,887 INFO conf.Configuration: resource-types.xml not found</span><br><span class="line">2021-09-02 13:15:38,887 INFO resource.ResourceUtils: Unable to find <span class="string">&#x27;resource-types.xml&#x27;</span>.</span><br><span class="line">2021-09-02 13:15:38,964 INFO impl.YarnClientImpl: Submitted application application_1630509320297_0004</span><br><span class="line">2021-09-02 13:15:39,063 INFO mapreduce.Job: The url to track the job: http://hadoop103:8088/proxy/application_1630509320297_0004/</span><br><span class="line">2021-09-02 13:15:39,063 INFO mapreduce.Job: Running job: job_1630509320297_0004</span><br><span class="line">2021-09-02 13:15:48,877 INFO mapreduce.Job: Job job_1630509320297_0004 running <span class="keyword">in</span> uber mode : <span class="literal">false</span></span><br><span class="line">2021-09-02 13:15:48,879 INFO mapreduce.Job:  map 0% reduce 0%</span><br><span class="line">2021-09-02 13:17:39,986 INFO mapreduce.Job:  map 100% reduce 0%</span><br><span class="line">2021-09-02 13:18:46,452 INFO mapreduce.Job:  map 100% reduce 100%</span><br><span class="line">2021-09-02 13:18:48,469 INFO mapreduce.Job: Job job_1630509320297_0004 completed successfully</span><br><span class="line">2021-09-02 13:18:48,743 INFO mapreduce.Job: Counters: 54</span><br><span class="line">	File System Counters</span><br><span class="line">		FILE: Number of bytes <span class="built_in">read</span>=58</span><br><span class="line">		FILE: Number of bytes written=452423</span><br><span class="line">		FILE: Number of <span class="built_in">read</span> operations=0</span><br><span class="line">		FILE: Number of large <span class="built_in">read</span> operations=0</span><br><span class="line">		FILE: Number of write operations=0</span><br><span class="line">		HDFS: Number of bytes <span class="built_in">read</span>=144</span><br><span class="line">		HDFS: Number of bytes written=36</span><br><span class="line">		HDFS: Number of <span class="built_in">read</span> operations=8</span><br><span class="line">		HDFS: Number of large <span class="built_in">read</span> operations=0</span><br><span class="line">		HDFS: Number of write operations=2</span><br><span class="line">		HDFS: Number of bytes <span class="built_in">read</span> erasure-coded=0</span><br><span class="line">	Job Counters </span><br><span class="line">		Launched map tasks=1</span><br><span class="line">		Launched reduce tasks=1</span><br><span class="line">		Data-local map tasks=1</span><br><span class="line">		Total time spent by all maps <span class="keyword">in</span> occupied slots (ms)=108569</span><br><span class="line">		Total time spent by all reduces <span class="keyword">in</span> occupied slots (ms)=63584</span><br><span class="line">		Total time spent by all map tasks (ms)=108569</span><br><span class="line">		Total time spent by all reduce tasks (ms)=63584</span><br><span class="line">		Total vcore-milliseconds taken by all map tasks=108569</span><br><span class="line">		Total vcore-milliseconds taken by all reduce tasks=63584</span><br><span class="line">		Total megabyte-milliseconds taken by all map tasks=111174656</span><br><span class="line">		Total megabyte-milliseconds taken by all reduce tasks=65110016</span><br><span class="line">	Map-Reduce Framework</span><br><span class="line">		Map input records=4</span><br><span class="line">		Map output records=6</span><br><span class="line">		Map output bytes=65</span><br><span class="line">		Map output materialized bytes=58</span><br><span class="line">		Input split bytes=103</span><br><span class="line">		Combine input records=6</span><br><span class="line">		Combine output records=4</span><br><span class="line">		Reduce input groups=4</span><br><span class="line">		Reduce shuffle bytes=58</span><br><span class="line">		Reduce input records=4</span><br><span class="line">		Reduce output records=4</span><br><span class="line">		Spilled Records=8</span><br><span class="line">		Shuffled Maps =1</span><br><span class="line">		Failed Shuffles=0</span><br><span class="line">		Merged Map outputs=1</span><br><span class="line">		GC time elapsed (ms)=11835</span><br><span class="line">		CPU time spent (ms)=68260</span><br><span class="line">		Physical memory (bytes) snapshot=507523072</span><br><span class="line">		Virtual memory (bytes) snapshot=5576531968</span><br><span class="line">		Total committed heap usage (bytes)=404226048</span><br><span class="line">		Peak Map Physical memory (bytes)=297627648</span><br><span class="line">		Peak Map Virtual memory (bytes)=2785103872</span><br><span class="line">		Peak Reduce Physical memory (bytes)=209895424</span><br><span class="line">		Peak Reduce Virtual memory (bytes)=2791428096</span><br><span class="line">	Shuffle Errors</span><br><span class="line">		BAD_ID=0</span><br><span class="line">		CONNECTION=0</span><br><span class="line">		IO_ERROR=0</span><br><span class="line">		WRONG_LENGTH=0</span><br><span class="line">		WRONG_MAP=0</span><br><span class="line">		WRONG_REDUCE=0</span><br><span class="line">	File Input Format Counters </span><br><span class="line">		Bytes Read=41</span><br><span class="line">	File Output Format Counters </span><br><span class="line">		Bytes Written=36</span><br></pre></td></tr></table></figure>

<ul>
<li><p>查看执行结果：</p>
<p><img src="/2021/08/25/hadoop/image-20210902132243410.png" alt="image-20210902132243410"></p>
</li>
<li><p>执行时异常的排除：在初次执行时，报异常 <code>错误: 找不到或无法加载主类 org.apache.hadoop.mapreduce.v2.app.MRAppMaster</code>，解决方法是停止集群，然后向 yarn-site.xml 配置文件中，添加一个属性值。然后，重新运行 wordcount 程序，即能正常执行。</p>
<ul>
<li><p>停止集群：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ stop-yarn.sh </span><br><span class="line">Stopping nodemanagers</span><br><span class="line">hadoop103: WARNING: nodemanager did not stop gracefully after 5 seconds: Trying to <span class="built_in">kill</span> with <span class="built_in">kill</span> -9</span><br><span class="line">hadoop104: WARNING: nodemanager did not stop gracefully after 5 seconds: Trying to <span class="built_in">kill</span> with <span class="built_in">kill</span> -9</span><br><span class="line">hadoop102: WARNING: nodemanager did not stop gracefully after 5 seconds: Trying to <span class="built_in">kill</span> with <span class="built_in">kill</span> -9</span><br><span class="line">Stopping resourcemanager</span><br><span class="line">[xisun@hadoop102 ~]$ stop-dfs.sh </span><br><span class="line">Stopping namenodes on [hadoop102]</span><br><span class="line">Stopping datanodes</span><br><span class="line">Stopping secondary namenodes [hadoop104]</span><br><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">42220 Jps</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 yarn-site.xml，添加 <code>yarn.application.classpath</code> 属性值：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ hadoop classpath</span><br><span class="line">/opt/module/hadoop-3.2.1/etc/hadoop:/opt/module/hadoop-3.2.1/share/hadoop/common/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/common/*:/opt/module/hadoop-3.2.1/share/hadoop/hdfs:/opt/module/hadoop-3.2.1/share/hadoop/hdfs/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/hdfs/*:/opt/module/hadoop-3.2.1/share/hadoop/mapreduce/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/mapreduce/*:/opt/module/hadoop-3.2.1/share/hadoop/yarn:/opt/module/hadoop-3.2.1/share/hadoop/yarn/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/yarn/*</span><br><span class="line">[xisun@hadoop102 hadoop]$ vim yarn-site.xml </span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-3.2.1/etc/hadoop:/opt/module/hadoop-3.2.1/share/hadoop/common/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/common/*:/opt/module/hadoop-3.2.1/share/hadoop/hdfs:/opt/module/hadoop-3.2.1/share/hadoop/hdfs/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/hdfs/*:/opt/module/hadoop-3.2.1/share/hadoop/mapreduce/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/mapreduce/*:/opt/module/hadoop-3.2.1/share/hadoop/yarn:/opt/module/hadoop-3.2.1/share/hadoop/yarn/lib/*:/opt/module/hadoop-3.2.1/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>分发 yarn-site.xml 到集群所有主机上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ xsync /opt/module/hadoop-3.2.1/etc/hadoop/yarn-site.xml </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 66 bytes  received 12 bytes  156.00 bytes/sec</span><br><span class="line">total size is 1,621  speedup is 20.78</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">yarn-site.xml</span><br><span class="line"></span><br><span class="line">sent 1,038 bytes  received 47 bytes  434.00 bytes/sec</span><br><span class="line">total size is 1,621  speedup is 1.49</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">yarn-site.xml</span><br><span class="line"></span><br><span class="line">sent 1,038 bytes  received 47 bytes  2,170.00 bytes/sec</span><br><span class="line">total size is 1,621  speedup is 1.49</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动集群：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ start-dfs.sh </span><br><span class="line">Starting namenodes on [hadoop102]</span><br><span class="line">Starting datanodes</span><br><span class="line">Starting secondary namenodes [hadoop104]</span><br><span class="line">[xisun@hadoop102 hadoop]$ start-yarn.sh </span><br><span class="line">Starting resourcemanager</span><br><span class="line">Starting nodemanagers</span><br><span class="line">[xisun@hadoop102 hadoop]$ jps</span><br><span class="line">42544 NameNode</span><br><span class="line">43346 Jps</span><br><span class="line">42680 DataNode</span><br><span class="line">43177 NodeManager</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>与本地模式执行 wordcount 一样，HDFS 上不能已经存在 <code>/wcoutput</code> 目录，否则报错。如果已经存在，则需要删除：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hdfs dfs -rm -r /wcoutput</span><br><span class="line">Deleted /wcoutput</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="配置历史服务器"><a href="#配置历史服务器" class="headerlink" title="配置历史服务器"></a>配置历史服务器</h4><ul>
<li><p>为了查看程序的历史运行情况，需要配置一下历史服务器。</p>
</li>
<li><p>第一步：编辑 mapred-site.xml，增加历史服务器的配置。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ vim /opt/module/hadoop-3.2.1/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 历史服务器端地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 历史服务器Web端地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：集群分发 mapred-site.xml。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ xsync /opt/module/hadoop-3.2.1/etc/hadoop/mapred-site.xml </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 67 bytes  received 12 bytes  158.00 bytes/sec</span><br><span class="line">total size is 1,229  speedup is 15.56</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">mapred-site.xml</span><br><span class="line"></span><br><span class="line">sent 647 bytes  received 47 bytes  462.67 bytes/sec</span><br><span class="line">total size is 1,229  speedup is 1.77</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">mapred-site.xml</span><br><span class="line"></span><br><span class="line">sent 647 bytes  received 47 bytes  1,388.00 bytes/sec</span><br><span class="line">total size is 1,229  speedup is 1.77</span><br></pre></td></tr></table></figure>
</li>
<li><p>第三步：在 hadoop102 上启动历史服务器。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ mapred --daemon start historyserver</span><br><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">47605 Jps</span><br><span class="line">46106 NodeManager</span><br><span class="line">45612 DataNode</span><br><span class="line">47564 JobHistoryServer</span><br><span class="line">45485 NameNode</span><br></pre></td></tr></table></figure>
</li>
<li><p>第四步：重新运行一次 wordcount（需要先删除 HDFS 上的 <code>/wcoutput</code>），查看任务的历史日志。</p>
<p><img src="/2021/08/25/hadoop/image-20210902152328283.png" alt="image-20210902152328283"></p>
<p><img src="/2021/08/25/hadoop/image-20210902152507027.png" alt="image-20210902152507027"></p>
</li>
</ul>
<h4 id="配置日志的聚集"><a href="#配置日志的聚集" class="headerlink" title="配置日志的聚集"></a>配置日志的聚集</h4><ul>
<li><p>日志聚集概念：应用运行完成以后，将程序运行日志信息上传到 HDFS 系统上。</p>
<p><img src="/2021/08/25/hadoop/image-20210902153939242.png" alt="image-20210902153939242"></p>
</li>
<li><p>如果不配置日志聚集，在 Web 端查看历史日志时，点击 logs 会无法查看（程序的运行日志，可能会分布在集群的各个机器上）。</p>
<p><img src="/2021/08/25/hadoop/image-20210902153854565.png" alt="image-20210902153854565"></p>
</li>
<li><p>日志聚集功能好处：可以方便的查看到程序运行详情，方便开发调试。</p>
</li>
<li><p>第一步：编辑 yarn-site.xml，添加日志聚集的配置。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ vim /opt/module/hadoop-3.2.1/etc/hadoop/yarn-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启日志聚集功能，默认不开启 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 设置日志聚集服务器地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://hadoop102:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 设置日志保留时间为7天 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：集群分发 yarn-site.xml 文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ xsync /opt/module/hadoop-3.2.1/etc/hadoop/yarn-site.xml </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 66 bytes  received 12 bytes  156.00 bytes/sec</span><br><span class="line">total size is 2,115  speedup is 27.12</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">yarn-site.xml</span><br><span class="line"></span><br><span class="line">sent 836 bytes  received 53 bytes  1,778.00 bytes/sec</span><br><span class="line">total size is 2,115  speedup is 2.38</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">yarn-site.xml</span><br><span class="line"></span><br><span class="line">sent 836 bytes  received 53 bytes  1,778.00 bytes/sec</span><br><span class="line">total size is 2,115  speedup is 2.38</span><br></pre></td></tr></table></figure>
</li>
<li><p>第三步：重新启动 NodeManager 、ResourceManager 和 HistoryServer。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ mapred --daemon stop historyserver</span><br><span class="line">[xisun@hadoop102 ~]$ stop-yarn.sh </span><br><span class="line">Stopping nodemanagers</span><br><span class="line">hadoop102: WARNING: nodemanager did not stop gracefully after 5 seconds: Trying to <span class="built_in">kill</span> with <span class="built_in">kill</span> -9</span><br><span class="line">hadoop104: WARNING: nodemanager did not stop gracefully after 5 seconds: Trying to <span class="built_in">kill</span> with <span class="built_in">kill</span> -9</span><br><span class="line">hadoop103: WARNING: nodemanager did not stop gracefully after 5 seconds: Trying to <span class="built_in">kill</span> with <span class="built_in">kill</span> -9</span><br><span class="line">Stopping resourcemanager</span><br><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">48872 Jps</span><br><span class="line">45612 DataNode</span><br><span class="line">45485 NameNode</span><br><span class="line">[xisun@hadoop102 ~]$ start-yarn.sh </span><br><span class="line">Starting resourcemanager</span><br><span class="line">Starting nodemanagers</span><br><span class="line">[xisun@hadoop102 ~]$ mapred --daemon start historyserver</span><br><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">49696 Jps</span><br><span class="line">49636 JobHistoryServer</span><br><span class="line">45612 DataNode</span><br><span class="line">45485 NameNode</span><br><span class="line">49134 NodeManager</span><br></pre></td></tr></table></figure>
</li>
<li><p>第四步：重新运行一次 wordcount（需要先删除 HDFS 上的 <code>/wcoutput</code>），查看任务的历史日志。</p>
<p><img src="/2021/08/25/hadoop/image-20210902165115208.png" alt="image-20210902165115208"></p>
</li>
</ul>
<h4 id="集群启动-停止方式总结"><a href="#集群启动-停止方式总结" class="headerlink" title="集群启动/停止方式总结"></a>集群启动/停止方式总结</h4><ul>
<li><p>各个模块分开启动/停止（配置 ssh 是前提）— 常用</p>
<ul>
<li><p>整体启动/停止 HDFS</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ start-dfs.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ stop-dfs.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>整体启动/停止 YARN</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ start-yarn.sh </span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ stop-yarn.sh </span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>各个服务组件逐一启动/停止</p>
<ul>
<li><p>分别启动/停止 HDFS 组件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hdfs --daemon start namenode/datanode/secondarynamenode</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hdfs --daemon stop namenode/datanode/secondarynamenode</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动/停止 YARN</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ yarn --daemon start  resourcemanager/nodemanager</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ yarn --daemon stop  resourcemanager/nodemanager</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="编写-Hadoop-集群常用脚本"><a href="#编写-Hadoop-集群常用脚本" class="headerlink" title="编写 Hadoop 集群常用脚本"></a>编写 Hadoop 集群常用脚本</h4><ul>
<li><p>Hadoop 集群启停脚本（包含 HDFS，Yarn 和 Historyserver）：myhadoop.sh</p>
<ul>
<li><p>编写脚本：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 bin]$ <span class="built_in">pwd</span></span><br><span class="line">/home/xisun/bin</span><br><span class="line">[xisun@hadoop102 bin]$ vim myhadoop.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -lt 1 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;No Args Input...&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> ;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;start&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== 启动 hadoop集群 ===================&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; ------------------- 启动 hdfs ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.2.1/sbin/start-dfs.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- 启动 yarn ---------------&quot;</span></span><br><span class="line">        ssh hadoop103 <span class="string">&quot;/opt/module/hadoop-3.2.1/sbin/start-yarn.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- 启动 historyserver ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.2.1/bin/mapred --daemon start historyserver&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="string">&quot;stop&quot;</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; =================== 关闭 hadoop集群 ===================&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- 关闭 historyserver ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.2.1/bin/mapred --daemon stop historyserver&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- 关闭 yarn ---------------&quot;</span></span><br><span class="line">        ssh hadoop103 <span class="string">&quot;/opt/module/hadoop-3.2.1/sbin/stop-yarn.sh&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot; --------------- 关闭 hdfs ---------------&quot;</span></span><br><span class="line">        ssh hadoop102 <span class="string">&quot;/opt/module/hadoop-3.2.1/sbin/stop-dfs.sh&quot;</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Input Args Error...&quot;</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在脚本中，使用全路径，如：<code>/opt/module/hadoop-3.2.1/sbin/start-dfs.sh</code>，不要使用 <code>start-dfs.sh</code>。</p>
</blockquote>
</li>
<li><p>赋予脚本执行权限：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 bin]$ chmod 777 myhadoop.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试脚本停止集群：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ myhadoop.sh stop</span><br><span class="line"> =================== 关闭 hadoop集群 ===================</span><br><span class="line"> --------------- 关闭 historyserver ---------------</span><br><span class="line"> --------------- 关闭 yarn ---------------</span><br><span class="line">Stopping nodemanagers</span><br><span class="line">Stopping resourcemanager</span><br><span class="line"> --------------- 关闭 hdfs ---------------</span><br><span class="line">Stopping namenodes on [hadoop102]</span><br><span class="line">Stopping datanodes</span><br><span class="line">Stopping secondary namenodes [hadoop104]</span><br><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">51019 Jps</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试脚本启动集群：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ myhadoop.sh start</span><br><span class="line"> =================== 启动 hadoop集群 ===================</span><br><span class="line"> --------------- 启动 hdfs ---------------</span><br><span class="line">Starting namenodes on [hadoop102]</span><br><span class="line">Starting datanodes</span><br><span class="line">Starting secondary namenodes [hadoop104]</span><br><span class="line"> --------------- 启动 yarn ---------------</span><br><span class="line">Starting resourcemanager</span><br><span class="line">Starting nodemanagers</span><br><span class="line"> --------------- 启动 historyserver ---------------</span><br><span class="line">[xisun@hadoop102 ~]$ jps</span><br><span class="line">51666 NodeManager</span><br><span class="line">51209 NameNode</span><br><span class="line">51339 DataNode</span><br><span class="line">51917 Jps</span><br><span class="line">51839 JobHistoryServer</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>查看三台服务器 Java 进程脚本：jpsall</p>
<ul>
<li><p>编写脚本：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> hadoop102 hadoop103 hadoop104</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> =============== <span class="variable">$host</span> ===============</span><br><span class="line">        ssh <span class="variable">$host</span> jps</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> hadoop102 hadoop103 hadoop104</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> =============== <span class="variable">$host</span> ===============</span><br><span class="line">        ssh <span class="variable">$host</span> jps</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>赋予脚本执行权限：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 bin]$ chmod 777 jpsall</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试脚本：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ jpsall </span><br><span class="line">=============== hadoop102 ===============</span><br><span class="line">51666 NodeManager</span><br><span class="line">51209 NameNode</span><br><span class="line">51339 DataNode</span><br><span class="line">51979 Jps</span><br><span class="line">51839 JobHistoryServer</span><br><span class="line">=============== hadoop103 ===============</span><br><span class="line">40195 Jps</span><br><span class="line">39492 DataNode</span><br><span class="line">39800 NodeManager</span><br><span class="line">39677 ResourceManager</span><br><span class="line">=============== hadoop104 ===============</span><br><span class="line">40920 NodeManager</span><br><span class="line">40809 SecondaryNameNode</span><br><span class="line">41081 Jps</span><br><span class="line">40699 DataNode</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>分发 hadoop102 上的 <code>/home/xisun/bin</code> 目录，保证自定义脚本在集群的所有机器上都可以使用。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ xsync /home/xisun/bin/</span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 139 bytes  received 17 bytes  312.00 bytes/sec</span><br><span class="line">total size is 2,175  speedup is 13.94</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">bin/</span><br><span class="line">bin/jpsall</span><br><span class="line">bin/myhadoop.sh</span><br><span class="line"></span><br><span class="line">sent 1,499 bytes  received 58 bytes  3,114.00 bytes/sec</span><br><span class="line">total size is 2,175  speedup is 1.40</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">bin/</span><br><span class="line">bin/jpsall</span><br><span class="line">bin/myhadoop.sh</span><br><span class="line"></span><br><span class="line">sent 1,499 bytes  received 58 bytes  3,114.00 bytes/sec</span><br><span class="line">total size is 2,175  speedup is 1.40</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="常用端口号和配置文件说明"><a href="#常用端口号和配置文件说明" class="headerlink" title="常用端口号和配置文件说明"></a>常用端口号和配置文件说明</h4><ul>
<li><p>常用端口号</p>
<table>
<thead>
<tr>
<th>端口名称</th>
<th>Hadoop 2.x</th>
<th>Hadoop 3.x</th>
</tr>
</thead>
<tbody><tr>
<td>HDFS NameNode 内部通信端口</td>
<td>8020 / 9000</td>
<td>8020 / 9000 / 9820</td>
</tr>
<tr>
<td>HDFS NameNode HTTP UI<br>（对用户的查询端口）</td>
<td>50070</td>
<td><strong>9870</strong></td>
</tr>
<tr>
<td>YARN MapReduce 查看执行任务端口</td>
<td>8088</td>
<td><strong>8088</strong></td>
</tr>
<tr>
<td>历史服务器通信端口</td>
<td>19888</td>
<td>19888</td>
</tr>
</tbody></table>
</li>
<li><p>常用配置文件</p>
<ul>
<li>Hadoop 2.x：core-site.xml，hdfs-site.xml，yarn-site.xml，mapred-site.xml，slaves。</li>
<li>Hadoop 3.x：core-site.xml，hdfs-site.xml，yarn-site.xml，mapred-site.xml，workers。</li>
</ul>
</li>
</ul>
<h4 id="集群时间同步"><a href="#集群时间同步" class="headerlink" title="集群时间同步"></a>集群时间同步</h4><ul>
<li>如果服务器在公网环境（能连接外网），可以不采用集群时间同步，因为服务器会定期和公网时间进行校准。</li>
<li>如果服务器在内网环境，必须要配置集群时间同步，否则时间久了，会产生时间偏差，导致集群执行任务时间不同步。</li>
<li>配置过程略。</li>
</ul>
<h2 id="HDFS-概述"><a href="#HDFS-概述" class="headerlink" title="HDFS 概述"></a>HDFS 概述</h2><h3 id="HDFS-产生背景及定义"><a href="#HDFS-产生背景及定义" class="headerlink" title="HDFS 产生背景及定义"></a>HDFS 产生背景及定义</h3><h4 id="HDFS-产生背景"><a href="#HDFS-产生背景" class="headerlink" title="HDFS 产生背景"></a>HDFS 产生背景</h4><ul>
<li><p>随着数据量越来越大，在一个操作系统存不下所有的数据，那么就分配到更多的操作系统管理的磁盘中，但是不方便管理和维护，迫切需要一种系统来管理多台机器上的文件，这就是分布式文件管理系统。HDFS 只是分布式文件管理系统中的一种。</p>
<ul>
<li><p>个人电脑上的磁盘，是 NTFS 文件管理系统。</p>
<p><img src="/2021/08/25/hadoop/image-20210903163243434.png" alt="image-20210903163243434"></p>
</li>
</ul>
</li>
</ul>
<h4 id="HDFS-定义"><a href="#HDFS-定义" class="headerlink" title="HDFS 定义"></a>HDFS 定义</h4><ul>
<li>HDFS（Hadoop Distributed File System），它是一个文件系统，用于存储文件，通过目录树来定位文件；其次，它是分布式的，由很多服务器联合起来实现其功能，集群中的服务器有各自的角色。</li>
<li>HDFS 的使用场景：适合一次写入，多次读出的场景。一个文件经过创建、写入和关闭之后就不需要改变。</li>
</ul>
<h3 id="HDFS-优缺点"><a href="#HDFS-优缺点" class="headerlink" title="HDFS 优缺点"></a>HDFS 优缺点</h3><h4 id="HDFS-优点"><a href="#HDFS-优点" class="headerlink" title="HDFS 优点"></a>HDFS 优点</h4><ul>
<li><p>高容错性</p>
<ul>
<li><p>数据自动保存多个副本。它通过增加副本的形式，提高容错性。</p>
<p><img src="/2021/08/25/hadoop/image-20210903165715516.png" alt="image-20210903165715516"></p>
</li>
<li><p>某一个副本丢失以后，它可以自动恢复。</p>
<p><img src="/2021/08/25/hadoop/image-20210903165748149.png" alt="image-20210903165748149"></p>
</li>
</ul>
</li>
<li><p>适合处理大数据</p>
<ul>
<li>数据规模：能够处理数据规模达到 GB、TB、甚至 PB 级别的数据。</li>
<li>文件规模：能够处理百万规模以上的文件数量，数量相当之大。</li>
</ul>
</li>
<li><p>可构建在廉价机器上，通过多副本机制，提高可靠性。</p>
</li>
</ul>
<h4 id="HDFS-缺点"><a href="#HDFS-缺点" class="headerlink" title="HDFS 缺点"></a>HDFS 缺点</h4><ul>
<li><p>不适合低延时数据访问，比如毫秒级的存储数据，是做不到的。</p>
</li>
<li><p>无法高效的对大量小文件进行存储。</p>
<ul>
<li>存储大量小文件的话，它会占用 NameNode 大量的内存来存储文件目录和块信息。这样是不可取的，因为 NameNode 的内存总是有限的。</li>
<li>小文件存储的寻址时间会超过读取时间，它违反了 HDFS 的设计目标。</li>
</ul>
</li>
<li><p>不支持并发写入、文件随机修改。</p>
<ul>
<li><p>一个文件只能有一个写，不允许多个线程同时写。</p>
<p><img src="/2021/08/25/hadoop/image-20210903170115237.png" alt="image-20210903170115237"></p>
</li>
<li><p>仅支持数据 append（追加），不支持文件的随机修改。</p>
</li>
</ul>
</li>
</ul>
<h3 id="HDFS-组成架构"><a href="#HDFS-组成架构" class="headerlink" title="HDFS 组成架构"></a>HDFS 组成架构</h3><ul>
<li><p>官方文档：<a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/">https://hadoop.apache.org/docs/</a></p>
</li>
<li><p>hadoop-3.2.1 HDFS 文档：<a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/r3.2.1/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html">https://hadoop.apache.org/docs/r3.2.1/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html</a></p>
</li>
<li><p>HDFS 组成架构：</p>
<p><img src="/2021/08/25/hadoop/image-20210903170728742.png" alt="image-20210903170728742"></p>
<ul>
<li>NameNode：nn，就是 Master，它是一个主管、管理者。<ul>
<li>管理 HDFS 的名称空间；</li>
<li>配置副本策略；</li>
<li>管理数据块（Block）映射信息；</li>
<li>处理客户端读写请求。</li>
</ul>
</li>
<li>DataNode：就是 Slave。NameNode下达命令，DataNode 执行实际的操作。<ul>
<li>存储实际的数据块；</li>
<li>执行数据块的读/写操作。</li>
</ul>
</li>
</ul>
</li>
<li><p>Client：就是客户端。比如，Web 打开的 Browse Directory 页面就是一个客户端，能够对 HDFS 进行操作。</p>
<ul>
<li>文件切分。文件上传到 HDFS 的时候，Client 将文件切分成一个一个的 Block，然后进行上传；</li>
<li>与 NameNode 交互，获取文件的位置信息；</li>
<li>与 DataNode 交互，读取或者写入数据；</li>
<li>Client 提供一些命令来管理 HDFS，比如 NameNode 格式化；</li>
<li>Client 可以通过一些命令来访问 HDFS，比如对 HDFS 增删查改操作。</li>
</ul>
</li>
<li><p>Secondary NameNode：2nn，并非 NameNode 的热备。当 NameNode 挂掉的时候，它并不能马上替换 NameNode 并提供服务。</p>
<ul>
<li>辅助 NameNode，分担其工作量，比如定期合并 Fsimage 和 Edits，并推送给 NameNode；</li>
<li>在紧急情况下，可辅助恢复 NameNode（只能恢复一部分数据，无法恢复全部数据）。</li>
</ul>
</li>
</ul>
<h3 id="HDFS-文件块大小"><a href="#HDFS-文件块大小" class="headerlink" title="HDFS 文件块大小"></a>HDFS 文件块大小</h3><ul>
<li>HDFS 中的文件在物理上是分块存储（Block），块的大小可以通过配置参数 <code>dfs.blocksize</code> 来规定，默认大小在 Hadoop 2.x/3.x 版本中是 128 MB，Hadoop 1.x 版本中是 64 MB。<ul>
<li>如果寻址时间约为 10 ms，即查找到集群中的目标 Block 的时间为 10 ms。当寻址时间为传输时间的 1% 时（专家研究），则为最佳状态。因此，传输时间 = 10 ms / 0.01 = 1000 ms = 1 s。而目前磁盘的传输速率普遍为 100 MB/s，因此，Block 大小 = 1 s * 100 MB/s = 100 MB。在计算机系统中，取 1024 的整数倍，即取 Block 大小为 128 MB。如果是固态硬盘，传输速率可以达到 200 ~ 300 MB/s，此时，一般取 Block 大小为 256 MB。</li>
</ul>
</li>
<li>HDFS 的 Block 块的大小设置主要取决于磁盘传输速率。<ul>
<li>如果 HDFS 的 Block 块设置的太小，会增加寻址时间，程序一直在找块的开始位置。</li>
<li>如果 HDFS 的 Block 块设置的太大，从磁盘传输数据的时间会明显大于定位这个块开始位置所需的时间，导致程序在处理这块数据时，会非常慢。</li>
</ul>
</li>
</ul>
<h2 id="HDFS-的-Shell-操作"><a href="#HDFS-的-Shell-操作" class="headerlink" title="HDFS 的 Shell 操作"></a>HDFS 的 Shell 操作</h2><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><ul>
<li>方式一：<code>hadoop fs 具体命令</code></li>
<li>方式二：<code>hdfs dfs 具体命令</code></li>
</ul>
<h3 id="命令大全"><a href="#命令大全" class="headerlink" title="命令大全"></a>命令大全</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs</span><br><span class="line">Usage: hadoop fs [generic options]</span><br><span class="line">	[-appendToFile &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-cat [-ignoreCrc] &lt;src&gt; ...]</span><br><span class="line">	[-checksum &lt;src&gt; ...]</span><br><span class="line">	[-chgrp [-R] GROUP PATH...]</span><br><span class="line">	[-chmod [-R] &lt;MODE[,MODE]... | OCTALMODE&gt; PATH...]</span><br><span class="line">	[-chown [-R] [OWNER][:[GROUP]] PATH...]</span><br><span class="line">	[-copyFromLocal [-f] [-p] [-l] [-d] [-t &lt;thread count&gt;] &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-copyToLocal [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;]</span><br><span class="line">	[-count [-q] [-h] [-v] [-t [&lt;storage <span class="built_in">type</span>&gt;]] [-u] [-x] [-e] &lt;path&gt; ...]</span><br><span class="line">	[-cp [-f] [-p | -p[topax]] [-d] &lt;src&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-createSnapshot &lt;snapshotDir&gt; [&lt;snapshotName&gt;]]</span><br><span class="line">	[-deleteSnapshot &lt;snapshotDir&gt; &lt;snapshotName&gt;]</span><br><span class="line">	[-df [-h] [&lt;path&gt; ...]]</span><br><span class="line">	[-du [-s] [-h] [-v] [-x] &lt;path&gt; ...]</span><br><span class="line">	[-expunge [-immediate]]</span><br><span class="line">	[-find &lt;path&gt; ... &lt;expression&gt; ...]</span><br><span class="line">	[-get [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;]</span><br><span class="line">	[-getfacl [-R] &lt;path&gt;]</span><br><span class="line">	[-getfattr [-R] &#123;-n name | -d&#125; [-e en] &lt;path&gt;]</span><br><span class="line">	[-getmerge [-nl] [-skip-empty-file] &lt;src&gt; &lt;localdst&gt;]</span><br><span class="line">	[-head &lt;file&gt;]</span><br><span class="line">	[-<span class="built_in">help</span> [cmd ...]]</span><br><span class="line">	[-ls [-C] [-d] [-h] [-q] [-R] [-t] [-S] [-r] [-u] [-e] [&lt;path&gt; ...]]</span><br><span class="line">	[-mkdir [-p] &lt;path&gt; ...]</span><br><span class="line">	[-moveFromLocal &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-moveToLocal &lt;src&gt; &lt;localdst&gt;]</span><br><span class="line">	[-mv &lt;src&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-put [-f] [-p] [-l] [-d] &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-renameSnapshot &lt;snapshotDir&gt; &lt;oldName&gt; &lt;newName&gt;]</span><br><span class="line">	[-rm [-f] [-r|-R] [-skipTrash] [-safely] &lt;src&gt; ...]</span><br><span class="line">	[-rmdir [--ignore-fail-on-non-empty] &lt;dir&gt; ...]</span><br><span class="line">	[-setfacl [-R] [&#123;-b|-k&#125; &#123;-m|-x &lt;acl_spec&gt;&#125; &lt;path&gt;]|[--<span class="built_in">set</span> &lt;acl_spec&gt; &lt;path&gt;]]</span><br><span class="line">	[-setfattr &#123;-n name [-v value] | -x name&#125; &lt;path&gt;]</span><br><span class="line">	[-setrep [-R] [-w] &lt;rep&gt; &lt;path&gt; ...]</span><br><span class="line">	[-<span class="built_in">stat</span> [format] &lt;path&gt; ...]</span><br><span class="line">	[-tail [-f] [-s &lt;sleep interval&gt;] &lt;file&gt;]</span><br><span class="line">	[-<span class="built_in">test</span> -[defswrz] &lt;path&gt;]</span><br><span class="line">	[-text [-ignoreCrc] &lt;src&gt; ...]</span><br><span class="line">	[-touch [-a] [-m] [-t TIMESTAMP ] [-c] &lt;path&gt; ...]</span><br><span class="line">	[-touchz &lt;path&gt; ...]</span><br><span class="line">	[-truncate [-w] &lt;length&gt; &lt;path&gt; ...]</span><br><span class="line">	[-usage [cmd ...]]</span><br><span class="line"></span><br><span class="line">Generic options supported are:</span><br><span class="line">-conf &lt;configuration file&gt;        specify an application configuration file</span><br><span class="line">-D &lt;property=value&gt;               define a value <span class="keyword">for</span> a given property</span><br><span class="line">-fs &lt;file:///|hdfs://namenode:port&gt; specify default filesystem URL to use, overrides <span class="string">&#x27;fs.defaultFS&#x27;</span> property from configurations.</span><br><span class="line">-jt &lt;<span class="built_in">local</span>|resourcemanager:port&gt;  specify a ResourceManager</span><br><span class="line">-files &lt;file1,...&gt;                specify a comma-separated list of files to be copied to the map reduce cluster</span><br><span class="line">-libjars &lt;jar1,...&gt;               specify a comma-separated list of jar files to be included <span class="keyword">in</span> the classpath</span><br><span class="line">-archives &lt;archive1,...&gt;          specify a comma-separated list of archives to be unarchived on the compute machines</span><br><span class="line"></span><br><span class="line">The general <span class="built_in">command</span> line syntax is:</span><br><span class="line"><span class="built_in">command</span> [genericOptions] [commandOptions]</span><br></pre></td></tr></table></figure>

<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><h4 id="查看帮助"><a href="#查看帮助" class="headerlink" title="查看帮助"></a>查看帮助</h4><ul>
<li><p>-help：查看命令的使用说明</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -<span class="built_in">help</span> rm</span><br><span class="line">-rm [-f] [-r|-R] [-skipTrash] [-safely] &lt;src&gt; ... :</span><br><span class="line">  Delete all files that match the specified file pattern. Equivalent to the Unix</span><br><span class="line">  <span class="built_in">command</span> <span class="string">&quot;rm &lt;src&gt;&quot;</span></span><br><span class="line">                                                                                 </span><br><span class="line">  -f          If the file does not exist, <span class="keyword">do</span> not display a diagnostic message or </span><br><span class="line">              modify the <span class="built_in">exit</span> status to reflect an error.                        </span><br><span class="line">  -[rR]       Recursively deletes directories.                                   </span><br><span class="line">  -skipTrash  option bypasses trash, <span class="keyword">if</span> enabled, and immediately deletes &lt;src&gt;.  </span><br><span class="line">  -safely     option requires safety confirmation, <span class="keyword">if</span> enabled, requires          </span><br><span class="line">              confirmation before deleting large directory with more than        </span><br><span class="line">              &lt;hadoop.shell.delete.limit.num.files&gt; files. Delay is expected when</span><br><span class="line">              walking over large directory recursively to count the number of    </span><br><span class="line">              files to be deleted before the confirmation. </span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="直接操作-HDFS"><a href="#直接操作-HDFS" class="headerlink" title="直接操作 HDFS"></a>直接操作 HDFS</h4><ul>
<li><p>-ls：显示目录信息。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /</span><br><span class="line">Found 5 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup  359196911 2021-09-02 10:45 /hadoop-3.2.1.tar.gz</span><br><span class="line">drwx------   - xisun supergroup          0 2021-09-02 16:35 /tmp</span><br><span class="line">drwxr-xr-x   - xisun supergroup          0 2021-09-02 10:14 /wcinput</span><br><span class="line">drwxr-xr-x   - xisun supergroup          0 2021-09-02 16:36 /wcoutput</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /wcinput</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup         41 2021-09-02 10:14 /wcinput/word.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>-cat：显示文件内容。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -cat /wcinput/word.txt</span><br><span class="line">2021-09-06 14:07:12,091 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">xisun</span><br><span class="line">xisun</span><br></pre></td></tr></table></figure>
</li>
<li><p>-mkdir：创建路径。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -mkdir /sanguo</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /</span><br><span class="line">Found 5 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup  359196911 2021-09-02 10:45 /hadoop-3.2.1.tar.gz</span><br><span class="line">drwxr-xr-x   - xisun supergroup          0 2021-09-06 13:35 /sanguo</span><br><span class="line">drwx------   - xisun supergroup          0 2021-09-02 16:35 /tmp</span><br><span class="line">drwxr-xr-x   - xisun supergroup          0 2021-09-02 10:14 /wcinput</span><br><span class="line">drwxr-xr-x   - xisun supergroup          0 2021-09-02 16:36 /wcoutput</span><br></pre></td></tr></table></figure>
</li>
<li><p>-cp：从 HDFS 的一个路径拷贝到 HDFS 的另一个路径。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -cp /wcinput/word.txt /sanguo</span><br><span class="line">2021-09-06 16:16:26,225 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">2021-09-06 16:16:27,148 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /sanguo</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup         41 2021-09-06 16:16 /sanguo/word.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>-mv：在 HDFS 目录中移动文件或重命名文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -mv /sanguo/word.txt /sanguo/sanguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /sanguo</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup         41 2021-09-06 16:16 /sanguo/sanguo.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>-tail：显示一个文件的末尾 1 kb 的数据。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -tail /sanguo/sanguo.txt</span><br><span class="line">2021-09-06 16:19:45,518 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">xisun</span><br><span class="line">xisun</span><br></pre></td></tr></table></figure>
</li>
<li><p>-rm：删除文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -rm /sanguo/sanguo.txt</span><br><span class="line">Deleted /sanguo/sanguo.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>-rm -r：递归删除目录及目录里面内容。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -rm /sanguo</span><br><span class="line">rm: `/sanguo<span class="string">&#x27;: Is a directory</span></span><br><span class="line"><span class="string">[xisun@hadoop102 ~]$ hadoop fs -rm -r /sanguo</span></span><br><span class="line"><span class="string">Deleted /sanguo</span></span><br><span class="line"><span class="string">[xisun@hadoop102 ~]$ hadoop fs -ls /</span></span><br><span class="line"><span class="string">Found 4 items</span></span><br><span class="line"><span class="string">-rw-r--r--   3 xisun supergroup  359196911 2021-09-02 10:45 /hadoop-3.2.1.tar.gz</span></span><br><span class="line"><span class="string">drwx------   - xisun supergroup          0 2021-09-02 16:35 /tmp</span></span><br><span class="line"><span class="string">drwxr-xr-x   - xisun supergroup          0 2021-09-02 10:14 /wcinput</span></span><br><span class="line"><span class="string">drwxr-xr-x   - xisun supergroup          0 2021-09-02 16:36 /wcoutput</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>-du：统计文件夹的大小信息。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -du -s -h /wcinput</span><br><span class="line">41  123  /wcinput</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -du -h /wcinput</span><br><span class="line">41  123  /wcinput/word.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>41 表示文件大小；123 表示 41 * 3 个副本；/wcinput 表示查看的目录。</li>
</ul>
</li>
<li><p>-chgrp、-chmod、-chown：与 Linux 文件系统中的用法一样，修改文件所属权限。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /wcinput</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup         41 2021-09-02 10:14 /wcinput/word.txt</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -chmod 666 /wcinput/word.txt</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /wcinput</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-rw-rw-   3 xisun supergroup         41 2021-09-02 10:14 /wcinput/word.txt</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -chown xisun:xisun /wcinput/word.txt</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /wcinput</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-rw-rw-   3 xisun xisun         41 2021-09-02 10:14 /wcinput/word.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>-setrep：设置 HDFS 中文件的副本数量。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -setrep 10 /wcinput/word.txt</span><br><span class="line">Replication 10 <span class="built_in">set</span>: /wcinput/word.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/25/hadoop/image-20210906163539785.png" alt="image-20210906163539785"></p>
<p><img src="/2021/08/25/hadoop/image-20210906163702812.png" alt="image-20210906163702812"></p>
<ul>
<li>这里设置的副本数只是记录在 NameNode 的元数据中，是否真的会有这么多副本，取决于 DataNode 的数量。因为目前只有 3 台设备，最多也就 3 个副本，只有节点数的增加到 10 台时，副本数才能达到 10。</li>
</ul>
</li>
</ul>
<h4 id="上传到-HDFS"><a href="#上传到-HDFS" class="headerlink" title="上传到 HDFS"></a>上传到 HDFS</h4><ul>
<li><p>-moveFromLocal：从本地文件系统剪切文件粘贴到 HDFS 路径。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ vim shuguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  7 9月   6 16:39 shuguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -mkdir /sanguo</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /sanguo</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -moveFromLocal ./shuguo.txt /sanguo</span><br><span class="line">2021-09-06 16:40:09,950 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /sanguo</span><br><span class="line">Found 1 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup          7 2021-09-06 16:40 /sanguo/shuguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>-copyFromLocal：从本地文件系统中拷贝文件到 HDFS 路径。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ vim weiguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  7 9月   6 16:43 weiguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -copyFromLocal weiguo.txt /sanguo</span><br><span class="line">2021-09-06 16:43:50,298 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /sanguo</span><br><span class="line">Found 2 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup          7 2021-09-06 16:40 /sanguo/shuguo.txt</span><br><span class="line">-rw-r--r--   3 xisun supergroup          7 2021-09-06 16:43 /sanguo/weiguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  7 9月   6 16:43 weiguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>-put：等同于 -copyFromLocal，生产环境更习惯用 -put。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ vim wuguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 8</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  7 9月   6 16:43 weiguo.txt</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  6 9月   6 16:45 wuguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -put wuguo.txt /sanguo</span><br><span class="line">2021-09-06 16:46:14,881 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -ls /sanguo</span><br><span class="line">Found 3 items</span><br><span class="line">-rw-r--r--   3 xisun supergroup          7 2021-09-06 16:40 /sanguo/shuguo.txt</span><br><span class="line">-rw-r--r--   3 xisun supergroup          7 2021-09-06 16:43 /sanguo/weiguo.txt</span><br><span class="line">-rw-r--r--   3 xisun supergroup          6 2021-09-06 16:46 /sanguo/wuguo.txt</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 8</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  7 9月   6 16:43 weiguo.txt</span><br><span class="line">-rw-rw-r--. 1 xisun xisun  6 9月   6 16:45 wuguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>-appendToFile：追加一个文件到已经存在的文件末尾。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -cat /sanguo/shuguo.txt</span><br><span class="line">2021-09-06 16:47:33,926 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">shuguo</span><br><span class="line">[xisun@hadoop102 ~]$ vim liubei.txt</span><br><span class="line">[xisun@hadoop102 ~]$ cat liubei.txt </span><br><span class="line">liubei</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -appendToFile liubei.txt /sanguo/shuguo.txt</span><br><span class="line">2021-09-06 16:48:18,942 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 hadoop fs -cat /sanguo/shuguo.txt</span><br><span class="line">2021-09-06 16:48:32,423 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">shuguo</span><br><span class="line">liubei</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="下载至-HDFS"><a href="#下载至-HDFS" class="headerlink" title="下载至 HDFS"></a>下载至 HDFS</h4><ul>
<li><p>-copyToLocal：从 HDFS 路径拷贝文件到本地文件系统。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ rm liubei.txt weiguo.txt wuguo.txt </span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 0</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br><span class="line">[xisun@hadoop102 ~]$ hadoop fs -copyToLocal /sanguo/shuguo.txt ./</span><br><span class="line">2021-09-06 16:49:58,344 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 4</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-r--r--. 1 xisun xisun 14 9月   6 16:49 shuguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>-get：等同于 -copyToLocal，生产环境更习惯用 -get。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ hadoop fs -get /sanguo/weiguo.txt ./</span><br><span class="line">2021-09-06 16:50:23,583 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 8</span><br><span class="line">drwxrwxr-x. 2 xisun xisun 52 9月   2 23:15 bin</span><br><span class="line">-rw-r--r--. 1 xisun xisun 14 9月   6 16:49 shuguo.txt</span><br><span class="line">-rw-r--r--. 1 xisun xisun  7 9月   6 16:50 weiguo.txt</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun  6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="HDFS-的-API-操作"><a href="#HDFS-的-API-操作" class="headerlink" title="HDFS 的 API 操作"></a>HDFS 的 API 操作</h2><h3 id="客户端环境准备"><a href="#客户端环境准备" class="headerlink" title="客户端环境准备"></a>客户端环境准备</h3><ul>
<li><p>Windows 系统开发 Hadoop 时，如果是远程连接 Linux 上的 Hadoop 集群，则不需要再下载安装 Windows 版本的 Hadoop。但是，需要在本地配置相关的 Hadoop 变量，主要包括 hadoop.dll 与 winutils.exe 等。</p>
<ul>
<li><p>由于 Hadoop 主要基于 Linux 编写，winutil.exe 主要用于模拟 Linux 下的目录环境。当 Hadoop 在 Windows 下运行或调用远程 Hadoop 集群的时候，需要该辅助程序才能运行。winutils.exe 是 Windows 中的二进制文件，适用于不同版本的 Hadoop 系统并构建在 Windows VM 上，该 VM 用以在 Windows 系统中测试 Hadoop/YARN 相关的应用程序。参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/HeyShHeyou/article/details/103441110%E3%80%82">https://blog.csdn.net/HeyShHeyou/article/details/103441110。</a></p>
</li>
<li><p>相关异常信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">java.io.FileNotFoundException: java.io.FileNotFoundException: HADOOP_HOME and hadoop.home.dir are unset. -see https:<span class="comment">//wiki.apache.org/hadoop/WindowsProblems</span></span><br><span class="line">        at org.apache.hadoop.util.Shell.fileNotFoundException(Shell.java:<span class="number">528</span>) ~[hadoop-common-<span class="number">2.8</span>.<span class="number">4.</span>jar:na]</span><br><span class="line">        at org.apache.hadoop.util.Shell.getHadoopHomeDir(Shell.java:<span class="number">549</span>) ~[hadoop-common-<span class="number">2.8</span>.<span class="number">4.</span>jar:na]</span><br><span class="line">        at org.apache.hadoop.util.Shell.getQualifiedBin(Shell.java:<span class="number">572</span>) ~[hadoop-common-<span class="number">2.8</span>.<span class="number">4.</span>jar:na]</span><br><span class="line">        at org.apache.hadoop.util.Shell.&lt;clinit&gt;(Shell.java:<span class="number">669</span>) ~[hadoop-common-<span class="number">2.8</span>.<span class="number">4.</span>jar:na]</span><br><span class="line">        at org.apache.hadoop.util.StringUtils.&lt;clinit&gt;(StringUtils.java:<span class="number">79</span>) [hadoop-common-<span class="number">2.8</span>.<span class="number">4.</span>jar:na]</span><br><span class="line">        at org.apache.hadoop.conf.Configuration.getBoolean(Configuration.java:<span class="number">1555</span>) [hadoop-common-<span class="number">2.8</span>.<span class="number">4.</span>jar:na]</span><br><span class="line">        at org.apache.hadoop.hbase.HBaseConfiguration.checkDefaultsVersion(HBaseConfiguration.java:<span class="number">66</span>) [hbase-common-<span class="number">2.0</span>.<span class="number">0.</span>jar:<span class="number">2.0</span>.<span class="number">0</span>]</span><br><span class="line">        at org.apache.hadoop.hbase.HBaseConfiguration.addHbaseResources(HBaseConfiguration.java:<span class="number">80</span>) [hbase-common-<span class="number">2.0</span>.<span class="number">0.</span>jar:<span class="number">2.0</span>.<span class="number">0</span>]</span><br><span class="line">        at org.apache.hadoop.hbase.HBaseConfiguration.create(HBaseConfiguration.java:<span class="number">94</span>) [hbase-common-<span class="number">2.0</span>.<span class="number">0.</span>jar:<span class="number">2.0</span>.<span class="number">0</span>]</span><br><span class="line">        at org.apache.phoenix.query.ConfigurationFactory$ConfigurationFactoryImpl$<span class="number">1.</span>call(ConfigurationFactory.java:<span class="number">49</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br><span class="line">        at org.apache.phoenix.query.ConfigurationFactory$ConfigurationFactoryImpl$<span class="number">1.</span>call(ConfigurationFactory.java:<span class="number">46</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br><span class="line">        at org.apache.phoenix.util.PhoenixContextExecutor.call(PhoenixContextExecutor.java:<span class="number">76</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br><span class="line">        at org.apache.phoenix.util.PhoenixContextExecutor.callWithoutPropagation(PhoenixContextExecutor.java:<span class="number">91</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br><span class="line">        at org.apache.phoenix.query.ConfigurationFactory$ConfigurationFactoryImpl.getConfiguration(ConfigurationFactory.java:<span class="number">46</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br><span class="line">        at org.apache.phoenix.jdbc.PhoenixDriver.initializeConnectionCache(PhoenixDriver.java:<span class="number">151</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br><span class="line">        at org.apache.phoenix.jdbc.PhoenixDriver.&lt;init&gt;(PhoenixDriver.java:<span class="number">143</span>) [phoenix-core-<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>.jar:<span class="number">5.0</span>.<span class="number">0</span>-HBase-<span class="number">2.0</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>根据 Linux 上 Hadoop 版本，下载对应的 winutils.exe 版本：<a target="_blank" rel="noopener" href="https://github.com/cdarlint/winutils%EF%BC%8Chttps://github.com/steveloughran/winutils%E3%80%82">https://github.com/cdarlint/winutils，https://github.com/steveloughran/winutils。</a></p>
<p><img src="/2021/08/25/hadoop/image-20210906233413928.png" alt="image-20210906233413928"></p>
</li>
<li><p>配置 HADOOP_HOME 环境变量：</p>
<p><img src="/2021/08/25/hadoop/image-20210906232417504.png" alt="image-20210906232417504"></p>
</li>
<li><p>配置 Path 环境变量：</p>
<p><img src="/2021/08/25/hadoop/image-20210906232525065.png" alt="image-20210906232525065"></p>
</li>
<li><p>验证 Hadoop 环境变量是否正常。双击 winutils.exe，如果一闪而过，说明正常；如果报如下错误，说明缺少微软运行库（正版系统往往有这个问题）。</p>
<p><img src="/2021/08/25/hadoop/image-20210906232834423.png" alt="image-20210906232834423"></p>
<p><img src="/2021/08/25/hadoop/image-20210906233140290.png" alt="image-20210906233140290"></p>
</li>
<li><p>Hadoop 环境变量配置好后，可能需要重启 IDEA 或者重启电脑。</p>
</li>
</ul>
<h3 id="项目创建"><a href="#项目创建" class="headerlink" title="项目创建"></a>项目创建</h3><ul>
<li><p>添加依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.xisun.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xisun-hadoop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.version</span>&gt;</span>3.6.1<span class="tag">&lt;/<span class="name">maven.compiler.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>$&#123;java.version&#125;<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>$&#123;java.version&#125;<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hadoop.version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">hadoop.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 日志相关 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Hadoop客户端 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;hadoop.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;maven.compiler.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>$&#123;maven.compiler.source&#125;<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>$&#123;maven.compiler.target&#125;<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>日志配置：</p>
<ul>
<li><p>log4j.properties:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">INFO, stdout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%d %p [%c] - %m%n</span></span><br><span class="line"><span class="meta">log4j.appender.logfile</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.logfile.File</span>=<span class="string">target/spring.log</span></span><br><span class="line"><span class="meta">log4j.appender.logfile.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.logfile.layout.ConversionPattern</span>=<span class="string">%d %p [%c] - %m%n</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>logback.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span></span></span><br><span class="line"><span class="tag">        <span class="attr">debug</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">&quot;http://ch.qos.logback/xml/ns/logback&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://ch.qos.logback/xml/ns/logback</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://raw.githubusercontent.com/enricopulatzo/logback-XSD/master/src/main/xsd/logback.xsd&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义日志文件的存储地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logging.path&quot;</span> <span class="attr">value</span>=<span class="string">&quot;./&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logging.level&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;message.format&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n%ex&#123;full, DISPLAY_EX_EVAL&#125;&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 控制台输出日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 自定义滚动日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;RollingAppender&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">append</span>&gt;</span>true<span class="tag">&lt;/<span class="name">append</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>$&#123;logging.level&#125;<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;logging.path&#125;/reaction-extractor-%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>$&#123;message.format&#125;<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 异步输出日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ASYNC&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.AsyncAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">discardingThreshold</span>&gt;</span>0<span class="tag">&lt;/<span class="name">discardingThreshold</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">queueSize</span>&gt;</span>100<span class="tag">&lt;/<span class="name">queueSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;RollingAppender&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;$&#123;logging.level&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ASYNC&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>项目结构：</p>
<p><img src="/2021/08/25/hadoop/image-20210907150906533.png" alt="image-20210907150906533"></p>
</li>
</ul>
<h3 id="案例实操"><a href="#案例实操" class="headerlink" title="案例实操"></a>案例实操</h3><h4 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> XiSun</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/9/6 22:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HdfsClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> FileSystem fileSystem;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            init();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (URISyntaxException | IOException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取文件系统</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> URISyntaxException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> URISyntaxException, IOException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="comment">// 集群nn的连接地址</span></span><br><span class="line">        URI uri = <span class="keyword">new</span> URI(<span class="string">&quot;hdfs://hadoop102:8020&quot;</span>);</span><br><span class="line">        <span class="comment">// 创建一个配置文件，按需求自定义配置条件</span></span><br><span class="line">        Configuration configuration = <span class="keyword">new</span> Configuration();</span><br><span class="line">        <span class="comment">// 用户</span></span><br><span class="line">        String user = <span class="string">&quot;xisun&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取客户端对象</span></span><br><span class="line">        fileSystem = FileSystem.get(uri, configuration, user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭资源</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (fileSystem != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileSystem.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">                exception.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建目录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mkdirs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileSystem.mkdirs(<span class="keyword">new</span> Path(<span class="string">&quot;/xiyou/huaguoshan/&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">            exception.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        mkdirs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>客户端去操作 HDFS 时，是有一个用户身份的。默认情况下，HDFS 客户端 API 会从采用 Windows 默认用户访问 HDFS，这通常会报权限异常错误。因此，在创建文件系统对象时，一定要配置用户。</li>
</ul>
</li>
<li><p>控制台输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">02</span>.<span class="number">744</span> [main] DEBUG o.apache.hadoop.metrics2.lib.MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginSuccess with annotation <span class="meta">@org</span>.apache.hadoop.metrics2.annotation.Metric(sampleName=Ops, always=<span class="keyword">false</span>, valueName=Time, about=, interval=<span class="number">10</span>, type=DEFAULT, value=[<span class="function">Rate of successful kerberos logins and <span class="title">latency</span> <span class="params">(milliseconds)</span>])</span></span><br><span class="line"><span class="function">2021-09-07 15:35:02.750 [main] DEBUG o.apache.hadoop.metrics2.lib.MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginFailure with annotation @org.apache.hadoop.metrics2.annotation.<span class="title">Metric</span><span class="params">(sampleName=Ops, always=<span class="keyword">false</span>, valueName=Time, about=, interval=<span class="number">10</span>, type=DEFAULT, value=[Rate of failed kerberos logins and latency (milliseconds)</span>])</span></span><br><span class="line"><span class="function">2021-09-07 15:35:02.750 [main] DEBUG o.apache.hadoop.metrics2.lib.MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.getGroups with annotation @org.apache.hadoop.metrics2.annotation.<span class="title">Metric</span><span class="params">(sampleName=Ops, always=<span class="keyword">false</span>, valueName=Time, about=, interval=<span class="number">10</span>, type=DEFAULT, value=[GetGroups])</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:02.751 [main] DEBUG o.apache.hadoop.metrics2.lib.MutableMetricsFactory - field <span class="keyword">private</span> org.apache.hadoop.metrics2.lib.MutableGaugeLong org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailuresTotal with annotation @org.apache.hadoop.metrics2.annotation.<span class="title">Metric</span><span class="params">(sampleName=Ops, always=<span class="keyword">false</span>, valueName=Time, about=, interval=<span class="number">10</span>, type=DEFAULT, value=[Renewal failures since startup])</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:02.751 [main] DEBUG o.apache.hadoop.metrics2.lib.MutableMetricsFactory - field <span class="keyword">private</span> org.apache.hadoop.metrics2.lib.MutableGaugeInt org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailures with annotation @org.apache.hadoop.metrics2.annotation.<span class="title">Metric</span><span class="params">(sampleName=Ops, always=<span class="keyword">false</span>, valueName=Time, about=, interval=<span class="number">10</span>, type=DEFAULT, value=[Renewal failures since last successful login])</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:02.752 [main] DEBUG org.apache.hadoop.metrics2.impl.MetricsSystemImpl - UgiMetrics, User and group related metrics</span></span><br><span class="line"><span class="function">2021-09-07 15:35:02.761 [main] DEBUG org.apache.hadoop.security.UserGroupInformation - PrivilegedAction as:<span class="title">xisun</span> <span class="params">(auth:SIMPLE)</span> from:org.apache.hadoop.fs.FileSystem.<span class="title">get</span><span class="params">(FileSystem.java:<span class="number">214</span>)</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.049 [main] DEBUG org.apache.hadoop.fs.FileSystem - Loading filesystems</span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.065 [main] DEBUG org.apache.hadoop.fs.FileSystem - file:<span class="comment">// = class org.apache.hadoop.fs.LocalFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-common/3.2.1/hadoop-common-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.073 [main] DEBUG org.apache.hadoop.fs.FileSystem - viewfs:<span class="comment">// = class org.apache.hadoop.fs.viewfs.ViewFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-common/3.2.1/hadoop-common-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.076 [main] DEBUG org.apache.hadoop.fs.FileSystem - har:<span class="comment">// = class org.apache.hadoop.fs.HarFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-common/3.2.1/hadoop-common-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.077 [main] DEBUG org.apache.hadoop.fs.FileSystem - http:<span class="comment">// = class org.apache.hadoop.fs.http.HttpFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-common/3.2.1/hadoop-common-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.078 [main] DEBUG org.apache.hadoop.fs.FileSystem - https:<span class="comment">// = class org.apache.hadoop.fs.http.HttpsFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-common/3.2.1/hadoop-common-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.090 [main] DEBUG org.apache.hadoop.fs.FileSystem - hdfs:<span class="comment">// = class org.apache.hadoop.hdfs.DistributedFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-hdfs-client/3.2.1/hadoop-hdfs-client-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.102 [main] DEBUG org.apache.hadoop.fs.FileSystem - webhdfs:<span class="comment">// = class org.apache.hadoop.hdfs.web.WebHdfsFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-hdfs-client/3.2.1/hadoop-hdfs-client-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.104 [main] DEBUG org.apache.hadoop.fs.FileSystem - swebhdfs:<span class="comment">// = class org.apache.hadoop.hdfs.web.SWebHdfsFileSystem from /D:/java/maven-repo/org/apache/hadoop/hadoop-hdfs-client/3.2.1/hadoop-hdfs-client-3.2.1.jar</span></span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.104 [main] DEBUG org.apache.hadoop.fs.FileSystem - Looking <span class="keyword">for</span> FS supporting hdfs</span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.104 [main] DEBUG org.apache.hadoop.fs.FileSystem - looking <span class="keyword">for</span> configuration option fs.hdfs.impl</span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.120 [main] DEBUG org.apache.hadoop.fs.FileSystem - Looking in service filesystems <span class="keyword">for</span> implementation class</span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.121 [main] DEBUG org.apache.hadoop.fs.FileSystem - FS <span class="keyword">for</span> hdfs is class org.apache.hadoop.hdfs.DistributedFileSystem</span></span><br><span class="line"><span class="function">2021-09-07 15:35:03.204 [main] DEBUG org.apache.hadoop.hdfs.client.impl.DfsClientConf - dfs.client.use.legacy.blockreader.local </span>= <span class="keyword">false</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">205</span> [main] DEBUG org.apache.hadoop.hdfs.client.impl.DfsClientConf - dfs.client.read.shortcircuit = <span class="keyword">false</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">205</span> [main] DEBUG org.apache.hadoop.hdfs.client.impl.DfsClientConf - dfs.client.domain.socket.data.traffic = <span class="keyword">false</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">205</span> [main] DEBUG org.apache.hadoop.hdfs.client.impl.DfsClientConf - dfs.domain.socket.path = </span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">219</span> [main] DEBUG org.apache.hadoop.hdfs.DFSClient - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to <span class="number">0</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">240</span> [main] DEBUG org.apache.hadoop.security.SecurityUtil - Setting hadoop.security.token.service.use_ip to <span class="keyword">true</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">254</span> [main] DEBUG org.apache.hadoop.io.retry.RetryUtils - multipleLinearRandomRetry = <span class="keyword">null</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">291</span> [main] DEBUG org.apache.hadoop.security.Groups -  Creating <span class="keyword">new</span> Groups object</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">293</span> [main] DEBUG org.apache.hadoop.util.NativeCodeLoader - Trying to load the custom-built <span class="keyword">native</span>-hadoop library...</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">297</span> [main] DEBUG org.apache.hadoop.util.NativeCodeLoader - Loaded the <span class="keyword">native</span>-hadoop library</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">298</span> [main] DEBUG o.apache.hadoop.security.JniBasedUnixGroupsMapping - Using JniBasedUnixGroupsMapping <span class="keyword">for</span> Group resolution</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">298</span> [main] DEBUG o.a.h.s.JniBasedUnixGroupsMappingWithFallback - Group mapping impl=org.apache.hadoop.security.JniBasedUnixGroupsMapping</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">335</span> [main] DEBUG org.apache.hadoop.security.Groups - Group mapping impl=org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback; cacheTimeout=<span class="number">300000</span>; warningDeltaMs=<span class="number">5000</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">347</span> [main] DEBUG org.apache.hadoop.ipc.Server - rpcKind=RPC_PROTOCOL_BUFFER, rpcRequestWrapperClass=<span class="class"><span class="keyword">class</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">hadoop</span>.<span class="title">ipc</span>.<span class="title">ProtobufRpcEngine</span>$<span class="title">RpcProtobufRequest</span>, <span class="title">rpcInvoker</span></span>=org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker@<span class="number">3</span>ce1e309</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">03</span>.<span class="number">672</span> [main] DEBUG org.apache.hadoop.ipc.Client - getting client out of cache: org.apache.hadoop.ipc.Client@<span class="number">52</span>bf72b5</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">085</span> [main] DEBUG org.apache.hadoop.util.PerformanceAdvisory - Both <span class="keyword">short</span>-circuit local reads and UNIX domain socket are disabled.</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">092</span> [main] DEBUG o.a.h.h.p.datatransfer.sasl.DataTransferSaslUtil - DataTransferProtocol not using SaslPropertiesResolver, no QOP found in configuration <span class="keyword">for</span> dfs.data.transfer.protection</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">112</span> [main] DEBUG org.apache.hadoop.hdfs.DFSClient - /xiyou/huaguoshan: masked=&#123; masked: rwxr-xr-x, unmasked: rwxrwxrwx &#125;</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">151</span> [main] DEBUG org.apache.hadoop.ipc.Client - The ping interval is <span class="number">60000</span> ms.</span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">153</span> [main] DEBUG org.apache.hadoop.ipc.Client - Connecting to hadoop102/<span class="number">192.168</span>.<span class="number">10.102</span>:<span class="number">8020</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">227</span> [<span class="function">IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun] DEBUG org.apache.hadoop.ipc.Client - IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun: starting, having connections 1</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.230 [IPC Parameter Sending Thread #0] DEBUG org.apache.hadoop.ipc.Client - IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun sending #0 org.apache.hadoop.hdfs.protocol.ClientProtocol.mkdirs</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.244 [IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun] DEBUG org.apache.hadoop.ipc.Client - IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun got value #0</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.245 [main] DEBUG org.apache.hadoop.ipc.ProtobufRpcEngine - Call: mkdirs took 118ms</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.248 [main] DEBUG org.apache.hadoop.ipc.Client - stopping client from cache: org.apache.hadoop.ipc.Client@52bf72b5</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.248 [main] DEBUG org.apache.hadoop.ipc.Client - removing client from cache: org.apache.hadoop.ipc.Client@52bf72b5</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.248 [main] DEBUG org.apache.hadoop.ipc.Client - stopping actual client because no more references remain: org.apache.hadoop.ipc.Client@52bf72b5</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.248 [main] DEBUG org.apache.hadoop.ipc.Client - Stopping client</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.248 [IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun] DEBUG org.apache.hadoop.ipc.Client - IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun: closed</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.248 [IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun] DEBUG org.apache.hadoop.ipc.Client - IPC <span class="title">Client</span> <span class="params">(<span class="number">956420404</span>)</span> connection to hadoop102/192.168.10.102:8020 from xisun: stopped, remaining connections 0</span></span><br><span class="line"><span class="function">2021-09-07 15:35:04.354 [Thread-4] DEBUG org.apache.hadoop.util.ShutdownHookManager - Completed shutdown in 0.001 seconds</span>; Timeouts: <span class="number">0</span></span><br><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">35</span>:<span class="number">04</span>.<span class="number">363</span> [Thread-<span class="number">4</span>] DEBUG org.apache.hadoop.util.ShutdownHookManager - ShutdownHookManger completed shutdown.</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建结果：</p>
<p><img src="/2021/08/25/hadoop/image-20210907153615806.png" alt="image-20210907153615806"></p>
</li>
</ul>
<h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 上传文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyFromLocalFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 参数一：Windows原文件是否删除；参数二：若HDFS目的地文件已存在，是否允许覆盖；参数三：Windows原文件路径；参数四：HDFS目的地路径</span></span><br><span class="line">        fileSystem.copyFromLocalFile(<span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">new</span> Path(<span class="string">&quot;E:\\sunwukong.txt&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://hadoop102/xiyou/huaguoshan&quot;</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制台输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">15</span>:<span class="number">46</span>:<span class="number">03</span>.<span class="number">654</span> [Thread-<span class="number">6</span>] INFO  o.a.h.h.p.datatransfer.sasl.SaslDataTransferClient - SASL encryption trust check: localHostTrusted = <span class="keyword">false</span>, remoteHostTrusted = <span class="keyword">false</span></span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>上传结果：</p>
<p><img src="/2021/08/25/hadoop/image-20210907154935556.png" alt="image-20210907154935556"></p>
<ul>
<li><p>可以看出，上传文件，默认备份数是 3，参数的优先级顺序：hdfs-default.xml &lt; hdfs-site.xml &lt; 在项目资源目录下的配置文件 &lt; 代码里面的配置。</p>
<img src="/2021/08/25/hadoop/image-20210907155850375.png" alt="image-20210907155850375" style="zoom:80%;">

<ul>
<li><p>项目资源目录下的配置文件：</p>
<p><img src="/2021/08/25/hadoop/image-20210907155455332.png" alt="image-20210907155455332"></p>
</li>
<li><p>代码里面的配置：</p>
<p><img src="/2021/08/25/hadoop/image-20210907155532293.png" alt="image-20210907155532293"></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 下载文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyToLocalFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 参数一：HDFS原文件是否删除；参数二：HDFS原文件路径；参数三：Windows目标地址路径；参数四：是否开启本地文件校验，false表示开启</span></span><br><span class="line">        fileSystem.copyToLocalFile(<span class="keyword">false</span>, <span class="keyword">new</span> Path(<span class="string">&quot;hdfs://hadoop102/wcinput/word.txt&quot;</span>),</span><br><span class="line">                <span class="keyword">new</span> Path(<span class="string">&quot;E:\\11\\&quot;</span>), <span class="keyword">false</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>也可以直接下载 HDFS 上的文件路径。</p>
</blockquote>
</li>
<li><p>控制台输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2021</span>-<span class="number">09</span>-<span class="number">07</span> <span class="number">16</span>:<span class="number">06</span>:<span class="number">31.318</span> [main] INFO  o.a.h.h.p.datatransfer.sasl.SaslDataTransferClient - SASL encryption trust check: localHostTrusted = <span class="keyword">false</span>, remoteHostTrusted = <span class="keyword">false</span></span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下载结果：</p>
<p><img src="/2021/08/25/hadoop/image-20210907161117479.png" alt="image-20210907161117479"></p>
</li>
</ul>
<h4 id="文件删除"><a href="#文件删除" class="headerlink" title="文件删除"></a>文件删除</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">rm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 参数1：HDFS要删除的路径；参数2：是否递归删除</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 删除文件</span></span><br><span class="line">        fileSystem.delete(<span class="keyword">new</span> Path(<span class="string">&quot;/hadoop-3.2.1.tar.gz&quot;</span>), <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除空目录</span></span><br><span class="line">        fileSystem.delete(<span class="keyword">new</span> Path(<span class="string">&quot;/honglou&quot;</span>), <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除非空目录</span></span><br><span class="line">        fileSystem.delete(<span class="keyword">new</span> Path(<span class="string">&quot;/xiyou&quot;</span>), <span class="keyword">true</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="文件的更名和移动"><a href="#文件的更名和移动" class="headerlink" title="文件的更名和移动"></a>文件的更名和移动</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件的更名和移动</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mv</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 参数1：HDFS原文件路径；参数2：HDFS目标文件路径</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对文件名称的修改</span></span><br><span class="line">        <span class="comment">// fileSystem.rename(new Path(&quot;/wcinput/word.txt&quot;), new Path(&quot;/wcinput/words.txt&quot;));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 文件的移动和更名</span></span><br><span class="line">        <span class="comment">// fileSystem.rename(new Path(&quot;/wcinput/words.txt&quot;), new Path(&quot;/wordout.txt&quot;));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 目录更名</span></span><br><span class="line">        fileSystem.rename(<span class="keyword">new</span> Path(<span class="string">&quot;/honglou&quot;</span>), <span class="keyword">new</span> Path(<span class="string">&quot;/hongloumeng&quot;</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="文件详情查看"><a href="#文件详情查看" class="headerlink" title="文件详情查看"></a>文件详情查看</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取文件详细信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listFiles</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 获取所有文件信息，第二个参数表示是否递归</span></span><br><span class="line">        RemoteIterator&lt;LocatedFileStatus&gt; listFiles = fileSystem.listFiles(<span class="keyword">new</span> Path(<span class="string">&quot;/&quot;</span>), <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 遍历文件</span></span><br><span class="line">        <span class="keyword">while</span> (listFiles.hasNext()) &#123;</span><br><span class="line">            LocatedFileStatus fileStatus = listFiles.next();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;==========&quot;</span> + fileStatus.getPath() + <span class="string">&quot;=========&quot;</span>);</span><br><span class="line">            System.out.println(fileStatus.getPermission());</span><br><span class="line">            System.out.println(fileStatus.getOwner());</span><br><span class="line">            System.out.println(fileStatus.getGroup());</span><br><span class="line">            System.out.println(fileStatus.getLen());</span><br><span class="line">            System.out.println(fileStatus.getModificationTime());</span><br><span class="line">            System.out.println(fileStatus.getReplication());</span><br><span class="line">            System.out.println(fileStatus.getBlockSize());</span><br><span class="line">            System.out.println(fileStatus.getPath().getName());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取块信息</span></span><br><span class="line">            BlockLocation[] blockLocations = fileStatus.getBlockLocations();</span><br><span class="line">            System.out.println(Arrays.toString(blockLocations));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制台输出：</p>
<p><img src="/2021/08/25/hadoop/image-20210907171215574.png" alt="image-20210907171215574"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">==========hdfs:<span class="comment">//hadoop102:8020/sanguoyanyi/shuguo.txt=========</span></span><br><span class="line">rw-r--r--</span><br><span class="line">xisun</span><br><span class="line">supergroup</span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="number">1630918100557</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">134217728</span></span><br><span class="line">shuguo.txt</span><br><span class="line">[<span class="number">0</span>,<span class="number">14</span>,hadoop102,hadoop103,hadoop104]</span><br><span class="line">==========hdfs:<span class="comment">//hadoop102:8020/sanguoyanyi/weiguo.txt=========</span></span><br><span class="line">rw-r--r--</span><br><span class="line">xisun</span><br><span class="line">supergroup</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">1630917830657</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">134217728</span></span><br><span class="line">weiguo.txt</span><br><span class="line">[<span class="number">0</span>,<span class="number">7</span>,hadoop102,hadoop103,hadoop104]</span><br><span class="line">==========hdfs:<span class="comment">//hadoop102:8020/sanguoyanyi/wuguo.txt=========</span></span><br><span class="line">rw-r--r--</span><br><span class="line">xisun</span><br><span class="line">supergroup</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">1630917975305</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">134217728</span></span><br><span class="line">wuguo.txt</span><br><span class="line">[<span class="number">0</span>,<span class="number">6</span>,hadoop102,hadoop103,hadoop104]</span><br><span class="line">    </span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="文件和文件夹类型判断"><a href="#文件和文件夹类型判断" class="headerlink" title="文件和文件夹类型判断"></a>文件和文件夹类型判断</h4><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断是文件夹还是文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fileType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        FileStatus[] listStatus = fileSystem.listStatus(<span class="keyword">new</span> Path(<span class="string">&quot;/&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (FileStatus status : listStatus) &#123;</span><br><span class="line">            <span class="keyword">if</span> (status.isFile()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;文件：&quot;</span> + status.getPath().getName());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;目录：&quot;</span> + status.getPath().getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line">        exception.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制台输出：</p>
<p><img src="/2021/08/25/hadoop/image-20210907171344066.png" alt="image-20210907171344066"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">目录：sanguoyanyi</span><br><span class="line">目录：tmp</span><br><span class="line">目录：wcinput</span><br><span class="line">目录：wcoutput</span><br><span class="line">文件：wordout.txt</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="HDFS-的读写流程"><a href="#HDFS-的读写流程" class="headerlink" title="HDFS 的读写流程"></a>HDFS 的读写流程</h2><h3 id="HDFS-写数据流程"><a href="#HDFS-写数据流程" class="headerlink" title="HDFS 写数据流程"></a>HDFS 写数据流程</h3><p><img src="/2021/08/25/hadoop/image-20210908104338787.png" alt="image-20210908104338787"></p>
<ol>
<li>客户端通过 Distributed FileSystem 模块向 NameNode 请求上传文件，NameNode 检查目标文件是否已存在，父目录是否存在。</li>
<li>NameNode 返回是否可以上传。</li>
<li>客户端请求第一个 Block 上传到哪几个 DataNode 服务器上。</li>
<li>NameNode 返回 3 个 DataNode 节点，分别为 dn1、dn2、dn3。</li>
<li>客户端通过 FSDataOutputStream 模块请求向 dn1 上传数据，dn1 收到请求会继续调用 dn2，然后 dn2 调用 dn3，将这个通信管道建立完成。</li>
<li>dn1、dn2、dn3 逐级应答客户端。</li>
<li>客户端开始往 dn1 上传第一个 Block（先从磁盘读取数据放到一个本地内存缓存），以 Packet 为单位，dn1 收到一个 Packet 就会传给 dn2，dn2 再传给 dn3；dn1 每传一个 Packet 会放入一个应答队列等待应答。</li>
<li>当一个 Block 传输完成之后，客户端再次请求 NameNode 上传第二个 Block 的服务器。（重复执行 3 - 7 步）</li>
</ol>
<h4 id="网络拓扑-节点距离计算"><a href="#网络拓扑-节点距离计算" class="headerlink" title="网络拓扑 - 节点距离计算"></a>网络拓扑 - 节点距离计算</h4><ul>
<li><p>在 HDFS 写数据的过程中，NameNode 会选择距离待上传数据最近距离的 DataNode 接收数据。</p>
</li>
<li><p>节点距离：两个节点到达最近的共同祖先的距离总和。</p>
</li>
<li><p>假设有集群 d1 机架 r1 中的节点 n1，则该节点可以表示为 /d1/r1/n1。利用这种标记，这里给出四种距离描述，如下图所示：</p>
<p><img src="/2021/08/25/hadoop/image-20210908104610376.png" alt="image-20210908104610376"></p>
<ul>
<li>节点到其自身的距离为 0，到其所属机架的距离为 1，到其所属集群的距离为 2，到其所属机房的距离为 3。</li>
<li>Distance(/d1/r1/n0, /d1/r1/n0) = 0：同一节点上的进程。/d1/r1/n0 与 /d1/r1/n0 的共同祖先是 n0，因此，距离为 0 + 0 = 0。</li>
<li>Distance(/d1/r1/n1, /d1/r1/n2) = 2：同一机架上的不同节点。/d1/r1/n1 与 /d1/r1/n2 的共同祖先是机架 r1，因此，距离为 1 + 1 = 2。</li>
<li>Distance(/d1/r2/n0, /d1/r3/n2) = 4：同一数据中心不同机架上的节点。/d1/r2/n0 与 /d1/r3/n2 的共同祖先是集群 d1，因此，距离为 2 + 2 = 4。</li>
<li>Distance(/d1/r2/n1, /d2/r4/n1) = 6：不同数据中心的节点。/d1/r2/n1 与 /d2/r4/n1 的共同祖先是机房，因此，距离为 3 + 3 = 6。</li>
</ul>
</li>
<li><p>再比如下图互联网上的一个计算机群，5 号机和 9 号机的节点距离为 3，2 号机和 10 号机的节点距离也为 3。</p>
<p><img src="/2021/08/25/hadoop/image-20210908091317080.png" alt="image-20210908091317080"></p>
</li>
</ul>
<h4 id="机架感知-副本存储节点选择"><a href="#机架感知-副本存储节点选择" class="headerlink" title="机架感知 - 副本存储节点选择"></a>机架感知 - 副本存储节点选择</h4><ul>
<li><p>机架感知说明</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">For the common case, when the replication factor is three, HDFS’s placement policy is to put one replica on the local machine if the writer is on a datanode, otherwise on a random datanode in the same rack as that of the writer, another replica on a node in a different (remote) rack, and the last on a different node in the same remote rack. This policy cuts the inter-rack write traffic which generally improves write performance. The chance of rack failure is far less than that of node failure; this policy does not impact data reliability and availability guarantees. However, it does reduce the aggregate network bandwidth used when reading data since a block is placed in only two unique racks rather than three. With this policy, the replicas of a file do not evenly distribute across the racks. One third of replicas are on one node, two thirds of replicas are on one rack, and the other third are evenly distributed across the remaining racks. This policy improves write performance without compromising data reliability or read performance.</span><br></pre></td></tr></table></figure>
</li>
<li><p>副本存储节点选择</p>
<p><img src="/2021/08/25/hadoop/image-20210908102248682.png" alt="image-20210908102248682"></p>
<ul>
<li>第一个副本，在 Client 所处的节点上，节点距离最近，上传速度最快。如果客户端在集群外，则随机选一个。比如：/d1/r1/n0。</li>
<li>第二个副本，在另一个机架的随机一个节点，以保证数据的可靠性。比如：/d1/r2/n0。</li>
<li>第三个副本，在第二个副本所在机架的随机节点，考虑的是传输效率。比如：/d1/r2/n1。</li>
</ul>
</li>
</ul>
<h3 id="HDFS-读数据流程"><a href="#HDFS-读数据流程" class="headerlink" title="HDFS 读数据流程"></a>HDFS 读数据流程</h3><p><img src="/2021/08/25/hadoop/image-20210908105937977.png" alt="image-20210908105937977"></p>
<ol>
<li>客户端通过 DistributedFileSystem 向 NameNode 请求下载文件，NameNode 通过检查权限和查询元数据，找到文件块所在的 DataNode 地址。</li>
<li>挑选一台 DataNode（就近原则，然后随机）服务器，请求读取数据。</li>
<li>DataNode 开始传输数据给客户端（从磁盘里面读取数据输入流，以 Packet 为单位来做校验）。</li>
<li>客户端以 Packet 为单位接收，先在本地缓存，然后写入目标文件。</li>
</ol>
<h2 id="NameNode-和-SecondaryNameNode"><a href="#NameNode-和-SecondaryNameNode" class="headerlink" title="NameNode 和 SecondaryNameNode"></a>NameNode 和 SecondaryNameNode</h2><h3 id="NN-和-2NN-工作机制"><a href="#NN-和-2NN-工作机制" class="headerlink" title="NN 和 2NN 工作机制"></a>NN 和 2NN 工作机制</h3><p><img src="/2021/08/25/hadoop/image-20210908114133555.png" alt="image-20210908114133555"></p>
<ul>
<li>NameNode 中的元数据如何存储的？<ul>
<li>首先，我们做个假设，如果存储在 NameNode 节点的磁盘中，因为经常需要进行随机访问，还有响应客户请求，必然是效率过低。因此，元数据需要存放在内存中。但如果只存在内存中，一旦断电，元数据丢失，整个集群就无法工作了。因此，需要一个在磁盘中备份元数据的 FsImage。</li>
<li>其次，这样又会带来新的问题，当在内存中的元数据更新时，如果同时更新 FsImage，就会导致效率过低，但如果不更新，就会发生一致性问题，一旦 NameNode 节点断电，就会产生数据丢失。因此，引入 Edits 文件（此文件只进行追加操作，即只记录每一个请求的过程，不计算结果，效率很高）。每当元数据有更新或者添加元数据时，修改内存中的元数据并将请求操作追加到 Edits 中。这样，一旦 NameNode 节点断电，可以通过 FsImage 和 Edits 的合并，合成元数据。</li>
<li>但是，如果长时间添加数据到 Edits 中，会导致该文件数据过大，效率降低，而且一旦断电，恢复元数据需要的时间过长。因此，需要定期进行 FsImage 和 Edits 的合并，如果这个操作由 NameNode 节点完成，又会效率过低。因此，引入一个新的节点 SecondaryNamenode，专门用于 FsImage 和 Edits 的合并。</li>
</ul>
</li>
<li>第一阶段：NameNode 启动。<ol>
<li>第一次启动 NameNode 格式化后，创建 Fsimage（镜像文件）和 Edits（编辑日志）文件。如果不是第一次启动，直接加载 Fsimage 和 Edits 到内存。</li>
<li>客户端发送对元数据进行增删改的请求。</li>
<li>NameNode 记录操作日志，更新滚动日志。</li>
<li>NameNode 在内存中对元数据进行增删改。</li>
</ol>
</li>
<li>第二阶段：Secondary NameNode 工作。<ol>
<li>Secondary NameNode 询问 NameNode 是否需要 CheckPoint，并直接带回 NameNode 是否检查的结果。</li>
<li>Secondary NameNode 请求执行 CheckPoint。</li>
<li>NameNode 滚动正在写的 Edits 日志。</li>
<li>NameNode 将滚动前的镜像文件和编辑日志拷贝到 Secondary NameNode。</li>
<li>Secondary NameNode 加载镜像文件和编辑日志到内存，并合并。</li>
<li>Secondary NameNode 生成新的镜像文件 fsimage.chkpoint。</li>
<li>Secondary NameNode 拷贝 fsimage.chkpoint 到 NameNode。</li>
<li>NameNode 将 fsimage.chkpoint 重新命名成 fsimage。</li>
</ol>
</li>
</ul>
<h3 id="Fsimage-和-Edits-解析"><a href="#Fsimage-和-Edits-解析" class="headerlink" title="Fsimage 和 Edits 解析"></a>Fsimage 和 Edits 解析</h3><h4 id="Fsimage-和-Edits-的概念"><a href="#Fsimage-和-Edits-的概念" class="headerlink" title="Fsimage 和 Edits 的概念"></a>Fsimage 和 Edits 的概念</h4><ul>
<li><p>NameNode 被格式化之后，将在 <code>/opt/module/hadoop-3.1.3/data/tmp/dfs/name/current</code> 路径中产生如下文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 current]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data/dfs/name/current</span><br><span class="line">[xisun@hadoop102 current]$ ll</span><br><span class="line">总用量 701</span><br><span class="line">-rw-rw-r--. 1 xisun xisun     418 9月   8 13:43 fsimage_0000000000000000000</span><br><span class="line">-rw-rw-r--. 1 xisun xisun      62 9月   8 13:43 fsimage_0000000000000000000.md5</span><br><span class="line">-rw-rw-r--. 1 xisun xisun       4 9月   8 13:43 seen_txid</span><br><span class="line">-rw-rw-r--. 1 xisun xisun     217 9月   7 11:44 VERSION</span><br></pre></td></tr></table></figure>
</li>
<li><p>Fsimage 文件：HDFS 文件系统元数据的一个永久性的检查点，其中包含 HDFS 文件系统的所有目录和文件 inode 的序列化信息。</p>
</li>
<li><p>Edits 文件：存放 HDFS 文件系统的所有更新操作的路径，文件系统客户端执行的所有写操作首先会被记录到 Edits 文件中。</p>
</li>
<li><p>seen_txid 文件：保存的是一个数字，就是最后一个 edits_ 的数字。</p>
<p><img src="/2021/08/25/hadoop/image-20210908162349654.png" alt="image-20210908162349654"></p>
</li>
<li><p>每次 NameNode 启动的时候都会将 Fsimage 文件读入内存，加载 Edits 里面的更新操作，保证内存中的元数据信息是最新的、同步的，可以看成当 NameNode 启动的时候就将 Fsimage 和 Edits 文件进行了合并。</p>
</li>
</ul>
<h4 id="oiv-查看-Fsimage-文件"><a href="#oiv-查看-Fsimage-文件" class="headerlink" title="oiv 查看 Fsimage 文件"></a>oiv 查看 Fsimage 文件</h4><ul>
<li><p>查看 oiv 和 oev 命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 current]$ hdfs</span><br><span class="line">Usage: hdfs [OPTIONS] SUBCOMMAND [SUBCOMMAND OPTIONS]</span><br><span class="line">...</span><br><span class="line">oev                  apply the offline edits viewer to an edits file</span><br><span class="line">oiv                  apply the offline fsimage viewer to an fsimage</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li><p>基本语法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs oiv -p 文件类型 -i 镜像文件名称 -o 转换后文件的输出路径</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-o 参数需要制定转换后文件的具体名称，不能只是一个目录。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 current]$ hdfs oiv -p XML -i fsimage_0000000000000000931 -o ~</span><br><span class="line">Encountered exception.  Exiting: /home/xisun (是一个目录)</span><br><span class="line">java.io.FileNotFoundException: /home/xisun (是一个目录)</span><br><span class="line">	at java.io.FileOutputStream.open0(Native Method)</span><br><span class="line">	at java.io.FileOutputStream.open(FileOutputStream.java:270)</span><br><span class="line">	at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:213)</span><br><span class="line">	at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:101)</span><br><span class="line">	at java.io.PrintStream.&lt;init&gt;(PrintStream.java:248)</span><br><span class="line">	at org.apache.hadoop.hdfs.tools.offlineImageViewer.OfflineImageViewerPB.run(OfflineImageViewerPB.java:178)</span><br><span class="line">	at org.apache.hadoop.hdfs.tools.offlineImageViewer.OfflineImageViewerPB.main(OfflineImageViewerPB.java:137)</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>实例</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 current]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-3.2.1/data/dfs/name/current</span><br><span class="line">[xisun@hadoop102 current]$ hdfs oiv -p XML -i fsimage_0000000000000000931 -o ~/fsimage.XML</span><br><span class="line">2021-09-08 16:35:27,445 INFO offlineImageViewer.FSImageHandler: Loading 6 strings</span><br><span class="line">2021-09-08 16:35:29,097 INFO namenode.FSDirectory: GLOBAL serial map: bits=29 maxEntries=536870911</span><br><span class="line">2021-09-08 16:35:29,097 INFO namenode.FSDirectory: USER serial map: bits=24 maxEntries=16777215</span><br><span class="line">2021-09-08 16:35:29,097 INFO namenode.FSDirectory: GROUP serial map: bits=24 maxEntries=16777215</span><br><span class="line">2021-09-08 16:35:29,097 INFO namenode.FSDirectory: XATTR serial map: bits=24 maxEntries=16777215</span><br><span class="line">[xisun@hadoop102 current]$ <span class="built_in">cd</span> ~</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 28</span><br><span class="line">drwxrwxr-x. 2 xisun xisun    52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 19241 9月   8 16:35 fsimage.XML</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载文件并查看</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ sz fsimage.XML</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fsimage</span>&gt;</span><span class="tag">&lt;<span class="name">version</span>&gt;</span><span class="tag">&lt;<span class="name">layoutVersion</span>&gt;</span>-65<span class="tag">&lt;/<span class="name">layoutVersion</span>&gt;</span><span class="tag">&lt;<span class="name">onDiskVersion</span>&gt;</span>1<span class="tag">&lt;/<span class="name">onDiskVersion</span>&gt;</span><span class="tag">&lt;<span class="name">oivRevision</span>&gt;</span>b3cbbb467e22ea829b3808f4b7b01d07e0bf3842<span class="tag">&lt;/<span class="name">oivRevision</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">NameSection</span>&gt;</span><span class="tag">&lt;<span class="name">namespaceId</span>&gt;</span>817173371<span class="tag">&lt;/<span class="name">namespaceId</span>&gt;</span><span class="tag">&lt;<span class="name">genstampV1</span>&gt;</span>1000<span class="tag">&lt;/<span class="name">genstampV1</span>&gt;</span><span class="tag">&lt;<span class="name">genstampV2</span>&gt;</span>1068<span class="tag">&lt;/<span class="name">genstampV2</span>&gt;</span><span class="tag">&lt;<span class="name">genstampV1Limit</span>&gt;</span>0<span class="tag">&lt;/<span class="name">genstampV1Limit</span>&gt;</span><span class="tag">&lt;<span class="name">lastAllocatedBlockId</span>&gt;</span>1073741891<span class="tag">&lt;/<span class="name">lastAllocatedBlockId</span>&gt;</span><span class="tag">&lt;<span class="name">txid</span>&gt;</span>931<span class="tag">&lt;/<span class="name">txid</span>&gt;</span><span class="tag">&lt;/<span class="name">NameSection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ErasureCodingSection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">policyId</span>&gt;</span>1<span class="tag">&lt;/<span class="name">policyId</span>&gt;</span><span class="tag">&lt;<span class="name">policyName</span>&gt;</span>RS-6-3-1024k<span class="tag">&lt;/<span class="name">policyName</span>&gt;</span><span class="tag">&lt;<span class="name">cellSize</span>&gt;</span>1048576<span class="tag">&lt;/<span class="name">cellSize</span>&gt;</span><span class="tag">&lt;<span class="name">policyState</span>&gt;</span>DISABLED<span class="tag">&lt;/<span class="name">policyState</span>&gt;</span><span class="tag">&lt;<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">codecName</span>&gt;</span>rs<span class="tag">&lt;/<span class="name">codecName</span>&gt;</span><span class="tag">&lt;<span class="name">dataUnits</span>&gt;</span>6<span class="tag">&lt;/<span class="name">dataUnits</span>&gt;</span><span class="tag">&lt;<span class="name">parityUnits</span>&gt;</span>3<span class="tag">&lt;/<span class="name">parityUnits</span>&gt;</span><span class="tag">&lt;/<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">policyId</span>&gt;</span>2<span class="tag">&lt;/<span class="name">policyId</span>&gt;</span><span class="tag">&lt;<span class="name">policyName</span>&gt;</span>RS-3-2-1024k<span class="tag">&lt;/<span class="name">policyName</span>&gt;</span><span class="tag">&lt;<span class="name">cellSize</span>&gt;</span>1048576<span class="tag">&lt;/<span class="name">cellSize</span>&gt;</span><span class="tag">&lt;<span class="name">policyState</span>&gt;</span>DISABLED<span class="tag">&lt;/<span class="name">policyState</span>&gt;</span><span class="tag">&lt;<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">codecName</span>&gt;</span>rs<span class="tag">&lt;/<span class="name">codecName</span>&gt;</span><span class="tag">&lt;<span class="name">dataUnits</span>&gt;</span>3<span class="tag">&lt;/<span class="name">dataUnits</span>&gt;</span><span class="tag">&lt;<span class="name">parityUnits</span>&gt;</span>2<span class="tag">&lt;/<span class="name">parityUnits</span>&gt;</span><span class="tag">&lt;/<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">policyId</span>&gt;</span>3<span class="tag">&lt;/<span class="name">policyId</span>&gt;</span><span class="tag">&lt;<span class="name">policyName</span>&gt;</span>RS-LEGACY-6-3-1024k<span class="tag">&lt;/<span class="name">policyName</span>&gt;</span><span class="tag">&lt;<span class="name">cellSize</span>&gt;</span>1048576<span class="tag">&lt;/<span class="name">cellSize</span>&gt;</span><span class="tag">&lt;<span class="name">policyState</span>&gt;</span>DISABLED<span class="tag">&lt;/<span class="name">policyState</span>&gt;</span><span class="tag">&lt;<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">codecName</span>&gt;</span>rs-legacy<span class="tag">&lt;/<span class="name">codecName</span>&gt;</span><span class="tag">&lt;<span class="name">dataUnits</span>&gt;</span>6<span class="tag">&lt;/<span class="name">dataUnits</span>&gt;</span><span class="tag">&lt;<span class="name">parityUnits</span>&gt;</span>3<span class="tag">&lt;/<span class="name">parityUnits</span>&gt;</span><span class="tag">&lt;/<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">policyId</span>&gt;</span>4<span class="tag">&lt;/<span class="name">policyId</span>&gt;</span><span class="tag">&lt;<span class="name">policyName</span>&gt;</span>XOR-2-1-1024k<span class="tag">&lt;/<span class="name">policyName</span>&gt;</span><span class="tag">&lt;<span class="name">cellSize</span>&gt;</span>1048576<span class="tag">&lt;/<span class="name">cellSize</span>&gt;</span><span class="tag">&lt;<span class="name">policyState</span>&gt;</span>DISABLED<span class="tag">&lt;/<span class="name">policyState</span>&gt;</span><span class="tag">&lt;<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">codecName</span>&gt;</span>xor<span class="tag">&lt;/<span class="name">codecName</span>&gt;</span><span class="tag">&lt;<span class="name">dataUnits</span>&gt;</span>2<span class="tag">&lt;/<span class="name">dataUnits</span>&gt;</span><span class="tag">&lt;<span class="name">parityUnits</span>&gt;</span>1<span class="tag">&lt;/<span class="name">parityUnits</span>&gt;</span><span class="tag">&lt;/<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">policyId</span>&gt;</span>5<span class="tag">&lt;/<span class="name">policyId</span>&gt;</span><span class="tag">&lt;<span class="name">policyName</span>&gt;</span>RS-10-4-1024k<span class="tag">&lt;/<span class="name">policyName</span>&gt;</span><span class="tag">&lt;<span class="name">cellSize</span>&gt;</span>1048576<span class="tag">&lt;/<span class="name">cellSize</span>&gt;</span><span class="tag">&lt;<span class="name">policyState</span>&gt;</span>DISABLED<span class="tag">&lt;/<span class="name">policyState</span>&gt;</span><span class="tag">&lt;<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">codecName</span>&gt;</span>rs<span class="tag">&lt;/<span class="name">codecName</span>&gt;</span><span class="tag">&lt;<span class="name">dataUnits</span>&gt;</span>10<span class="tag">&lt;/<span class="name">dataUnits</span>&gt;</span><span class="tag">&lt;<span class="name">parityUnits</span>&gt;</span>4<span class="tag">&lt;/<span class="name">parityUnits</span>&gt;</span><span class="tag">&lt;/<span class="name">ecSchema</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">erasureCodingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ErasureCodingSection</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">INodeSection</span>&gt;</span><span class="tag">&lt;<span class="name">lastInodeId</span>&gt;</span>16535<span class="tag">&lt;/<span class="name">lastInodeId</span>&gt;</span><span class="tag">&lt;<span class="name">numInodes</span>&gt;</span>48<span class="tag">&lt;/<span class="name">numInodes</span>&gt;</span><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16385<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1631005240758<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0755<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>9223372036854775807<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16386<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>wcinput<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1631005111883<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0755<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16387<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>wordout.txt<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>10<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630548862351<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1631005650890<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:xisun:0666<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741825<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1001<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>41<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16389<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>tmp<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571709992<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16390<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop-yarn<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553418947<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16391<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>staging<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630554923848<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16392<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>xisun<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553418948<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16393<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>.staging<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571777142<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16394<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0001<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553421706<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">xattrs</span>&gt;</span><span class="tag">&lt;<span class="name">xattr</span>&gt;</span><span class="tag">&lt;<span class="name">ns</span>&gt;</span>SYSTEM<span class="tag">&lt;/<span class="name">ns</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>hdfs.erasurecoding.policy<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">val</span>&gt;</span>\0000;\0000;\0000;\000b;replication<span class="tag">&lt;/<span class="name">val</span>&gt;</span><span class="tag">&lt;/<span class="name">xattr</span>&gt;</span><span class="tag">&lt;/<span class="name">xattrs</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16395<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.jar<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>10<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553421192<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553420729<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741829<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1005<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>316534<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16396<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.split<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>10<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553421574<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553421453<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741830<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1006<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>110<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16397<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.splitmetainfo<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553421698<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553421586<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741831<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1007<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>43<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16398<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553422297<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553421706<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741832<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1008<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>192215<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16399<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0002<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553679452<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0700<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">xattrs</span>&gt;</span><span class="tag">&lt;<span class="name">xattr</span>&gt;</span><span class="tag">&lt;<span class="name">ns</span>&gt;</span>SYSTEM<span class="tag">&lt;/<span class="name">ns</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>hdfs.erasurecoding.policy<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">val</span>&gt;</span>\0000;\0000;\0000;\000b;replication<span class="tag">&lt;/<span class="name">val</span>&gt;</span><span class="tag">&lt;/<span class="name">xattr</span>&gt;</span><span class="tag">&lt;/<span class="name">xattrs</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16400<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.jar<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>10<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553679124<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553678890<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741833<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1009<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>316534<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16401<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.split<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>10<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553679334<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553679221<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741834<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1010<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>110<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16402<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.splitmetainfo<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553679443<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553679339<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741835<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1011<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>43<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16403<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630553679670<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630553679452<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741836<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1012<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>192215<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16409<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>history<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567073024<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0755<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16410<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>done_intermediate<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630554923873<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:1777<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16411<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>xisun<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571854446<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16418<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0003-1630554915644-xisun-word+count-1630554943250-0-0-FAILED-default-1630554928660.jhist<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630554943458<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630554943411<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741844<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1020<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>14969<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16419<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0003_conf.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630554943540<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630554943476<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741845<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1021<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>222769<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16437<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0004-1630559739775-xisun-word+count-1630559924980-1-1-SUCCEEDED-default-1630559746457.jhist<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630559927155<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630559927104<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741854<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1030<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>22803<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16438<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0004_conf.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630559927279<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630559927177<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741855<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1031<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>223439<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16456<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0005-1630562908651-xisun-word+count-1630563047214-1-1-SUCCEEDED-default-1630562921426.jhist<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630563046601<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630563046543<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741864<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1040<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>22770<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16457<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0005_conf.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630563046693<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630563046621<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741865<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1041<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>223439<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16458<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>done<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567231439<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16476<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0006-1630567142285-xisun-word+count-1630567220324-1-1-SUCCEEDED-default-1630567156915.jhist<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567219772<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630567219669<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741874<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1050<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>22792<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16477<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0006_conf.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567219913<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630567219802<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741875<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1051<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>223437<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16478<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>2021<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567231440<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16479<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>09<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567231440<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16480<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>02<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630567231441<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16481<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>000000<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571854446<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16487<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>logs<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571710042<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:xisun:1777<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16488<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>xisun<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571710049<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:xisun:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16489<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>logs-tfile<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571710069<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:xisun:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16490<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>application_1630509320297_0007<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571783775<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:xisun:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16492<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>wcoutput<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571775649<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0755<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16498<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>part-r-00000<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571775482<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630571775197<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741882<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1058<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>36<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16500<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>_SUCCESS<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571775653<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630571775649<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16503<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0007-1630571709613-xisun-word+count-1630571776516-1-1-SUCCEEDED-default-1630571719711.jhist<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571775936<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630656192752<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741884<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1060<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>22765<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16504<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>job_1630509320297_0007_conf.xml<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571776037<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630571775955<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0770<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741885<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1061<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>223615<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16505<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop103_43362<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630571783767<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630571783609<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:xisun:0640<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741886<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1062<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>136973<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16508<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>DIRECTORY<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>sanguoyanyi<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630917975333<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0755<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">nsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">nsquota</span>&gt;</span><span class="tag">&lt;<span class="name">dsquota</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">dsquota</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16509<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>shuguo.txt<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630918100557<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630917608900<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741888<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1067<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>14<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16510<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>weiguo.txt<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630917830657<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630917830222<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741889<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1065<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>7<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">inode</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>16511<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">type</span>&gt;</span>FILE<span class="tag">&lt;/<span class="name">type</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span>wuguo.txt<span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">replication</span>&gt;</span>3<span class="tag">&lt;/<span class="name">replication</span>&gt;</span><span class="tag">&lt;<span class="name">mtime</span>&gt;</span>1630917975305<span class="tag">&lt;/<span class="name">mtime</span>&gt;</span><span class="tag">&lt;<span class="name">atime</span>&gt;</span>1630917974782<span class="tag">&lt;/<span class="name">atime</span>&gt;</span><span class="tag">&lt;<span class="name">preferredBlockSize</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">preferredBlockSize</span>&gt;</span><span class="tag">&lt;<span class="name">permission</span>&gt;</span>xisun:supergroup:0644<span class="tag">&lt;/<span class="name">permission</span>&gt;</span><span class="tag">&lt;<span class="name">blocks</span>&gt;</span><span class="tag">&lt;<span class="name">block</span>&gt;</span><span class="tag">&lt;<span class="name">id</span>&gt;</span>1073741890<span class="tag">&lt;/<span class="name">id</span>&gt;</span><span class="tag">&lt;<span class="name">genstamp</span>&gt;</span>1066<span class="tag">&lt;/<span class="name">genstamp</span>&gt;</span><span class="tag">&lt;<span class="name">numBytes</span>&gt;</span>6<span class="tag">&lt;/<span class="name">numBytes</span>&gt;</span><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">blocks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">storagePolicyId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">storagePolicyId</span>&gt;</span><span class="tag">&lt;/<span class="name">inode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">INodeSection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">INodeReferenceSection</span>&gt;</span><span class="tag">&lt;/<span class="name">INodeReferenceSection</span>&gt;</span><span class="tag">&lt;<span class="name">SnapshotSection</span>&gt;</span><span class="tag">&lt;<span class="name">snapshotCounter</span>&gt;</span>0<span class="tag">&lt;/<span class="name">snapshotCounter</span>&gt;</span><span class="tag">&lt;<span class="name">numSnapshots</span>&gt;</span>0<span class="tag">&lt;/<span class="name">numSnapshots</span>&gt;</span><span class="tag">&lt;/<span class="name">SnapshotSection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">INodeDirectorySection</span>&gt;</span><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16385<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16508<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16389<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16386<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16492<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16387<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16389<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16390<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16487<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16390<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16391<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16391<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16409<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16392<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16392<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16393<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16393<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16394<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16399<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16394<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16395<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16396<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16397<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16398<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16399<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16400<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16401<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16402<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16403<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16409<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16458<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16410<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16410<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16411<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16458<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16478<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16478<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16479<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16479<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16480<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16480<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16481<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16481<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16418<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16419<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16437<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16438<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16456<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16457<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16476<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16477<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16503<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16504<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16487<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16488<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16488<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16489<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16489<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16490<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16490<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16505<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16492<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16500<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16498<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span><span class="tag">&lt;<span class="name">parent</span>&gt;</span>16508<span class="tag">&lt;/<span class="name">parent</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16509<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16510<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;<span class="name">child</span>&gt;</span>16511<span class="tag">&lt;/<span class="name">child</span>&gt;</span><span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">INodeDirectorySection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FileUnderConstructionSection</span>&gt;</span><span class="tag">&lt;/<span class="name">FileUnderConstructionSection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">SecretManagerSection</span>&gt;</span><span class="tag">&lt;<span class="name">currentId</span>&gt;</span>0<span class="tag">&lt;/<span class="name">currentId</span>&gt;</span><span class="tag">&lt;<span class="name">tokenSequenceNumber</span>&gt;</span>0<span class="tag">&lt;/<span class="name">tokenSequenceNumber</span>&gt;</span><span class="tag">&lt;<span class="name">numDelegationKeys</span>&gt;</span>0<span class="tag">&lt;/<span class="name">numDelegationKeys</span>&gt;</span><span class="tag">&lt;<span class="name">numTokens</span>&gt;</span>0<span class="tag">&lt;/<span class="name">numTokens</span>&gt;</span><span class="tag">&lt;/<span class="name">SecretManagerSection</span>&gt;</span><span class="tag">&lt;<span class="name">CacheManagerSection</span>&gt;</span><span class="tag">&lt;<span class="name">nextDirectiveId</span>&gt;</span>1<span class="tag">&lt;/<span class="name">nextDirectiveId</span>&gt;</span><span class="tag">&lt;<span class="name">numDirectives</span>&gt;</span>0<span class="tag">&lt;/<span class="name">numDirectives</span>&gt;</span><span class="tag">&lt;<span class="name">numPools</span>&gt;</span>0<span class="tag">&lt;/<span class="name">numPools</span>&gt;</span><span class="tag">&lt;/<span class="name">CacheManagerSection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fsimage</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Fsimage 文件中保存了 HDFS 上存储的文件的信息，包括父节点和子节点的关系。</li>
<li>Fsimage 文件中没有记录 Block 块所对应的 DataNode 信息，这是因为，在集群启动后，会要求 DataNode 上报数据块信息，并间隔一段时间后再次上报。</li>
</ul>
</li>
</ul>
<h4 id="oev-查看-Edits-文件"><a href="#oev-查看-Edits-文件" class="headerlink" title="oev 查看 Edits 文件"></a>oev 查看 Edits 文件</h4><ul>
<li><p>基本语法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs oev -p 文件类型 -i 编辑日志名称 -o 转换后文件的输出路径</span><br></pre></td></tr></table></figure>
</li>
<li><p>实例</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">cd</span> /opt/module/hadoop-3.2.1/data/dfs/name/current</span><br><span class="line">[xisun@hadoop102 current]$ hdfs oev -p XML -i edits_inprogress_0000000000000000936 -o ~/edits.XML</span><br><span class="line">[xisun@hadoop102 current]$ <span class="built_in">cd</span> ~</span><br><span class="line">[xisun@hadoop102 ~]$ ll</span><br><span class="line">总用量 24</span><br><span class="line">drwxrwxr-x. 2 xisun xisun    52 9月   2 23:15 bin</span><br><span class="line">-rw-rw-r--. 1 xisun xisun   221 9月   8 16:46 edits.XML</span><br><span class="line">-rw-rw-r--. 1 xisun xisun 19241 9月   8 16:35 fsimage.XML</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 公共</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 模板</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 视频</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 图片</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 文档</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 下载</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 音乐</span><br><span class="line">drwxr-xr-x. 2 xisun xisun     6 8月  28 23:56 桌面</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载文件并查看</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 current]$ sz ~/edits.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">EDITS</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">EDITS_VERSION</span>&gt;</span>-65<span class="tag">&lt;/<span class="name">EDITS_VERSION</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">RECORD</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">OPCODE</span>&gt;</span>OP_START_LOG_SEGMENT<span class="tag">&lt;/<span class="name">OPCODE</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DATA</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">TXID</span>&gt;</span>936<span class="tag">&lt;/<span class="name">TXID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DATA</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">RECORD</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">RECORD</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">OPCODE</span>&gt;</span>OP_DELETE<span class="tag">&lt;/<span class="name">OPCODE</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DATA</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">TXID</span>&gt;</span>937<span class="tag">&lt;/<span class="name">TXID</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">LENGTH</span>&gt;</span>0<span class="tag">&lt;/<span class="name">LENGTH</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PATH</span>&gt;</span>/sanguoyanyi<span class="tag">&lt;/<span class="name">PATH</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">TIMESTAMP</span>&gt;</span>1631092478280<span class="tag">&lt;/<span class="name">TIMESTAMP</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">RPC_CLIENTID</span>&gt;</span>db87d83d-dba1-4362-add1-ff9cbdbceea0<span class="tag">&lt;/<span class="name">RPC_CLIENTID</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">RPC_CALLID</span>&gt;</span>3<span class="tag">&lt;/<span class="name">RPC_CALLID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DATA</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">RECORD</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">EDITS</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>NameNode 如何确定下次开机启动的时候合并哪些 Edits：假设当前 fsimage 最大编号为 935，则会将所有编号大于 935 的 Edits 合并。</li>
</ul>
</li>
</ul>
<h3 id="CheckPoint-时间设置"><a href="#CheckPoint-时间设置" class="headerlink" title="CheckPoint 时间设置"></a>CheckPoint 时间设置</h3><ul>
<li><p>CheckPoint 是指 SecondaryNameNode 向 nn 执行的操作。</p>
</li>
<li><p>通常情况下，SecondaryNameNode 每隔一小时执行一次。间隔时间在 hdfs-default.xml 文件中进行配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.period<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>3600s<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">    The number of seconds between two periodic checkpoints.</span><br><span class="line">    Support multiple time unit suffix(case insensitive), as described</span><br><span class="line">    in dfs.heartbeat.interval.</span><br><span class="line">   <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>另外，SecondaryNameNode 每隔一分钟检查一次 NameNode 的操作次数，当操作次数达到 1 百万时，SecondaryNameNode 执行一次 CheckPoint。间隔时间和操作次数在 hdfs-default.xml 文件中进行配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.txns<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>1000000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>The Secondary NameNode or CheckpointNode will create a checkpoint</span><br><span class="line">  of the namespace every &#x27;dfs.namenode.checkpoint.txns&#x27; transactions, regardless</span><br><span class="line">  of whether &#x27;dfs.namenode.checkpoint.period&#x27; has expired.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.checkpoint.check.period<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>60s<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>The SecondaryNameNode and CheckpointNode will poll the NameNode</span><br><span class="line">  every &#x27;dfs.namenode.checkpoint.check.period&#x27; seconds to query the number</span><br><span class="line">  of uncheckpointed transactions. Support multiple time unit suffix(case insensitive),</span><br><span class="line">  as described in dfs.heartbeat.interval.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="DataNode"><a href="#DataNode" class="headerlink" title="DataNode"></a>DataNode</h2><h3 id="DataNode-工作机制"><a href="#DataNode-工作机制" class="headerlink" title="DataNode 工作机制"></a>DataNode 工作机制</h3><p><img src="/2021/08/25/hadoop/image-20210908232731057.png" alt="image-20210908232731057"></p>
<ul>
<li><p>一个数据块在 DataNode 上以文件形式存储在磁盘上，包括两个文件，一个是数据本身，一个是元数据，包括数据块的长度，块数据的校验和，以及时间戳。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 ~]$ <span class="built_in">cd</span> /opt/module/hadoop-3.2.1/data/dfs/data/current/BP-288566776-192.168.10.102-1630507194979/current/finalized/subdir0/subdir0</span><br><span class="line">[xisun@hadoop102 subdir0]$ ll</span><br><span class="line">总用量 52</span><br><span class="line">-rw-rw-r--. 1 xisun xisun     41 9月   2 10:14 blk_1073741825</span><br><span class="line">-rw-rw-r--. 1 xisun xisun     11 9月   2 10:14 blk_1073741825_1001.meta</span><br></pre></td></tr></table></figure>

<blockquote>
<p>.meta 文件存储的是元数据，另一个文件存储的是数据本身。</p>
</blockquote>
</li>
<li><p>DataNode 启动后向 NameNode 注册，通过后，再周期性（6 小时）的向 NameNode 上报所有的块信息。</p>
<ul>
<li><p>DataNode 扫描自己节点块信息列表的时间，默认 6 小时。在 hdfs-default.xml 文件中配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.directoryscan.interval<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>21600s<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>Interval in seconds for Datanode to scan data directories and</span><br><span class="line">  reconcile the difference between blocks in memory and on the disk.</span><br><span class="line">  Support multiple time unit suffix(case insensitive), as described</span><br><span class="line">  in dfs.heartbeat.interval.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>DataNode 向 NameNode 汇报当前节点块信息的时间间隔，默认 6 小时。在 hdfs-default.xml 文件中配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.blockreport.intervalMsec<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>21600000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>Determines block reporting interval in milliseconds.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以看出，DataNode 每隔 6 小时自查一次，自查完成后，立即向 NameNode 上报一次当前节点的信息。如果服务器中存在某些服务器性能差，可以设置自查和上报的时间间隔短一点。</p>
</li>
</ul>
</li>
<li><p>心跳是每 3 秒一次，心跳返回结果带有 NameNode 给该 DataNode 的命令，比如复制块数据到另一台机器，或删除某个数据块。如果超过 10 分钟没有收到某个 DataNode 的心跳，则认为该节点不可用，NameNode 也就不会再和该 DataNode 有数据交互。</p>
</li>
<li><p>集群运行中可以安全加入和退出一些机器。</p>
</li>
</ul>
<h3 id="数据完整性"><a href="#数据完整性" class="headerlink" title="数据完整性"></a>数据完整性</h3><ul>
<li><p>思考：如果电脑磁盘里面存储的数据是控制高铁信号灯的红灯信号（1）和绿灯信号（0），但是存储该数据的磁盘坏了，一直显示是绿灯，是否很危险？同理，如果 DataNode 节点上的数据损坏了，却没有发现，也很危险，那么如何解决呢？</p>
</li>
<li><p>如下是 DataNode 节点保证数据完整性的方法：</p>
<ol>
<li><p>当 DataNode 读取 Block 的时候，它会计算 CheckSum。</p>
</li>
<li><p>如果计算后的 CheckSum，与 Block 创建时的值不一样，说明 Block 已经损坏。</p>
</li>
<li><p>然后，Client 读取其他 DataNode 上的 Block。</p>
</li>
<li><p>DataNode 会在其文件创建后周期验证 CheckSum。</p>
</li>
<li><p>常见的校验算法有： crc（32），md5（128），sha1（160）。</p>
<p><img src="/2021/08/25/hadoop/image-20210909092530067.png" alt="image-20210909092530067"></p>
<ul>
<li>奇偶校验位方法，是检验算法中极其简单的一种。原始数据封装时，查看待传输数据中 1 的个数，如果为偶数，则在数据后添加一个校验位，值为 0，如果为奇数，则校验位值为 1。当接收到数据后，对数据进行重新计算，查看数据中 1 的个数，验证其是否与传输前的校验位相同。如果在数据传输过程中，导致数据发生了错误，接收到的数据校验位与原始数据的不同，则认为数据损坏，不再使用。</li>
<li>奇偶校验法，并不能保证一定检验出数据传输过程中可能出现的错误。crc 校验算法会更复杂，也更可靠，但原理上是相同的。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="掉线时限参数设置"><a href="#掉线时限参数设置" class="headerlink" title="掉线时限参数设置"></a>掉线时限参数设置</h3><ul>
<li><p>如果 DataNode 进程死亡或者网络故障，造成 DataNode 无法与 NameNode 通信；</p>
</li>
<li><p>此时，NameNode 不会立即把该 DataNode 节点判定为死亡，要经过一段时间，这段时间暂称作超时时长。</p>
</li>
<li><p>HDFS 默认的超时时长为 10 分钟 + 30 秒。（实际上，这就是 DataNode 工作机制中，DataNode 向 NameNode 发送心跳的超时时间）</p>
</li>
<li><p>如果定义超时时间为 TimeOut，则超时时长的计算公式为：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TimeOut = 2 * dfs.namenode.heartbeat.recheck-interval + 10 * dfs.heartbeat.interval</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 hdfs-default.xml 文件中，<code>dfs.namenode.heartbeat.recheck-interval</code> 默认为 300000 毫秒（5 分钟），<code>dfs.heartbeat.interval</code> 默认为 3 秒。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.heartbeat.recheck-interval<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>300000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">    This time decides the interval to check for expired datanodes.</span><br><span class="line">    With this value and dfs.heartbeat.interval, the interval of</span><br><span class="line">    deciding the datanode is stale or not is also calculated.</span><br><span class="line">    The unit of this configuration is millisecond.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.heartbeat.interval<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>3s<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">    Determines datanode heartbeat interval in seconds.</span><br><span class="line">    Can use the following suffix (case insensitive):</span><br><span class="line">    ms(millis), s(sec), m(min), h(hour), d(day)</span><br><span class="line">    to specify the time (such as 2s, 2m, 1h, etc.).</span><br><span class="line">    Or provide complete number in seconds (such as 30 for 30 seconds).</span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="YARN-资源调度器"><a href="#YARN-资源调度器" class="headerlink" title="YARN 资源调度器"></a>YARN 资源调度器</h2><ul>
<li>YARN 是一个资源调度平台，负责为运算程序提供服务器运算资源，相当于一个分布式的操作系统平台，而 MapReduce 等运算程序则相当于运行于操作系统之上的应用程序。</li>
</ul>
<h3 id="YARN-基础架构"><a href="#YARN-基础架构" class="headerlink" title="YARN 基础架构"></a>YARN 基础架构</h3><p><img src="/2021/08/25/hadoop/image-20210909113318240.png" alt="image-20210909113318240"></p>
<ul>
<li>YARN 主要由 ResourceManager、NodeManager、ApplicationMaster 和 Container 等组件构成。</li>
<li>ResourceManager（RM）的主要作用如下：<ul>
<li>处理客户端请求。</li>
<li>监控 NodeManager。</li>
<li>启动或监控 ApplicationMaster。</li>
<li>资源的分配与调度。</li>
</ul>
</li>
<li>NodeManager（NM）的主要作用如下：<ul>
<li>管理单个节点上的资源。</li>
<li>处理来自 ResourceManager 的命令。</li>
<li>处理来自 ApplicationMaster 的命令。</li>
</ul>
</li>
<li>ApplicationMaster（AM）的主要作用如下：<ul>
<li>为应用程序申请资源并分配给内部的任务。</li>
<li>任务的监控与容错。</li>
</ul>
</li>
<li>Container 的主要作用如下：<ul>
<li>Container 是 YARN 中的资源抽象，它封装了某个节点上的多维度资源，如内存、CPU、磁盘、网络等。</li>
</ul>
</li>
</ul>
<h3 id="YARN-工作机制"><a href="#YARN-工作机制" class="headerlink" title="YARN 工作机制"></a>YARN 工作机制</h3><p><img src="/2021/08/25/hadoop/image-20210909132534626.png" alt="image-20210909132534626"></p>
<ul>
<li>MapReduce 程序（任务分为 MapTask 和 ReduceTask）提交到客户端所在的节点，程序执行后创建一个 YarnRunner。</li>
<li>YarnRunner 向 ResourceManager 申请一个 Application。</li>
<li>ResourceManager 将该应用程序的资源提交路径返回给 YarnRunner。</li>
<li>该程序将运行所需资源（split 切片信息，xml 配置文件，JAR 包等）提交到 HDFS 上。</li>
<li>程序运行所需的资源提交到 HDFS 完毕后，再向 ResourceManager 申请运行 ApplicationMaster。</li>
<li>ResourceManager 将客户端（用户）的请求初始化成一个 Task。并将 Task 以及其他客户端的请求所初始化的 Task，都放到一个任务调度队列中（Apache Hadoop 默认使用容量调度器）。</li>
<li>集群中的一个空闲的 NodeManager，从任务调度队列中领取到 Task 任务。</li>
<li>然后，该 NodeManager 创建一个容器 Container，并启动一个 ApplicationMaster 进程。</li>
<li>Container 从 HDFS 上拷贝程序运行所需的资源到本地。</li>
<li>ApplicationMaster 进程拿到 Job 的切片信息之后，再向 ResourceManager 申请运行 MapTask 的资源（假设 MapTask 有两个任务）。</li>
<li>ResourceManager 将运行 MapTask 的任务分配给集群另外两个 NodeManager（也有可能是同一个 NodeManager 的两个 Container 上），这两个 NodeManager 分别领取任务并创建容器，并拷贝任务运行所需的 JAR 包等资源。</li>
<li>MapReduce 向两个接收到任务的 NodeManager 发送程序启动脚本，然后这两个 NodeManager 分别启动 MapTask，各自开启一个 YarnChild 子进程，之后，MapTask 开始执行，对数据分区排序。</li>
<li>ApplicationMaster 进程等待所有的 MapTask 运行完毕后，再向 ResourceManager 申请容器，运行 ReduceTask。这一步与运行 MapTask 的操作相同。</li>
<li>ReduceTask 启动时，向 MapTask 获取相应分区的数据，然后执行任务。</li>
<li>当程序运行完毕后，MapReduce 会向 ResourceManager 申请注销任务执行过程中所使用的资源。</li>
</ul>
<h3 id="作业提交全过程"><a href="#作业提交全过程" class="headerlink" title="作业提交全过程"></a>作业提交全过程</h3><ul>
<li><p>HDFS、YARN、MapReduce 三者关系</p>
<p><img src="/2021/08/25/hadoop/image-20210909152245552.png" alt="image-20210909152245552"></p>
</li>
<li><p>作业提交过程之 YARN</p>
<p><img src="/2021/08/25/hadoop/image-20210909132534626.png" alt="image-20210909132534626"></p>
</li>
<li><p>作业提交过程之 HDFS &amp; MapReduce</p>
<p><img src="/2021/08/25/hadoop/image-20210909153850477.png" alt="image-20210909153850477"></p>
</li>
<li><p>作业提交全过程详解</p>
<ul>
<li>作业提交：<ul>
<li>第 1 步：Client 调用 job.waitForCompletion 方法，向整个集群提交 MR 作业。</li>
<li>第 2 步：Client 向 RM 申请一个作业 id。</li>
<li>第 3 步：RM 给 Client 返回该 Job 资源的 HDFS 提交路径和作业 id。</li>
<li>第 4 步：Client 提交 JAR 包、切片信息和配置文件到指定的 HDFS 资源提交路径。</li>
<li>第 5 步：Client 提交完资源后，向 RM 申请运行 AM。</li>
</ul>
</li>
<li>作业初始化：<ul>
<li>第 6 步：当 RM 收到 Client 的请求后，将该 Job 添加到容量调度器中。</li>
<li>第 7 步：某一个空闲的 NM 领取到该 Job。</li>
<li>第 8 步：该 NM 创建 Container，并启动 AM 进程。</li>
<li>第 9 步：该 Container 下载 Client 提交到 HDFS 的资源到本地。</li>
</ul>
</li>
<li>任务分配：<ul>
<li>第 10 步：AM 向 RM 申请执行多个 MapTask 任务的资源。</li>
<li>第 11 步：RM 将运行 MapTask 的任务分配给相应的 NM，这些 NM 分别领取任务并创建 Container。</li>
</ul>
</li>
<li>任务运行：<ul>
<li>第 12 步：MR 向接收到任务的 NM 发送程序启动脚本，这些 NM 分别启动 MapTask，MapTask 对数据分区排序。</li>
<li>第 13 步：AM 等待所有 MapTask 运行完毕后，再向 RM 申请容器，运行 ReduceTask。</li>
<li>第 14 步：ReduceTask 向 MapTask 获取相应分区的数据。</li>
<li>第 15 步：程序运行完毕后，MR 向 RM 申请注销自己。</li>
</ul>
</li>
<li>进度和状态更新：<ul>
<li>YARN 中的任务将其进度和状态（包括 counter）返回给应用管理器, 客户端每秒（通过 <code>mapreduce.client.progressmonitor.pollinterval</code> 设置）向应用管理器请求进度更新，展示给用户。</li>
</ul>
</li>
<li>作业完成：<ul>
<li>除了向应用管理器请求作业进度外，客户端每 5 秒都会通过调用 <code>waitForCompletion()</code> 来检查作业是否完成。时间间隔可以通过 <code>mapreduce.client.completion.pollinterval</code> 来设置。作业完成之后，应用管理器和 Container 会清理工作状态。作业的信息会被作业历史服务器存储以备之后用户核查。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="YARN-调度器和调度算法"><a href="#YARN-调度器和调度算法" class="headerlink" title="YARN 调度器和调度算法"></a>YARN 调度器和调度算法</h3><ul>
<li><p>目前，Hadoop 提供的任务队列调度器主要有三种：先进先出调度器（FIFO）、容量调度器（Capacity Scheduler）和公平调度器（Fair Scheduler）。</p>
</li>
<li><p>Apache Hadoop-3.2.1 默认的资源调度器是 Capacity Scheduler，在 yarn-default.xml 文件中，有具体的配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>The class to use as the resource scheduler.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Cloudera Hadoop 默认使用的调度器是 Fair Scheduler。</p>
</blockquote>
</li>
</ul>
<h4 id="先进先出调度器（FIFO）"><a href="#先进先出调度器（FIFO）" class="headerlink" title="先进先出调度器（FIFO）"></a>先进先出调度器（FIFO）</h4><p><img src="/2021/08/25/hadoop/image-20210909164336456.png" alt="image-20210909164336456"></p>
<ul>
<li>FIFO 调度器（First In First Out）：单队列，根据提交作业的先后顺序，先来的先服务。</li>
<li>优点：简单易懂。</li>
<li>缺点：不支持多队列，生产环境很少使用。</li>
</ul>
<h4 id="容量调度器（Capacity-Scheduler）"><a href="#容量调度器（Capacity-Scheduler）" class="headerlink" title="容量调度器（Capacity Scheduler）"></a>容量调度器（Capacity Scheduler）</h4><ul>
<li><p>Capacity Scheduler 是 Yahoo 开发的多用户调度器。</p>
</li>
<li><p>容量调度器的特点</p>
<p><img src="/2021/08/25/hadoop/image-20210909170809620.png" alt="image-20210909170809620"></p>
<ul>
<li>多队列：每个队列可配置一定的资源量，每个队列采用 FIFO 调度策略。</li>
<li>容量保证：管理员可为每个队列设置资源最低保证和资源使用上限。</li>
<li>灵活性：如果一个队列中的资源有剩余，可以暂时共享给那些需要资源的队列，而一旦该队列有新的应用程序提交，则其他队列借调的资源会归还给该队列（非强制回收）。</li>
<li>多租户：支持多用户共享集群和多应用程序同时运行。为了防止同一个用户的作业独占队列中的资源，该调度器会对同一用户提交的作业所占资源量进行限定。比如，queueC 队列中，有 ss 和 cls 两个用户提交的作业，调度器可以限制每一个用户所占的资源量为自身资源的 50%。</li>
</ul>
</li>
<li><p>容量调度器的队列的资源分配方式</p>
<ul>
<li>FIFO 策略，默认。<ul>
<li>具体的资源分配过程：<ul>
<li>第一步：队列资源分配。<ul>
<li>从 root 开始，使用深度优先算法，优先选择资源利用率最低（已使用的资源量/队列分配的资源容量）的队列分配资源。</li>
</ul>
</li>
<li>第二步：作业资源分配。<ul>
<li>默认按照提交作业的优先级和提交时间顺序分配资源。</li>
</ul>
</li>
<li>第三步：容器资源分配。<ul>
<li>按照容器的优先级分配资源。</li>
<li>如果容器的优先级相同，按照数据本地性原则（节点距离最小的）：<ul>
<li>任务和数据在同一节点。</li>
<li>任务和数据在同一机架。</li>
<li>任务和数据不在同一节点也不在同一机架。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>DRF 策略</li>
</ul>
</li>
<li><p>容量调度器的资源分配算法实例</p>
<p><img src="/2021/08/25/hadoop/image-20210909171256904.png" alt="image-20210909171256904"></p>
</li>
</ul>
<h4 id="公平调度器（Fair-Scheduler-）"><a href="#公平调度器（Fair-Scheduler-）" class="headerlink" title="公平调度器（Fair Scheduler ）"></a>公平调度器（Fair Scheduler ）</h4><ul>
<li><p>Fair Schedulere 是 Facebook 开发的多用户调度器。</p>
</li>
<li><p>公平调度器的特点</p>
<p><img src="/2021/08/25/hadoop/image-20210909173251464.png" alt="image-20210909173251464"></p>
<ul>
<li>与容量调度器的相同点<ul>
<li>多队列：支持多队列多作业。</li>
<li>容量保证：管理员可为每个队列设置资源最低保证和资源使用上限。</li>
<li>灵活性：如果一个队列中的资源有剩余，可以暂时共享给那些需要资源的队列，而一旦该队列有新的应用程序提交，则其他队列借调的资源会归还给该队列。</li>
<li>多租户：支持多用户共享集群和多应用程序同时运行。为了防止同一个用户的作业独占队列中的资源，该调度器会对同一用户提交的作业所占资源量进行限定。</li>
</ul>
</li>
<li>与容量调度器的不同点<ul>
<li>核心调度策略不同：<ul>
<li>容量调度器：优先选择资源利用率低的队列。</li>
<li>公平调度器：优先选择对资源的缺额比例大的。</li>
</ul>
</li>
<li>每个队列可以单独设置资源的分配方式不同：<ul>
<li>容量调度器：FIFO、DRF。</li>
<li>公平调度器：FIFO、FAIR、DRF。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>公平调度器的缺额概念</p>
<p><img src="/2021/08/25/hadoop/image-20210909234011348.png" alt="image-20210909234011348"></p>
<ul>
<li>公平调度器设计目标是：在时间尺度上，所有作业获得公平的资源。在某一时刻，一个作业应获取的资源和它实际获取的资源的差距叫“缺额”。</li>
<li>公平调度器会优先为缺额大的作业分配资源。</li>
</ul>
</li>
<li><p>公平调度器的队列的资源分配方式</p>
<ul>
<li><p>FIFO 策略</p>
<ul>
<li>公平调度器每个队列资源分配策略如果选择 FIFO 的话，此时公平调度器相当于上面讲过的容量调度器。</li>
</ul>
</li>
<li><p>Fair 策略，默认。</p>
<ul>
<li><p>Fair 策略是一种基于最大最小公平算法实现的资源多路复用方式，默认情况下，每个队列内部采用该方式分配资源。这意味着，如果一个队列中有两个应用程序同时运行，则每个应用程序可得到 1/2 的资源；如果三个应用程序同时运行，则每个应用程序可得到 1/3 的资源。</p>
</li>
<li><p>具体的资源分配过程和容量调度器一致：</p>
<ul>
<li><p>选择队列</p>
</li>
<li><p>选择作业</p>
</li>
<li><p>选择容器</p>
</li>
<li><p>注意：以上三步，每一步都是按照公平策略来分配资源。</p>
<p><img src="/2021/08/25/hadoop/image-20210910171552241.png" alt="image-20210910171552241"></p>
<ul>
<li>实际最小资源份额：<code>mindshare = Min(资源需求量, 配置的最小资源)</code></li>
<li>是否饥饿：<code>isNeedy = 资源使用量 &lt; mindshare</code></li>
<li>资源分配比：<code>minShareRatio = 资源使用量 / Max（mindshare, 1)</code></li>
<li>资源使用权重比：<code>useToWeightRatio = 资源使用量 / 权重</code></li>
<li>假设一个任务，其资源需求量为 4，配置的最小资源为 2，现在的资源使用量为 1，权重为 8。则 mindshare 为 2，因为资源使用量小于 mindshare，所以该任务处于饥饿状态。另外，其 minShareRatio 的值为 1/2，useToWeightRatio 值为 1/6。同理，计算出其他任务的这些状态值，按上图流程，决定资源优先分配到哪个任务。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>DRF 策略</p>
<ul>
<li>DRF（Dominant Resource Fairness），前面说的资源，都是单一标准，例如只考虑内存（也是 YARN 默认的情况）。但是很多时候资源有很多种，例如内存，CPU，网络带宽等，这样就很难衡量两个应用应该分配的资源比例。</li>
<li>在 YARN 中，用 DRF 来决定如何调度：<ul>
<li>假设集群一共有 100 CPU 和 10 T 内存，而应用 A 需要（2 CPU，300 GB 内存），应用 B 需要（6 CPU，100 GB 内存）。则两个应用分别需要 A（2% CPU，3% 内存）和 B（6% CPU，1% 内存）的资源，这就意味着 A 是内存主导的，B 是 CPU 主导的，针对这种情况，我们可以选择 DRF 策略对不同应用进行不同资源（CPU 和内存）的一个不同比例的限制。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>公平调度器的资源分配算法实例</p>
<p><img src="/2021/08/25/hadoop/image-20210910230253307.png" alt="image-20210910230253307"></p>
<ul>
<li>队列资源分配<ul>
<li>需求：集群总资源 100，有三个队列，对资源的需求分别是：queueA —&gt; 20，queueB —&gt; 50，queueC —&gt; 30。</li>
<li>第一次算：100 / 3 = 33.33，即每个队列应得资源 33.33。<ul>
<li>queueA：分 33.33  —&gt; 多 13.33。</li>
<li>queueB：分 33.33  —&gt; 少 16.67。</li>
<li>queueC：分 33.33  —&gt; 多 3.33。</li>
</ul>
</li>
<li>第二次算：(13.33 + 3.33) / 1 = 16.66，各队列空闲资源的总和，与需要资源的队列数的比值。<ul>
<li>queueA：分 20。</li>
<li>queueB：分 33.33 + 16.66 = 50。</li>
<li>queueC：分 30。</li>
</ul>
</li>
</ul>
</li>
<li>作业资源分配<ul>
<li>不加权（关注点是 job 的个数）<ul>
<li>需求：有一条队列总资源 12 个，有 4 个 job，对资源的需求分别是：job1 —&gt; 1，job2 —&gt; 2，job3 —&gt; 6，job4 —&gt; 5。</li>
<li>第一次算：12 / 4 = 3。<ul>
<li>job1：分 3 —&gt; 多 2 个。</li>
<li>job2：分 3 —&gt; 多 1 个。</li>
<li>job3：分 3 —&gt; 少 3 个。</li>
<li>job4：分 3 —&gt; 少 2 个。</li>
</ul>
</li>
<li>第二次算：3 / 2 = 1.5<ul>
<li>job1：分 1 —&gt; 最终：1。</li>
<li>job2：分 2 —&gt; 最终：2。</li>
<li>job3：分 3 —&gt; 少 3 个 —&gt; 分 1.5 —&gt; 最终：4.5。</li>
<li>job4：分 3 —&gt; 少 2 个 —&gt; 分 1.5 —&gt; 最终：4.5。</li>
</ul>
</li>
<li>job3 和 job4 的资源都不够，继续等待，运行过程中，有资源释放出来时，继续按平均计算。</li>
<li>第 n 次算：一直算到没有空闲资源。</li>
</ul>
</li>
<li>加权（ 关注点是 job 的权重）<ul>
<li>需求：有一条队列总资源 16 个，有 4 个 job，对资源的需求分别是：job1 —&gt; 4，job2 —&gt; 2，job3 —&gt;10，job4 —&gt; 4，每个 job 的权重为：job1 —&gt; 5，job2 —&gt; 8，job3 —&gt; 1，job4 —&gt; 2。</li>
<li>第一次算：16 / (5 + 8 + 1 + 2) = 1。<ul>
<li>job1：分 5 * 1 —&gt; 多 1 个。</li>
<li>job2：分 8 * 1 —&gt; 多 6 个。</li>
<li>job3：分 1 * 1 —&gt; 少 9 个。</li>
<li>job4：分 2 * 1 —&gt; 少 2 个。</li>
</ul>
</li>
<li>第二次算：7 / (1 + 2) = 7/3。<ul>
<li>job1：分 4。</li>
<li>job2：分 2。</li>
<li>job3：分 1 —&gt; 少 9 个 —&gt; 分 1 * 7/3 ≈ 2.33 —&gt; 少 6.67 个。</li>
<li>job4：分 2 —&gt; 少 2 个 —&gt; 分 2 * 7/3 ≈ 4.66 —&gt; 多 2.66 个。</li>
</ul>
</li>
<li>第三次算：2.66 / 1 = 2.66。<ul>
<li>job1：分 4 —&gt; 最终：4。</li>
<li>job2：分 2 —&gt; 最终：2。</li>
<li>job3：分 1 —&gt; 少 9 个 —&gt; 分 1 * 7/3 ≈ 2.33 —&gt; 少 6.67 个 —&gt; 分 1 * 2.66 —&gt; 最终：6。</li>
<li>job4：分 4 —&gt; 最终：4。</li>
</ul>
</li>
<li>job3 资源不够，继续等待，运行过程中，有资源释放出来时，继续按平均计算。</li>
<li>第 n 次算：一直算到没有空闲资源。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="YARN-常用命令"><a href="#YARN-常用命令" class="headerlink" title="YARN 常用命令"></a>YARN 常用命令</h3><ul>
<li>YARN 状态的查询，除了可以在 <a target="_blank" rel="noopener" href="http://hadoop103:8088/">http://hadoop103:8088/</a> 页面查看外，还可以通过命令操作。</li>
</ul>
<h4 id="yarn-node-查看节点"><a href="#yarn-node-查看节点" class="headerlink" title="yarn node 查看节点"></a>yarn node 查看节点</h4><ul>
<li><p>列出所有节点</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn node -list -all</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="yarn-queue-查看队列"><a href="#yarn-queue-查看队列" class="headerlink" title="yarn queue 查看队列"></a>yarn queue 查看队列</h4><ul>
<li><p>查询队列信息</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn queue -status &lt;QueueName&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="yarn-application-查看任务"><a href="#yarn-application-查看任务" class="headerlink" title="yarn application 查看任务"></a>yarn application 查看任务</h4><ul>
<li><p>列出所有 Application</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn application -list</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据 Application 的状态查询</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn application -list -appStates [option]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>状态参数可选项有：ALL、NEW、NEW_SAVING、SUBMITTED、ACCEPTED、RUNNING、FINISHED、FAILED、KILLED。</p>
</blockquote>
</li>
<li><p>Kill Application</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn application -<span class="built_in">kill</span> [ApplicationId]</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="yarn-container-查看容器"><a href="#yarn-container-查看容器" class="headerlink" title="yarn container 查看容器"></a>yarn container 查看容器</h4><ul>
<li><p>列出所有 Container</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn container -list &lt;ApplicationId&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>打印 Container 状态</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn container -status &lt;ContainerId&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>只有在任务运行的过程中，才能看到 Container 的状态。如果任务运行结束了，Container 也就被回收了。</p>
</blockquote>
</li>
</ul>
<h4 id="yarn-logs-查看日志"><a href="#yarn-logs-查看日志" class="headerlink" title="yarn logs 查看日志"></a>yarn logs 查看日志</h4><ul>
<li><p>查询 Application 日志</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn logs -applicationId &lt;ApplicationId&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询 Container 日志</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn logs -applicationId &lt;ApplicationId&gt; -containerId &lt;ContainerId&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="yarn-applicationattempt-查看尝试运行的任务"><a href="#yarn-applicationattempt-查看尝试运行的任务" class="headerlink" title="yarn applicationattempt 查看尝试运行的任务"></a>yarn applicationattempt 查看尝试运行的任务</h4><ul>
<li><p>列出所有 Application 尝试的列表</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn applicationattempt -list &lt;ApplicationId&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>打印 ApplicationAttemp 状态</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn applicationattempt -status &lt;ApplicationAttemptId&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="yarn-rmadmin-更新配置"><a href="#yarn-rmadmin-更新配置" class="headerlink" title="yarn rmadmin 更新配置"></a>yarn rmadmin 更新配置</h4><ul>
<li><p>更新队列配置</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[xisun@hadoop102 hadoop]$ yarn rmadmin -refreshQueues</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果修改了队列的相关信息，不需要重启 YARN，执行此命令即可生效。</p>
</blockquote>
</li>
</ul>
<h3 id="YARN-生产环境核心参数"><a href="#YARN-生产环境核心参数" class="headerlink" title="YARN 生产环境核心参数"></a>YARN 生产环境核心参数</h3><ul>
<li>ResourceManager 相关<ul>
<li><code>yarn.resourcemanager.scheduler.class</code>：配置调度器，Apache Hadoop 默认使用容量调度器。</li>
<li><code>yarn.resourcemanager.scheduler.client.thread-count</code>：ResourceManager 处理调度器请求的线程数量，默认 50。</li>
</ul>
</li>
<li>NodeManager 相关<ul>
<li><code>yarn.nodemanager.resource.detect-hardware-capabilities</code>：是否让 YARN 自己检测硬件进行配置，默认 false。</li>
<li><code>yarn.nodemanager.resource.count-logical-processors-as-cores</code>：是否将虚拟核数当作 CPU 核数，默认 false。<ul>
<li>虚拟 CPU 和物理 CPU。如果集群中的多台服务器，CPU 性能差距较大，可以考虑设置此参数为 true。</li>
</ul>
</li>
<li><code>yarn.nodemanager.resource.pcores-vcores-multiplier</code>：虚拟核数和物理核数乘数，例如：4 核 8 线程，该参数就应设为 2。默认为 1.0。如果上一个参数设置为 true，此参数按实际配置。</li>
<li><code>yarn.nodemanager.resource.memory-mb</code>：NodeManager 使用的内存，默认 8 G。</li>
<li><code>yarn.nodemanager.resource.system-reserved-memory-mb</code>：NodeManager 为系统保留多少内存（系统内存与使用内存的差值）。与上一个参数，二者配置一个即可。</li>
<li><code>yarn.nodemanager.resource.cpu-vcores</code>：NodeManager 使用的 CPU 核数，默认 8 个。</li>
<li><code>yarn.nodemanager.pmem-check-enabled</code>：是否开启物理内存检查限制 Container，默认打开。<ul>
<li>一种安全机制：如果 NodeManager 使用的内存，即将超过其可以使用的内存量时，触发报警机制，防止 NodeManager 占用虚拟机正常运行时的内存，导致系统崩溃。</li>
</ul>
</li>
<li><code>yarn.nodemanager.vmem-check-enabled</code>：是否开启虚拟内存检查限制 Container，默认打开。</li>
<li><code>yarn.nodemanager.vmem-pmem-ratio</code>：虚拟内存与物理内存的比例，默认 2.1。</li>
</ul>
</li>
<li>Container 相关<ul>
<li><code>yarn.scheduler.minimum-allocation-mb</code>：容器最小内存，默认 1 G。</li>
<li><code>yarn.scheduler.maximum-allocation-mb</code>：容器最大内存，默认 8 G。不能超过 NodeManager 能使用的内存。</li>
<li><code>yarn.scheduler.minimum-allocation-vcores</code>：容器最小 CPU 核数，默认 1 个。</li>
<li><code>yarn.scheduler.maximum-allocation-vcores</code>：容器最大 CPU 核数，默认 4 个。</li>
</ul>
</li>
</ul>
<h2 id="YARN-案例实操"><a href="#YARN-案例实操" class="headerlink" title="YARN 案例实操"></a>YARN 案例实操</h2><ul>
<li><p>调整下列参数之前尽量拍摄 Linux 快照，否则后续的案例，还需要重新准备集群。</p>
<p><img src="/2021/08/25/hadoop/image-20210912181004046.png" alt="image-20210912181004046"></p>
<p><img src="/2021/08/25/hadoop/image-20210912180732521.png" alt="image-20210912180732521"></p>
<p><img src="/2021/08/25/hadoop/image-20210912180838645.png" alt="image-20210912180838645"></p>
</li>
</ul>
<h3 id="YARN-生产环境核心参数配置案例"><a href="#YARN-生产环境核心参数配置案例" class="headerlink" title="YARN 生产环境核心参数配置案例"></a>YARN 生产环境核心参数配置案例</h3><ul>
<li>需求：从 1 G 数据中，统计每个单词出现的次数。服务器 3 台，每台配置 4 G 内存，4 核 CPU，4 线程。</li>
</ul>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Qp4y1n7EN">https://www.bilibili.com/video/BV1Qp4y1n7EN</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/25/movie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/25/movie/" class="post-title-link" itemprop="url">movie</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-08-25 15:19:54 / 修改时间：15:20:37" itemprop="dateCreated datePublished" datetime="2021-08-25T15:19:54+08:00">2021-08-25</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>13</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="a"><a href="#a" class="headerlink" title="a"></a>a</h2><p>那山那人那狗  岁月无声  夜莺  </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/12/flink-kafka/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/12/flink-kafka/" class="post-title-link" itemprop="url">记录一次 Flink 与 Kafka 结合的项目经验</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-12 14:55:52" itemprop="dateCreated datePublished" datetime="2021-08-12T14:55:52+08:00">2021-08-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-27 13:17:29" itemprop="dateModified" datetime="2021-08-27T13:17:29+08:00">2021-08-27</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>27k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>25 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="项目主体结构"><a href="#项目主体结构" class="headerlink" title="项目主体结构"></a>项目主体结构</h2><ul>
<li><p>代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlinkKafkaJob3</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 获取参数</span></span><br><span class="line">        ParameterTool parameterTool = ParameterTool.fromArgs(args);</span><br><span class="line">        String consumerTopic = parameterTool.get(<span class="string">&quot;consumerTopic&quot;</span>);</span><br><span class="line">        String producerTopic = parameterTool.get(<span class="string">&quot;producerTopic&quot;</span>);</span><br><span class="line">        String specialTopic = parameterTool.get(<span class="string">&quot;specialTopic&quot;</span>);</span><br><span class="line">        String ifEarliestOffset = parameterTool.get(<span class="string">&quot;ifEarliestOffset&quot;</span>);</span><br><span class="line">        String ifSpecialOffset = parameterTool.get(<span class="string">&quot;ifSpecialOffset&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;consumerTopic: &quot;</span> + consumerTopic + <span class="string">&quot;, producerTopic: &quot;</span> + producerTopic +</span><br><span class="line">                <span class="string">&quot;, specialTopic: &quot;</span> + specialTopic + <span class="string">&quot;, ifEarliestOffset: &quot;</span> + ifEarliestOffset + <span class="string">&quot;, ifSpecialOffset: &quot;</span> + ifSpecialOffset);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建流环境</span></span><br><span class="line">        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*env.enableCheckpointing(30 * 1000);</span></span><br><span class="line"><span class="comment">        env.getCheckpointConfig().setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE);</span></span><br><span class="line"><span class="comment">        env.getCheckpointConfig().setCheckpointTimeout(60000L);</span></span><br><span class="line"><span class="comment">        env.getCheckpointConfig().setMinPauseBetweenCheckpoints(60000L);</span></span><br><span class="line"><span class="comment">        env.setRestartStrategy(RestartStrategies.fixedDelayRestart(1, Time.minutes(1)));*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 定义kafka消费者</span></span><br><span class="line">        Properties consumerProp = ConsumerProperties.getProps();</span><br><span class="line">        FlinkKafkaConsumer&lt;ConsumerRecord&lt;String, String&gt;&gt; consumer = <span class="keyword">new</span> FlinkKafkaConsumer&lt;&gt;(</span><br><span class="line">                consumerTopic,</span><br><span class="line">                <span class="keyword">new</span> ConsumerStringDeserializationSchema(),</span><br><span class="line">                consumerProp);</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;yes&quot;</span>.equals(ifEarliestOffset)) &#123;</span><br><span class="line">            consumer.setStartFromEarliest();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;yes&quot;</span>.equals(ifSpecialOffset)) &#123;</span><br><span class="line">            String partitions = parameterTool.get(<span class="string">&quot;partition&quot;</span>);</span><br><span class="line">            String offsets = parameterTool.get(<span class="string">&quot;offset&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (partitions != <span class="keyword">null</span> &amp;&amp; offsets != <span class="keyword">null</span>) &#123;</span><br><span class="line">                Map&lt;KafkaTopicPartition, Long&gt; specificOffsets = <span class="keyword">new</span> HashMap&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">                String[] split = partitions.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                String[] split1 = offsets.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; split.length; i++) &#123;</span><br><span class="line">                    KafkaTopicPartition kafkaTopicPartition = <span class="keyword">new</span> KafkaTopicPartition(consumerTopic, Integer.parseInt(split[i]));</span><br><span class="line">                    specificOffsets.put(kafkaTopicPartition, Long.parseLong(split1[i]));</span><br><span class="line">                &#125;</span><br><span class="line">                consumer.setStartFromSpecificOffsets(specificOffsets);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 定义kafka生产者</span></span><br><span class="line">        Properties producerProp = ProducerProperties.getProps();</span><br><span class="line">        FlinkKafkaProducer&lt;String&gt; producer = <span class="keyword">new</span> FlinkKafkaProducer&lt;&gt;(</span><br><span class="line">                producerTopic,</span><br><span class="line">                <span class="keyword">new</span> ProducerStringSerializationSchema(producerTopic),</span><br><span class="line">                producerProp,</span><br><span class="line">                FlinkKafkaProducer.Semantic.EXACTLY_ONCE);</span><br><span class="line">        producer.setWriteTimestampToKafka(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Flink任务链</span></span><br><span class="line">        env.addSource(consumer)</span><br><span class="line">                .map((MapFunction&lt;ConsumerRecord&lt;String, String&gt;, PatentMessage&gt;) consumerRecord -&gt; &#123;</span><br><span class="line">                    String topic = consumerRecord.topic();</span><br><span class="line">                    <span class="keyword">int</span> partition = consumerRecord.partition();</span><br><span class="line">                    <span class="keyword">long</span> offset = consumerRecord.offset();</span><br><span class="line">                    String key = consumerRecord.key();</span><br><span class="line">                    String value = consumerRecord.value();</span><br><span class="line">                    JSONObject kafkaMessage = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                    kafkaMessage.put(<span class="string">&quot;topic&quot;</span>, topic);</span><br><span class="line">                    kafkaMessage.put(<span class="string">&quot;partition&quot;</span>, partition);</span><br><span class="line">                    kafkaMessage.put(<span class="string">&quot;offset&quot;</span>, offset);</span><br><span class="line">                    kafkaMessage.put(<span class="string">&quot;key&quot;</span>, key);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> PatentMessage(topic, partition, offset, key, value, <span class="keyword">null</span>, kafkaMessage);</span><br><span class="line">                &#125;)</span><br><span class="line">                .filter(<span class="keyword">new</span> FilterLargerOperator(specialTopic))</span><br><span class="line">                .map((MapFunction&lt;PatentMessage, PatentMessage&gt;) patentMessage -&gt; &#123;</span><br><span class="line">                    String value = patentMessage.getValue();</span><br><span class="line">                    <span class="keyword">if</span> (patentMessage.getKey().endsWith(PatentXmlTags.SGM)) &#123;</span><br><span class="line">                        value = PatentContentUtil.transferSgmPatentContent(value);</span><br><span class="line">                    &#125;</span><br><span class="line">                    Document document = Utils.buildXmlFromString(value);</span><br><span class="line">                    patentMessage.setDocument(document);</span><br><span class="line">                    <span class="keyword">return</span> patentMessage;</span><br><span class="line">                &#125;)</span><br><span class="line">                .filter(<span class="keyword">new</span> FilterBadOperator(specialTopic))</span><br><span class="line">                .flatMap(<span class="keyword">new</span> RichFlatMapOperator(specialTopic))</span><br><span class="line">            	<span class="comment">// 有的时候，lambda表达式无法获悉返回值参数类型，需要指定，could not be determined automatically</span></span><br><span class="line">                .returns(Types.STRING)</span><br><span class="line">                .addSink(producer);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行任务</span></span><br><span class="line">        env.execute(<span class="string">&quot;patent reaction extractor loader&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>打包命令：<code>mvn clean package -DskipTests</code>。</p>
</li>
</ul>
<h2 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h2><ul>
<li><p>主机地址：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client ~]$ ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens192: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:14:8b:4e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.2.106/24 brd 192.168.2.255 scope global noprefixroute dynamic ens192</span><br><span class="line">       valid_lft 40466sec preferred_lft 40466sec</span><br><span class="line">    inet6 fe80::fda6:9e98:3fce:8b74/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">(base) [hadoop@client ~]$ ifconfig</span><br><span class="line">ens192: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.2.106  netmask 255.255.255.0  broadcast 192.168.2.255</span><br><span class="line">        inet6 fe80::fda6:9e98:3fce:8b74  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:14:8b:4e  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 2326369660  bytes 961932882940 (895.8 GiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 1614468546  bytes 1124856260518 (1.0 TiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 34513  bytes 3083025 (2.9 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 34513  bytes 3083025 (2.9 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>主机名：hadoopclient。</p>
</blockquote>
</li>
<li><p>Flink 版本：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client flink-1.11.1]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/flink-1.11.1</span><br><span class="line">(base) [hadoop@client flink-1.11.1]$ flink -v</span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding <span class="keyword">in</span> [jar:file:/opt/flink-1.11.1/lib/logback-classic-1.2.3.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding <span class="keyword">in</span> [jar:file:/opt/hadoop-3.2.1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http://www.slf4j.org/codes.html<span class="comment">#multiple_bindings for an explanation.</span></span><br><span class="line">SLF4J: Actual binding is of <span class="built_in">type</span> [ch.qos.logback.classic.util.ContextSelectorStaticBinder]</span><br><span class="line">Version: 1.11.1, Commit ID: 7eb514a</span><br></pre></td></tr></table></figure>
</li>
<li><p>Hadoop 版本：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client hadoop-3.2.1]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/hadoop-3.2.1</span><br></pre></td></tr></table></figure>
</li>
<li><p>Hadoop 节点：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client ~]$ <span class="built_in">cd</span> .ssh/</span><br><span class="line">(base) [hadoop@client .ssh]$ <span class="built_in">pwd</span></span><br><span class="line">/home/hadoop/.ssh</span><br><span class="line">(base) [hadoop@client .ssh]$ ll</span><br><span class="line">total 24</span><br><span class="line">-rw-------. 1 hadoop hadoop 5921 Sep  3  2020 authorized_keys</span><br><span class="line">-rw-------. 1 hadoop hadoop 1675 Sep  3  2020 id_rsa</span><br><span class="line">-rw-r--r--. 1 hadoop hadoop  395 Sep  3  2020 id_rsa.pub</span><br><span class="line">-rw-r--r--. 1 hadoop hadoop 7446 Sep  9  2020 known_hosts</span><br><span class="line">(base) [hadoop@client .ssh]$ cat known_hosts </span><br><span class="line">datanode1,192.168.2.188</span><br><span class="line">datanode3,192.168.2.143</span><br><span class="line">datanode2,192.168.2.199</span><br><span class="line">node1,192.168.1.61</span><br><span class="line">node2,192.168.1.62</span><br><span class="line">node3,192.168.1.63</span><br><span class="line">node4,192.168.1.64</span><br><span class="line">node5,192.168.1.65</span><br><span class="line">node6,192.168.1.66</span><br><span class="line">node7,192.168.1.67</span><br><span class="line">node8,192.168.1.68</span><br></pre></td></tr></table></figure>

<blockquote>
<p>known_hosts 文件内容有删改。</p>
<p>datanode1 ~ 3 主要为存储节点，node1 ~ 8 主要为计算节点。</p>
</blockquote>
</li>
<li><p>主机与节点间的切换：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client ~]$ ssh node1</span><br><span class="line">Last login: Mon Aug 23 15:58:50 2021 from node2</span><br><span class="line">[hadoop@node1 ~]$ ll /opt/</span><br><span class="line">total 0</span><br><span class="line">drwxrwxr-x.  6 hadoop hadoop  99 Feb 28  2020 apache-maven-3.6.3</span><br><span class="line">drwxr-xr-x. 10 hadoop hadoop 156 Sep  3  2020 flink-1.11.1</span><br><span class="line">drwxr-xr-x. 12 hadoop hadoop 185 Sep 23  2020 hadoop-3.2.1</span><br><span class="line">drwxrwxr-x.  7 hadoop hadoop 146 Feb 13  2020 zookeeper-3.5.6</span><br><span class="line">[hadoop@node1 ~]$ ssh node6</span><br><span class="line">Last login: Mon Oct 19 14:19:59 2020 from node5</span><br><span class="line">[hadoop@node6 ~]$ ll /opt/</span><br><span class="line">total 0</span><br><span class="line">drwxrwxr-x.  6 hadoop hadoop  99 Aug 30  2020 apache-maven-3.6.3</span><br><span class="line">drwxr-xr-x. 10 hadoop hadoop 156 Sep  3  2020 flink-1.11.1</span><br><span class="line">drwxr-xr-x. 12 hadoop hadoop 185 Sep 23  2020 hadoop-3.2.1</span><br><span class="line">drwxrwxr-x.  7 hadoop hadoop 146 Aug 30  2020 zookeeper-3.5.6</span><br><span class="line">[hadoop@node6 ~]$ ssh hadoopclient</span><br><span class="line">Last login: Mon Aug 23 16:06:40 2021 from 192.168.1.1</span><br><span class="line">(base) [hadoop@client ~]$ ll /opt/</span><br><span class="line">total 0</span><br><span class="line">drwxrwxr-x.  6 hadoop hadoop  99 Aug 30  2020 apache-maven-3.6.3</span><br><span class="line">drwxr-xr-x. 10 hadoop hadoop 186 Aug 23 15:37 flink-1.11.1</span><br><span class="line">drwxr-xr-x. 12 hadoop hadoop 185 Sep 23  2020 hadoop-3.2.1</span><br><span class="line">drwxrwxr-x.  7 hadoop hadoop 146 Aug 30  2020 zookeeper-3.5.6</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Kafka-操作命令"><a href="#Kafka-操作命令" class="headerlink" title="Kafka 操作命令"></a>Kafka 操作命令</h2><ul>
<li><p>查看 Kafka topic 列表命令，返回 topic 名字列表：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181 --list</span><br><span class="line">__consumer_offsets</span><br><span class="line">__transaction_state</span><br><span class="line">extractor-log</span><br><span class="line">extractor-patent</span><br><span class="line">extractor-patent-exception</span><br><span class="line">extractor-result</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 Kafka topic 命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181,hadoopdatanode2:2181,hadoopdatanode3:2181 --create --partitions 12 --replication-factor 2 --topic extractor-patent</span><br><span class="line">Created topic extractor-patent.</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 Kafka 指定 topic 的详情命令，返回该 topic 的 partition 数量、replica 因子以及每个 partition 的 leader、replica 信息：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181 --describe --topic extractor-patent</span><br><span class="line">Topic: extractor-patent	PartitionCount: 12	ReplicationFactor: 2	Configs: </span><br><span class="line">	Topic: extractor-patent	Partition: 0	Leader: 1	Replicas: 1,2	Isr: 1,2</span><br><span class="line">	Topic: extractor-patent	Partition: 1	Leader: 2	Replicas: 2,0	Isr: 2,0</span><br><span class="line">	Topic: extractor-patent	Partition: 2	Leader: 0	Replicas: 0,1	Isr: 0,1</span><br><span class="line">	Topic: extractor-patent	Partition: 3	Leader: 1	Replicas: 1,0	Isr: 1,0</span><br><span class="line">	Topic: extractor-patent	Partition: 4	Leader: 2	Replicas: 2,1	Isr: 2,1</span><br><span class="line">	Topic: extractor-patent	Partition: 5	Leader: 0	Replicas: 0,2	Isr: 0,2</span><br><span class="line">	Topic: extractor-patent	Partition: 6	Leader: 1	Replicas: 1,2	Isr: 1,2</span><br><span class="line">	Topic: extractor-patent	Partition: 7	Leader: 2	Replicas: 2,0	Isr: 2,0</span><br><span class="line">	Topic: extractor-patent	Partition: 8	Leader: 0	Replicas: 0,1	Isr: 0,1</span><br><span class="line">	Topic: extractor-patent	Partition: 9	Leader: 1	Replicas: 1,0	Isr: 1,0</span><br><span class="line">	Topic: extractor-patent	Partition: 10	Leader: 2	Replicas: 2,1	Isr: 2,1</span><br><span class="line">	Topic: extractor-patent	Partition: 11	Leader: 0	Replicas: 0,2	Isr: 0,2</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 Kafka 指定 topic 各 partition 的 offset 信息命令，–time 参数为 -1 时，表示各分区最大的 offset，为 -2 时，表示各分区最小的 offset：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-run-class.sh kafka.tools.GetOffsetShell --broker-list hadoopdatanode1:9092 --time -1 --topic extractor-patent</span><br><span class="line">extractor-patent:0:364004</span><br><span class="line">extractor-patent:1:364109</span><br><span class="line">extractor-patent:2:363695</span><br><span class="line">extractor-patent:3:364158</span><br><span class="line">extractor-patent:4:363723</span><br><span class="line">extractor-patent:5:363860</span><br><span class="line">extractor-patent:6:363821</span><br><span class="line">extractor-patent:7:365197</span><br><span class="line">extractor-patent:8:364364</span><br><span class="line">extractor-patent:9:364092</span><br><span class="line">extractor-patent:10:365772</span><br><span class="line">extractor-patent:11:364990</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除 Kafka topic 命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181 --delete -topic extractor-patents</span><br><span class="line">Topic extractor-patents is marked <span class="keyword">for</span> deletion.</span><br><span class="line">Note: This will have no impact <span class="keyword">if</span> delete.topic.enable is not <span class="built_in">set</span> to <span class="literal">true</span>.</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 Kafka consumer group 命令，返回 consumer group 名字列表 (新版信息保存在 broker 中，老版信息保存在 zookeeper 中，二者命令不同)：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --list</span><br><span class="line">extractor-patent-consumer</span><br><span class="line">result-consumer</span><br><span class="line">log-consumer</span><br><span class="line">timeout-consumer</span><br></pre></td></tr></table></figure>

<blockquote>
<p>老版命令：<code>~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --zookeeper hadoopdatanode1:2181 --list</code>。</p>
</blockquote>
</li>
<li><p>查看 Kafka 指定 consumer group 的详情命令，返回 consumer group 对应的 topic 信息、当前消费的 offset、总 offset、剩余待消费 offset 等信息：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --describe --group extractor-patent-consumer</span><br><span class="line"></span><br><span class="line">Consumer group <span class="string">&#x27;extractor-patent-consumer&#x27;</span> has no active members.</span><br><span class="line"></span><br><span class="line">GROUP                     TOPIC            PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID     HOST            CLIENT-ID</span><br><span class="line">extractor-patent-consumer extractor-patent 5          262567          363860          101293          -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 6          267012          363821          96809           -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 3          262809          364158          101349          -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 4          262506          363723          101217          -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 9          266548          364092          97544           -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 10         266975          365772          98797           -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 7          264665          365197          100532          -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 8          270991          364364          93373           -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 11         256111          364990          108879          -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 1          267012          364109          97097           -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 2          264837          363695          98858           -               -               -</span><br><span class="line">extractor-patent-consumer extractor-patent 0          262513          364004          101491          -               -               -</span><br></pre></td></tr></table></figure>

<p><img src="/2021/08/12/flink-kafka/image-20210823171956927.png" alt="image-20210823171956927"></p>
</li>
<li><p>重置 Kafka 指定 consumer group 消费的 topic 的 offset 命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --reset-offsets -to-offset 0 --execute --topic patent-app --group extractor-patent-consumer</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除 Kafka 指定 consumer group 命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --delete --group extractor-patent-consumer</span><br></pre></td></tr></table></figure>
</li>
<li><p>命令行消费 Kafka 指定 topic 的内容命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从头开始消费</span></span><br><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --from-beginning --topic extractor-log &gt; extractor.log</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从头开始消费前10条消息，并显示key</span></span><br><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --from-beginning --max-messages 10 --property print.key=<span class="literal">true</span> --topic extractor-log</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从指定分区、指定offset开始消费</span></span><br><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --partition 0 --offset 219000 --topic extractor-log</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从尾开始消费，必须指定分区</span></span><br><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --partition 0 --offset latest --topic extractor-log</span><br></pre></td></tr></table></figure>
</li>
<li><p>更多命令参数查看 help：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --<span class="built_in">help</span></span><br><span class="line">This tool helps to create, delete, describe, or change a topic.</span><br><span class="line">Option                                   Description                            </span><br><span class="line">------                                   -----------                            </span><br><span class="line">--alter                                  Alter the number of partitions,        </span><br><span class="line">                                           replica assignment, and/or           </span><br><span class="line">                                           configuration <span class="keyword">for</span> the topic.         </span><br><span class="line">--at-min-isr-partitions                  <span class="keyword">if</span> <span class="built_in">set</span> when describing topics, only    </span><br><span class="line">                                           show partitions whose isr count is   </span><br><span class="line">                                           equal to the configured minimum. Not </span><br><span class="line">                                           supported with the --zookeeper       </span><br><span class="line">                                           option.                              </span><br><span class="line">--bootstrap-server &lt;String: server to    REQUIRED: The Kafka server to connect  </span><br><span class="line">  connect to&gt;                              to. In <span class="keyword">case</span> of providing this, a     </span><br><span class="line">                                           direct Zookeeper connection won<span class="string">&#x27;t be </span></span><br><span class="line"><span class="string">                                           required.                            </span></span><br><span class="line"><span class="string">--command-config &lt;String: command        Property file containing configs to be </span></span><br><span class="line"><span class="string">  config property file&gt;                    passed to Admin Client. This is used </span></span><br><span class="line"><span class="string">                                           only with --bootstrap-server option  </span></span><br><span class="line"><span class="string">                                           for describing and altering broker   </span></span><br><span class="line"><span class="string">                                           configs.                             </span></span><br><span class="line"><span class="string">--config &lt;String: name=value&gt;            A topic configuration override for the </span></span><br><span class="line"><span class="string">                                           topic being created or altered.The   </span></span><br><span class="line"><span class="string">                                           following is a list of valid         </span></span><br><span class="line"><span class="string">                                           configurations:                      </span></span><br><span class="line"><span class="string">                                         	cleanup.policy                        </span></span><br><span class="line"><span class="string">                                         	compression.type                      </span></span><br><span class="line"><span class="string">                                         	delete.retention.ms                   </span></span><br><span class="line"><span class="string">                                         	file.delete.delay.ms                  </span></span><br><span class="line"><span class="string">                                         	flush.messages                        </span></span><br><span class="line"><span class="string">                                         	flush.ms                              </span></span><br><span class="line"><span class="string">                                         	follower.replication.throttled.       </span></span><br><span class="line"><span class="string">                                           replicas                             </span></span><br><span class="line"><span class="string">                                         	index.interval.bytes                  </span></span><br><span class="line"><span class="string">                                         	leader.replication.throttled.replicas </span></span><br><span class="line"><span class="string">                                         	max.compaction.lag.ms                 </span></span><br><span class="line"><span class="string">                                         	max.message.bytes                     </span></span><br><span class="line"><span class="string">                                         	message.downconversion.enable         </span></span><br><span class="line"><span class="string">                                         	message.format.version                </span></span><br><span class="line"><span class="string">                                         	message.timestamp.difference.max.ms   </span></span><br><span class="line"><span class="string">                                         	message.timestamp.type                </span></span><br><span class="line"><span class="string">                                         	min.cleanable.dirty.ratio             </span></span><br><span class="line"><span class="string">                                         	min.compaction.lag.ms                 </span></span><br><span class="line"><span class="string">                                         	min.insync.replicas                   </span></span><br><span class="line"><span class="string">                                         	preallocate                           </span></span><br><span class="line"><span class="string">                                         	retention.bytes                       </span></span><br><span class="line"><span class="string">                                         	retention.ms                          </span></span><br><span class="line"><span class="string">                                         	segment.bytes                         </span></span><br><span class="line"><span class="string">                                         	segment.index.bytes                   </span></span><br><span class="line"><span class="string">                                         	segment.jitter.ms                     </span></span><br><span class="line"><span class="string">                                         	segment.ms                            </span></span><br><span class="line"><span class="string">                                         	unclean.leader.election.enable        </span></span><br><span class="line"><span class="string">                                         See the Kafka documentation for full   </span></span><br><span class="line"><span class="string">                                           details on the topic configs.It is   </span></span><br><span class="line"><span class="string">                                           supported only in combination with --</span></span><br><span class="line"><span class="string">                                           create if --bootstrap-server option  </span></span><br><span class="line"><span class="string">                                           is used.                             </span></span><br><span class="line"><span class="string">--create                                 Create a new topic.                    </span></span><br><span class="line"><span class="string">--delete                                 Delete a topic                         </span></span><br><span class="line"><span class="string">--delete-config &lt;String: name&gt;           A topic configuration override to be   </span></span><br><span class="line"><span class="string">                                           removed for an existing topic (see   </span></span><br><span class="line"><span class="string">                                           the list of configurations under the </span></span><br><span class="line"><span class="string">                                           --config option). Not supported with </span></span><br><span class="line"><span class="string">                                           the --bootstrap-server option.       </span></span><br><span class="line"><span class="string">--describe                               List details for the given topics.     </span></span><br><span class="line"><span class="string">--disable-rack-aware                     Disable rack aware replica assignment  </span></span><br><span class="line"><span class="string">--exclude-internal                       exclude internal topics when running   </span></span><br><span class="line"><span class="string">                                           list or describe command. The        </span></span><br><span class="line"><span class="string">                                           internal topics will be listed by    </span></span><br><span class="line"><span class="string">                                           default                              </span></span><br><span class="line"><span class="string">--force                                  Suppress console prompts               </span></span><br><span class="line"><span class="string">--help                                   Print usage information.               </span></span><br><span class="line"><span class="string">--if-exists                              if set when altering or deleting or    </span></span><br><span class="line"><span class="string">                                           describing topics, the action will   </span></span><br><span class="line"><span class="string">                                           only execute if the topic exists.    </span></span><br><span class="line"><span class="string">--if-not-exists                          if set when creating topics, the       </span></span><br><span class="line"><span class="string">                                           action will only execute if the      </span></span><br><span class="line"><span class="string">                                           topic does not already exist.        </span></span><br><span class="line"><span class="string">--list                                   List all available topics.             </span></span><br><span class="line"><span class="string">--partitions &lt;Integer: # of partitions&gt;  The number of partitions for the topic </span></span><br><span class="line"><span class="string">                                           being created or altered (WARNING:   </span></span><br><span class="line"><span class="string">                                           If partitions are increased for a    </span></span><br><span class="line"><span class="string">                                           topic that has a key, the partition  </span></span><br><span class="line"><span class="string">                                           logic or ordering of the messages    </span></span><br><span class="line"><span class="string">                                           will be affected). If not supplied   </span></span><br><span class="line"><span class="string">                                           for create, defaults to the cluster  </span></span><br><span class="line"><span class="string">                                           default.                             </span></span><br><span class="line"><span class="string">--replica-assignment &lt;String:            A list of manual partition-to-broker   </span></span><br><span class="line"><span class="string">  broker_id_for_part1_replica1 :           assignments for the topic being      </span></span><br><span class="line"><span class="string">  broker_id_for_part1_replica2 ,           created or altered.                  </span></span><br><span class="line"><span class="string">  broker_id_for_part2_replica1 :                                                </span></span><br><span class="line"><span class="string">  broker_id_for_part2_replica2 , ...&gt;                                           </span></span><br><span class="line"><span class="string">--replication-factor &lt;Integer:           The replication factor for each        </span></span><br><span class="line"><span class="string">  replication factor&gt;                      partition in the topic being         </span></span><br><span class="line"><span class="string">                                           created. If not supplied, defaults   </span></span><br><span class="line"><span class="string">                                           to the cluster default.              </span></span><br><span class="line"><span class="string">--topic &lt;String: topic&gt;                  The topic to create, alter, describe   </span></span><br><span class="line"><span class="string">                                           or delete. It also accepts a regular </span></span><br><span class="line"><span class="string">                                           expression, except for --create      </span></span><br><span class="line"><span class="string">                                           option. Put topic name in double     </span></span><br><span class="line"><span class="string">                                           quotes and use the &#x27;</span>\<span class="string">&#x27; prefix to     </span></span><br><span class="line"><span class="string">                                           escape regular expression symbols; e.</span></span><br><span class="line"><span class="string">                                           g. &quot;test\.topic&quot;.                    </span></span><br><span class="line"><span class="string">--topics-with-overrides                  if set when describing topics, only    </span></span><br><span class="line"><span class="string">                                           show topics that have overridden     </span></span><br><span class="line"><span class="string">                                           configs                              </span></span><br><span class="line"><span class="string">--unavailable-partitions                 if set when describing topics, only    </span></span><br><span class="line"><span class="string">                                           show partitions whose leader is not  </span></span><br><span class="line"><span class="string">                                           available                            </span></span><br><span class="line"><span class="string">--under-min-isr-partitions               if set when describing topics, only    </span></span><br><span class="line"><span class="string">                                           show partitions whose isr count is   </span></span><br><span class="line"><span class="string">                                           less than the configured minimum.    </span></span><br><span class="line"><span class="string">                                           Not supported with the --zookeeper   </span></span><br><span class="line"><span class="string">                                           option.                              </span></span><br><span class="line"><span class="string">--under-replicated-partitions            if set when describing topics, only    </span></span><br><span class="line"><span class="string">                                           show under replicated partitions     </span></span><br><span class="line"><span class="string">--version                                Display Kafka version.                 </span></span><br><span class="line"><span class="string">--zookeeper &lt;String: hosts&gt;              DEPRECATED, The connection string for  </span></span><br><span class="line"><span class="string">                                           the zookeeper connection in the form </span></span><br><span class="line"><span class="string">                                           host:port. Multiple hosts can be     </span></span><br><span class="line"><span class="string">                                           given to allow fail-over.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --<span class="built_in">help</span></span><br><span class="line">Missing required argument <span class="string">&quot;[bootstrap-server]&quot;</span></span><br><span class="line">Option                                  Description                            </span><br><span class="line">------                                  -----------                            </span><br><span class="line">--all-groups                            Apply to all consumer groups.          </span><br><span class="line">--all-topics                            Consider all topics assigned to a      </span><br><span class="line">                                          group <span class="keyword">in</span> the `reset-offsets` process.</span><br><span class="line">--bootstrap-server &lt;String: server to   REQUIRED: The server(s) to connect to. </span><br><span class="line">  connect to&gt;                                                                  </span><br><span class="line">--by-duration &lt;String: duration&gt;        Reset offsets to offset by duration    </span><br><span class="line">                                          from current timestamp. Format:      </span><br><span class="line">                                          <span class="string">&#x27;PnDTnHnMnS&#x27;</span>                         </span><br><span class="line">--command-config &lt;String: <span class="built_in">command</span>       Property file containing configs to be </span><br><span class="line">  config property file&gt;                   passed to Admin Client and Consumer. </span><br><span class="line">--delete                                Pass <span class="keyword">in</span> groups to delete topic         </span><br><span class="line">                                          partition offsets and ownership      </span><br><span class="line">                                          information over the entire consumer </span><br><span class="line">                                          group. For instance --group g1 --    </span><br><span class="line">                                          group g2                             </span><br><span class="line">--delete-offsets                        Delete offsets of consumer group.      </span><br><span class="line">                                          Supports one consumer group at the   </span><br><span class="line">                                          time, and multiple topics.           </span><br><span class="line">--describe                              Describe consumer group and list       </span><br><span class="line">                                          offset lag (number of messages not   </span><br><span class="line">                                          yet processed) related to given      </span><br><span class="line">                                          group.                               </span><br><span class="line">--dry-run                               Only show results without executing    </span><br><span class="line">                                          changes on Consumer Groups.          </span><br><span class="line">                                          Supported operations: reset-offsets. </span><br><span class="line">--execute                               Execute operation. Supported           </span><br><span class="line">                                          operations: reset-offsets.           </span><br><span class="line">--<span class="built_in">export</span>                                Export operation execution to a CSV    </span><br><span class="line">                                          file. Supported operations: reset-   </span><br><span class="line">                                          offsets.                             </span><br><span class="line">--from-file &lt;String: path to CSV file&gt;  Reset offsets to values defined <span class="keyword">in</span> CSV </span><br><span class="line">                                          file.                                </span><br><span class="line">--group &lt;String: consumer group&gt;        The consumer group we wish to act on.  </span><br><span class="line">--<span class="built_in">help</span>                                  Print usage information.               </span><br><span class="line">--list                                  List all consumer groups.              </span><br><span class="line">--members                               Describe members of the group. This    </span><br><span class="line">                                          option may be used with <span class="string">&#x27;--describe&#x27;</span> </span><br><span class="line">                                          and <span class="string">&#x27;--bootstrap-server&#x27;</span> options     </span><br><span class="line">                                          only.                                </span><br><span class="line">                                        Example: --bootstrap-server localhost: </span><br><span class="line">                                          9092 --describe --group group1 --    </span><br><span class="line">                                          members                              </span><br><span class="line">--offsets                               Describe the group and list all topic  </span><br><span class="line">                                          partitions <span class="keyword">in</span> the group along with   </span><br><span class="line">                                          their offset lag. This is the        </span><br><span class="line">                                          default sub-action of and may be     </span><br><span class="line">                                          used with <span class="string">&#x27;--describe&#x27;</span> and <span class="string">&#x27;--       </span></span><br><span class="line"><span class="string">                                          bootstrap-server&#x27;</span> options only.      </span><br><span class="line">                                        Example: --bootstrap-server localhost: </span><br><span class="line">                                          9092 --describe --group group1 --    </span><br><span class="line">                                          offsets                              </span><br><span class="line">--reset-offsets                         Reset offsets of consumer group.       </span><br><span class="line">                                          Supports one consumer group at the   </span><br><span class="line">                                          time, and instances should be        </span><br><span class="line">                                          inactive                             </span><br><span class="line">                                        Has 2 execution options: --dry-run     </span><br><span class="line">                                          (the default) to plan <span class="built_in">which</span> offsets  </span><br><span class="line">                                          to reset, and --execute to update    </span><br><span class="line">                                          the offsets. Additionally, the --    </span><br><span class="line">                                          <span class="built_in">export</span> option is used to <span class="built_in">export</span> the  </span><br><span class="line">                                          results to a CSV format.             </span><br><span class="line">                                        You must choose one of the following   </span><br><span class="line">                                          reset specifications: --to-datetime, </span><br><span class="line">                                          --by-period, --to-earliest, --to-    </span><br><span class="line">                                          latest, --shift-by, --from-file, --  </span><br><span class="line">                                          to-current.                          </span><br><span class="line">                                        To define the scope use --all-topics   </span><br><span class="line">                                          or --topic. One scope must be        </span><br><span class="line">                                          specified unless you use <span class="string">&#x27;--from-    </span></span><br><span class="line"><span class="string">                                          file&#x27;</span>.                               </span><br><span class="line">--shift-by &lt;Long: number-of-offsets&gt;    Reset offsets shifting current offset  </span><br><span class="line">                                          by <span class="string">&#x27;n&#x27;</span>, <span class="built_in">where</span> <span class="string">&#x27;n&#x27;</span> can be positive or </span><br><span class="line">                                          negative.                            </span><br><span class="line">--state [String]                        When specified with <span class="string">&#x27;--describe&#x27;</span>,      </span><br><span class="line">                                          includes the state of the group.     </span><br><span class="line">                                        Example: --bootstrap-server localhost: </span><br><span class="line">                                          9092 --describe --group group1 --    </span><br><span class="line">                                          state                                </span><br><span class="line">                                        When specified with <span class="string">&#x27;--list&#x27;</span>, it       </span><br><span class="line">                                          displays the state of all groups. It </span><br><span class="line">                                          can also be used to list groups with </span><br><span class="line">                                          specific states.                     </span><br><span class="line">                                        Example: --bootstrap-server localhost: </span><br><span class="line">                                          9092 --list --state stable,empty     </span><br><span class="line">                                        This option may be used with <span class="string">&#x27;--       </span></span><br><span class="line"><span class="string">                                          describe&#x27;</span>, <span class="string">&#x27;--list&#x27;</span> and <span class="string">&#x27;--bootstrap-</span></span><br><span class="line"><span class="string">                                          server&#x27;</span> options only.                </span><br><span class="line">--timeout &lt;Long: timeout (ms)&gt;          The timeout that can be <span class="built_in">set</span> <span class="keyword">for</span> some   </span><br><span class="line">                                          use cases. For example, it can be    </span><br><span class="line">                                          used when describing the group to    </span><br><span class="line">                                          specify the maximum amount of time   </span><br><span class="line">                                          <span class="keyword">in</span> milliseconds to <span class="built_in">wait</span> before the   </span><br><span class="line">                                          group stabilizes (when the group is  </span><br><span class="line">                                          just created, or is going through    </span><br><span class="line">                                          some changes). (default: 5000)       </span><br><span class="line">--to-current                            Reset offsets to current offset.       </span><br><span class="line">--to-datetime &lt;String: datetime&gt;        Reset offsets to offset from datetime. </span><br><span class="line">                                          Format: <span class="string">&#x27;YYYY-MM-DDTHH:mm:SS.sss&#x27;</span>    </span><br><span class="line">--to-earliest                           Reset offsets to earliest offset.      </span><br><span class="line">--to-latest                             Reset offsets to latest offset.        </span><br><span class="line">--to-offset &lt;Long: offset&gt;              Reset offsets to a specific offset.    </span><br><span class="line">--topic &lt;String: topic&gt;                 The topic whose consumer group         </span><br><span class="line">                                          information should be deleted or     </span><br><span class="line">                                          topic whose should be included <span class="keyword">in</span>    </span><br><span class="line">                                          the reset offset process. In `reset- </span><br><span class="line">                                          offsets` <span class="keyword">case</span>, partitions can be     </span><br><span class="line">                                          specified using this format: `topic1:</span><br><span class="line">                                          0,1,2`, <span class="built_in">where</span> 0,1,2 are the          </span><br><span class="line">                                          partition to be included <span class="keyword">in</span> the      </span><br><span class="line">                                          process. Reset-offsets also supports </span><br><span class="line">                                          multiple topic inputs.               </span><br><span class="line">--verbose                               Provide additional information, <span class="keyword">if</span>     </span><br><span class="line">                                          any, when describing the group. This </span><br><span class="line">                                          option may be used with <span class="string">&#x27;--          </span></span><br><span class="line"><span class="string">                                          offsets&#x27;</span>/<span class="string">&#x27;--members&#x27;</span>/<span class="string">&#x27;--state&#x27;</span> and   </span><br><span class="line">                                          <span class="string">&#x27;--bootstrap-server&#x27;</span> options only.   </span><br><span class="line">                                        Example: --bootstrap-server localhost: </span><br><span class="line">                                          9092 --describe --group group1 --    </span><br><span class="line">                                          members --verbose                    </span><br><span class="line">--version                               Display Kafka version.</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --<span class="built_in">help</span></span><br><span class="line">This tool helps to <span class="built_in">read</span> data from Kafka topics and outputs it to standard output.</span><br><span class="line">Option                                   Description                            </span><br><span class="line">------                                   -----------                            </span><br><span class="line">--bootstrap-server &lt;String: server to    REQUIRED: The server(s) to connect to. </span><br><span class="line">  connect to&gt;                                                                   </span><br><span class="line">--consumer-property &lt;String:             A mechanism to pass user-defined       </span><br><span class="line">  consumer_prop&gt;                           properties <span class="keyword">in</span> the form key=value to  </span><br><span class="line">                                           the consumer.                        </span><br><span class="line">--consumer.config &lt;String: config file&gt;  Consumer config properties file. Note  </span><br><span class="line">                                           that [consumer-property] takes       </span><br><span class="line">                                           precedence over this config.         </span><br><span class="line">--enable-systest-events                  Log lifecycle events of the consumer   </span><br><span class="line">                                           <span class="keyword">in</span> addition to logging consumed      </span><br><span class="line">                                           messages. (This is specific <span class="keyword">for</span>      </span><br><span class="line">                                           system tests.)                       </span><br><span class="line">--formatter &lt;String: class&gt;              The name of a class to use <span class="keyword">for</span>         </span><br><span class="line">                                           formatting kafka messages <span class="keyword">for</span>        </span><br><span class="line">                                           display. (default: kafka.tools.      </span><br><span class="line">                                           DefaultMessageFormatter)             </span><br><span class="line">--from-beginning                         If the consumer does not already have  </span><br><span class="line">                                           an established offset to consume     </span><br><span class="line">                                           from, start with the earliest        </span><br><span class="line">                                           message present <span class="keyword">in</span> the <span class="built_in">log</span> rather    </span><br><span class="line">                                           than the latest message.             </span><br><span class="line">--group &lt;String: consumer group id&gt;      The consumer group id of the consumer. </span><br><span class="line">--<span class="built_in">help</span>                                   Print usage information.               </span><br><span class="line">--isolation-level &lt;String&gt;               Set to read_committed <span class="keyword">in</span> order to      </span><br><span class="line">                                           filter out transactional messages    </span><br><span class="line">                                           <span class="built_in">which</span> are not committed. Set to      </span><br><span class="line">                                           read_uncommitted to <span class="built_in">read</span> all         </span><br><span class="line">                                           messages. (default: read_uncommitted)</span><br><span class="line">--key-deserializer &lt;String:                                                     </span><br><span class="line">  deserializer <span class="keyword">for</span> key&gt;                                                         </span><br><span class="line">--max-messages &lt;Integer: num_messages&gt;   The maximum number of messages to      </span><br><span class="line">                                           consume before exiting. If not <span class="built_in">set</span>,  </span><br><span class="line">                                           consumption is continual.            </span><br><span class="line">--offset &lt;String: consume offset&gt;        The offset id to consume from (a non-  </span><br><span class="line">                                           negative number), or <span class="string">&#x27;earliest&#x27;</span>      </span><br><span class="line">                                           <span class="built_in">which</span> means from beginning, or       </span><br><span class="line">                                           <span class="string">&#x27;latest&#x27;</span> <span class="built_in">which</span> means from end        </span><br><span class="line">                                           (default: latest)                    </span><br><span class="line">--partition &lt;Integer: partition&gt;         The partition to consume from.         </span><br><span class="line">                                           Consumption starts from the end of   </span><br><span class="line">                                           the partition unless <span class="string">&#x27;--offset&#x27;</span> is   </span><br><span class="line">                                           specified.                           </span><br><span class="line">--property &lt;String: prop&gt;                The properties to initialize the       </span><br><span class="line">                                           message formatter. Default           </span><br><span class="line">                                           properties include:                  </span><br><span class="line">                                         	print.timestamp=<span class="literal">true</span>|<span class="literal">false</span>            </span><br><span class="line">                                         	print.key=<span class="literal">true</span>|<span class="literal">false</span>                  </span><br><span class="line">                                         	print.value=<span class="literal">true</span>|<span class="literal">false</span>                </span><br><span class="line">                                         	key.separator=&lt;key.separator&gt;         </span><br><span class="line">                                         	line.separator=&lt;line.separator&gt;       </span><br><span class="line">                                         	key.deserializer=&lt;key.deserializer&gt;   </span><br><span class="line">                                         	value.deserializer=&lt;value.            </span><br><span class="line">                                           deserializer&gt;                        </span><br><span class="line">                                         Users can also pass <span class="keyword">in</span> customized      </span><br><span class="line">                                           properties <span class="keyword">for</span> their formatter; more </span><br><span class="line">                                           specifically, users can pass <span class="keyword">in</span>      </span><br><span class="line">                                           properties keyed with <span class="string">&#x27;key.          </span></span><br><span class="line"><span class="string">                                           deserializer.&#x27;</span> and <span class="string">&#x27;value.           </span></span><br><span class="line"><span class="string">                                           deserializer.&#x27;</span> prefixes to configure </span><br><span class="line">                                           their deserializers.                 </span><br><span class="line">--skip-message-on-error                  If there is an error when processing a </span><br><span class="line">                                           message, skip it instead of halt.    </span><br><span class="line">--timeout-ms &lt;Integer: timeout_ms&gt;       If specified, <span class="built_in">exit</span> <span class="keyword">if</span> no message is    </span><br><span class="line">                                           available <span class="keyword">for</span> consumption <span class="keyword">for</span> the    </span><br><span class="line">                                           specified interval.                  </span><br><span class="line">--topic &lt;String: topic&gt;                  The topic id to consume on.            </span><br><span class="line">--value-deserializer &lt;String:                                                   </span><br><span class="line">  deserializer <span class="keyword">for</span> values&gt;                                                      </span><br><span class="line">--version                                Display Kafka version.                 </span><br><span class="line">--whitelist &lt;String: whitelist&gt;          Regular expression specifying          </span><br><span class="line">                                           whitelist of topics to include <span class="keyword">for</span>   </span><br><span class="line">                                           consumption.          </span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Flink-任务提交"><a href="#Flink-任务提交" class="headerlink" title="Flink 任务提交"></a>Flink 任务提交</h2><ul>
<li><p>提交任务所需的 jar 包，放置于主机上：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client patent-extractor]$ <span class="built_in">pwd</span></span><br><span class="line">/data/patent/official/patent-extractor</span><br><span class="line">(base) [hadoop@client patent-extractor]$ ll</span><br><span class="line">total 349140</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 357510953 Aug 20 12:01 reaction-extractor-1.0-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交任务的模式：yarn-cluster。</p>
</li>
<li><p>提交任务的命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flink run -m yarn-cluster -p 12 -d reaction-extractor-1.0-SNAPSHOT.jar --consumerTopic extractor-patent --producerTopic extractor-result --specialTopic extractor-patent-exception</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flink run -m yarn-cluster -p 12 -d reaction-extractor-1.0-SNAPSHOT.jar --consumerTopic extractor-patent --producerTopic extractor-result --specialTopic extractor-patent-timeout --ifEarliestOffset yes</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flink run -m yarn-cluster -p 12 -d reaction-extractor-1.0-SNAPSHOT.jar --consumerTopic extractor-patent --producerTopic extractor-result --specialTopic extractor-patent-timeout --ifSpecialOffset yes </span><br><span class="line">        --partition 0,1,2,3,4,5,6,7,8,9,10,11 --offset 273413,277780,268447,274226,273855,273795,278069,275783,284768,277734,281195,265928</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="YARN-查询命令"><a href="#YARN-查询命令" class="headerlink" title="YARN 查询命令"></a>YARN 查询命令</h2><ul>
<li><p>查看yarn上面的资源使用情况命令，ctrl+c退出：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client official]$ yarn top</span><br><span class="line">YARN top - 22:52:46, up 266d, 4:43, 0 active users, queue(s): root</span><br><span class="line">NodeManager(s): 11 total, 11 active, 0 unhealthy, 0 decommissioned, 0 lost, 0 rebooted</span><br><span class="line">Queue(s) Applications: 1 running, 167 submitted, 0 pending, 39 completed, 127 killed, 0 failed</span><br><span class="line">Queue(s) Mem(GB): 382 available, 146 allocated, 0 pending, 0 reserved</span><br><span class="line">Queue(s) VCores: 163 available, 13 allocated, 0 pending, 0 reserved</span><br><span class="line">Queue(s) Containers: 13 allocated, 0 pending, 0 reserved</span><br><span class="line"></span><br><span class="line">                  APPLICATIONID USER             TYPE      QUEUE PRIOR   <span class="comment">#CONT  #RCONT  VCORES RVCORES     MEM    RMEM  VCORESECS    MEMSECS %PROGR       TIME NAME                                                                             </span></span><br><span class="line"> application_1606730935892_0168 hadoop     apache flink    default     0      13       0      13       0    146G      0G      68363     767752 100.00   00:01:27 Flink per-job cluster</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 YARN 上运行的任务列表命令，如果集群有 krb 认证的话，需要先 kinit，认证后可以看到所有正在运行的任务：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client official]$ yarn application -list</span><br><span class="line">Total number of applications (application-types: [], states: [SUBMITTED, ACCEPTED, RUNNING] and tags: []):1</span><br><span class="line">                Application-Id	    Application-Name	    Application-Type	      User	     Queue	             State	       Final-State	       Progress	                       Tracking-URL</span><br><span class="line">application_1606730935892_0168	Flink per-job cluster	        Apache Flink	    hadoop	   default	           RUNNING	         UNDEFINED	           100%	                 http://node3:36312</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 YARN 上运行的指定状态的任务列表命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client official]$ yarn application -list -appStates RUNNING</span><br><span class="line">Total number of applications (application-types: [], states: [RUNNING] and tags: []):1</span><br><span class="line">                Application-Id	    Application-Name	    Application-Type	      User	     Queue	             State	       Final-State	       Progress	                       Tracking-URL</span><br><span class="line">application_1606730935892_0168	Flink per-job cluster	        Apache Flink	    hadoop	   default	           RUNNING	         UNDEFINED	           100%	                 http://node3:36312</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 YARN 指定任务的状态信息命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn application -status &lt;applicationId&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client official]$ yarn application -status application_1606730935892_0168</span><br><span class="line">Application Report : </span><br><span class="line">	Application-Id : application_1606730935892_0168</span><br><span class="line">	Application-Name : Flink per-job cluster</span><br><span class="line">	Application-Type : Apache Flink</span><br><span class="line">	User : hadoop</span><br><span class="line">	Queue : default</span><br><span class="line">	Application Priority : 0</span><br><span class="line">	Start-Time : 1629725098333</span><br><span class="line">	Finish-Time : 0</span><br><span class="line">	Progress : 100%</span><br><span class="line">	State : RUNNING</span><br><span class="line">	Final-State : UNDEFINED</span><br><span class="line">	Tracking-URL : http://node3:36312</span><br><span class="line">	RPC Port : 36312</span><br><span class="line">	AM Host : node3</span><br><span class="line">	Aggregate Resource Allocation : 829449970 MB-seconds, 72126 vcore-seconds</span><br><span class="line">	Aggregate Resource Preempted : 0 MB-seconds, 0 vcore-seconds</span><br><span class="line">	Log Aggregation Status : NOT_START</span><br><span class="line">	Diagnostics : </span><br><span class="line">	Unmanaged Application : <span class="literal">false</span></span><br><span class="line">	Application Node Label Expression : &lt;Not <span class="built_in">set</span>&gt;</span><br><span class="line">	AM container Node Label Expression : &lt;DEFAULT_PARTITION&gt;</span><br><span class="line">	TimeoutType : LIFETIME	ExpiryTime : UNLIMITED	RemainingTime : -1seconds</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 YARN 指定 application 任务日志命令，可以选择输出到本地文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn logs -applicationId &lt;applicationId&gt; &gt; yarn.log</span><br></pre></td></tr></table></figure>
</li>
<li><p>kill yarn application 命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn application -<span class="built_in">kill</span> &lt;applicationId&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>kill yarn job 命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn job -<span class="built_in">kill</span> &lt;jobId&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/28/db-mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/28/db-mysql/" class="post-title-link" itemprop="url">MySQL 入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-28 10:36:17" itemprop="dateCreated datePublished" datetime="2021-06-28T10:36:17+08:00">2021-06-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-05 14:56:02" itemprop="dateModified" datetime="2021-07-05T14:56:02+08:00">2021-07-05</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="MySQL-安装"><a href="#MySQL-安装" class="headerlink" title="MySQL 安装"></a>MySQL 安装</h2><h3 id="Windows-上安装-MySQL"><a href="#Windows-上安装-MySQL" class="headerlink" title="Windows 上安装 MySQL"></a>Windows 上安装 MySQL</h3><ul>
<li><p>下载：</p>
<ul>
<li><p>地址：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/">https://dev.mysql.com/downloads/</a></p>
<img src="/2021/06/28/db-mysql/image-20210628104033167.png" alt="image-20210628104033167" style="zoom:80%;">

<img src="/2021/06/28/db-mysql/image-20210628104631688.png" alt="image-20210628104631688" style="zoom: 67%;">

<img src="/2021/06/28/db-mysql/image-20210628104732582.png" alt="image-20210628104732582" style="zoom:80%;">
</li>
</ul>
</li>
<li><p>安装：</p>
<ul>
<li><p>产品选择：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628105225639.png" alt="image-20210628105225639"></p>
<ul>
<li>Developer Default：开发者默认，安装 MySQL 开发所需的所有产品。</li>
<li>Server only：服务器，只安装 MySQL 服务器产品。</li>
<li>Client only：客户端，只安装没有服务器的 MySQL 客户端产品。</li>
<li>Full：完全，安装所有包含的 MySQL 产品和功能。</li>
<li>Custom：手动，手动选择系统上应安装的产品。</li>
</ul>
</li>
<li><p>跳过 Check Requirements：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628105821442.png" alt="image-20210628105821442"></p>
</li>
<li><p>进度，安装需要一段时间：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628110013750.png" alt="image-20210628110013750"></p>
</li>
<li><p>待配置项，接下来会一项接一项的进行配置。当一项配置完后，会回到此页面，并显示该项 Configuration Complete，然后进行下一项：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628110646919.png" alt="image-20210628110646919"></p>
</li>
<li><p>端口：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628111323014.png" alt="image-20210628111323014"></p>
</li>
<li><p>root 用户密码 (此密码不能忘)：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628111107793.png" alt="image-20210628111107793"></p>
<blockquote>
<p>可以在本页面添加其他用户，并赋予权限和登录密码。</p>
</blockquote>
</li>
<li><p>配置 MySQL 在 Windows 系统中的名字，以及是否选择开机启动 MySQL 服务：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628111545278.png" alt="image-20210628111545278"></p>
</li>
<li><p>应用配置：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628111742778.png" alt="image-20210628111742778"></p>
</li>
<li><p>安装日志，可以查看端口和安装位置等信息：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628111936212.png" alt="image-20210628111936212"></p>
</li>
<li><p>安装完成：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628112810961.png" alt="image-20210628112810961"></p>
</li>
<li><p>双击运行之前下载的安装包，能看到所安装的产品。</p>
<p><img src="/2021/06/28/db-mysql/image-20210628113107855.png" alt="image-20210628113107855"></p>
</li>
</ul>
</li>
<li><p>添加环境变量：</p>
<ul>
<li>新建 MASQL_HOME：</li>
</ul>
<p><img src="/2021/06/28/db-mysql/image-20210628113444200.png" alt="image-20210628113444200"></p>
<ul>
<li><p>添加 path：</p>
<p><img src="/2021/06/28/db-mysql/image-20210628113538999.png" alt="image-20210628113538999"></p>
</li>
<li><p>测试：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Users</span>\<span class="title">XiSun</span>&gt;<span class="title">mysql</span> -<span class="title">u</span> <span class="title">root</span> -<span class="title">p</span></span></span><br><span class="line"><span class="function"><span class="title">Enter</span> <span class="title">password</span>: ***************</span></span><br><span class="line"><span class="function"><span class="title">Welcome</span> <span class="title">to</span> <span class="title">the</span> <span class="title">MySQL</span> <span class="title">monitor</span>.  <span class="title">Commands</span> <span class="title">end</span> <span class="title">with</span> ; <span class="title">or</span> \<span class="title">g</span>.</span></span><br><span class="line"><span class="function"><span class="title">Your</span> <span class="title">MySQL</span> <span class="title">connection</span> <span class="title">id</span> <span class="title">is</span> 30</span></span><br><span class="line"><span class="function"><span class="title">Server</span> <span class="title">version</span>: 8.0.25 <span class="title">MySQL</span> <span class="title">Community</span> <span class="title">Server</span> - <span class="title">GPL</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Copyright</span> (<span class="title">c</span>) 2000, 2021, <span class="title">Oracle</span> <span class="title">and</span>/<span class="title">or</span> <span class="title">its</span> <span class="title">affiliates</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Oracle</span> <span class="title">is</span> <span class="title">a</span> <span class="title">registered</span> <span class="title">trademark</span> <span class="title">of</span> <span class="title">Oracle</span> <span class="title">Corporation</span> <span class="title">and</span>/<span class="title">or</span> <span class="title">its</span></span></span><br><span class="line"><span class="function"><span class="title">affiliates</span>. <span class="title">Other</span> <span class="title">names</span> <span class="title">may</span> <span class="title">be</span> <span class="title">trademarks</span> <span class="title">of</span> <span class="title">their</span> <span class="title">respective</span></span></span><br><span class="line"><span class="function"><span class="title">owners</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Type</span> &#x27;<span class="title">help</span>;&#x27; <span class="title">or</span> &#x27;\<span class="title">h</span>&#x27; <span class="title">for</span> <span class="title">help</span>. <span class="title">Type</span> &#x27;\<span class="title">c</span>&#x27; <span class="title">to</span> <span class="title">clear</span> <span class="title">the</span> <span class="title">current</span> <span class="title">input</span> <span class="title">statement</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">mysql</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/mysql/mysql-install.html">https://www.runoob.com/mysql/mysql-install.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/windows10-mysql-installer.html">https://www.runoob.com/w3cnote/windows10-mysql-installer.html</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XiSun"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">XiSun</p>
  <div class="site-description" itemprop="description">心如止水者，虽世间繁华之红尘纷扰，已然空无一物</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XiSun</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.8m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">27:35</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
