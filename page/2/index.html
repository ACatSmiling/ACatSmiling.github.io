<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
<meta property="og:type" content="website">
<meta property="og:title" content="XiSun的博客">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="XiSun的博客">
<meta property="og:description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="XiSun">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>XiSun的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">XiSun的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Learning is endless</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/12/maven-modules/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/12/maven-modules/" class="post-title-link" itemprop="url">maven 构建分模块项目</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-12 17:17:19" itemprop="dateCreated datePublished" datetime="2021-01-12T17:17:19+08:00">2021-01-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-20 15:37:52" itemprop="dateModified" datetime="2021-01-20T15:37:52+08:00">2021-01-20</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>15k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>14 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="分模块构建-maven-工程分析"><a href="#分模块构建-maven-工程分析" class="headerlink" title="分模块构建 maven 工程分析"></a>分模块构建 maven 工程分析</h2><p>在现实生活中，汽车厂家进行汽车生产时，由于整个生产过程非常复杂和繁琐，工作量非常大，所以车场都会将整个汽车的部件分开生产，最终再将生产好的部件进行组装，形成一台完整的汽车：</p>
<p><img src="/2021/01/12/maven-modules/%E5%9B%BE%E7%89%8712.png" alt="1559550879535"></p>
<p>类似的，随着项目功能的增加，项目本身会变得越来越庞大，这个时候，代码的良好管理和规划就会变得很重要。为了提高效率，根据业务的不同将揉作一团的业务代码分离出来，业务划分上分割清晰，提高代码复用率，例如：</p>
<p><img src="/2021/01/12/maven-modules/%E5%9B%BE%E7%89%8713.png" alt="1559550904100"></p>
<p>上述功能的实现就是代码这一层级的变动，可以采用多项目模式和多模块模式：</p>
<ul>
<li>多项目：每个业务单独新建项目并编写相应逻辑</li>
<li>多模块：业务聚合在一个项目中的不同模块中，然后通过依赖调用实现业务逻辑</li>
</ul>
<h3 id="maven-工程的继承"><a href="#maven-工程的继承" class="headerlink" title="maven 工程的继承"></a>maven 工程的继承</h3><p>在 java 语言中，类之间是可以继承的，通过继承，子类就可以引用父类中非 private 的属性和方法。同样，在 maven 工程之间也可以继承，子工程继承父工程后，就可以使用在父工程中引入的依赖。继承的目的是为了消除重复代码。</p>
<p><img src="/2021/01/12/maven-modules/%E5%9B%BE%E7%89%8714.png" alt="1559550956068"></p>
<h3 id="maven-工程的聚合"><a href="#maven-工程的聚合" class="headerlink" title="maven 工程的聚合"></a>maven 工程的聚合</h3><p>在 maven 工程的 pom.xml 文件中，可以使用 <modules> 标签将其他 maven 工程聚合到一起，聚合的目的是为了进行统一操作。</modules></p>
<p>例如，拆分后的 maven 工程有多个，如果要进行打包，就需要针对每个工程分别执行打包命令，操作起来非常繁琐。这时就可以使用 <modules> 标签将这些工程统一聚合到 maven 工程中，需要打包的时候，只需要在此工程中执行一次打包命令，其下被聚合的工程就都会被打包了。</modules></p>
<p><img src="/2021/01/12/maven-modules/%E5%9B%BE%E7%89%8715.png" alt="1559551000245"></p>
<h2 id="分模块构建-maven-工程"><a href="#分模块构建-maven-工程" class="headerlink" title="分模块构建 maven 工程"></a>分模块构建 maven 工程</h2><h3 id="构建父模块"><a href="#构建父模块" class="headerlink" title="构建父模块"></a>构建父模块</h3><p>新建 maven 项目：</p>
<p><img src="/2021/01/12/maven-modules/image-20210113100427171.png" alt="image-20210113100427171"></p>
<p>保留 pom.xml 文件，删除 src 目录：</p>
<p><img src="/2021/01/12/maven-modules/image-20210113101242280.png" alt="image-20210113101242280"></p>
<h3 id="构建子模块"><a href="#构建子模块" class="headerlink" title="构建子模块"></a>构建子模块</h3><p>新建 module 1：</p>
<p><img src="/2021/01/12/maven-modules/image-20210113101550741.png" alt="image-20210113101550741"></p>
<p>新建 module 2：</p>
<p><img src="/2021/01/12/maven-modules/image-20210113101831549.png" alt="image-20210113101831549"></p>
<p>如果需要更多的模块，重复上述步骤。</p>
<h3 id="父模块-pom-配置"><a href="#父模块-pom-配置" class="headerlink" title="父模块 pom 配置"></a>父模块 pom 配置</h3><p>公用的 pom 配置，可以放在父模块的 pom.xml 文件中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.matgene.reaction-extractor-assistant<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reaction-extractor-assistant<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- parent必须使用pom格式打包并上传到仓库 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>patent-loader<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>consumer-log<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>consumer-reaction<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>consumer-timeout<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 全局版本管理 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">maven.compiler.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>$&#123;java.version&#125;<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>$&#123;java.version&#125;<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 全局依赖管理 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.danielwegener<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-kafka-appender<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.2.0-RC1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.json-lib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>json-lib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">classifier</span>&gt;</span>jdk15<span class="tag">&lt;/<span class="name">classifier</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.kafka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>kafka-clients<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;maven.compiler.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>$&#123;maven.compiler.source&#125;<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>$&#123;maven.compiler.target&#125;<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="子模块-pom-配置"><a href="#子模块-pom-配置" class="headerlink" title="子模块 pom 配置"></a>子模块 pom 配置</h3><p>子模块单独使用的 pom 配置，放在子模块自己的 pom.xml 文件中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reaction-extractor-assistant<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.matgene.reaction-extractor-assistant<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>patent-loader<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">app.main.class</span>&gt;</span>cn.matgene.patent.cn.matgene.patent.loader.PatentLoaderJob<span class="tag">&lt;/<span class="name">app.main.class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">createDependencyReducedPom</span>&gt;</span>false<span class="tag">&lt;/<span class="name">createDependencyReducedPom</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">transformer</span></span></span><br><span class="line"><span class="tag">                                        <span class="attr">implementation</span>=<span class="string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">manifestEntries</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">Main-Class</span>&gt;</span>$&#123;app.main.class&#125;<span class="tag">&lt;/<span class="name">Main-Class</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">X-Compile-Source-JDK</span>&gt;</span>$&#123;maven.compiler.source&#125;<span class="tag">&lt;/<span class="name">X-Compile-Source-JDK</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">X-Compile-Target-JDK</span>&gt;</span>$&#123;maven.compiler.target&#125;<span class="tag">&lt;/<span class="name">X-Compile-Target-JDK</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;/<span class="name">manifestEntries</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面构建的项目比较简单，各模块之间不存在依赖关系，同时，因为每个模块都需要打包，因此把打包的插件放在每一个子模块的 pom.xml 文件中。</p>
<h3 id="一个-spring-web-项目的实例"><a href="#一个-spring-web-项目的实例" class="headerlink" title="一个 spring web 项目的实例"></a>一个 spring web 项目的实例</h3><ol>
<li>父工程 maven_parent 构建</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.0.5.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">springmvc.version</span>&gt;</span>5.0.5.RELEASE<span class="tag">&lt;/<span class="name">springmvc.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--锁定jar版本--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springMVC --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;springmvc.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- spring --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>子工程 maven_pojo 构建</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>子工程 maven_dao 构建</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- maven_pojo的依赖 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven_pojo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- Mybatis和mybatis与spring的整合 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- MySql驱动 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.32<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- druid数据库连接池 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- spring相关 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- junit测试 --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>子工程 maven_service 构建</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- maven_dao的依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven_dao<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>子工程 maven_web 构建</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- maven_service的依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven_service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>maven_web<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginManagement</span>&gt;</span><span class="comment">&lt;!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-clean-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- see http://maven.apache.org/ref/current/maven-core/default-bindings.html#Plugin_bindings_for_war_packaging --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.22.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-install-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-deploy-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>项目整体结构如下：</li>
</ol>
<ol>
<li><p>maven_parent 为父工程，其余工程为子工程，都继承父工程 maven_parent；</p>
</li>
<li><p>maven_parent 工程将其子工程都进行了聚合 ；</p>
</li>
<li><p>子工程之间存在依赖关系，比如 maven_dao 依赖 maven_pojo，maven_service 依赖 maven_dao，maven_web 依赖 maven_service。</p>
</li>
</ol>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903970024980488">https://juejin.cn/post/6844903970024980488</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/tianlong/p/10552848.html">https://www.cnblogs.com/tianlong/p/10552848.html</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/11/linux-error/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/11/linux-error/" class="post-title-link" itemprop="url">linux 常见错误</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-01-11 14:49:11 / 修改时间：16:00:48" itemprop="dateCreated datePublished" datetime="2021-01-11T14:49:11+08:00">2021-01-11</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="No-space-left-on-device"><a href="#No-space-left-on-device" class="headerlink" title="No space left on device"></a>No space left on device</h2><p>有时候，在创建新文件，或者往磁盘写内容时，会提示 <code>No space left on device</code> 异常。</p>
<p>一般来说，linux 空间占满有如两种情况：</p>
<h3 id="空间占满"><a href="#空间占满" class="headerlink" title="空间占满"></a>空间占满</h3><p>通过 <code>df -h</code> 命令，查看空间的使用情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ df -h</span><br><span class="line">Filesystem                     Size  Used Avail Use% Mounted on</span><br><span class="line">udev                           3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs                          799M   82M  718M  11% /run</span><br><span class="line">/dev/mapper/lin--vg-root       491G  195G  272G  42% /</span><br><span class="line">tmpfs                          3.9G  8.0K  3.9G   1% /dev/shm</span><br><span class="line">tmpfs                          5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs                          3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1                      472M   58M  390M  13% /boot</span><br><span class="line">tmpfs                          799M     0  799M   0% /run/user/1000</span><br><span class="line">192.168.1.152:/mnt/chenlei      10T  5.0T  4.6T  53% /home/lin/share/storage_server_1</span><br><span class="line">192.168.1.236:/mnt              10T  9.0T  520G  95% /home/lin/share/storage_server_2</span><br><span class="line">192.168.1.106:/mnt              40T   24T   15T  63% /home/lin/share/storage_server_3</span><br><span class="line">192.168.1.102:/home/lin/share  491G  195G  272G  42% /tmp/share</span><br></pre></td></tr></table></figure>

<p>可以看出，各分区仍有较大的空间能够使用。如果某个分区的使用率达到了 100%，那也就无法再创建新文件，也无法再写入内容，需要删除一些文件。</p>
<h3 id="inode-占满"><a href="#inode-占满" class="headerlink" title="inode 占满"></a>inode 占满</h3><p>通过 <code>df -i</code> 命令，查看 inode 的使用情况。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ df -ih</span><br><span class="line">Filesystem                    Inodes IUsed IFree IUse% Mounted on</span><br><span class="line">udev                            993K   421  993K    1% /dev</span><br><span class="line">tmpfs                           998K   749  998K    1% /run</span><br><span class="line">/dev/mapper/lin--vg-root         32M  1.6M   30M    6% /</span><br><span class="line">tmpfs                           998K     2  998K    1% /dev/shm</span><br><span class="line">tmpfs                           998K     3  998K    1% /run/lock</span><br><span class="line">tmpfs                           998K    16  998K    1% /sys/fs/cgroup</span><br><span class="line">/dev/sda1                       122K   303  122K    1% /boot</span><br><span class="line">tmpfs                           998K     4  998K    1% /run/user/1000</span><br><span class="line">192.168.1.152:/mnt/chenlei      320M   42M  279M   13% /home/lin/share/storage_server_1</span><br><span class="line">192.168.1.236:/mnt              320M   69M  252M   22% /home/lin/share/storage_server_2</span><br><span class="line">192.168.1.106:/mnt              640M  641M    0M  100% /home/lin/share/storage_server_3</span><br><span class="line">192.168.1.102:/home/lin/share    32M  1.6M   30M    6% /tmp/share</span><br></pre></td></tr></table></figure>

<p>可以看出，每个分区都有一定大小的 inode 空间，但 <code>/home/lin/share/storage_server_3</code> 分区的 inode 空间使用率达到 100%。因此，再往此分区创建新文件或写入内容时，会提示  <code>No space left on device</code> 异常。</p>
<p>解决方法：将 <code>/home/lin/share/storage_server_3</code> 分区上一些不必要的文件删除。</p>
<blockquote>
<p>理解 inode，要从文件储存说起。</p>
<p>文件储存在硬盘上，硬盘的最小存储单位叫做 “扇区” (Sector)，每个扇区储存 512 字节 (相当于 0.5KB)。</p>
<p>操作系统读取硬盘的时候，不会一个个扇区地读取，这样效率太低，而是一次性连续读取多个扇区，即一次性读取一个 “块” (Block)。这种由多个扇区组成的 “块”，是文件存取的最小单位。”块” 的大小，最常见的是 4 KB，即连续八个 Sector 组成一个 Block。</p>
<p>文件数据都储存在 “块” 中，那么很显然，我们还必须找到一个地方储存文件的元信息，比如文件的创建者、文件的创建日期、文件的大小等等。这种储存文件元信息的区域就叫做 inode，中文译名为 “索引节点”。</p>
<p>每一个文件都有对应的 inode，里面包含了与该文件有关的一些信息。</p>
<p>某些时候，尽管一个分区的磁盘占用率未满，但是 inode 已经用完，可能是因为该分区的目录下存在大量小文件导致。尽管小文件占用的磁盘空间并不大，但是数量太多，也会导致 inode 用尽。本例中就是因为 <code>/home/lin/share/storage_server_3</code> 分区存在大量的小文件。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/06/java-log/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/06/java-log/" class="post-title-link" itemprop="url">java 的日志处理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-06 17:14:19" itemprop="dateCreated datePublished" datetime="2021-01-06T17:14:19+08:00">2021-01-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-12 15:26:56" itemprop="dateModified" datetime="2021-01-12T15:26:56+08:00">2021-01-12</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>16k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>14 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="常用日志处理工具"><a href="#常用日志处理工具" class="headerlink" title="常用日志处理工具"></a>常用日志处理工具</h2><p>常见的 log 日志处理工具有：log4j、Logging、commons-logging、slf4j、logback。其中，commons-loggin、slf4j 是一种日志抽象门面，不是具体的日志框架；log4j、logback 是具体的日志实现框架。</p>
<p><strong>一般使用 slf4j + logback 处理日志</strong>，也可以使用 slf4j + log4j、commons-logging + log4j 这两种日志组合框架。</p>
<h2 id="日志级别"><a href="#日志级别" class="headerlink" title="日志级别"></a>日志级别</h2><p>日志的输出都是分级别的，不同的场合设置不同的级别，以打印不同的日志。下面拿最普遍用的 log4j 日志框架来做个日志级别的说明，这个比较奇全，其他的日志框架也都大同小异。</p>
<p>log4j 的级别类 org.apache.log4j.Level 里面定义了日志级别，日志输出优先级由高到底分别为以下 8 种：</p>
<p><img src="/2021/01/06/java-log/165cb8810e985c1d" alt="img"></p>
<table>
<thead>
<tr>
<th>日志级别</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>OFF</td>
<td>关闭：最高级别，不输出日志。</td>
</tr>
<tr>
<td>FATAL</td>
<td>致命：输出非常严重的可能会导致应用程序终止的错误。</td>
</tr>
<tr>
<td>ERROR</td>
<td>错误：输出错误，但应用还能继续运行。</td>
</tr>
<tr>
<td>WARN</td>
<td>警告：输出可能潜在的危险状况。</td>
</tr>
<tr>
<td>INFO</td>
<td>信息：输出应用运行过程的详细信息。</td>
</tr>
<tr>
<td>DEBUG</td>
<td>调试：输出更细致的对调试应用有用的信息。</td>
</tr>
<tr>
<td>TRACE</td>
<td>跟踪：输出更细致的程序运行轨迹。</td>
</tr>
<tr>
<td>ALL</td>
<td>所有：输出所有级别信息。</td>
</tr>
</tbody></table>
<p>所以，日志优先级别标准顺序为：</p>
<p>ALL &lt; TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF</p>
<p>如果日志设置为 L ，一个级别为 P 的输出日志只有当 P &gt;= L 时日志才会输出。</p>
<p>即如果日志级别 L 设置 INFO，只有 P 的输出级别为 INFO、WARN，后面的日志才会正常输出。</p>
<p>具体的输出关系可以参考下图：</p>
<p><img src="/2021/01/06/java-log/165cb88312571bb0" alt="img"></p>
<h2 id="Lombok"><a href="#Lombok" class="headerlink" title="Lombok"></a>Lombok</h2><p>Lombok 是一种 java 实用工具，可用来帮助开发人员消除 java 的冗长代码，尤其是对于简单的 java 对象 (POJO)。它通过注释实现这一目的。</p>
<h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>IntelliJ 安装：</p>
<p><img src="/2021/01/06/java-log/16140d77d80ebc6f" alt="img"></p>
<blockquote>
<p>Lombok 是侵入性很高的一个 library。</p>
</blockquote>
<p>maven 添加依赖：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.18.10&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="注解说明"><a href="#注解说明" class="headerlink" title="注解说明"></a>注解说明</h3><p>常用注解：</p>
<p><img src="/2021/01/06/java-log/lombok_overview.png" alt="img"></p>
<ul>
<li><code>@Getter</code> 和 <code>@Setter</code></li>
</ul>
<p>自动生成 getter 和 setter 方法。</p>
<p><img src="/2021/01/06/java-log/lombok_getter_setter.png" alt="img"></p>
<ul>
<li><code>@ToString</code></li>
</ul>
<p>自动重写 <code>toString()</code> 方法，打印所有变量。也可以加其他参数，例如 <code>@ToString(exclude=”id”)</code> 排除 id 属性，或者 <code>@ToString(callSuper=true, includeFieldNames=true)</code> 调用父类的 <code>toString()</code> 方法，包含所有属性。</p>
<p><img src="/2021/01/06/java-log/lombok_tostring.png" alt="img"></p>
<ul>
<li><code>@EqualsAndHashCode</code></li>
</ul>
<p>自动生成 <code>equals(Object other)</code> 和 <code>hashcode()</code> 方法，包括所有非静态变量和非 transient 的变量。</p>
<p><img src="/2021/01/06/java-log/lombok_equalsandhashcode.png" alt="img"></p>
<p>如果某些变量不想要加进判断，可以通过 exclude 排除，也可以使用 of 指定某些字段：</p>
<p><img src="/2021/01/06/java-log/lombok_equalsandhashcode_exclude.png" alt="img"></p>
<blockquote>
<p>java 中规定，当两个 object equals 时，它们的 hashcode 一定要相同，反之，当 hashcode 相同时，object 不一定 equals。所以 equals 和 hashcode 要一起 implement，免得出现违反 java 规定的情形。</p>
</blockquote>
<ul>
<li><code>@NoArgsConstructor</code>，<code>@AllArgsConstructor</code>，<code>@RequiredArgsConstructor</code></li>
</ul>
<p>这三个很像，都是自动生成该类的 constructor，差別只在生成的 constructor 的参数不一样而已。</p>
<p><code>@NoArgsConstructor</code>：生成一个沒有参数的 constructor。</p>
<p><img src="/2021/01/06/java-log/lombok_noargsconstructor.png" alt="img"></p>
<blockquote>
<p>在 java 中，如果沒有指定类的 constructor，java compiler 会自动生成一个无参构造器，但是如果自己写了 constructor 之后，java 就不会再自动生成无参构造器。但是，很多时候，无参构造器是必须的，因此，为避免不必要的麻烦，应在类上至少加上 <code>@NoArgsConstrcutor</code>。</p>
</blockquote>
<p><code>@AllArgsConstructor</code> ：生成一个包含所有参数的 constructor。</p>
<p><img src="/2021/01/06/java-log/lombok_allargsconstructor.png" alt="img"></p>
<p><code>@RequiredArgsConstructor</code>：生成一个包含 “特定参数” 的 constructor，特定参数指的是那些有加上 final 修饰词的变量。</p>
<p><img src="/2021/01/06/java-log/lombok_requiredargsconstructor.png" alt="img"></p>
<blockquote>
<p>如果所有的变量都沒有用 final 修饰，<code>@RequiredArgsConstructor</code> 会生成一个沒有参数的 constructor。</p>
</blockquote>
<ul>
<li><code>@Data</code></li>
</ul>
<p>等于同时添加了以下注解：<code>@Getter</code>，<code>@Setter</code>，<code>@ToString</code>，<code>@EqualsAndHashCode</code> 和 <code>@RequiredArgsConstructor</code>。</p>
<p><img src="https://kucw.github.io/images/blog/lombok_data.png" alt="img"></p>
<ul>
<li><code>@Value</code></li>
</ul>
<p>把所有的变量都设成 final，其他的就跟 <code>@Data</code> 类似，等于同时添加了以下注解：<code>@Getter</code>，<code>@ToString</code>，<code>@EqualsAndHashCode</code> 和 <code>@RequiredArgsConstructor</code>。</p>
<p><img src="/2021/01/06/java-log/lombok_value.png" alt="img"></p>
<ul>
<li>@Builder</li>
</ul>
<p>自动生成流式 set 值写法。</p>
<p><img src="/2021/01/06/java-log/lombok_builder.png" alt="img"></p>
<p>注意，虽然只要加上 <code>@Builder</code> 注解，我们就能用流式写法快速设定 Object 的值，但是 setter 还是不应该舍弃的，因为 Spring 或是其他框架，有很多地方都会用到 Object 的 getter/setter 方法来对属性取值/赋值。</p>
<p>所以，通常是 <code>@Data</code> 和 <code>@Builder</code> 会一起用在同个类上，既方便流式写 code，也方便框架做事。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>@Slf4j</code></li>
</ul>
<p>自动生成该类的 log 静态常量，要打日志就可以直接打，不用再手动 new log 静态常量了。</p>
<p><img src="/2021/01/06/java-log/lombok_slf4j.png" alt="img"></p>
<p>除了 <code>@Slf4j</code> 之外，Lombok 也提供其他日志框架的几种注解，像是 <code>@Log</code>，<code>@Log4j</code> 等，他们都可以创建一个静态常量 log，只是使用的 library 不一样而已。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Log</span> <span class="comment">// 对应的log语句如下</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> java.util.logging.Logger log = java.util.logging.Logger.getLogger(LogExample.class.getName());</span><br><span class="line"></span><br><span class="line"><span class="meta">@Log4j</span> <span class="comment">// 对应的log语句如下</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> org.apache.log4j.Logger log = org.apache.log4j.Logger.getLogger(LogExample.class);</span><br></pre></td></tr></table></figure>

<p>更多的参考：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903557016076302">https://juejin.cn/post/6844903557016076302</a></p>
<h2 id="Logback"><a href="#Logback" class="headerlink" title="Logback"></a>Logback</h2><h3 id="引入-1"><a href="#引入-1" class="headerlink" title="引入"></a>引入</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>logback 依赖中，含有对 slf4j 的依赖。</p>
</blockquote>
<h3 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h3><p>configuration 为主节点，其主要字节点如下：</p>
<h4 id="property"><a href="#property" class="headerlink" title="property"></a>property</h4><p>定义变量值的标签，有两个属性，name 和 value，定义变量后，可以使 “${name}” 来使用变量。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;property name=<span class="string">&quot;logging.level&quot;</span> value=<span class="string">&quot;info&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<h4 id="appender"><a href="#appender" class="headerlink" title="appender"></a>appender</h4><p>日志打印的组件，定义打印过滤的条件、打印输出方式、滚动策略、编码方式、打印格式等。</p>
<p>种类：</p>
<ul>
<li><p>ConsoleAppender：把日志添加到控制台。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;appender name=<span class="string">&quot;STDOUT&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span><br><span class="line">   &lt;encoder charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">      &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-6level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">   &lt;/encoder&gt;</span><br><span class="line">&lt;/appender&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>FileAppender：把日志添加到文件。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;appender name=<span class="string">&quot;ReactionExtractorAppender&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span><br><span class="line">    &lt;append&gt;true&lt;/append&gt;</span><br><span class="line">    &lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br><span class="line">        &lt;level&gt;$&#123;logging.level&#125;&lt;/level&gt;</span><br><span class="line">    &lt;/filter&gt;</span><br><span class="line">    &lt;file&gt;</span><br><span class="line">        $&#123;logging.path&#125;/reaction-extractor.log</span><br><span class="line">    &lt;/file&gt;</span><br><span class="line">    &lt;encoder&gt;</span><br><span class="line">        &lt;pattern&gt;$&#123;message.format&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">    &lt;/encoder&gt;</span><br><span class="line">&lt;/appender&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>RollingFileAppender：FileAppender 的子类，滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;appender name=<span class="string">&quot;ReactionExtractorRollingAppender&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span><br><span class="line">    &lt;append&gt;true&lt;/append&gt;</span><br><span class="line">    &lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br><span class="line">        &lt;level&gt;$&#123;logging.level&#125;&lt;/level&gt;</span><br><span class="line">    &lt;/filter&gt;</span><br><span class="line">    &lt;rollingPolicy <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span><br><span class="line">        &lt;FileNamePattern&gt;$&#123;logging.path&#125;/reaction-extractork-%d&#123;yyyy-MM-dd&#125;.log&lt;/FileNamePattern&gt;</span><br><span class="line">        &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;</span><br><span class="line">    &lt;/rollingPolicy&gt;</span><br><span class="line">    &lt;encoder&gt;</span><br><span class="line">        &lt;pattern&gt;$&#123;message.format&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">    &lt;/encoder&gt;</span><br><span class="line">&lt;/appender&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>属性：</p>
<ul>
<li><p>name：指定 appender 的名称。</p>
</li>
<li><p>class：指定 appender 的全限定名。</p>
</li>
</ul>
<p>子节点：</p>
<ul>
<li><p>append：默认为 true，表示日志被追加到文件结尾，如果是 false，清空现存文件。</p>
</li>
<li><p>filter：过滤器，执行完一个过滤器后返回 DENY，NEUTRAL，ACCEPT 三个枚举值中的一个。</p>
<p>filter 的返回值含义：</p>
<ol>
<li>DENY：日志将立即被抛弃不再经过其他过滤器。</li>
<li>NEUTRAL：有序列表里的下个过滤器过接着处理日志。</li>
<li>ACCEPT：日志会被立即处理，不再经过剩余过滤器。</li>
</ol>
<p>filter 的两种类型：</p>
<ol>
<li><p>ThresholdFilter：临界值过滤器，过滤掉低于指定临界值的日志。当日志级别等于或高于临界值时，过滤器返回 NEUTRAL，当日志级别低于临界值时，日志会被拒绝。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br><span class="line">   &lt;level&gt;INFO&lt;/level&gt;</span><br><span class="line">&lt;/filter&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>LevelFilter：级别过滤器，根据日志级别进行过滤。如果日志级别等于配置级别，过滤器会根据 onMath (用于配置符合过滤条件的操作) 和 onMismatch (用于配置不符合过滤条件的操作) 接收或拒绝日志。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;   </span><br><span class="line">   &lt;level&gt;INFO&lt;/level&gt;   </span><br><span class="line">   &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt;   </span><br><span class="line">   &lt;onMismatch&gt;DENY&lt;/onMismatch&gt;   </span><br><span class="line">&lt;/filter&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>file：指定被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。</p>
</li>
<li><p>rollingPolicy：滚动策略，只有 appender 的 class 是 RollingFileAppender 时才需要配置。</p>
<ol>
<li><p>TimeBasedRollingPolicy：根据时间来制定滚动策略，既负责滚动也负责触发滚动。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;rollingPolicy <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span><br><span class="line">   &lt;!-- 日志文件输出的文件名：按天回滚 daily --&gt;</span><br><span class="line">   &lt;FileNamePattern&gt;</span><br><span class="line">       $&#123;logging.path&#125;/glmapper-spring-boot/glmapper-loggerone.log.%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;</span><br><span class="line">   &lt;/FileNamePattern&gt;</span><br><span class="line">   &lt;!-- 日志文件保留天数 --&gt;</span><br><span class="line">   &lt;MaxHistory&gt;30&lt;/MaxHistory&gt;</span><br><span class="line">&lt;/rollingPolicy&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>每天生成一个日志文件，日志文件保存 30 天。</p>
</blockquote>
</li>
<li><p>FixedWindowRollingPolicy：根据固定窗口算法重命名文件的滚动策略。</p>
</li>
</ol>
</li>
<li><p>encoder：对记录事件进行格式化。主要作用是：把日志信息转换成字节数组，以及把字节数组写入到输出流。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;encoder <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span><br><span class="line">   &lt;!-- 格式化输出：%d表示日期；%thread表示线程名；%-<span class="number">5l</span>evel：级别从左显示<span class="number">5</span>个字符宽度；%logger&#123;<span class="number">50</span>&#125; 表示logger名字最长<span class="number">50</span>个字符，否则按照句点分割；%msg：日志消息；%n是换行符 --&gt;</span><br><span class="line">   &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">   &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">&lt;/encoder&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="logger"><a href="#logger" class="headerlink" title="logger"></a>logger</h4><p>用来设置某一个包或者具体的某一个类的日志打印级别以及指定 appender。</p>
<p>属性：</p>
<ul>
<li>name：指定受此 logger 约束的某一个包或者具体的某一个类。</li>
<li>level：设置打印级别 (TRACE，DEBUG，INFO，WARN，ERROR，ALL 和 OFF)，还有一个值 INHERITED 或者同义词 NULL，代表强制执行上级的级别。如果没有设置此属性，那么当前 logger 将会继承上级的级别。</li>
<li>addtivity：设置是否向上级 logger 传递打印信息，默认为 true。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;logger name=<span class="string">&quot;com.glmapper.spring.boot.controller&quot;</span> level=<span class="string">&quot;$&#123;logging.level&#125;&quot;</span> additivity=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">    &lt;appender-ref ref=<span class="string">&quot;GLMAPPER-LOGGERONE&quot;</span> /&gt;</span><br><span class="line">&lt;/logger&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>com.glmapper.spring.boot.controller 这个包下的 ${logging.level} 级别的日志将会使用 GLMAPPER-LOGGERONE 来打印。</p>
</blockquote>
<h4 id="root"><a href="#root" class="headerlink" title="root"></a>root</h4><p>根 logger，也是一种 logger，但只有一个 level 属性。</p>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用说明：</span><br><span class="line">        <span class="number">1.</span> logback核心jar包：logback-core-<span class="number">1.2</span>.<span class="number">3.</span>jar，logback-classic-<span class="number">1.2</span>.<span class="number">3.</span>jar，slf4j-api-<span class="number">1.7</span>.<span class="number">25.</span>jar</span><br><span class="line">            <span class="number">1</span>) logback官方建议配合slf4j使用</span><br><span class="line">            <span class="number">2</span>) logback手动下载地址：https:<span class="comment">//repo1.maven.org/maven2/ch/qos/logback/</span></span><br><span class="line">            <span class="number">3</span>) slf4j手动下载地址：https:<span class="comment">//www.mvnjar.com/org.slf4j/slf4j-api/1.7.25/detail.html</span></span><br><span class="line">            <span class="number">4</span>) jar包可以从maven仓库快速获取</span><br><span class="line">        <span class="number">2.</span> logback分为<span class="number">3</span>个组件：logback-core，logback-classic和logback-access</span><br><span class="line">            <span class="number">1</span>) 其中logback-core提供了logback的核心功能，是另外两个组件的基础</span><br><span class="line">            <span class="number">2</span>) logback-classic实现了slf4j的API，所以当想配合slf4j使用时，需要将logback-classic加入classpath</span><br><span class="line">            <span class="number">3</span>) logback-access是为了集成servlet环境而准备的，可提供HTTP-access的日志接口</span><br><span class="line">        <span class="number">3.</span> 配置中KafkaAppender的jar包：logback-kafka-appender-<span class="number">0.2</span>.<span class="number">0</span>-RC1.jar</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 参考：</span><br><span class="line">        https:<span class="comment">//juejin.im/post/5b51f85c5188251af91a7525</span></span><br><span class="line">        https:<span class="comment">//my.oschina.net/Declan/blog/1793444</span></span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 说明：logback.xml配置文件，需放置在项目的resources路径下 --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- configuration属性：</span><br><span class="line">        scan：热加载，当此属性设置为<span class="keyword">true</span>时，配置文件如果发生改变，将会被重新加载，默认值为<span class="keyword">true</span></span><br><span class="line">        scanPeriod：设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为<span class="keyword">true</span>时，此属性生效。默认的时间间隔为<span class="number">1</span>分钟</span><br><span class="line">        debug：当此属性设置为<span class="keyword">true</span>时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为<span class="keyword">false</span></span><br><span class="line">        packagingData：是否打印包的信息。默认值为<span class="keyword">false</span></span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;configuration</span><br><span class="line">        debug=<span class="string">&quot;false&quot;</span></span><br><span class="line">        xmlns=<span class="string">&quot;http://ch.qos.logback/xml/ns/logback&quot;</span></span><br><span class="line">        xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">        xsi:schemaLocation=<span class="string">&quot;http://ch.qos.logback/xml/ns/logback</span></span><br><span class="line"><span class="string">        https://raw.githubusercontent.com/enricopulatzo/logback-XSD/master/src/main/xsd/logback.xsd&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">    &lt;!-- property：定义变量值，两个属性，name和value --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;logging.path&quot;</span> value=<span class="string">&quot;./&quot;</span>/&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;logging.level&quot;</span> value=<span class="string">&quot;INFO&quot;</span>/&gt;</span><br><span class="line">    &lt;!-- 日志格式化：</span><br><span class="line">            %d：日期</span><br><span class="line">            %thread：线程名</span><br><span class="line">            %-<span class="number">5l</span>evel：日志级别，从左显示<span class="number">5</span>个字符宽度</span><br><span class="line">            %logger&#123;<span class="number">50</span>&#125;：logger名字最长<span class="number">50</span>个字符，超过的按照句点分割</span><br><span class="line">            %msg：日志消息</span><br><span class="line">            %n：换行符</span><br><span class="line">            %ex&#123;full, DISPLAY_EX_EVAL&#125;：异常信息，full表示全输出，可以替换为异常信息指定输出的行数</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;message.format&quot;</span></span><br><span class="line">              value=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n%ex&#123;full, DISPLAY_EX_EVAL&#125;&quot;</span>/&gt;</span><br><span class="line">    &lt;!-- kafka topic --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;topic.name&quot;</span> value=<span class="string">&quot;log-collect&quot;</span>/&gt;</span><br><span class="line">    &lt;!-- 本地地址 --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;bootstrap.servers&quot;</span> value=<span class="string">&quot;192.168.1.71:9092&quot;</span>/&gt;</span><br><span class="line">    &lt;!-- 集群地址 --&gt;</span><br><span class="line">    &lt;!-- &lt;property name=<span class="string">&quot;bootstrap.servers&quot;</span> value=<span class="string">&quot;hadoopdatanode1:9092,hadoopdatanode2:9092,hadoopdatanode3:9092&quot;</span>/&gt; --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- appender种类：</span><br><span class="line">            ConsoleAppender：把日志添加到控制台</span><br><span class="line">            FileAppender：把日志添加到文件</span><br><span class="line">            RollingFileAppender：滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件。FileAppender的子类</span><br><span class="line">    --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 控制台输出日志 --&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;STDOUT&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">            &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 自定义输出日志到文件 --&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;FileAppender&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span><br><span class="line">        &lt;!-- append：<span class="keyword">true</span>，日志被追加到文件结尾；<span class="keyword">false</span>，清空现存文件；默认是<span class="keyword">true</span> --&gt;</span><br><span class="line">        &lt;append&gt;true&lt;/append&gt;</span><br><span class="line">        &lt;!-- 级别过滤器：</span><br><span class="line">                ThresholdFilter：临界值过滤器，过滤掉低于指定临界值的日志</span><br><span class="line">                LevelFilter：级别过滤器，需配置onMatch和onMismatch</span><br><span class="line">        --&gt;</span><br><span class="line">        &lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br><span class="line">            &lt;level&gt;$&#123;logging.level&#125;&lt;/level&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;file&gt;</span><br><span class="line">            $&#123;logging.path&#125;/base.log</span><br><span class="line">        &lt;/file&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;message.format&#125;&lt;/pattern&gt;</span><br><span class="line">            &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 自定义异常输出日志文件 --&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;ErrorFileAppender&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span><br><span class="line">        &lt;append&gt;true&lt;/append&gt;</span><br><span class="line">        &lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br><span class="line">            &lt;level&gt;$&#123;logging.level&#125;&lt;/level&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;file&gt;</span><br><span class="line">            $&#123;logging.path&#125;/error-file.log</span><br><span class="line">        &lt;/file&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;message.format&#125;&lt;/pattern&gt;</span><br><span class="line">            &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 自定义输出日志：滚动记录日志 --&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;RollingFileAppender&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span><br><span class="line">        &lt;append&gt;true&lt;/append&gt;</span><br><span class="line">        &lt;filter <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br><span class="line">            &lt;level&gt;$&#123;logging.level&#125;&lt;/level&gt;</span><br><span class="line">        &lt;/filter&gt;</span><br><span class="line">        &lt;!-- 滚动策略：每天生成一个日志文件，保存<span class="number">365</span>天的日志文件 --&gt;</span><br><span class="line">        &lt;rollingPolicy <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span><br><span class="line">            &lt;!-- 日志文件输出的文件名：按天回滚 daily --&gt;</span><br><span class="line">            &lt;FileNamePattern&gt;$&#123;logging.path&#125;/reaction-log-%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;.log&lt;/FileNamePattern&gt;</span><br><span class="line">            &lt;!-- 日志文件保留天数 --&gt;</span><br><span class="line">            &lt;MaxHistory&gt;365&lt;/MaxHistory&gt;</span><br><span class="line">        &lt;/rollingPolicy&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;message.format&#125;&lt;/pattern&gt;</span><br><span class="line">            &lt;charset&gt;UTF-8&lt;/charset&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">        &lt;!-- 日志文件最大的大小 --&gt;</span><br><span class="line">        &lt;triggeringPolicy <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;</span>&gt;</span><br><span class="line">            &lt;MaxFileSize&gt;50MB&lt;/MaxFileSize&gt;</span><br><span class="line">        &lt;/triggeringPolicy&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 输出日志到kafka，参考：https:<span class="comment">//github.com/danielwegener/logback-kafka-appender --&gt;</span></span><br><span class="line">    &lt;appender name=<span class="string">&quot;KafkaAppender&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.github.danielwegener.logback.kafka.KafkaAppender&quot;</span>&gt;</span><br><span class="line">        &lt;encoder&gt;</span><br><span class="line">            &lt;pattern&gt;$&#123;message.format&#125;&lt;/pattern&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">        &lt;topic&gt;$&#123;topic.name&#125;&lt;/topic&gt;</span><br><span class="line">        &lt;keyingStrategy <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.github.danielwegener.logback.kafka.keying.NoKeyKeyingStrategy&quot;</span>/&gt;</span><br><span class="line">        &lt;deliveryStrategy <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.github.danielwegener.logback.kafka.delivery.AsynchronousDeliveryStrategy&quot;</span>/&gt;</span><br><span class="line">        &lt;!-- Optional parameter to use a fixed partition --&gt;</span><br><span class="line">        &lt;!-- &lt;partition&gt;0&lt;/partition&gt; --&gt;</span><br><span class="line">        &lt;!-- Optional parameter to include log timestamps into the kafka message --&gt;</span><br><span class="line">        &lt;!-- &lt;appendTimestamp&gt;true&lt;/appendTimestamp&gt; --&gt;</span><br><span class="line">        &lt;!-- each &lt;producerConfig&gt; translates to regular kafka-<span class="function">client <span class="title">config</span> <span class="params">(format: key=value)</span> --&gt;</span></span><br><span class="line"><span class="function">        &lt;!-- producer configs are documented here: https:<span class="comment">//kafka.apache.org/documentation.html#newproducerconfigs --&gt;</span></span></span><br><span class="line"><span class="function">        &lt;!-- bootstrap.servers is the only mandatory producerConfig --&gt;</span></span><br><span class="line">        &lt;producerConfig&gt;bootstrap.servers=$&#123;bootstrap.servers&#125;&lt;/producerConfig&gt;</span><br><span class="line">        &lt;!-- <span class="keyword">this</span> is the fallback appender <span class="keyword">if</span> kafka is not available. --&gt;</span><br><span class="line">        &lt;appender-ref ref=<span class="string">&quot;FileAppender&quot;</span>/&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 异步输出日志</span><br><span class="line">            步骤：异步输出日志就是Logger.info负责往Queue(BlockingQueue)中放日志，然后再起个线程把Queue中的日志写到磁盘上</span><br><span class="line">            参考：https:<span class="comment">//blog.csdn.net/lkforce/article/details/76637071</span></span><br><span class="line">     --&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;ASYNC&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.AsyncAppender&quot;</span>&gt;</span><br><span class="line">        &lt;!-- 不丢失日志。默认的，如果队列的<span class="number">80</span>%已满，则会丢弃TRACT、DEBUG、INFO级别的日志 --&gt;</span><br><span class="line">        &lt;discardingThreshold&gt;0&lt;/discardingThreshold&gt;</span><br><span class="line">        &lt;!-- 更改默认的队列的深度，该值会影响性能。默认值为<span class="number">256</span> --&gt;</span><br><span class="line">        &lt;queueSize&gt;100&lt;/queueSize&gt;</span><br><span class="line">        &lt;!-- 添加附加的appender，最多只能添加一个，此处指定后，在root下不要再指定该appender，否则会输出两次 --&gt;</span><br><span class="line">        &lt;appender-ref ref=<span class="string">&quot;KafkaAppender&quot;</span>/&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--日志异步到数据库：未做测试，配置正确与否未知，先记录于此 --&gt;</span><br><span class="line">    &lt;!--&lt;appender name=<span class="string">&quot;DB&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.classic.db.DBAppender&quot;</span>&gt;</span><br><span class="line">        &lt;connectionSource <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;ch.qos.logback.core.db.DriverManagerConnectionSource&quot;</span>&gt;</span><br><span class="line">            &lt;dataSource <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span><br><span class="line">                &lt;driverClass&gt;com.mysql.jdbc.Driver&lt;/driverClass&gt;</span><br><span class="line">                &lt;url&gt;jdbc:mysql:<span class="comment">//127.0.0.1:3306/databaseName&lt;/url&gt;</span></span><br><span class="line">                &lt;user&gt;root&lt;/user&gt;</span><br><span class="line">                &lt;password&gt;root&lt;/password&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/connectionSource&gt;</span><br><span class="line">    &lt;/appender&gt;--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 关闭指定包下的日志输出，name里面的内容可以是包路径，或者具体要忽略的文件名称 --&gt;</span><br><span class="line">    &lt;logger name=<span class="string">&quot;org.apache.flink&quot;</span> level=<span class="string">&quot;OFF&quot;</span>/&gt;</span><br><span class="line">    &lt;!-- 将指定包下指定级别的日志，输出到指定的appender中</span><br><span class="line">            addtivity：是否向上级logger传递打印信息。默认是<span class="keyword">true</span>。若此包下的日志单独输出到文件中，应设置为<span class="keyword">false</span>，否则在root日志也会记录一遍 --&gt;</span><br><span class="line">    &lt;logger name=<span class="string">&quot;org.apache.kafka&quot;</span> level=<span class="string">&quot;ERROR&quot;</span> addtivity=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">        &lt;!-- 指定此包下的error级别信息，输出到指定的收集文件 --&gt;</span><br><span class="line">        &lt;appender-ref ref=<span class="string">&quot;ErrorFileAppender&quot;</span>/&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line"></span><br><span class="line">    &lt;root level=<span class="string">&quot;$&#123;logging.level&#125;&quot;</span>&gt;</span><br><span class="line">        &lt;!--&lt;appender-ref ref=<span class="string">&quot;STDOUT&quot;</span>/&gt;--&gt;</span><br><span class="line">        &lt;!--&lt;appender-ref ref=<span class="string">&quot;FileAppender&quot;</span>/&gt;--&gt;</span><br><span class="line">        &lt;appender-ref ref=<span class="string">&quot;ASYNC&quot;</span>/&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>根据实际情况，对 appender 进行取舍，实际使用时不要所有的都添加到 logback.xml 配置文件中。</p>
</blockquote>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://kucw.github.io/blog/2020/3/java-lombok/">https://kucw.github.io/blog/2020/3/java-lombok/</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903641535479821">https://juejin.cn/post/6844903641535479821</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/03/hadoop-hdfs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/03/hadoop-hdfs/" class="post-title-link" itemprop="url">hadoop-hdfs</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-03 21:59:31" itemprop="dateCreated datePublished" datetime="2021-01-03T21:59:31+08:00">2021-01-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-05 15:30:50" itemprop="dateModified" datetime="2021-01-05T15:30:50+08:00">2021-01-05</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>764</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="HDFS-常用-shell-命令"><a href="#HDFS-常用-shell-命令" class="headerlink" title="HDFS 常用 shell 命令"></a>HDFS 常用 shell 命令</h2><p>操作 HDFS 的 shell命令有三种：</p>
<ol>
<li>hadoop fs：适用于任何不同的文件系统，比如本地文件系统和 HDFS 文件系统。</li>
<li>hadoop dfs：只适用于 HDFS 文件系统。</li>
<li>hdfs dfs：只适用于 HDFS 文件系统。</li>
</ol>
<blockquote>
<p>官方不推荐使用第二种命令 hadoop dfs，有些 Hadoop 版本中已将这种命令弃用。</p>
</blockquote>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs [genericOptions] [commandOptions]</span><br></pre></td></tr></table></figure>

<h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><table>
<thead>
<tr>
<th>HDFS 常用命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>hadoop fs -ls</strong></td>
<td><strong>显示指定文件的详细信息</strong></td>
</tr>
<tr>
<td>hadoop fs -cat</td>
<td>将指定文件的内容输出到标准输出</td>
</tr>
<tr>
<td>hadoop fs touchz</td>
<td>创建一个指定的空文件</td>
</tr>
<tr>
<td><strong>hadoop fs -mkdir [-p]</strong></td>
<td><strong>创建指定的一个或多个文件夹，-p 选项用于递归创建</strong></td>
</tr>
<tr>
<td><strong>hadoop fs -cp</strong></td>
<td><strong>将文件从源路径复制到目标路径</strong></td>
</tr>
<tr>
<td>hadoop fs -mv</td>
<td>将文件从源路径移动到目标路径</td>
</tr>
<tr>
<td><strong>hadoop fs -rm</strong></td>
<td><strong>删除指定的文件，只删除非空目录和文件</strong></td>
</tr>
<tr>
<td>hadoop fs -rm -r</td>
<td>删除指定的文件夹及其下的所有文件，-r 表示递归删除子目录</td>
</tr>
<tr>
<td>hadoop fs -chown</td>
<td>改变指定文件的所有者，该命令仅适用于超级用户</td>
</tr>
<tr>
<td>hadoop fs -chmod</td>
<td>将指定的文件权限更改为可执行文件，该命令仅适用于超级用户和文件所有者</td>
</tr>
<tr>
<td><strong>hadoop fs -get</strong></td>
<td><strong>复制指定的文件到本地文件系统指定的文件或文件夹</strong></td>
</tr>
<tr>
<td><strong>hadoop fs -put</strong></td>
<td><strong>从本地文件系统中复制指定的单个或多个源文件到指定的目标文件系统</strong></td>
</tr>
<tr>
<td>hadoop fs -moveFromLocal</td>
<td>与 -put 命令功能相同，但是文件上传结束后会删除源文件</td>
</tr>
<tr>
<td>hadoop fs -copyFromLocal</td>
<td>与 -put 命令功能相同，将本地源文件复制到路径指定的文件或文件夹中</td>
</tr>
<tr>
<td>hadoop fs -copyToLocal</td>
<td>与 -get命令功能相同，将目标文件复制到本地文件或文件夹中</td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/01/java-threadpool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/01/java-threadpool/" class="post-title-link" itemprop="url">java 线程池</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-01 19:44:47" itemprop="dateCreated datePublished" datetime="2021-01-01T19:44:47+08:00">2021-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-12 17:20:16" itemprop="dateModified" datetime="2021-01-12T17:20:16+08:00">2021-01-12</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="线程池的理解"><a href="#线程池的理解" class="headerlink" title="线程池的理解"></a>线程池的理解</h2><p>线程池是预先创建线程的一种技术，线程池在还没有任务到来之前，事先创建一定数量的线程，放入空闲队列中，然后对这些资源进行复用，从而减少频繁的创建和销毁对象。</p>
<p>系统启动一个新线程的成本是比较高的，因为它涉及与操作系统交互。在这种情形下，使用线程池可以很好地提高性能，尤其是当程序中需要创建大量生存期很短暂的线程时，更应该考虑使用线程池。</p>
<p>与数据库连接池类似的是，线程池在系统启动时即创建大量空闲的线程，程序将一个 Runnable 对象或 Callable 对象传给线程池，线程池就会启动一个线程来执行它们的 <code>run()</code> 或 <code>call()</code> 方法， 当 <code>run()</code> 或 <code>call()</code> 方法执行结束后， 该线程并不会死亡，而是再次返回线程池中成为空闲状态，等待执行下一个 Runnable 对象的 <code>run()</code> 或 <code>call()</code> 方法。</p>
<p>总结：由于系统创建和销毁线程都是需要时间和系统资源开销，为了提高性能，才考虑使用线程池。线程池会在系统启动时就创建大量的空闲线程，然后等待新的线程调用，线程执行结束并不会销毁，而是重新进入线程池，等待再次被调用。这样子就可以减少系统创建启动和销毁线程的时间，提高系统的性能。</p>
<h2 id="线程池的使用"><a href="#线程池的使用" class="headerlink" title="线程池的使用"></a>线程池的使用</h2><h3 id="使用-Executors-创建线程池"><a href="#使用-Executors-创建线程池" class="headerlink" title="使用 Executors 创建线程池"></a>使用 Executors 创建线程池</h3><p><img src="/2021/01/01/java-threadpool/diagram.png"></p>
<p>Executor 是线程池的顶级接口，接口中只定义了一个方法 <code>void execute(Runnable command);</code>，线程池的操作方法都是定义在 ExecutorService 子接口中的，所以说 ExecutorService 是线程池真正的接口。</p>
<h4 id="newSingleThreadExecutor"><a href="#newSingleThreadExecutor" class="headerlink" title="newSingleThreadExecutor"></a>newSingleThreadExecutor</h4><p>创建一个单线程的线程池。这个线程池只有一个线程在工作，也就是相当于单线程串行执行所有任务。如果这个唯一的线程因为异常结束，那么会有一个新的线程替代它。此线程池保证所有任务的执行顺序按照任务的提交顺序执行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService</span><br><span class="line">        (<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                                <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="newFixedThreadPool"><a href="#newFixedThreadPool" class="headerlink" title="newFixedThreadPool"></a>newFixedThreadPool</h4><p>创建固定大小的线程池，每次提交一个任务就创建一个线程，直到线程达到线程池的最大大小。线程池的大小一旦达到是大值就会保持不变。如果某个线程因为执行异常而结束，那么线程池会补充一个新线程。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads, ThreadFactory threadFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),</span><br><span class="line">                                  threadFactory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="newCachedThreadPool"><a href="#newCachedThreadPool" class="headerlink" title="newCachedThreadPool"></a>newCachedThreadPool</h4><p>创建一个可缓存的线程池。如果线程池的大小超过了处理任务所需要的线程，那么就会回收部分空闲 (60 秒不执行任务) 的线程。当任务数增加时，此线程池又可以智能的添加新线程来处理任务。此线程池不会对钱程池大小做限制，线程池大小完全依赖于操作系统 (或者说 JVM)  能够创建的最大线程大小。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用-ThreadPoolExecutor-创建线程池"><a href="#使用-ThreadPoolExecutor-创建线程池" class="headerlink" title="使用 ThreadPoolExecutor 创建线程池"></a>使用 ThreadPoolExecutor 创建线程池</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> maximumPoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">long</span> keepAliveTime,</span></span></span><br><span class="line"><span class="function"><span class="params">                          TimeUnit unit,</span></span></span><br><span class="line"><span class="function"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span></span><br><span class="line"><span class="function"><span class="params">                          ThreadFactory threadFactory,</span></span></span><br><span class="line"><span class="function"><span class="params">                          RejectedExecutionHandler handler)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt; corePoolSize ||</span><br><span class="line">        keepAliveTime &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">    <span class="keyword">if</span> (workQueue == <span class="keyword">null</span> || threadFactory == <span class="keyword">null</span> || handler == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    <span class="keyword">this</span>.acc = System.getSecurityManager() == <span class="keyword">null</span> ?</span><br><span class="line">            <span class="keyword">null</span> :</span><br><span class="line">            AccessController.getContext();</span><br><span class="line">    <span class="keyword">this</span>.corePoolSize = corePoolSize;</span><br><span class="line">    <span class="keyword">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class="line">    <span class="keyword">this</span>.workQueue = workQueue;</span><br><span class="line">    <span class="keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class="line">    <span class="keyword">this</span>.threadFactory = threadFactory;</span><br><span class="line">    <span class="keyword">this</span>.handler = handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="构造函数参数说明"><a href="#构造函数参数说明" class="headerlink" title="构造函数参数说明"></a>构造函数参数说明</h4><p><strong>corePoolSize：</strong>核心线程数大小，当线程数小于 corePoolSize 的时候，会创建线程执行 runnable。</p>
<p><strong>maximumPoolSize：</strong>最大线程数， 当线程数大于等于 corePoolSize 的时候，会把 runnable 放入 workQueue 中。</p>
<p><strong>keepAliveTime：</strong>保持存活时间，当线程数大于 corePoolSize 的时候，空闲线程能保持的最大时间。</p>
<p><strong>unit：</strong>时间单位。</p>
<p><strong>workQueue：</strong>保存任务的阻塞队列。</p>
<p><strong>threadFactory：</strong>创建线程的工厂。</p>
<p><strong>handler：</strong>拒绝策略。</p>
<h4 id="任务执行顺序"><a href="#任务执行顺序" class="headerlink" title="任务执行顺序"></a>任务执行顺序</h4><ul>
<li><p>当线程数小于 corePoolSize 时，创建线程执行新任务。</p>
</li>
<li><p>当线程数大于等于 corePoolSize，并且 workQueue 没有满时，新任务放入 workQueue 中。</p>
</li>
<li><p>当线程数大于等于 corePoolSize，并且 workQueue 满时，新任务创建新线程运行，但线程总数要小于 maximumPoolSize。</p>
</li>
<li><p>当线程总数等于 maximumPoolSize，并且 workQueue 满时，执行 handler 的 rejectedExecution，也就是拒绝策略。</p>
</li>
</ul>
<p><img src="/2021/01/01/java-threadpool/20200709102721415.png" alt="img"></p>
<h4 id="阻塞队列"><a href="#阻塞队列" class="headerlink" title="阻塞队列"></a>阻塞队列</h4><p>阻塞队列是一个在队列基础上又支持了两个附加操作的队列：</p>
<ol>
<li>支持阻塞的<strong>插入</strong>方法：队列满时，队列会阻塞插入元素的线程，直到队列不满。</li>
<li>支持阻塞的<strong>移除</strong>方法：队列空时，获取元素的线程会等待队列变为非空。</li>
</ol>
<h5 id="阻塞队列的应用场景"><a href="#阻塞队列的应用场景" class="headerlink" title="阻塞队列的应用场景"></a>阻塞队列的应用场景</h5><p>阻塞队列常用于生产者和消费者的场景，生产者是向队列里添加元素的线程，消费者是从队列里取元素的线程。简而言之，阻塞队列是生产者用来存放元素、消费者获取元素的容器。</p>
<h5 id="阻塞队列的方法"><a href="#阻塞队列的方法" class="headerlink" title="阻塞队列的方法"></a>阻塞队列的方法</h5><p>在阻塞队列不可用的时候，上述两个附加操作提供了四种处理方法：</p>
<table>
<thead>
<tr>
<th>方法处理方式</th>
<th>抛出异常</th>
<th>返回特殊值</th>
<th>一直阻塞</th>
<th>超时退出</th>
</tr>
</thead>
<tbody><tr>
<td>插入方法</td>
<td>add(e)</td>
<td>offer(e)</td>
<td>put(e)</td>
<td>offer(e,time,unit)</td>
</tr>
<tr>
<td>移除方法</td>
<td>remove()</td>
<td>poll()</td>
<td>take()</td>
<td>poll(time,unit)</td>
</tr>
<tr>
<td>检查方法</td>
<td>element()</td>
<td>peek()</td>
<td>不可用</td>
<td>不可用</td>
</tr>
</tbody></table>
<h5 id="阻塞队列的类型"><a href="#阻塞队列的类型" class="headerlink" title="阻塞队列的类型"></a>阻塞队列的类型</h5><p>jdk 7 提供了 7 个阻塞队列，如下：</p>
<ol>
<li><strong>ArrayBlockingQueue：</strong>数组结构组成的有界阻塞队列。</li>
</ol>
<p>此队列按照先进先出 (FIFO) 的原则对元素进行排序，但是默认情况下不保证线程公平的访问队列，即如果队列满了，那么被阻塞在外面的线程对队列访问的顺序是不能保证线程公平 (即先阻塞，先插入) 的。</p>
<ol start="2">
<li><strong>LinkedBlockingQueue：</strong>一个由链表结构组成的有界阻塞队列。</li>
</ol>
<p>此队列按照先出先进的原则对元素进行排序。</p>
<ol start="3">
<li><p><strong>PriorityBlockingQueue：</strong>支持优先级的无界阻塞队列。</p>
</li>
<li><p><strong>DelayQueue：</strong>支持延时获取元素的无界阻塞队列，即可以指定多久才能从队列中获取当前元素。</p>
</li>
<li><p><strong>SynchronousQueue：</strong>不存储元素的阻塞队列，每一个 put 必须等待一个 take 操作，否则不能继续添加元素。并且他支持公平访问队列。</p>
</li>
<li><p><strong>LinkedTransferQueue：</strong>由链表结构组成的无界阻塞 TransferQueue 队列。</p>
</li>
</ol>
<p>相对于其他阻塞队列，多了 tryTransfer 和 transfer 方法：</p>
<p><strong>transfer方法：</strong>如果当前有消费者正在等待接收元素 (take 或者待时间限制的 poll 方法)，transfer 可以把生产者传入的元素立刻传给消费者。如果没有消费者等待接收元素，则将元素放在队列的 tail 节点，并等到该元素被消费者消费了才返回。</p>
<p><strong>tryTransfer方法：</strong>用来试探生产者传入的元素能否直接传给消费者。如果没有消费者在等待，则返回 false。和上述方法的区别是该方法无论消费者是否接收，方法立即返回，而 transfer 方法是必须等到消费者消费了才返回。</p>
<ol start="7">
<li><strong>LinkedBlockingDeque：</strong>链表结构的双向阻塞队列，优势在于多线程入队时，减少一半的竞争。</li>
</ol>
<h4 id="拒绝策略"><a href="#拒绝策略" class="headerlink" title="拒绝策略"></a>拒绝策略</h4><p>当队列和线程池都满了，说明线程池处于饱和的状态，那么必须采取一种策略处理提交的新任务。ThreadPoolExecutor 默认有四个拒绝策略：</p>
<ul>
<li><code>ThreadPoolExecutor.AbortPolicy()</code>：默认策略，直接抛出异常 RejectedExecutionException。</li>
</ul>
<blockquote>
<p><strong>java.util.concurrent.RejectedExecutionException：</strong></p>
<p>当线程池  ThreadPoolExecutor 执行方法 <code>shutdown ()</code> 之后，再向线程池提交任务的时候，如果配置的拒绝策略是 AbortPolicy ，这个异常就会抛出来。</p>
<p>当设置的任务缓存队列过小的时候，或者说，线程池里面所有的线程都在干活（线程数等于 maxPoolSize)，并且任务缓存队列也已经充满了等待的队列， 这个时候，再向它提交任务，也会抛出这个异常。</p>
</blockquote>
<ul>
<li><p><code>ThreadPoolExecutor.CallerRunsPolicy()</code>：直接调用 <code>run ()</code> 方法并且阻塞执行。</p>
</li>
<li><p><code>ThreadPoolExecutor.DiscardPolicy()</code>：不处理，直接丢弃后来的任务。</p>
</li>
<li><p><code>ThreadPoolExecutor.DiscardOldestPolicy()</code>：丢弃在队列中队首的任务，并执行当前任务。</p>
</li>
</ul>
<p>当然可以继承 RejectedExecutionHandler 来自定义拒绝策略。</p>
<h4 id="线程池参数选择"><a href="#线程池参数选择" class="headerlink" title="线程池参数选择"></a>线程池参数选择</h4><p>CPU 密集型：线程池的大小推荐为 CPU 数量 +1。CPU 数量可以根据 <code>Runtime.getRuntime().availableProcessors()</code> 方法获取。</p>
<p>IO 密集型：CPU 数量 * CPU 利用率 * (1 + 线程等待时间 / 线程 CPU 时间)。</p>
<p>混合型：将任务分为 CPU 密集型和 IO 密集型，然后分别使用不同的线程池去处理，从而使每个线程池可以根据各自的工作负载来调整。</p>
<p>阻塞队列：推荐使用有界队列，有界队列有助于避免资源耗尽的情况发生。</p>
<p>拒绝策略：默认采用的是 AbortPolicy 拒绝策略，直接在程序中抛出 RejectedExecutionException 异常，因为是运行时异常，不强制 catch，但这种处理方式不够优雅。处理拒绝策略有以下几种比较推荐：</p>
<ul>
<li>在程序中捕获 RejectedExecutionException 异常，在捕获异常中对任务进行处理。针对默认拒绝策略。</li>
<li>使用 CallerRunsPolicy 拒绝策略，该策略会将任务交给调用 execute 的线程执行 (一般为主线程)，此时主线程将在一段时间内不能提交任何任务，从而使工作线程处理正在执行的任务。此时提交的线程将被保存在 TCP 队列中，TCP 队列满将会影响客户端，这是一种平缓的性能降低。</li>
<li>自定义拒绝策略，只需要实现 RejectedExecutionHandler 接口即可。</li>
<li>如果任务不是特别重要，使用 DiscardPolicy 和 DiscardOldestPolicy 拒绝策略将任务丢弃也是可以的。</li>
</ul>
<p>如果使用 Executors 的静态方法创建 ThreadPoolExecutor 对象，可以通过使用 Semaphore 对任务的执行进行限流也可以避免出现 OOM 异常。</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestThreadPoolExecutor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> startTimeMillis = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 构造一个线程池</span></span><br><span class="line">        ThreadPoolExecutor threadPool = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>,</span><br><span class="line">                TimeUnit.SECONDS, <span class="keyword">new</span> ArrayBlockingQueue&lt;Runnable&gt;(<span class="number">3</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                String task = <span class="string">&quot;task = &quot;</span> + i;</span><br><span class="line">                System.out.println(<span class="string">&quot;创建任务并提交到线程池中：&quot;</span> + task);</span><br><span class="line">                threadPool.execute(<span class="keyword">new</span> ThreadPoolTask(task));</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 等待所有线程执行完毕当前任务</span></span><br><span class="line">            threadPool.shutdown();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">boolean</span> loop = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="comment">// 等待所有线程执行完毕，当前任务结束</span></span><br><span class="line">                loop = !threadPool.awaitTermination(<span class="number">2</span>, TimeUnit.SECONDS);<span class="comment">// 等待2秒</span></span><br><span class="line">            &#125; <span class="keyword">while</span> (loop);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!loop) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;所有线程执行完毕&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;耗时：&quot;</span> + (System.currentTimeMillis() - startTimeMillis));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolTask</span> <span class="keyword">implements</span> <span class="title">Runnable</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String attachData;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolTask</span><span class="params">(String tasks)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.attachData = tasks;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;开始执行：&quot;</span> + attachData + <span class="string">&quot;任务，使用的线程池，线程名称：&quot;</span></span><br><span class="line">                    + Thread.currentThread().getName() + <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        attachData = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果，可以看到线程 pool-1-thread-1 到 pool-1-thread-5 循环使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">创建任务并提交到线程池中：task = <span class="number">1</span></span><br><span class="line">开始执行：task = <span class="number">1</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">2</span></span><br><span class="line">开始执行：task = <span class="number">2</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">2</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">3</span></span><br><span class="line">开始执行：task = <span class="number">3</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">3</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">4</span></span><br><span class="line">开始执行：task = <span class="number">4</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">4</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">5</span></span><br><span class="line">开始执行：task = <span class="number">5</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">5</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">6</span></span><br><span class="line">开始执行：task = <span class="number">6</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">7</span></span><br><span class="line">开始执行：task = <span class="number">7</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">2</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">8</span></span><br><span class="line">开始执行：task = <span class="number">8</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">3</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">9</span></span><br><span class="line">开始执行：task = <span class="number">9</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">4</span></span><br><span class="line"></span><br><span class="line">创建任务并提交到线程池中：task = <span class="number">10</span></span><br><span class="line">开始执行：task = <span class="number">10</span>任务，使用的线程池，线程名称：pool-<span class="number">1</span>-thread-<span class="number">5</span></span><br><span class="line"></span><br><span class="line">所有线程执行完毕</span><br><span class="line">耗时：<span class="number">1014</span></span><br></pre></td></tr></table></figure>

<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000011527245">https://segmentfault.com/a/1190000011527245</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/01/java-string/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/01/java-string/" class="post-title-link" itemprop="url">java String 类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-01 19:31:54" itemprop="dateCreated datePublished" datetime="2021-01-01T19:31:54+08:00">2021-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-03-16 20:15:44" itemprop="dateModified" datetime="2021-03-16T20:15:44+08:00">2021-03-16</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>28k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>25 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="String-的特性"><a href="#String-的特性" class="headerlink" title="String 的特性"></a>String 的特性</h2><p>String：字符串，使用双引号引起来表示。</p>
<ul>
<li><p>String 是一个 final 类，不可被继承。</p>
</li>
<li><p>String 继承了 Serializable、Comparable 和 CharSequence 接口。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现 Serializable 接口：表示字符串是支持可序列化的。</li>
<li>实现 Comparable 接口  ：表示 String 可以比较大小。</li>
</ul>
</li>
<li><p><strong>String 内部定义了 <code>final char value[]</code> 用于存储字符串数据。</strong></p>
</li>
<li><p>String 代表不可变的字符序列 — 不可变性。 体现在：</p>
<ul>
<li><strong>当对字符串重新赋值时，需要重新指定内存区域赋值，不能使用原有的 value 进行赋值。</strong></li>
<li><strong>当对现有的字符串进行连接操作时，也需要重新指定内存区域赋值。</strong></li>
<li><strong>当调用 String 的 <code>replace()</code> 修改原字符串中指定的字符或字符串时，也需要重新指定内存区域赋值。</strong></li>
</ul>
</li>
<li><p><strong>通过字面量的定义 (区别于 new) 方式给一个字符串赋值，此时的字符串值声明在字符串常量池中。</strong></p>
</li>
<li><p><strong>字符串常量池中不会存储相同内容的字符串。</strong></p>
</li>
<li><p>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;abc&quot;</span>;<span class="comment">// 字面量的定义方式</span></span><br><span class="line">        String s2 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        System.out.println(s1 == s2);<span class="comment">// true</span></span><br><span class="line">        s1 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">        System.out.println(s1 == s2);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s1);<span class="comment">// hello</span></span><br><span class="line">        System.out.println(s2);<span class="comment">// abc</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;**************************&quot;</span>);</span><br><span class="line">        String s3 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        s3 += <span class="string">&quot;def&quot;</span>;</span><br><span class="line">        System.out.println(s3);<span class="comment">// abcdef</span></span><br><span class="line">        System.out.println(s2);<span class="comment">// abc ---&gt; 原abc没变</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;**************************&quot;</span>);</span><br><span class="line">        String s4 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        String s5 = s4.replace(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;m&quot;</span>);</span><br><span class="line">        System.out.println(s4);<span class="comment">// abc ---&gt; 原abc没变</span></span><br><span class="line">        System.out.println(s5);<span class="comment">// mbc</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<img src="/2021/01/01/java-string/image-20210311165147346.png" alt="image-20210311165147346" style="zoom:80%;">

<h2 id="String-对象的创建"><a href="#String-对象的创建" class="headerlink" title="String 对象的创建"></a>String 对象的创建</h2><ul>
<li><p><strong>方式一：通过字面量定义的方式，此时的字符串数据声明在方法区中的字符串常量池中。</strong></p>
</li>
<li><p><strong>方式二：通过 “new + 构造器” 的方式，此时变量保存的地址值，是字符串数据在堆空间中开辟空间以后所对应的地址值。</strong></p>
</li>
<li><p>常用的几种创建方式：</p>
<img src="/2021/01/01/java-string/image-20210311172851224.png" alt="image-20210311172851224" style="zoom:67%;">
</li>
<li><p>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 通过字面量定义的方式：此时的s1和s2的数据javaEE，声明在方法区中的字符串常量池中</span></span><br><span class="line">        String s1 = <span class="string">&quot;javaEE&quot;</span>;</span><br><span class="line">        String s2 = <span class="string">&quot;javaEE&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过&quot;new+构造器&quot;的方式：此时的s3和s4保存的地址值，是数据在堆空间中开辟空间以后所对应的地址值</span></span><br><span class="line">        String s3 = <span class="keyword">new</span> String(<span class="string">&quot;javaEE&quot;</span>);</span><br><span class="line">        String s4 = <span class="keyword">new</span> String(<span class="string">&quot;javaEE&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(s1 == s2);<span class="comment">// true</span></span><br><span class="line">        System.out.println(s1 == s3);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s1 == s4);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s3 == s4);<span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;*************************&quot;</span>);</span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person(<span class="string">&quot;Tom&quot;</span>, <span class="number">12</span>);<span class="comment">// 通过字面量定义的方式定义的name</span></span><br><span class="line">        Person p2 = <span class="keyword">new</span> Person(<span class="string">&quot;Tom&quot;</span>, <span class="number">12</span>);</span><br><span class="line">        System.out.println(p1.name.equals(p2.name));<span class="comment">// true</span></span><br><span class="line">        System.out.println(p1.name == p2.name);<span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">        p1.name = <span class="string">&quot;Jerry&quot;</span>;</span><br><span class="line">        System.out.println(p2.name);<span class="comment">// Tom</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;*************************&quot;</span>);</span><br><span class="line">        Person p3 = <span class="keyword">new</span> Person(<span class="keyword">new</span> String(<span class="string">&quot;Tom&quot;</span>), <span class="number">12</span>);<span class="comment">// 通过&quot;new+构造器&quot;的方式定义的name</span></span><br><span class="line">        Person p4 = <span class="keyword">new</span> Person(<span class="keyword">new</span> String(<span class="string">&quot;Tom&quot;</span>), <span class="number">12</span>);</span><br><span class="line">        System.out.println(p3.name.equals(p4.name));<span class="comment">// true</span></span><br><span class="line">        System.out.println(p3.name == p4.name);<span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>内存解析说明：</p>
<img src="/2021/01/01/java-string/image-20210311173259265.png" alt="image-20210311173259265" style="zoom:67%;">
</li>
<li><p>字符串初始化的过程：</p>
<img src="/2021/01/01/java-string/image-20210311194020782.png" alt="image-20210311194020782" style="zoom:67%;">

<img src="/2021/01/01/java-string/image-20210311194118841.png" alt="image-20210311194118841" style="zoom:80%;">
</li>
<li><p><strong>字符串拼接：</strong></p>
<ul>
<li><strong>如果是常量与常量的拼接，则结果在常量池，且常量池中不会存在相同内容的常量。</strong></li>
<li><strong>如果其中有一个是变量，则结果在堆中。</strong></li>
<li><strong>如果拼接的结果调用 <code>intern()</code> 方法，则返回值在常量池中。</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;javaEE&quot;</span>;</span><br><span class="line">        String s2 = <span class="string">&quot;hadoop&quot;</span>;</span><br><span class="line">        String s3 = <span class="string">&quot;javaEEhadoop&quot;</span>;</span><br><span class="line">        String s4 = <span class="string">&quot;javaEE&quot;</span> + <span class="string">&quot;hadoop&quot;</span>;</span><br><span class="line">        String s5 = s1 + <span class="string">&quot;hadoop&quot;</span>;</span><br><span class="line">        String s6 = <span class="string">&quot;javaEE&quot;</span> + s2;</span><br><span class="line">        String s7 = s1 + s2;</span><br><span class="line">        String s8 = (s1 + s2).intern();</span><br><span class="line"></span><br><span class="line">        System.out.println(s3 == s4);<span class="comment">// true</span></span><br><span class="line">        System.out.println(s3 == s5);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s3 == s6);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s3 == s7);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s3 == s8);<span class="comment">// true</span></span><br><span class="line">        System.out.println(s5 == s6);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s5 == s7);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s5 == s8);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s6 == s7);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s6 == s8);<span class="comment">// false</span></span><br><span class="line">        System.out.println(s7 == s8);<span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>内存解析说明：</p>
<img src="/2021/01/01/java-string/image-20210311212720801.png" alt="image-20210311212720801" style="zoom: 80%;">

<p>特殊的情况：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;javaEEhadoop&quot;</span>;</span><br><span class="line">        String s2 = <span class="string">&quot;javaEE&quot;</span>;</span><br><span class="line">        String s3 = s2 + <span class="string">&quot;hadoop&quot;</span>;</span><br><span class="line">        System.out.println(s1 == s3);<span class="comment">// false</span></span><br><span class="line">        <span class="keyword">final</span> String s4 = <span class="string">&quot;javaEE&quot;</span>;</span><br><span class="line">        String s5 = s4 + <span class="string">&quot;hadoop&quot;</span>;</span><br><span class="line">        System.out.println(s1 == s5);<span class="comment">// true</span></span><br><span class="line">        </span><br><span class="line">        System.out.println(s2 == s4);<span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>s4 变量被 final 修饰，实际上也就是常量，等同于 s2。</p>
</blockquote>
</li>
<li><p>面试题</p>
<ul>
<li><p><code>String s = new String(&quot;abc&quot;);</code> 方式创建对象，在内存中创建了几个对象？</p>
<ul>
<li>两个：一个是堆空间中 new 的结构，另一个是 char[] 对应的常量池中的数据 “abc”。</li>
</ul>
</li>
<li><p><code>String str1 = &quot;abc&quot;;</code> 与 <code>String str2 = new String(&quot;abc&quot;);</code> 的区别？</p>
<ul>
<li><strong>字符串常量存储在字符串常量池，目的是共享。</strong></li>
<li><strong>字符串非常量对象存储在堆中。</strong></li>
</ul>
<img src="/2021/01/01/java-string/image-20210311194809127.png" alt="image-20210311194809127" style="zoom:67%;">
</li>
<li><p>下面程序的运行结果是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    String str = <span class="keyword">new</span> String(<span class="string">&quot;good&quot;</span>);</span><br><span class="line">    <span class="keyword">char</span>[] ch = &#123;<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(String str, <span class="keyword">char</span> ch[])</span> </span>&#123;</span><br><span class="line">        str = <span class="string">&quot;test ok&quot;</span>;</span><br><span class="line">        ch[<span class="number">0</span>] = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringTest ex = <span class="keyword">new</span> StringTest();</span><br><span class="line">        ex.change(ex.str, ex.ch);</span><br><span class="line">        System.out.println(ex.str);<span class="comment">// good</span></span><br><span class="line">        System.out.println(ex.ch);<span class="comment">// best</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>值传递机制和 String 的不可变性。</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="String-的常用方法"><a href="#String-的常用方法" class="headerlink" title="String 的常用方法"></a>String 的常用方法</h2><ul>
<li><p><code>int length()</code>：返回字符串的长度，<code>return value.length</code>。</p>
</li>
<li><p><code>char charAt(int index)</code>：返回某索引处的字符，<code>return value[index]</code>。</p>
</li>
<li><p><code>boolean isEmpty()</code>：判断是否是空字符串，<code>return value.length == 0</code>。</p>
</li>
<li><p><code>String toLowerCase()</code>：使用默认语言环境，将 String 中的所有字符转换为小写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        String s2 = s1.toLowerCase();<span class="comment">// s1不可变，仍未原来的字符串</span></span><br><span class="line">        System.out.println(s2);<span class="comment">// helloworld</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String toUpperCase()</code>：使用默认语言环境，将 String 中的所有字符转换为大写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        String s2 = s1.toUpperCase();<span class="comment">// s1不可变，仍未原来的字符串</span></span><br><span class="line">        System.out.println(s2);<span class="comment">// HELLOWORLD</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String trim()</code>：返回字符串的副本，忽略前导空白和尾部空白。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;  he  llo    world    &quot;</span>;</span><br><span class="line">        String s2 = s1.trim();</span><br><span class="line">        System.out.println(<span class="string">&quot;---&quot;</span> + s1 + <span class="string">&quot;---&quot;</span>);<span class="comment">// ---  he  llo    world    ---</span></span><br><span class="line">        System.out.println(<span class="string">&quot;---&quot;</span> + s2 + <span class="string">&quot;---&quot;</span>);<span class="comment">// ---he  llo    world---</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>boolean equals(Object obj)</code>：比较字符串的内容是否相同。</p>
</li>
<li><p><code>boolean equalsIgnoreCase(String anotherString)</code>：比较字符串的内容是否相同，忽略大小写。</p>
</li>
<li><p><code>String concat(String str)</code>：将指定字符串连接到此字符串的结尾，等价于用 “+”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">        String s2 = s1.concat(<span class="string">&quot;def&quot;</span>);</span><br><span class="line">        System.out.println(s2);<span class="comment">// abcdef</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int compareTo(String anotherString)</code>：比较两个字符串的大小。</p>
</li>
<li><p><code>String substring(int beginIndex)</code>：返回一个新的字符串，截取当前字符串从 beginIndex 开始到最后的一个子字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        String s2 = s1.substring(<span class="number">2</span>);</span><br><span class="line">        System.out.println(s2);<span class="comment">// lloWorld</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String substring(int beginIndex, int endIndex)</code>：返回一个新字符串，截取当前字符串从 beginIndex 开始到 endIndex (不包含) 结束的一个子字符串 — 左闭右开，<code>[beginIndex, endIndex)</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        String s2 = s1.substring(<span class="number">2</span>, <span class="number">6</span>);</span><br><span class="line">        System.out.println(s2);<span class="comment">// lloW</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>boolean endsWith(String suffix)</code>：测试此字符串是否以指定的后缀结束。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        System.out.println(s1.endsWith(<span class="string">&quot;ld&quot;</span>));<span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>boolean startsWith(String prefix)</code>：测试此字符串是否以指定的前缀开始。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        System.out.println(s1.startsWith(<span class="string">&quot;ll&quot;</span>));<span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>boolean startsWith(String prefix, int toffset)</code>：测试此字符串从指定索引开始的子字符串是否以指定前缀开始。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        System.out.println(s1.startsWith(<span class="string">&quot;ll&quot;</span>, <span class="number">2</span>));<span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>boolean contains(CharSequence s)</code>：当且仅当此字符串包含指定的 char 值序列时，返回 true。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        System.out.println(s1.contains(<span class="string">&quot;wo&quot;</span>));<span class="comment">// false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int indexOf(String str)</code>：返回指定子字符串在此字符串中第一次出现处的索引，未找到返回 -1。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        System.out.println(s1.indexOf(<span class="string">&quot;lo&quot;</span>));<span class="comment">// 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int indexOf(String str, int fromIndex)</code>：返回指定子字符串在此字符串中第一次出现处的索引，从指定的索引开始，未找到返回 -1。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;HelloWorld&quot;</span>;</span><br><span class="line">        System.out.println(s1.indexOf(<span class="string">&quot;lo&quot;</span>, <span class="number">5</span>));<span class="comment">// -1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int lastIndexOf(String str)</code>：返回指定子字符串在此字符串中最右边出现处的索引，未找到返回 -1。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;hellorworld&quot;</span>;</span><br><span class="line">        System.out.println(s1.lastIndexOf(<span class="string">&quot;or&quot;</span>));<span class="comment">// 7</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>面试题：什么情况下，<code>indexOf(str)</code> 和 <code>lastIndexOf(str)</code> 返回值相同？</strong></p>
<p><strong>情况一：存在唯一的一个 str。情况二：不存在 str。</strong></p>
</li>
<li><p><code>int lastIndexOf(String str, int fromIndex)</code>：返回指定子字符串在此字符串中最后一次出现处的索引，从指定的索引开始反向搜索，未找到返回 -1。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;hellorworld&quot;</span>;</span><br><span class="line">        System.out.println(s1.lastIndexOf(<span class="string">&quot;or&quot;</span>, <span class="number">6</span>));<span class="comment">// 4</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String replace(char oldChar, char newChar)</code>：返回一个新的字符串，它是通过用 newChar 替换此字符串中出现的所有 oldChar 得到的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;hellorworld&quot;</span>;</span><br><span class="line">        String s2 = s1.replace(<span class="string">&quot;o&quot;</span>, <span class="string">&quot;D&quot;</span>);</span><br><span class="line">        System.out.println(s2);<span class="comment">// hellDrwDrld</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String replace(CharSequence target, CharSequence replacement)</code>：使用指定的字面值替换序列替换此字符串所有匹配字面值目标序列的子字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">&quot;hellorworld&quot;</span>;</span><br><span class="line">        String s2 = s1.replace(<span class="string">&quot;or&quot;</span>, <span class="string">&quot;DE&quot;</span>);</span><br><span class="line">        System.out.println(s2);<span class="comment">// hellDEwDEld</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String replaceAll(String regex, String replacement)</code>：使用给定的 replacement 替换此字符串所有匹配给定的正则表达式的子字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;12hello34world5java7891mysql456&quot;</span>;</span><br><span class="line">        <span class="comment">// 把字符串中的数字替换成,，如果结果中开头和结尾有,的话去掉</span></span><br><span class="line">        String s1 = str.replaceAll(<span class="string">&quot;\\d+&quot;</span>, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">        System.out.println(s1);<span class="comment">// ,hello,world,java,mysql,</span></span><br><span class="line">        String s2 = s1.replaceAll(<span class="string">&quot;^,|,$&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(s2);<span class="comment">// hello,world,java,mysql</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String replaceFirst(String regex, String replacement)</code>：使用给定的 replacement 替换此字符串匹配给定的正则表达式的第一个子字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;12hello34world5java7891mysql456&quot;</span>;</span><br><span class="line">        <span class="comment">// 把字符串中的数字替换成,，如果结果中开头和结尾有，的话去掉</span></span><br><span class="line">        String s1 = str.replaceFirst(<span class="string">&quot;\\d+&quot;</span>, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">        System.out.println(s1);<span class="comment">// ,hello34world5java7891mysql456</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>boolean matches(String regex)</code>：告知此字符串是否匹配给定的正则表达式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;1234d5&quot;</span>;</span><br><span class="line">        <span class="comment">// 判断str字符串中是否全部由数字组成，即有1-n个数字组成</span></span><br><span class="line">        <span class="keyword">boolean</span> matches = str.matches(<span class="string">&quot;\\d+&quot;</span>);</span><br><span class="line">        System.out.println(matches);<span class="comment">// false</span></span><br><span class="line">        String tel = <span class="string">&quot;0571-4534289&quot;</span>;</span><br><span class="line">        <span class="comment">// 判断这是否是一个杭州的固定电话</span></span><br><span class="line">        <span class="keyword">boolean</span> result = tel.matches(<span class="string">&quot;0571-\\d&#123;7,8&#125;&quot;</span>);</span><br><span class="line">        System.out.println(result);<span class="comment">// true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String[] split(String regex)</code>：根据匹配给定的正则表达式来拆分此字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;hello|world|java&quot;</span>;</span><br><span class="line">        String[] strs = str.split(<span class="string">&quot;\\|&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String value : strs) &#123;</span><br><span class="line">            System.out.println(value);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        String str2 = <span class="string">&quot;hello.world.java&quot;</span>;</span><br><span class="line">        String[] strs2 = str2.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String s : strs2) &#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        String str3 = <span class="string">&quot;hello-world-java&quot;</span>;</span><br><span class="line">        String[] strs3 = str3.split(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String s : strs3) &#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">java</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">java</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">java</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>String[] split(String regex, int limit)</code>：根据匹配给定的正则表达式来拆分此字符串，最多不超过 limit 个，如果超过了，剩下的全部都放到最后一个元素中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;hello|world|java&quot;</span>;</span><br><span class="line">        String[] strs = str.split(<span class="string">&quot;\\|&quot;</span>,<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (String value : strs) &#123;</span><br><span class="line">            System.out.println(value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">hello</span><br><span class="line">world|java</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>substring()</code> 与 <code>indexOf()</code> 结合使用：</p>
<ul>
<li><p>截取第二个 “-“ 之前的字符：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = <span class="string">&quot;application-2005-US20050154023A1-20050714&quot;</span>;</span><br><span class="line">        String r = s.substring(<span class="number">0</span>, s.indexOf(<span class="string">&quot;-&quot;</span>, s.indexOf(<span class="string">&quot;-&quot;</span>) + <span class="number">1</span>));</span><br><span class="line">        System.out.println(r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">application-<span class="number">2005</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>截取第二个 “-“ 之后的字符：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = <span class="string">&quot;application-2005-US20050154023A1-20050714&quot;</span>;</span><br><span class="line">        String r = s.substring(s.indexOf(<span class="string">&quot;-&quot;</span>, s.indexOf(<span class="string">&quot;-&quot;</span>) + <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">        System.out.println(r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">US20050154023A1-<span class="number">20050714</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>截取倒数第二个 “-“ 之前的字符：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = <span class="string">&quot;application-2005-US20050154023A1-20050714&quot;</span>;</span><br><span class="line">        String r = s.substring(<span class="number">0</span>, s.lastIndexOf(<span class="string">&quot;-&quot;</span>, s.lastIndexOf(<span class="string">&quot;-&quot;</span>) - <span class="number">1</span>));</span><br><span class="line">        System.out.println(r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">application-<span class="number">2005</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>截取倒数第二个 “-“ 之后的字符：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = <span class="string">&quot;application-2005-US20050154023A1-20050714&quot;</span>;</span><br><span class="line">        String r = s.substring(s.lastIndexOf(<span class="string">&quot;-&quot;</span>, s.lastIndexOf(<span class="string">&quot;-&quot;</span>) - <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">        System.out.println(r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">US20050154023A1-<span class="number">20050714</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="String-与其他结构之间的转换"><a href="#String-与其他结构之间的转换" class="headerlink" title="String 与其他结构之间的转换"></a>String 与其他结构之间的转换</h2><h3 id="String-与基本数据类型-包装类之间的转换"><a href="#String-与基本数据类型-包装类之间的转换" class="headerlink" title="String 与基本数据类型/包装类之间的转换"></a>String 与基本数据类型/包装类之间的转换</h3><ul>
<li>字符串转换为基本数据类型/包装类<ul>
<li>Integer 包装类的 <code>public static int parseInt(String s)</code>：可以将由 “数字” 字符组成的字符串，转换为整型。</li>
<li>类似地，使用 java.lang 包中的 Byte、Short、Long、Float、Double 类调相应的类方法可以将由 “数字” 字符组成的字符串，转换为相应的基本数据类型。</li>
</ul>
</li>
<li>基本数据类型/包装类转换为字符串<ul>
<li>调用 String 类的 <code>public String valueOf(int n)</code> 可将 int 型转换为字符串。</li>
<li>相应的 <code>valueOf(byte b)</code>、<code>valueOf(long l)</code>、<code>valueOf(float f)</code>、<code>valueOf(doubled)</code>、<code>valueOf(boolean b)</code> 可将参数的相应类型转换为字符串。</li>
</ul>
</li>
</ul>
<h3 id="String-与字符数组-char-之间的转换"><a href="#String-与字符数组-char-之间的转换" class="headerlink" title="String 与字符数组 (char[]) 之间的转换"></a>String 与字符数组 (char[]) 之间的转换</h3><ul>
<li><p>字符串转换为字符数组</p>
<ul>
<li><p><code>public char[] toCharArray()</code>：将字符串中的全部字符存放在一个字符数组中的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;hello|world|java&quot;</span>;</span><br><span class="line">        <span class="keyword">char</span>[] chars = str.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : chars) &#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>public void getChars(int srcBegin, int srcEnd, char[] dst, int dstBegin)</code>：提供了将指定索引范围内的字符串存放到数组中的方法。</p>
</li>
</ul>
</li>
<li><p>字符数组转换为字符串</p>
<ul>
<li><p>String 类的构造器：<code>String(char[])</code> 和 <code>String(char[], int offset, intlength)</code> 分别用字符数组中的全部字符和部分字符创建字符串对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] arr = <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line">        String str = <span class="keyword">new</span> String(arr);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="String-与字节数组-byte-之间的转换"><a href="#String-与字节数组-byte-之间的转换" class="headerlink" title="String 与字节数组 (byte[]) 之间的转换"></a>String 与字节数组 (byte[]) 之间的转换</h3><ul>
<li><p>字符串转换为字节数组</p>
<ul>
<li><strong>编码：String —&gt; byte[]，字符串 —&gt; 字节，看得懂的 —&gt; 看不懂的二进制数据。</strong></li>
<li><code>public byte[] getBytes()</code>：使用平台的默认字符集将此 String 编码为 byte 序列，并将结果存储到新的 byte 数组中。</li>
<li><code>public byte[] getBytes(String charsetName)</code>：使用指定的字符集将此 String 编码为 byte 序列，并将结果存储到新的 byte 数组中。</li>
</ul>
</li>
<li><p>字节数组转换为字符串</p>
<ul>
<li><strong>解码：byte[] —&gt; String，字节 —&gt; 字符串，看不懂的二进制数据 —&gt; 看得懂的。编码的逆过程。</strong></li>
<li><code>String(byte[])</code>：通过使用平台的默认字符集解码指定的 byte 数组，构造一个新的 String。</li>
<li><code>String(byte[] ，int offset ，int length)</code>： ：用指定的字节数组的一部分，即从数组起始位置 offset 开始，取 length 个字节构造一个字符串对象。</li>
</ul>
</li>
<li><p>实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str1 = <span class="string">&quot;abc123ABC中国&quot;</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = str1.getBytes();<span class="comment">// 使用默认的字符集进行编码，此处是UTF-8</span></span><br><span class="line">        System.out.println(Arrays.toString(bytes));<span class="comment">// [97, 98, 99, 49, 50, 51, 65, 66, 67, -28, -72, -83, -27, -101, -67]</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] gbks = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            gbks = str1.getBytes(<span class="string">&quot;GBK&quot;</span>);<span class="comment">// 使用GBK进行编码</span></span><br><span class="line">            System.out.println(Arrays.toString(gbks));<span class="comment">// [97, 98, 99, 49, 50, 51, 65, 66, 67, -42, -48, -71, -6]</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;*********************************&quot;</span>);</span><br><span class="line">        String str2 = <span class="keyword">new</span> String(bytes);<span class="comment">// 使用默认的字符集进行解码，此处是UTF-8</span></span><br><span class="line">        System.out.println(str2);<span class="comment">// abc123ABC中国</span></span><br><span class="line"></span><br><span class="line">        String str4 = <span class="keyword">new</span> String(gbks);</span><br><span class="line">        System.out.println(str4);<span class="comment">// abc123ABC�й�，出现乱码，原因：编码集和解码集不一致</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String gbk = <span class="keyword">new</span> String(gbks, <span class="string">&quot;GBK&quot;</span>);</span><br><span class="line">            System.out.println(gbk);<span class="comment">// abc123ABC中国，因为编码集和解码集一致，所以不会出现乱码</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>解码时，要求解码使用的字符集必须与编码时使用的字符集一致，否则会出现乱码。</strong></p>
</blockquote>
</li>
</ul>
<h2 id="String-相关的算法题目"><a href="#String-相关的算法题目" class="headerlink" title="String 相关的算法题目"></a>String 相关的算法题目</h2><ul>
<li><p>模拟一个 trim 方法，去除字符串两端的空格。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">myTrim</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 用于记录从前往后首次索引位置不是空格的位置的索引</span></span><br><span class="line">            <span class="keyword">int</span> start = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 用于记录从后往前首次索引位置不是空格的位置的索引</span></span><br><span class="line">            <span class="keyword">int</span> end = str.length() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (start &lt; end &amp;&amp; str.charAt(start) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                start++;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (start &lt; end &amp;&amp; str.charAt(end) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (str.charAt(start) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> str.substring(start, end + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = myTrim(<span class="string">&quot;  abc 123   d &quot;</span>);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将一个字符串中指定部分进行反转。比如 “abcdefg” 反转为 “abfedcg”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 方式一：</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">reverse1</span><span class="params">(String str, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">char</span>[] charArray = str.toCharArray();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = start, j = end; i &lt; j; i++, j--) &#123;</span><br><span class="line">                <span class="keyword">char</span> temp = charArray[i];</span><br><span class="line">                charArray[i] = charArray[j];</span><br><span class="line">                charArray[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(charArray);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方式二：</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">reverse2</span><span class="params">(String str, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        String newStr = str.substring(<span class="number">0</span>, start);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = end; i &gt;= start; i--) &#123;</span><br><span class="line">            newStr += str.charAt(i);</span><br><span class="line">        &#125;</span><br><span class="line">        newStr += str.substring(end + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> newStr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 方式三：推荐(相较于方式二做的改进)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">reverse3</span><span class="params">(String str, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        StringBuilder newStr = <span class="keyword">new</span> StringBuilder(str.length());</span><br><span class="line">        newStr.append(str, <span class="number">0</span>, start);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = end; i &gt;= start; i--) &#123;</span><br><span class="line">            newStr.append(str.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">        newStr.append(str.substring(end + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span> newStr.toString();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;abcdefg&quot;</span>;</span><br><span class="line">        String str1 = reverse3(str, <span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">        System.out.println(str1);<span class="comment">// abfedcg</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取一个字符串在另一个字符串中出现的次数。比如：获取 “ab” 在 “abkkcadkabkebfkabkskab” 中出现的次数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">(String mainStr, String subStr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mainStr.length() &gt;= subStr.length()) &#123;</span><br><span class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">/*// 方式一：</span></span><br><span class="line"><span class="comment">            while ((index = mainStr.indexOf(subStr)) != -1) &#123;</span></span><br><span class="line"><span class="comment">                count++;</span></span><br><span class="line"><span class="comment">                mainStr = mainStr.substring(index + subStr.length());</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line">            <span class="comment">// 改进：</span></span><br><span class="line">            <span class="keyword">while</span> ((index = mainStr.indexOf(subStr, index)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                index += subStr.length();</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str1 = <span class="string">&quot;cdabkkcadkabkebfkabkskab&quot;</span>;</span><br><span class="line">        String str2 = <span class="string">&quot;ab&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> count = getCount(str1, str2);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取两个字符串中最大相同子串。比如：<code>str1 = &quot;abcwerthelloyuiodef&quot;; str2 = &quot;cvhellobnm&quot;;</code>。提示：将短的那个串进行长度依次递减的子串与较长的串比较。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果只存在一个最大长度的相同子串</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getMaxSameSubString</span><span class="params">(String str1, String str2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str1 != <span class="keyword">null</span> &amp;&amp; str2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            String maxStr = (str1.length() &gt; str2.length()) ? str1 : str2;</span><br><span class="line">            String minStr = (str1.length() &gt; str2.length()) ? str2 : str1;</span><br><span class="line">            <span class="keyword">int</span> len = minStr.length();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;<span class="comment">// 此层循环决定要去几个字符</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>, y = len - i; y &lt;= len; x++, y++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (maxStr.contains(minStr.substring(x, y))) &#123;</span><br><span class="line">                        <span class="keyword">return</span> minStr.substring(x, y);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果存在多个长度相同的最大相同子串</span></span><br><span class="line">    <span class="comment">// 此时先返回String[]，后面可以用集合中的ArrayList替换，较方便</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String[] getMaxSameSubString1(String str1, String str2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str1 != <span class="keyword">null</span> &amp;&amp; str2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            StringBuilder strs = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            String maxString = (str1.length() &gt; str2.length()) ? str1 : str2;</span><br><span class="line">            String minString = (str1.length() &gt; str2.length()) ? str2 : str1;</span><br><span class="line">            <span class="keyword">int</span> len = minString.length();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>, y = len - i; y &lt;= len; x++, y++) &#123;</span><br><span class="line">                    String subString = minString.substring(x, y);</span><br><span class="line">                    <span class="keyword">if</span> (maxString.contains(subString)) &#123;</span><br><span class="line">                        strs.append(subString).append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (strs.length() != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> strs.toString().replaceAll(<span class="string">&quot;,$&quot;</span>, <span class="string">&quot;&quot;</span>).split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果存在多个长度相同的最大相同子串：使用ArrayList</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">getMaxSameSubString2</span><span class="params">(String str1, String str2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (str1 != <span class="keyword">null</span> &amp;&amp; str2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            String maxString = (str1.length() &gt; str2.length()) ? str1 : str2;</span><br><span class="line">            String minString = (str1.length() &gt; str2.length()) ? str2 : str1;</span><br><span class="line">            <span class="keyword">int</span> len = minString.length();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>, y = len - i; y &lt;= len; x++, y++) &#123;</span><br><span class="line">                    String subString = minString.substring(x, y);</span><br><span class="line">                    <span class="keyword">if</span> (maxString.contains(subString)) &#123;</span><br><span class="line">                        list.add(subString);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (list.size() != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> list;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str1 = <span class="string">&quot;abcwerthelloyuiodef&quot;</span>;</span><br><span class="line">        String str2 = <span class="string">&quot;cvhellobnmiodef&quot;</span>;</span><br><span class="line">        String[] strs = getMaxSameSubString1(str1, str2);</span><br><span class="line">        System.out.println(Arrays.toString(strs));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对字符串中的字符进行自然顺序排序。提示：① 字符串变成字符数组；② 对数组排序，选择，冒泡，<code>Arrays.sort();</code>；③ 将排序后的数组变成字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">&quot;abcwerthelloyuiodef&quot;</span>;</span><br><span class="line">        <span class="keyword">char</span>[] arr = str.toCharArray();</span><br><span class="line">        Arrays.sort(arr);</span><br><span class="line">        String newStr = <span class="keyword">new</span> String(arr);</span><br><span class="line">        System.out.println(newStr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="String、StringBuffer-和-StringBuilder"><a href="#String、StringBuffer-和-StringBuilder" class="headerlink" title="String、StringBuffer 和 StringBuilder"></a>String、StringBuffer 和 StringBuilder</h2><ul>
<li><p><code>java.lang.StringBuffer</code> 代表可变的字符序列，jdk 1.0 中声明，可以对字符串内容进行增删，此时不会产生新的对象。作为参数传递时，方法内部可以改变值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuffer</span> <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>java.lang.StringBuilder</code> 和 <code>java.lang.StringBuffer</code> 非常类似，也代表可变的字符序列，二者提供相关功能的方法也比较类似。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuilder</span> <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2021/01/01/java-string/image-20210313133051803.png" alt="image-20210313133051803" style="zoom:67%;">
</li>
<li><p>StringBuffer 类和 StringBuilder 类不同于 String，其对象必须使用构造器生成。常用以下三个构造器：</p>
<ul>
<li><p><code>StringBuffer()</code>/<code>StringBuilder()</code>：初始容量为 16 的字符串缓冲区。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs a string buffer with no characters in it and an</span></span><br><span class="line"><span class="comment"> * initial capacity of 16 characters.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuffer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs a string builder with no characters in it and an</span></span><br><span class="line"><span class="comment"> * initial capacity of 16 characters.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>StringBuffer(int capacity)</code>/<code>StringBuilder(int capacity)</code>：构造指定容量的字符串缓冲区。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs a string buffer with no characters in it and</span></span><br><span class="line"><span class="comment"> * the specified initial capacity.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>      capacity  the initial capacity.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@exception</span>  NegativeArraySizeException  if the &#123;<span class="doctag">@code</span> capacity&#125;</span></span><br><span class="line"><span class="comment"> *               argument is less than &#123;<span class="doctag">@code</span> 0&#125;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuffer</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(capacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs a string builder with no characters in it and an</span></span><br><span class="line"><span class="comment"> * initial capacity specified by the &#123;<span class="doctag">@code</span> capacity&#125; argument.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>      capacity  the initial capacity.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span>     NegativeArraySizeException  if the &#123;<span class="doctag">@code</span> capacity&#125;</span></span><br><span class="line"><span class="comment"> *               argument is less than &#123;<span class="doctag">@code</span> 0&#125;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(capacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>StringBuffer(String str)</code>/<code>StringBuilder(String str)</code>：将内容初始化为指定字符串内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs a string buffer initialized to the contents of the</span></span><br><span class="line"><span class="comment"> * specified string. The initial capacity of the string buffer is</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> 16&#125; plus the length of the string argument.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>   str   the initial contents of the buffer.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuffer</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(str.length() + <span class="number">16</span>);</span><br><span class="line">    append(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs a string builder initialized to the contents of the</span></span><br><span class="line"><span class="comment"> * specified string. The initial capacity of the string builder is</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> 16&#125; plus the length of the string argument.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>   str   the initial contents of the buffer.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(str.length() + <span class="number">16</span>);</span><br><span class="line">    append(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>StringBuffer 类的常用方法，很多方法与 String 相同，StringBuilder 类的常用方法参考 StringBuffer。</p>
<ul>
<li><p>StringBuffer 类和 StringBuilder 类的方法的主要区别，举例如下：</p>
<ul>
<li><p><strong>StringBuffer 类 — 同步方法：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> StringBuffer <span class="title">append</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    toStringCache = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">super</span>.append(str);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>StringBuilder 类 — 非同步方法：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> StringBuilder <span class="title">append</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.append(str);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>StringBuffer append(xxx)</code>：提供了参数可为多种类型的 <code>append()</code> 方法，用于进行字符串拼接。</p>
<p><img src="/2021/01/01/java-string/image-20210313150854764.png" alt="image-20210313150854764"></p>
<p>面试题，输出结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="keyword">null</span>;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        System.out.println(sb);</span><br><span class="line">        sb.append(str);</span><br><span class="line">        System.out.println(sb.length());</span><br><span class="line">        System.out.println(sb);</span><br><span class="line">        StringBuilder sb1 = <span class="keyword">new</span> StringBuilder(str);</span><br><span class="line">        System.out.println(sb1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="keyword">null</span></span><br><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.NullPointerException</span><br><span class="line">	at java.lang.StringBuilder.&lt;init&gt;(StringBuilder.java:<span class="number">112</span>)</span><br><span class="line">	at cn.xisun.java.base.ExceptionTest.main(ExceptionTest.java:<span class="number">17</span>)</span><br></pre></td></tr></table></figure>

<p>原因：</p>
<p><strong>① java 里面，null 不占字节。如果一个引用指向 null，该应用就不再指向堆内存中的任何对象。并且，这个对象引用的大小是 4 个字节。</strong></p>
<p>② <code>append()</code> 方法如果传入 null 参数，最终执行以下方法，因此上面第 7 行和第 8 行输出结果为 4 和 null (字符串 null)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> AbstractStringBuilder <span class="title">appendNull</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c = count;</span><br><span class="line">    ensureCapacityInternal(c + <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">char</span>[] value = <span class="keyword">this</span>.value;</span><br><span class="line">    value[c++] = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">    value[c++] = <span class="string">&#x27;u&#x27;</span>;</span><br><span class="line">    value[c++] = <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">    value[c++] = <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">    count = c;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③ <code>new StringBuilder(str)</code> 的代码中：<code>super(str.length() + 16);</code>，调用 null 的 <code>length()</code> 方法，会发生空指针异常。</p>
</li>
<li><p><code>StringBuffer delete(int start,int end)</code>：删除指定位置的内容。</p>
</li>
<li><p><code>StringBuffer replace(int start, int end, String str)</code>：把 [start,end) 位置替换为 str。</p>
</li>
<li><p><code>StringBuffer insert(int offset, xxx)</code>：在指定位置插入多种类型的参数。</p>
<p><img src="/2021/01/01/java-string/image-20210313151452492.png" alt="image-20210313151452492"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;abc123&quot;</span>);</span><br><span class="line">        sb.insert(<span class="number">3</span>, <span class="string">&quot;ABC&quot;</span>);</span><br><span class="line">        System.out.println(sb);<span class="comment">// abcABC123</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>StringBuffer reverse()</code>：把当前字符序列逆转。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;abc123&quot;</span>);</span><br><span class="line">        sb.reverse();</span><br><span class="line">        System.out.println(sb);<span class="comment">// 321cba</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int indexOf(String str)</code>：返回指定子字符串在此字符串中第一次出现处的索引，未找到返回 -1。</p>
</li>
<li><p><code>String substring(int start)</code>：返回一个新的字符串，截取当前字符串从 start 开始到最后的一个子字符串。</p>
</li>
<li><p><code>String substring(int start,int end)</code>：返回一个新字符串，截取当前字符串从 start 开始到 end (不包含) 结束的一个子字符串 — 左闭右开，<code>[start, end)</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;abc123abc&quot;</span>);</span><br><span class="line">        String sb2 = sb.substring(<span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">        System.out.println(sb2);<span class="comment">// bc12</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int length()</code>：返回字符串的长度。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">length</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>char charAt(int n )</code>：返回某索引处的字符。</p>
</li>
<li><p><code>void setCharAt(int n ,char ch)</code>：在指定索引处插入字符。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;abc123abc&quot;</span>);</span><br><span class="line">        sb.setCharAt(<span class="number">1</span>, <span class="string">&#x27;中&#x27;</span>);</span><br><span class="line">        System.out.println(sb);<span class="comment">// a中c123abc</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法总结：</p>
<ul>
<li><p>增：append，删：delete，改：setCharAt/replace，查：charAt，插：insert，长度：length，遍历：for + charAt/toString。</p>
</li>
<li><p>append、delete、replace、insert 和 reverse 这些方法，支持方法链操作，方法链的原理为：</p>
<img src="/2021/01/01/java-string/1615717860(1).png" alt="1615717860(1)" style="zoom:80%;">
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>String、StringBuffer 和 StringBuilder 的异同？</strong></p>
<ul>
<li><strong>String：Since jdk 1.0，不可变的字符序列；底层使用 <code>final char[]</code> 存储。</strong></li>
<li><strong>StringBuffer：Since jdk 1.0，可变的字符序列；线程安全的，效率低；底层使用 <code>char[]</code> 存储。</strong></li>
<li><strong>StringBuilder：Since jdk 1.5，可变的字符序列；线程不安全的，效率高；底层使用 <code>char[]</code> 存储。</strong></li>
</ul>
</li>
<li><p><strong>StringBuffer 和 StringBuilder 的扩容问题：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="keyword">new</span> String();<span class="comment">// final char[] value = new char[0];</span></span><br><span class="line"></span><br><span class="line">        String str1 = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);<span class="comment">// final char[] value = new char[]&#123;&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;&#125;;</span></span><br><span class="line"></span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();<span class="comment">// char[] value = new char[16]; 底层创建了一个长度是16的char数组</span></span><br><span class="line">        System.out.println(sb.length());<span class="comment">// 0</span></span><br><span class="line">        sb.append(<span class="string">&#x27;a&#x27;</span>);<span class="comment">// value[0] = &#x27;a&#x27;;</span></span><br><span class="line">        sb.append(<span class="string">&#x27;b&#x27;</span>);<span class="comment">// value[1] = &#x27;b&#x27;;</span></span><br><span class="line">        sb.append(<span class="string">&#x27;c&#x27;</span>);<span class="comment">// value[1] = &#x27;c&#x27;;</span></span><br><span class="line">        System.out.println(sb.length());<span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">        StringBuffer sb1 = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;abc&quot;</span>);<span class="comment">// char[] value = new char[&quot;abc&quot;.length() + 16];</span></span><br><span class="line">        System.out.println(sb1.length());<span class="comment">// 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>扩容问题：如果要添加的数据底层数组盛不下了，那就需要扩容底层的数组。</p>
<p>扩容方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minimumCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minimumCapacity - value.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        value = Arrays.copyOf(value,</span><br><span class="line">                newCapacity(minimumCapacity));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a capacity at least as large as the given minimum capacity.</span></span><br><span class="line"><span class="comment"> * Returns the current capacity increased by the same amount + 2 if</span></span><br><span class="line"><span class="comment"> * that suffices.</span></span><br><span class="line"><span class="comment"> * Will not return a capacity greater than &#123;<span class="doctag">@code</span> MAX_ARRAY_SIZE&#125;</span></span><br><span class="line"><span class="comment"> * unless the given minimum capacity is greater than that.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  minCapacity the desired minimum capacity</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> OutOfMemoryError if minCapacity is less than zero or</span></span><br><span class="line"><span class="comment"> *         greater than Integer.MAX_VALUE</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">newCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = (value.length &lt;&lt; <span class="number">1</span>) + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (newCapacity &lt;= <span class="number">0</span> || MAX_ARRAY_SIZE - newCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        ? hugeCapacity(minCapacity)</span><br><span class="line">        : newCapacity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>默认情况下，扩容为原来容量的 2 倍 + 2，同时将原来数组中的元素复制到新的数组中。</strong></p>
<p><strong>指导意义：开发中，如果知道创建的字符串的长度，建议使用 <code>StringBuffer(int capacity)</code> 或 <code>StringBuilder(int capacity)</code>，即可能得避免扩容的发生，这样可以提高效率。</strong></p>
</li>
<li><p>String、StringBuffer 和 StringBuilder 三者的效率测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 初始设置</span></span><br><span class="line">        String text = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        StringBuilder builder = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">long</span> startTime = <span class="number">0L</span>;</span><br><span class="line">        <span class="keyword">long</span> endTime = <span class="number">0L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开始对比</span></span><br><span class="line">        startTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20000</span>; i++) &#123;</span><br><span class="line">            text = text + i;</span><br><span class="line">        &#125;</span><br><span class="line">        endTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;String的执行时间：&quot;</span> + (endTime - startTime));</span><br><span class="line"></span><br><span class="line">        startTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20000</span>; i++) &#123;</span><br><span class="line">            buffer.append(String.valueOf(i));</span><br><span class="line">        &#125;</span><br><span class="line">        endTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;StringBuffer的执行时间：&quot;</span> + (endTime - startTime));</span><br><span class="line"></span><br><span class="line">        startTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20000</span>; i++) &#123;</span><br><span class="line">            builder.append(String.valueOf(i));</span><br><span class="line">        &#125;</span><br><span class="line">        endTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;StringBuilder的执行时间：&quot;</span> + (endTime - startTime));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出结果：</span><br><span class="line">StringBuffer的执行时间：<span class="number">6</span></span><br><span class="line">StringBuilder的执行时间：<span class="number">3</span></span><br><span class="line">String的执行时间：<span class="number">1713</span></span><br></pre></td></tr></table></figure>

<p><strong>效率从高到低排列：StringBuilder &gt; StringBuffer &gt; String。</strong></p>
</li>
</ul>
<h2 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h2><p><a target="_blank" rel="noopener" href="https://www.gulixueyuan.com/goods/show/203?targetId=309&amp;preview=0">https://www.gulixueyuan.com/goods/show/203?targetId=309&amp;preview=0</a></p>
<p>声明：写作本文初衷是个人学习记录，鉴于本人学识有限，如有侵权或不当之处，请联系 <a href="mailto:wdshfut@163.com">wdshfut@163.com</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/31/redis-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/31/redis-command/" class="post-title-link" itemprop="url">redis 命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-12-31 17:10:36 / 修改时间：17:12:10" itemprop="dateCreated datePublished" datetime="2020-12-31T17:10:36+08:00">2020-12-31</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>182</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="查询当前库-key-的个数"><a href="#查询当前库-key-的个数" class="headerlink" title="查询当前库 key 的个数"></a>查询当前库 key 的个数</h2><p>info可以看到所有库的key数量</p>
<p>dbsize则是当前库key的数量</p>
<p>keys *这种数据量小还可以，大的时候可以直接搞死生产环境。</p>
<p>dbsize和keys *统计的key数可能是不一样的，如果没记错的话，keys *统计的是当前db有效的key，而dbsize统计的是所有未被销毁的key（有效和未被销毁是不一样的，具体可以了解redis的过期策略）</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/30/kafka-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/30/kafka-command/" class="post-title-link" itemprop="url">Kafka 命令行工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-30 10:19:35" itemprop="dateCreated datePublished" datetime="2020-12-30T10:19:35+08:00">2020-12-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-26 10:17:31" itemprop="dateModified" datetime="2021-02-26T10:17:31+08:00">2021-02-26</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>5.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>查看 Kafka topic 列表命令，返回 topic 名字列表</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181 --list</span><br></pre></td></tr></table></figure>

<ul>
<li>创建 Kafka topic 命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181,hadoopdatanode2:2181,hadoopdatanode3:2181 --create --partitions 6 --replication-factor 2 --topic patent-grant</span><br></pre></td></tr></table></figure>

<ul>
<li> 查看 Kafka 指定 topic 的详情命令，返回该 topic 的 parition 数量、replica 因子以及每个 partition 的 leader、replica 信息</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181 --describe --topic patent-grant</span><br></pre></td></tr></table></figure>

<ul>
<li>查看 Kafka 指定 topic 各 partition 的 offset 信息命令，–time 参数为 -1 时，表示各分区最大的 offset，为 -2 时，表示各分区最小的 offset</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-run-class.sh kafka.tools.GetOffsetShell --broker-list hadoopdatanode1:9092 --time -1 --topic patent-grant</span><br></pre></td></tr></table></figure>

<ul>
<li>删除 Kafka topic 命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-topics.sh --zookeeper hadoopdatanode1:2181 --delete -topic patent-grant</span><br></pre></td></tr></table></figure>

<blockquote>
<p>只有 topic 不再被使用时，才能被删除。</p>
</blockquote>
<ul>
<li>修改 kafka topic 的数据保存时间：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-configs.sh --bootstrap-server hadoopdatanode1:9092 --alter --entity-type topics --entity-name extractor-patent --add-config retention.ms=2592000000</span><br></pre></td></tr></table></figure>

<blockquote>
<p>kafka 中默认消息的保留时间是 7 天，若想更改，需在配置文件 server.properties 里更改选项：log.retention.hours=168。</p>
<p>如果需要对某一个主题的消息存留的时间进行变更，但不影响其他主题，并且 kafka 集群不用重启，则使用上面的命令修改，该命令设置的是 30 天。</p>
</blockquote>
<ul>
<li>查看 kafka topic 配置信息：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-configs.sh --bootstrap-server hadoopdatanode1:9092 --describe --entity-type topics --entity-name extractor-patent</span><br></pre></td></tr></table></figure>

<p>如果使用的是默认配置，显示：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dynamic configs <span class="keyword">for</span> topic extractor-patent are:</span><br></pre></td></tr></table></figure>

<p>如果更改了配置，显示：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dynamic configs <span class="keyword">for</span> topic extractor-patent are:</span><br><span class="line">  retention.ms=2592000000 sensitive=<span class="literal">false</span> synonyms=&#123;DYNAMIC_TOPIC_CONFIG:retention.ms=2592000000&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>查看 kafka consumer group 命令，返回 consumer group 名字列表 (新版信息保存在 broker 中，老版信息保存在 zookeeper 中，二者命令不同)</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --list</span><br></pre></td></tr></table></figure>

<blockquote>
<p>老版命令：<code>~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --zookeeper hadoopdatanode1:2181 --list</code></p>
</blockquote>
<ul>
<li>查看 Kafka 指定 consumer group 的详情命令，返回 consumer group 对应的 topic 信息、当前消费的 offset、总 offset、剩余待消费 offset 等信息</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --describe --group log-consumer</span><br></pre></td></tr></table></figure>

<ul>
<li>重置 Kafka 指定 consumer group 消费的 topic 的 offset 命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --reset-offsets -to-offset 0 --execute --topic patent-app --group log-consumer</span><br></pre></td></tr></table></figure>

<ul>
<li>删除 Kafka 指定 consumer group 命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-consumer-groups.sh --bootstrap-server hadoopdatanode1:9092 --delete --group log-consumer</span><br></pre></td></tr></table></figure>

<ul>
<li>消费 Kafka 指定 topic 的内容命令</li>
</ul>
<p>kafka-console-consumer.sh 脚本是一个简易的消费者控制台。该 shell 脚本的功能通过调用 kafka.tools 包下的 ConsoleConsumer 类，并将提供的命令行参数全部传给该类实现。</p>
<p>参数说明：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh</span><br><span class="line">This tool helps to <span class="built_in">read</span> data from Kafka topics and outputs it to standard output.</span><br><span class="line">Option                                   Description                            </span><br><span class="line">------                                   -----------                            </span><br><span class="line">--bootstrap-server &lt;String: server to    REQUIRED: The server(s) to connect to. </span><br><span class="line">  connect to&gt;                                                                   </span><br><span class="line">--consumer-property &lt;String:             A mechanism to pass user-defined       </span><br><span class="line">  consumer_prop&gt;                           properties <span class="keyword">in</span> the form key=value to  </span><br><span class="line">                                           the consumer.                        </span><br><span class="line">--consumer.config &lt;String: config file&gt;  Consumer config properties file. Note  </span><br><span class="line">                                           that [consumer-property] takes       </span><br><span class="line">                                           precedence over this config.         </span><br><span class="line">--enable-systest-events                  Log lifecycle events of the consumer   </span><br><span class="line">                                           <span class="keyword">in</span> addition to logging consumed      </span><br><span class="line">                                           messages. (This is specific <span class="keyword">for</span>      </span><br><span class="line">                                           system tests.)                       </span><br><span class="line">--formatter &lt;String: class&gt;              The name of a class to use <span class="keyword">for</span>         </span><br><span class="line">                                           formatting kafka messages <span class="keyword">for</span>        </span><br><span class="line">                                           display. (default: kafka.tools.      </span><br><span class="line">                                           DefaultMessageFormatter)             </span><br><span class="line">--from-beginning                         If the consumer does not already have  </span><br><span class="line">                                           an established offset to consume     </span><br><span class="line">                                           from, start with the earliest        </span><br><span class="line">                                           message present <span class="keyword">in</span> the <span class="built_in">log</span> rather    </span><br><span class="line">                                           than the latest message.             </span><br><span class="line">--group &lt;String: consumer group id&gt;      The consumer group id of the consumer. </span><br><span class="line">--<span class="built_in">help</span>                                   Print usage information.               </span><br><span class="line">--isolation-level &lt;String&gt;               Set to read_committed <span class="keyword">in</span> order to      </span><br><span class="line">                                           filter out transactional messages    </span><br><span class="line">                                           <span class="built_in">which</span> are not committed. Set to      </span><br><span class="line">                                           read_uncommitted to <span class="built_in">read</span> all         </span><br><span class="line">                                           messages. (default: read_uncommitted)</span><br><span class="line">--key-deserializer &lt;String:                                                     </span><br><span class="line">  deserializer <span class="keyword">for</span> key&gt;                                                         </span><br><span class="line">--max-messages &lt;Integer: num_messages&gt;   The maximum number of messages to      </span><br><span class="line">                                           consume before exiting. If not <span class="built_in">set</span>,  </span><br><span class="line">                                           consumption is continual.            </span><br><span class="line">--offset &lt;String: consume offset&gt;        The offset id to consume from (a non-  </span><br><span class="line">                                           negative number), or <span class="string">&#x27;earliest&#x27;</span>      </span><br><span class="line">                                           <span class="built_in">which</span> means from beginning, or       </span><br><span class="line">                                           <span class="string">&#x27;latest&#x27;</span> <span class="built_in">which</span> means from end        </span><br><span class="line">                                           (default: latest)                    </span><br><span class="line">--partition &lt;Integer: partition&gt;         The partition to consume from.         </span><br><span class="line">                                           Consumption starts from the end of   </span><br><span class="line">                                           the partition unless <span class="string">&#x27;--offset&#x27;</span> is   </span><br><span class="line">                                           specified.                           </span><br><span class="line">--property &lt;String: prop&gt;                The properties to initialize the       </span><br><span class="line">                                           message formatter. Default           </span><br><span class="line">                                           properties include:                  </span><br><span class="line">                                         	print.timestamp=<span class="literal">true</span>|<span class="literal">false</span>            </span><br><span class="line">                                         	print.key=<span class="literal">true</span>|<span class="literal">false</span>                  </span><br><span class="line">                                         	print.value=<span class="literal">true</span>|<span class="literal">false</span>                </span><br><span class="line">                                         	key.separator=&lt;key.separator&gt;         </span><br><span class="line">                                         	line.separator=&lt;line.separator&gt;       </span><br><span class="line">                                         	key.deserializer=&lt;key.deserializer&gt;   </span><br><span class="line">                                         	value.deserializer=&lt;value.            </span><br><span class="line">                                           deserializer&gt;                        </span><br><span class="line">                                         Users can also pass <span class="keyword">in</span> customized      </span><br><span class="line">                                           properties <span class="keyword">for</span> their formatter; more </span><br><span class="line">                                           specifically, users can pass <span class="keyword">in</span>      </span><br><span class="line">                                           properties keyed with <span class="string">&#x27;key.          </span></span><br><span class="line"><span class="string">                                           deserializer.&#x27;</span> and <span class="string">&#x27;value.           </span></span><br><span class="line"><span class="string">                                           deserializer.&#x27;</span> prefixes to configure </span><br><span class="line">                                           their deserializers.                 </span><br><span class="line">--skip-message-on-error                  If there is an error when processing a </span><br><span class="line">                                           message, skip it instead of halt.    </span><br><span class="line">--timeout-ms &lt;Integer: timeout_ms&gt;       If specified, <span class="built_in">exit</span> <span class="keyword">if</span> no message is    </span><br><span class="line">                                           available <span class="keyword">for</span> consumption <span class="keyword">for</span> the    </span><br><span class="line">                                           specified interval.                  </span><br><span class="line">--topic &lt;String: topic&gt;                  The topic id to consume on.            </span><br><span class="line">--value-deserializer &lt;String:                                                   </span><br><span class="line">  deserializer <span class="keyword">for</span> values&gt;                                                      </span><br><span class="line">--version                                Display Kafka version.                 </span><br><span class="line">--whitelist &lt;String: whitelist&gt;          Regular expression specifying          </span><br><span class="line">                                           whitelist of topics to include <span class="keyword">for</span>   </span><br><span class="line">                                           consumption.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参数说明参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29116427/article/details/80206125">https://blog.csdn.net/qq_29116427/article/details/80206125</a></p>
</blockquote>
<p>从头开始消费：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --from-beginning --topic log-collect</span><br></pre></td></tr></table></figure>

<p>从头开始消费前 10 条消息，并显示 key：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --from-beginning --max-messages 10 --property print.key=<span class="literal">true</span> --topic log-collect</span><br></pre></td></tr></table></figure>

<p>从指定分区、指定 offset 开始消费：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --partition 0 --offset 219000 --topic log-collect</span><br></pre></td></tr></table></figure>

<p>从尾开始消费，必须指定分区：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ~/kafka_2.12-2.6.0/bin/kafka-console-consumer.sh --bootstrap-server hadoopdatanode1:9092 --partition 0 --offset latest --topic log-collect</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/22/shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/22/shell/" class="post-title-link" itemprop="url">shell 脚本中的一些方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-22 17:16:35" itemprop="dateCreated datePublished" datetime="2020-12-22T17:16:35+08:00">2020-12-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-01 16:13:35" itemprop="dateModified" datetime="2021-01-01T16:13:35+08:00">2021-01-01</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>5.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="字符串截取"><a href="#字符串截取" class="headerlink" title="字符串截取"></a>字符串截取</h2><p>shell 截取字符串通常有两种方式：从指定位置开始截取和从指定字符 (子字符串) 开始截取。</p>
<h3 id="从指定位置开始截取"><a href="#从指定位置开始截取" class="headerlink" title="从指定位置开始截取"></a>从指定位置开始截取</h3><p>两个参数：起始位置，截取长度。</p>
<h4 id="从字符串左边开始计数"><a href="#从字符串左边开始计数" class="headerlink" title="从字符串左边开始计数"></a>从字符串左边开始计数</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;string: start :length&#125;</span></span><br></pre></td></tr></table></figure>

<p>其中，string 是要截取的字符串，start 是起始位置 (从左边开始，从 0 开始计数)，length 是要截取的长度 (如果省略表示直到字符串的末尾)。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;c.biancheng.net&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 2: 9&#125;</span></span><br><span class="line"></span><br><span class="line">biancheng</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;c.biancheng.net&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 2&#125;</span></span><br><span class="line"></span><br><span class="line">biancheng.net</span><br></pre></td></tr></table></figure>

<h4 id="从字符串右边开始计数"><a href="#从字符串右边开始计数" class="headerlink" title="从字符串右边开始计数"></a>从字符串右边开始计数</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;string: 0-start :length&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>0-</code> 是固定的写法，专门用来表示从字符串右边开始计数。</p>
<blockquote>
<p>从左边开始计数时，起始数字是 0；从右边开始计数时，起始数字是 1。计数方向不同，起始数字也不同。</p>
<p>不管从哪边开始计数，截取方向都是从左到右。</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;c.biancheng.net&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 0-13: 9&#125;</span></span><br><span class="line"></span><br><span class="line">biancheng</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;c.biancheng.net&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 0-13&#125;</span></span><br><span class="line"></span><br><span class="line">biancheng.net</span><br></pre></td></tr></table></figure>

<blockquote>
<p>从右边数，b 是第 13 个字符。</p>
</blockquote>
<h3 id="从指定字符-子字符串-开始截取"><a href="#从指定字符-子字符串-开始截取" class="headerlink" title="从指定字符 (子字符串) 开始截取"></a>从指定字符 (子字符串) 开始截取</h3><p>这种截取方式无法指定字符串长度，只能从指定字符 (子字符串) 截取到字符串末尾。shell 可以截取指定字符 (子字符串) 右边的所有字符，也可以截取左边的所有字符。</p>
<h4 id="使用-截取指定字符-子字符串-右边字符"><a href="#使用-截取指定字符-子字符串-右边字符" class="headerlink" title="使用 # 截取指定字符 (子字符串)右边字符"></a>使用 # 截取指定字符 (子字符串)右边字符</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;string#*chars&#125;</span></span><br></pre></td></tr></table></figure>

<p>其中，string 表示要截取的字符，chars 是指定的字符 (子字符串)，<code>*</code> 是通配符的一种，表示任意长度的字符串。<code>*chars</code> 连起来使用的意思是：忽略左边的所有字符，直到遇见 chars (chars 不会被截取)。</p>
<blockquote>
<p>从左往右看。</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#*:&#125;</span></span><br><span class="line"></span><br><span class="line">//c.biancheng.net/index.html</span><br></pre></td></tr></table></figure>

<p>以下写法也可以得到同样的结果：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#*p:&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#*ttp:&#125;</span></span><br></pre></td></tr></table></figure>

<p>如果不需要忽略 chars 左边的字符，那么也可以不写 <code>*</code>，例如：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#http://&#125;</span></span><br><span class="line"></span><br><span class="line">c.biancheng.net/index.html</span><br></pre></td></tr></table></figure>

<p>注意，以上写法遇到第一个匹配的字符 (子字符串) 就结束了。例如：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#*/&#125;</span></span><br><span class="line"></span><br><span class="line">/c.biancheng.net/index.html</span><br></pre></td></tr></table></figure>

<blockquote>
<p>url 字符串中有三个 <code>/</code>，输出结果表明，shell 遇到第一个 <code>/</code> 就匹配结束了。</p>
</blockquote>
<p>如果希望直到最后一个指定字符 (子字符串) 再匹配结束，那么可以使用 <code>##</code>，具体格式为：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;string##*chars&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#*/&#125;</span>    <span class="comment"># 结果为 /c.biancheng.net/index.html</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url##*/&#125;</span>   <span class="comment"># 结果为 index.html</span></span><br><span class="line"></span><br><span class="line">str=<span class="string">&quot;---aa+++aa@@@&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str#*aa&#125;</span>   <span class="comment"># 结果为 +++aa@@@</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str##*aa&#125;</span>  <span class="comment"># 结果为 @@@</span></span><br></pre></td></tr></table></figure>

<h4 id="使用-截取指定字符-子字符串-左边字符"><a href="#使用-截取指定字符-子字符串-左边字符" class="headerlink" title="使用 % 截取指定字符 (子字符串)左边字符"></a>使用 % 截取指定字符 (子字符串)左边字符</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;string%chars*&#125;</span></span><br></pre></td></tr></table></figure>

<p>注意 <code>*</code> 的位置，因为要截取 chars 左边的字符，而忽略 chars 右边的字符，所以 <code>*</code> 应该位于 chars 的右侧。其他方面 <code>%</code> 和 <code>#</code> 的用法相同。</p>
<blockquote>
<p>从右往左看。</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url%/*&#125;</span>  <span class="comment"># 结果为 http://c.biancheng.net</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url%%/*&#125;</span>  <span class="comment"># 结果为 http:</span></span><br><span class="line"></span><br><span class="line">str=<span class="string">&quot;---aa+++aa@@@&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str%aa*&#125;</span>  <span class="comment"># 结果为 ---aa+++</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str%%aa*&#125;</span>  <span class="comment"># 结果为 ---</span></span><br></pre></td></tr></table></figure>

<h3 id="汇总"><a href="#汇总" class="headerlink" title="汇总"></a>汇总</h3><table>
<thead>
<tr>
<th>格式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>${string: start :length}</td>
<td>从 string 字符串的左边第 start 个字符开始，向右截取 length 个字符。</td>
</tr>
<tr>
<td>${string: start}</td>
<td>从 string 字符串的左边第 start 个字符开始截取，直到最后。</td>
</tr>
<tr>
<td>${string: 0-start :length}</td>
<td>从 string 字符串的右边第 start 个字符开始，向右截取 length 个字符。</td>
</tr>
<tr>
<td>${string: 0-start}</td>
<td>从 string 字符串的右边第 start 个字符开始截取，直到最后。</td>
</tr>
<tr>
<td>${string#*chars}</td>
<td>从 string 字符串第一次出现 *chars 的位置开始，截取 *chars 右边的所有字符。</td>
</tr>
<tr>
<td>${string##*chars}</td>
<td>从 string 字符串最后一次出现 *chars 的位置开始，截取 *chars 右边的所有字符。</td>
</tr>
<tr>
<td>${string%*chars}</td>
<td>从 string 字符串第一次出现 *chars 的位置开始，截取 *chars 左边的所有字符。</td>
</tr>
<tr>
<td>${string%%*chars}</td>
<td>从 string 字符串最后一次出现 *chars 的位置开始，截取 *chars 左边的所有字符。</td>
</tr>
</tbody></table>
<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/1120.html">http://c.biancheng.net/view/1120.html</a></p>
<h2 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">name=<span class="string">&quot;Shell&quot;</span></span><br><span class="line">url=<span class="string">&quot;http://c.biancheng.net/shell/&quot;</span></span><br><span class="line"></span><br><span class="line">str1=<span class="variable">$name</span><span class="variable">$url</span>  <span class="comment"># 中间不能有空格</span></span><br><span class="line">str2=<span class="string">&quot;<span class="variable">$name</span> <span class="variable">$url</span>&quot;</span>  <span class="comment"># 如果被双引号包围，那么中间可以有空格</span></span><br><span class="line">str3=<span class="variable">$name</span><span class="string">&quot;: &quot;</span><span class="variable">$url</span>  <span class="comment"># 中间可以出现别的字符串</span></span><br><span class="line">str4=<span class="string">&quot;<span class="variable">$name</span>: <span class="variable">$url</span>&quot;</span>  <span class="comment"># 这样写也可以</span></span><br><span class="line">str5=<span class="string">&quot;<span class="variable">$&#123;name&#125;</span>Script: <span class="variable">$&#123;url&#125;</span>index.html&quot;</span>  <span class="comment"># 这个时候需要给变量名加上大括号</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$str1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$str2</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$str3</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$str4</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$str5</span></span><br><span class="line"></span><br><span class="line">Shellhttp://c.biancheng.net/shell/</span><br><span class="line">Shell http://c.biancheng.net/shell/</span><br><span class="line">Shell: http://c.biancheng.net/shell/</span><br><span class="line">Shell: http://c.biancheng.net/shell/</span><br><span class="line">ShellScript: http://c.biancheng.net/shell/index.html</span><br></pre></td></tr></table></figure>

<p>对于第 7 行代码，$name 和 $url 之间之所以不能出现空格，是因为当字符串不被任何一种引号包围时，遇到空格就认为字符串结束了，空格后边的内容会作为其他变量或者命令解析。</p>
<p>对于第 10 行代码，加 { } 是为了帮助解释器识别变量的边界。</p>
<h2 id="字符串分割"><a href="#字符串分割" class="headerlink" title="字符串分割"></a>字符串分割</h2><h3 id="以空格为分隔符"><a href="#以空格为分隔符" class="headerlink" title="以空格为分隔符"></a>以空格为分隔符</h3><p>比如有一个变量 “123 456 789”，要求以空格为分隔符把这个变量分隔，并把分隔后的字段分别赋值给变量，即 a=123；b=456；c=789。<br>共有3中方法：<br>方法一：先定义一个数组，然后把分隔出来的字段赋值给数组中的每一个元素<br>方法二：通过 eval+ 赋值的方式<br>方法三：通过多次 awk 把每个字段赋值</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=<span class="string">&quot;123 456 789&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法一：通过数组的方式</span></span><br><span class="line"><span class="built_in">declare</span> -a arr</span><br><span class="line">index=0</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">echo</span> <span class="variable">$a</span> | awk <span class="string">&#x27;&#123;print $1,$3&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    arr[<span class="variable">$index</span>]=<span class="variable">$i</span></span><br><span class="line">    <span class="built_in">let</span> <span class="string">&quot;index+=1&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;arr[0]&#125;</span> <span class="comment"># 结果为 123</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;arr[1]&#125;</span> <span class="comment"># 结果为 789</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二：通过eval+赋值的方式</span></span><br><span class="line">b=<span class="string">&quot;&quot;</span></span><br><span class="line">c=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">eval</span> $(<span class="built_in">echo</span> <span class="variable">$a</span> | awk <span class="string">&#x27;&#123; printf(&quot;b=%s;c=%s&quot;,$2,$1)&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$b</span> <span class="comment"># 结果为 456</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$c</span> <span class="comment"># 结果为 123</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法三：通过多次awk赋值的方式</span></span><br><span class="line">m=<span class="string">&quot;&quot;</span></span><br><span class="line">n=<span class="string">&quot;&quot;</span></span><br><span class="line">m=`<span class="built_in">echo</span> <span class="variable">$a</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line">n=`<span class="built_in">echo</span> <span class="variable">$a</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$m</span> <span class="comment"># 结果为 123</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$n</span> <span class="comment"># 结果为 456</span></span><br></pre></td></tr></table></figure>

<h3 id="指定分隔符"><a href="#指定分隔符" class="headerlink" title="指定分隔符"></a>指定分隔符</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">string=<span class="string">&quot;hello,shell,haha&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法一  </span></span><br><span class="line">array=(<span class="variable">$&#123;string//,/ &#125;</span>)  </span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> <span class="variable">$&#123;array[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="variable">$var</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二</span></span><br><span class="line">IFS=<span class="string">&quot;,&quot;</span></span><br><span class="line">OLD_IFS=<span class="string">&quot;<span class="variable">$IFS</span>&quot;</span></span><br><span class="line">IFS=<span class="string">&quot;<span class="variable">$OLD_IFS</span>&quot;</span></span><br><span class="line">array2=(<span class="variable">$string</span>)</span><br><span class="line"><span class="keyword">for</span> var2 <span class="keyword">in</span> <span class="variable">$&#123;array2[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="variable">$var2</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line">shell</span><br><span class="line">haha</span><br><span class="line">hello</span><br><span class="line">shell</span><br><span class="line">haha</span><br></pre></td></tr></table></figure>

<h2 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h2><p>反引号：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var=`<span class="built_in">command</span>`</span><br></pre></td></tr></table></figure>

<p><code>$()</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var=$(<span class="built_in">command</span>)</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ A=`date`</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$A</span></span><br><span class="line">Fri Dec 25 20:02:30 CST 2020 <span class="comment"># 变量A存放了date命令的执行结果</span></span><br><span class="line"></span><br><span class="line">$ B=$(date)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$B</span></span><br><span class="line">Fri Dec 25 20:03:12 CST 2020 <span class="comment"># 变量B存放了date命令的执行结果</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：= 号前后不要有空格。</p>
</blockquote>
<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="https://book.51cto.com/art/201411/457601.htm">https://book.51cto.com/art/201411/457601.htm</a></p>
<h2 id="判断文件夹是否存在"><a href="#判断文件夹是否存在" class="headerlink" title="判断文件夹是否存在"></a>判断文件夹是否存在</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -d testgrid  ];<span class="keyword">then</span></span><br><span class="line">  mkdir testgrid</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> dir exist</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p>外部传参：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断传入的参数的个数是不是一个</span></span><br><span class="line"><span class="keyword">if</span> [ ! <span class="variable">$#</span> -eq 1  ];<span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> param error!</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断目录是不是已经存在，如果不存在则创建，存在则输出&quot;dir exist&quot; </span></span><br><span class="line">dirname=<span class="variable">$1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;the dir name is <span class="variable">$dirname</span>&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ ! -d <span class="variable">$dirname</span>  ];<span class="keyword">then</span></span><br><span class="line">  mkdir <span class="variable">$dirname</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> dir exist</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>类 C 语言：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ((i=1; i&lt;=100; i ++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>in 使用：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..100&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>seq 使用：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 100`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="发送微信消息"><a href="#发送微信消息" class="headerlink" title="发送微信消息"></a>发送微信消息</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/whatday/article/details/105781861">https://blog.csdn.net/whatday/article/details/105781861</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/15/linux-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="XiSun">
      <meta itemprop="description" content="心如止水者，虽世间繁华之红尘纷扰，已然空无一物">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiSun的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/15/linux-command/" class="post-title-link" itemprop="url">linux 命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-15 17:31:47" itemprop="dateCreated datePublished" datetime="2020-12-15T17:31:47+08:00">2020-12-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-01-01 19:35:41" itemprop="dateModified" datetime="2021-01-01T19:35:41+08:00">2021-01-01</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>24 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>用于在指定目录下查找文件。默认列出当前目录及子目录下所有的文件和文件夹。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find   path   -option   [   -<span class="built_in">print</span> ]   [ -<span class="built_in">exec</span>   -ok   <span class="built_in">command</span> ]   &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p><strong>-print</strong>： find 命令将匹配到的文件输出到标准输出。</p>
<p><strong>-exec</strong>： find 命令对匹配的文件执行该参数所给出的 Shell 命令。</p>
<p><strong>-ok</strong>： 和 -exec 的作用相同，只是更安全，在执行每个命令之前，都会给出提示，让用户来确定是否执行。</p>
<h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">-mount, -xdev</span><br><span class="line">		只检查和指定目录在同一个文件系统下的文件，避免列出其它文件系统中的文件。</span><br><span class="line"></span><br><span class="line">-amin n</span><br><span class="line">		在过去n分钟内被读取过。</span><br><span class="line"></span><br><span class="line">-anewer file</span><br><span class="line">		比文件file更晚被读取过的文件。</span><br><span class="line"></span><br><span class="line">-atime n</span><br><span class="line">		在过去n天内被读取过的文件。</span><br><span class="line">		</span><br><span class="line">-cmin n</span><br><span class="line">		在过去n分钟内被修改过。</span><br><span class="line">		</span><br><span class="line">-cnewer file</span><br><span class="line">		比文件file更新的文件。</span><br><span class="line">		</span><br><span class="line">-ctime n</span><br><span class="line">		在过去n天内被修改过的文件。</span><br><span class="line">		</span><br><span class="line">-empty</span><br><span class="line">		空的文件。</span><br><span class="line">		</span><br><span class="line">-gid n</span><br><span class="line">		gid是n。</span><br><span class="line">		</span><br><span class="line">-group name</span><br><span class="line">		group名称是name。</span><br><span class="line">		</span><br><span class="line">-path p | -ipath p</span><br><span class="line">		路径名称符合p的文件。ipath忽略大小写。</span><br><span class="line">		</span><br><span class="line">-name name | -iname name</span><br><span class="line">		文件名称符合name的文件。iname忽略大小写。</span><br><span class="line">		</span><br><span class="line">-size n</span><br><span class="line">		文件大小是n单位，b代表512位元组的区块，c表示字元数，k表示kilo bytes，w是二个位元组。</span><br><span class="line">		</span><br><span class="line">-<span class="built_in">type</span> d|f</span><br><span class="line">		文件类型是d|f的文件。</span><br><span class="line">		</span><br><span class="line">-pid n</span><br><span class="line">		process id是n的文件。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>文件类型：d — 目录，f — 一般文件，c — 字型装置文件，b — 区块装置文件，p — 具名贮列，l — 符号连结，s — socket。</p>
</blockquote>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ul>
<li>查询当前路径下的所有目录|普通文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -<span class="built_in">type</span> d</span><br><span class="line">$ find ./ -<span class="built_in">type</span> f</span><br></pre></td></tr></table></figure>

<ul>
<li>查询权限为 777 的普通文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -<span class="built_in">type</span> f -perm 777</span><br></pre></td></tr></table></figure>

<ul>
<li>查询 .XML 文件，且权限不为 777</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -<span class="built_in">type</span> f -name <span class="string">&quot;*.XML&quot;</span> ! -perm 777</span><br></pre></td></tr></table></figure>

<ul>
<li>查询 .XML 文件，并统计查询结果的条数</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> | wc -l</span><br></pre></td></tr></table></figure>

<ul>
<li>查询 .XML 文件，并复制查询结果到指定路径</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> | xargs -i cp &#123;&#125; ../111</span><br><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> -<span class="built_in">exec</span> cp &#123;&#125; ../111 \;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此命令不同于 cp，<code>cp *.XML ../111</code> 命令复制的是当前路径下符合条件的所有文件，子路径的不会被复制。</p>
</blockquote>
<ul>
<li>查询 .XML 文件，并删除</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> | xargs -i rm &#123;&#125;</span><br><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> -<span class="built_in">exec</span> rm &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此命令不同于 rm，<code>rm *.XML</code> 命令删除的是当前路径下符合条件的所有文件，子路径的不会被删除。</p>
</blockquote>
<ul>
<li>查询 .XML 文件，并将查询结果以 “File: 文件名” 的形式打印出来</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> | xargs -i <span class="built_in">printf</span> <span class="string">&quot;File: %s\n&quot;</span> &#123;&#125;</span><br><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> -<span class="built_in">exec</span> <span class="built_in">printf</span> <span class="string">&quot;File: %s\n&quot;</span> &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<ul>
<li>将当前路径及子路径下所有 3 天前的 .XML 格式的文件复制一份到指定路径</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -name <span class="string">&quot;*.XML&quot;</span> -mtime +3 -<span class="built_in">exec</span> cp &#123;&#125; ../111 \;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询多个文件后缀类型的文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -regextype posix-extended -regex <span class="string">&quot;.*\.(java|xml|XML)&quot;</span>	 <span class="comment"># 查找所有的.java、.xml和.XML文件</span></span><br><span class="line">$ find ./ -name <span class="string">&quot;*.java&quot;</span> -o -name <span class="string">&quot;*.xml&quot;</span> -o -name <span class="string">&quot;*.XML&quot;</span>		 <span class="comment"># -o选项，适用于查询少量文件后缀类型</span></span><br></pre></td></tr></table></figure>

<ul>
<li>组合查询，可以多次拼接查询条件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -name <span class="string">&quot;file1*&quot;</span> -a -name <span class="string">&quot;*.xml&quot;</span>	<span class="comment"># -a：与，查找以file1开头，且以.xml 结尾的文件</span></span><br><span class="line">$ find ./ -name <span class="string">&quot;file1*&quot;</span> -o -name <span class="string">&quot;*.xml&quot;</span>	<span class="comment"># -o：或，查找以file1开头，或以.xml 结尾的文件</span></span><br><span class="line">$ find ./ -name <span class="string">&quot;file1*&quot;</span> -not -name <span class="string">&quot;*.xml&quot;</span>	<span class="comment"># -not：非，查找以file1开头，且不以.xml 结尾的文件</span></span><br><span class="line">$ find ./ -name <span class="string">&quot;file1*&quot;</span> ! -name <span class="string">&quot;file2*&quot;</span>	<span class="comment"># !：同-not</span></span><br></pre></td></tr></table></figure>

<ul>
<li>查询当前目录下文件类型为 d 的文件，不包含子目录</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ -maxdepth 1 -<span class="built_in">type</span> d</span><br></pre></td></tr></table></figure>

<ul>
<li>和正则表达式的结合使用</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find ./ –name <span class="string">&quot;[^abc]*&quot;</span>	<span class="comment"># 在当前路径中搜索不以a、b、c开头的所有文件</span></span><br><span class="line">$ find ./ -name <span class="string">&quot;[A-Z0-9]*&quot;</span>	<span class="comment"># 在当前路径中搜索以大写字母或数字开头的所有文件</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>正则表达式符号含义：</p>
<p>*          代表任意字符 (可以没有字符)</p>
<p>?          代表任意单个字符</p>
<p>[]         代表括号内的任意字符，如 [abc] 可以匹配 a\b\c 某个字符</p>
<p>[a-z]    可以匹配 a-z 的某个字母</p>
<p>[A-Z]    可以匹配 A-Z 的某个字符</p>
<p>[0-9]    可以匹配 0-9 的某个数字</p>
<p>^          用在 [] 内的前缀表示不匹配 [] 中的字符</p>
<p>[^a-z]  表示不匹配a-z的某个字符</p>
</blockquote>
<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b30a8aa4d1f1">https://www.jianshu.com/p/b30a8aa4d1f1</a></p>
<p><a target="_blank" rel="noopener" href="https://www.oracle.com/cn/technical-resources/articles/linux-calish-find.html">https://www.oracle.com/cn/technical-resources/articles/linux-calish-find.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qmfsun/p/3811142.html">https://www.cnblogs.com/qmfsun/p/3811142.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ay-a/p/8017419.html">https://www.cnblogs.com/ay-a/p/8017419.html</a></p>
<h2 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h2><p>用于连接文件或标准输入并打印。这个命令常用来显示文件内容，或者将几个文件连接起来显示，或者从标准输入读取内容并显示，它常与重定向符号配合使用。 </p>
<h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat [-AbeEnstTuv] [--<span class="built_in">help</span>] [--version] fileName</span><br></pre></td></tr></table></figure>

<h3 id="参数说明-1"><a href="#参数说明-1" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-n | --number</span><br><span class="line">		由1开始对所有输出的行数编号。</span><br><span class="line"></span><br><span class="line">-b | --number-nonblank</span><br><span class="line">		和-n相似，只不过对于空白行不编号。</span><br><span class="line"></span><br><span class="line">-s | --squeeze-blank</span><br><span class="line">		当遇到有连续两行以上的空白行，就代换为一行的空白行。</span><br><span class="line"></span><br><span class="line">-v | --show-nonprinting</span><br><span class="line">		使用^和M-符号，除了LFD和TAB之外。</span><br><span class="line"></span><br><span class="line">-E | --show-ends</span><br><span class="line">		在每行结束处显示$。</span><br><span class="line">		</span><br><span class="line">-T | --show-tabs</span><br><span class="line">		将TAB字符显示为^I。</span><br><span class="line">		</span><br><span class="line">-A | --show-all</span><br><span class="line">		等价于<span class="string">&quot;-vET&quot;</span>。</span><br><span class="line">		</span><br><span class="line">-e</span><br><span class="line">		等价于<span class="string">&quot;-vE&quot;</span>。</span><br><span class="line">		</span><br><span class="line">-t</span><br><span class="line">		等价于<span class="string">&quot;-vT&quot;</span>。</span><br></pre></td></tr></table></figure>

<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><ul>
<li>把 textfile1 的文档内容加上行号后输入 textfile2 这个文档里</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat -n textfile1 &gt; textfile2</span><br></pre></td></tr></table></figure>

<ul>
<li>清空 /etc/test.txt 文档内容</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat /dev/null &gt; /etc/test.txt</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>/dev/null</strong>：在类 Unix 系统中，/dev/null 称空设备，是一个特殊的设备文件，它丢弃一切写入其中的数据 (但报告写入操作成功)，读取它则会立即得到一个 EOF。</p>
<p>而使用 <code>cat $filename &gt; /dev/null</code> 则不会得到任何信息，因为我们将本来该通过标准输出显示的文件信息重定向到了 /dev/null 中。</p>
<p>使用 <code>cat $filename 1 &gt; /dev/null</code> 也会得到同样的效果，因为默认重定向的 1 就是标准输出。 如果你对 shell 脚本或者重定向比较熟悉的话，应该会联想到 2 ，也即标准错误输出。</p>
<p>如果我们不想看到错误输出呢？我们可以禁止标准错误 <code>cat $badname 2 &gt; /dev/null</code>。</p>
</blockquote>
<ul>
<li>合并多个文件内容</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat b1.sql b2.sql b3.sql &gt; b_all.sql</span><br><span class="line">$ cat *.sql &gt; merge.sql</span><br></pre></td></tr></table></figure>

<h2 id="head"><a href="#head" class="headerlink" title="head"></a>head</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zmx19951103/article/details/78575265">https://blog.csdn.net/zmx19951103/article/details/78575265</a></p>
<h2 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/luo200618/article/details/52510638">https://blog.csdn.net/luo200618/article/details/52510638</a></p>
<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qmfsun/p/6626361.html">https://www.cnblogs.com/qmfsun/p/6626361.html</a></p>
<h2 id="jq"><a href="#jq" class="headerlink" title="jq"></a>jq</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dde911234761">https://www.jianshu.com/p/dde911234761</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/whatday/article/details/105781861">https://blog.csdn.net/whatday/article/details/105781861</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_26502245/article/details/100191694">https://blog.csdn.net/qq_26502245/article/details/100191694</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011641885/article/details/45559031">https://blog.csdn.net/u011641885/article/details/45559031</a></p>
<h2 id="basename"><a href="#basename" class="headerlink" title="basename"></a>basename</h2><p>用于去掉文件名的目录和后缀。</p>
<h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">	basename NAME [SUFFIX]</span><br><span class="line">or:	basename OPTION... NAME...</span><br></pre></td></tr></table></figure>

<p>去掉 NAME 中的目录部分和后缀 SUFFIX，如果输出结果没有，则输出 SUFFIX。</p>
<h3 id="参数说明-2"><a href="#参数说明-2" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-a | --multiple</span><br><span class="line">			support multiple arguments and treat each as a NAME</span><br><span class="line">			</span><br><span class="line">-s | --suffix=SUFFIX</span><br><span class="line">			remove a trailing SUFFIX; implies -a</span><br><span class="line">			</span><br><span class="line">-z | --zero</span><br><span class="line">			end each output line with NUL, not newline(默认情况下，每条输出行以换行符结尾)</span><br><span class="line">			</span><br><span class="line">--<span class="built_in">help</span></span><br><span class="line">			display this <span class="built_in">help</span> and <span class="built_in">exit</span></span><br><span class="line">			</span><br><span class="line">--version</span><br><span class="line">			output version information and <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h3 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h3><ul>
<li>去除目录</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$basename</span> /usr/bin/sort</span><br><span class="line">sort</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ basename /usr/include/stdio.h    </span><br><span class="line">stdio.h</span><br></pre></td></tr></table></figure>

<ul>
<li>去除目录和后缀</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ basename /usr/include/stdio.h .h</span><br><span class="line">stdio</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ basename -s .h /usr/include/stdio.h</span><br><span class="line">stdio</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ basename /usr/include/stdio.h stdio.h </span><br><span class="line">stdio.h</span><br></pre></td></tr></table></figure>

<ul>
<li>去除多个目录</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ basename -a any1/str1 any2/str2 any3/str3</span><br><span class="line">str1</span><br><span class="line">str2</span><br><span class="line">str3</span><br></pre></td></tr></table></figure>

<h2 id="dirname"><a href="#dirname" class="headerlink" title="dirname"></a>dirname</h2><p>用于去除文件名中的非目录部分，删除最后一个 “\“ 后面的路径，显示父目录。</p>
<h3 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirname [OPTION] NAME...</span><br></pre></td></tr></table></figure>

<p>如果 NAME 中不包含 /，则输出 .，即当前目录。</p>
<h3 id="参数说明-3"><a href="#参数说明-3" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-z | --zero</span><br><span class="line">		end each output line with NUL, not newline</span><br><span class="line">		</span><br><span class="line">--<span class="built_in">help</span></span><br><span class="line">		display this <span class="built_in">help</span> and <span class="built_in">exit</span></span><br><span class="line">		</span><br><span class="line">--version</span><br><span class="line">		output version information and <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h3 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ dirname /usr/bin/</span><br><span class="line">/usr</span><br><span class="line"></span><br><span class="line">$ dirname /usr/bin</span><br><span class="line">/usr</span><br><span class="line"></span><br><span class="line">$ dirname /etc/</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">$ dirname /etc/httpd/conf/httpd.conf</span><br><span class="line">/etc/httpd/conf</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ dirname dir1/str dir2/str</span><br><span class="line">dir1</span><br><span class="line">dir2</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ dirname stdio.h</span><br><span class="line">.</span><br></pre></td></tr></table></figure>

<h2 id="xargs"><a href="#xargs" class="headerlink" title="xargs"></a>xargs</h2><p>xargs 是给命令传递参数的一个过滤器，也是组合多个命令的一个工具。</p>
<p>xargs 可以将管道或标准输入 (stdin) 数据转换成命令行参数，也能够从文件的输出中读取数据。</p>
<p>xargs 也可以将单行或多行文本输入转换为其他格式，例如多行变单行，单行变多行。</p>
<p>xargs 默认的命令是 echo，这意味着通过管道传递给 xargs 的输入将会包含换行和空白，不过通过 xargs 的处理，换行和空白将被空格取代。</p>
<p>xargs 是一个强有力的命令，它能够捕获一个命令的输出，然后传递给另外一个命令。</p>
<p>之所以能用到这个命令，关键是由于很多命令不支持管道来传递参数，而日常工作中有有这个必要，所以就有了 xargs 命令，例如：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find /sbin -perm +700 | ls -l       <span class="comment">#这个命令是错误的</span></span><br><span class="line">find /sbin -perm +700 | xargs ls -l   <span class="comment">#这样才是正确的</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>xargs 一般是和管道一起使用。</p>
</blockquote>
<h3 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">some <span class="built_in">command</span> | xargs -item <span class="built_in">command</span></span><br></pre></td></tr></table></figure>

<h3 id="参数说明-4"><a href="#参数说明-4" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">-a file</span><br><span class="line">	从文件中读入作为sdtin</span><br><span class="line">		</span><br><span class="line">-e flag</span><br><span class="line">	注意有的时候可能会是-E，flag必须是一个以空格分隔的标志，当xargs分析到含有flag这个标志的时候就停止。</span><br><span class="line">		</span><br><span class="line">-p</span><br><span class="line">	当每次执行一个argument的时候询问一次用户。</span><br><span class="line">	</span><br><span class="line">-n num</span><br><span class="line">	后面加次数，表示命令在执行的时候一次用的argument的个数，默认是用所有的。</span><br><span class="line"></span><br><span class="line">-t</span><br><span class="line">	表示先打印命令，然后再执行。</span><br><span class="line"></span><br><span class="line">-i</span><br><span class="line">	或者是-I，这得看linux支持了，将xargs的每项名称，一般是一行一行赋值给&#123;&#125;，可以用&#123;&#125;代替。</span><br><span class="line"></span><br><span class="line">-r</span><br><span class="line">	no-run-if-empty，当xargs的输入为空的时候则停止xargs，不用再去执行了。</span><br><span class="line"></span><br><span class="line">-s</span><br><span class="line">	num命令行的最大字符数，指的是xargs后面那个命令的最大命令行字符数。</span><br><span class="line"></span><br><span class="line">-L num</span><br><span class="line">	从标准输入一次读取num行送给<span class="built_in">command</span>命令。</span><br><span class="line"></span><br><span class="line">-l</span><br><span class="line">	同 -L。</span><br><span class="line"></span><br><span class="line">-d delim</span><br><span class="line">	分隔符，默认的xargs分隔符是回车，argument的分隔符是空格，这里修改的是xargs的分隔符。</span><br><span class="line"></span><br><span class="line">-x</span><br><span class="line">	<span class="built_in">exit</span>的意思，主要是配合-s使用。</span><br><span class="line"></span><br><span class="line">-P</span><br><span class="line">	修改最大的进程数，默认是1，为0时候为as many as it can ，这个例子我没有想到，应该平时都用不到的吧。</span><br></pre></td></tr></table></figure>

<h3 id="实例-4"><a href="#实例-4" class="headerlink" title="实例"></a>实例</h3><ul>
<li>读取输入数据重新格式化后输出</li>
</ul>
<p>定义一个测试文件，内有多行文本数据：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.txt</span><br><span class="line">a b c d e f g</span><br><span class="line">h i j k l m n</span><br><span class="line">o p q</span><br><span class="line">r s t</span><br><span class="line">u v w x y z</span><br></pre></td></tr></table></figure>

<p>单行输出：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.txt | xargs</span><br><span class="line">a b c d e f g h i j k l m n o p q r s t u v w x y z</span><br></pre></td></tr></table></figure>

<p>-n 选项自定义多行输出：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.txt | xargs -n3</span><br><span class="line">a b c</span><br><span class="line">d e f</span><br><span class="line">g h i</span><br><span class="line">j k l</span><br><span class="line">m n o</span><br><span class="line">p q r</span><br><span class="line">s t u</span><br><span class="line">v w x</span><br><span class="line">y z</span><br></pre></td></tr></table></figure>

<p>-d 选项自定义一个定界符：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;nameXnameXnameXname&quot;</span> | xargs -dX</span><br><span class="line">name name name name</span><br></pre></td></tr></table></figure>

<p>结合 -n 选项使用：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;nameXnameXnameXname&quot;</span> | xargs -dX -n2</span><br><span class="line">name name</span><br><span class="line">name name</span><br></pre></td></tr></table></figure>

<ul>
<li>读取 stdin，将格式化后的参数传递给命令</li>
</ul>
<p>假设一个命令为 sk.sh 和一个保存参数的文件 arg.txt：</p>
<p>sk.sh 命令内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印出所有参数。</span></span><br><span class="line"><span class="built_in">echo</span> $*</span><br></pre></td></tr></table></figure>

<p>arg.txt 文件内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat arg.txt</span><br><span class="line">aaa</span><br><span class="line">bbb</span><br><span class="line">ccc</span><br></pre></td></tr></table></figure>

<p>xargs 的一个选项 -I，使用 -I 指定一个替换字符串 {}，这个字符串在 xargs 扩展时会被替换掉，当 -I 与 xargs 结合使用，每一个参数命令都会被执行一次：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat arg.txt | xargs -I &#123;&#125; ./sk.sh -p &#123;&#125; -l</span><br><span class="line">-p aaa -l</span><br><span class="line">-p bbb -l</span><br><span class="line">-p ccc -l</span><br></pre></td></tr></table></figure>

<p>复制所有图片文件到 /data/images 目录下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls *.jpg | xargs -n1 -I &#123;&#125; cp &#123;&#125; /data/images</span><br></pre></td></tr></table></figure>

<ul>
<li>结合 find 使用</li>
</ul>
<p>用 rm 删除太多的文件时候，可能得到一个错误信息：**/bin/rm Argument list too long.**， 用 xargs 去避免这个问题：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.log&quot;</span> -print0 | xargs -0 rm -f</span><br></pre></td></tr></table></figure>

<blockquote>
<p>xargs -0 将 \0 作为定界符。</p>
</blockquote>
<p>统计一个源代码目录中所有 php 文件的行数：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.php&quot;</span> -print0 | xargs -0 wc -l</span><br></pre></td></tr></table></figure>

<p>查找所有的 jpg 文件，并且压缩它们：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.jpg&quot;</span> -<span class="built_in">print</span> | xargs tar -zcvf images.tar.gz</span><br></pre></td></tr></table></figure>

<ul>
<li>xargs 其他应用</li>
</ul>
<p>假如你有一个文件包含了很多你希望下载的 URL，你能够使用 xargs 下载所有链接：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat url-list.txt | xargs wget -c</span><br></pre></td></tr></table></figure>

<p>参考：？？？</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangqiguo/p/6464234.html">https://www.cnblogs.com/wangqiguo/p/6464234.html</a></p>
<h2 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h2><p>linux 内置的 cron 进程能实现定时任务需求。</p>
<p>crontab 命令是 cron table 的简写，它是 cron 的配置文件，也可以叫它作业列表。我们可以在以下文件夹内找到相关配置文件：</p>
<ul>
<li>**/var/spool/cron/**：该目录下存放的是每个用户包括 root 的 crontab 任务，每个任务以创建者的名字命名。</li>
<li><strong>/etc/crontab</strong>：该文件负责调度各种管理和维护任务。</li>
<li>**/etc/cron.d/**：该目录用来存放任何要执行的crontab文件或脚本。</li>
<li>另外，还可以把脚本放在 <strong>/etc/cron.hourly、/etc/cron.daily、/etc/cron.weekly、/etc/cron.monthly</strong> 目录中，让它<strong>每小时/天/星期/月</strong>执行一次。</li>
</ul>
<h3 id="语法-5"><a href="#语法-5" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab [-u user] [ -e | -l | -r ]</span><br></pre></td></tr></table></figure>

<h3 id="参数说明-5"><a href="#参数说明-5" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-u user</span><br><span class="line">	用来设定某个用户的crontab服务，省略此参数表示操作当前用户的crontab。</span><br><span class="line"></span><br><span class="line">file</span><br><span class="line">	file是命令文件的名字，表示将file做为crontab的任务列表文件并载入crontab。如果在命令行中没有指定这个文件，crontab命令将接受标准输入(键盘)上键入的命令，并将它们载入crontab。</span><br><span class="line"></span><br><span class="line">-e</span><br><span class="line">	编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。</span><br><span class="line"></span><br><span class="line">-l</span><br><span class="line">	显示某个用户的crontab文件内容。如果不指定用户，则表示显示当前用户的crontab文件内容。</span><br><span class="line"></span><br><span class="line">-r</span><br><span class="line">	从/var/spool/cron目录中删除某个用户的crontab文件。如果不指定用户，则默认删除当前用户的crontab文件。</span><br><span class="line"></span><br><span class="line">-i</span><br><span class="line">	在删除用户的crontab文件时给确认提示。</span><br></pre></td></tr></table></figure>

<h3 id="实例-5"><a href="#实例-5" class="headerlink" title="实例"></a>实例</h3><p>设置定时任务时，输入 <code>crontab -e</code> 命令，进入当前用户的工作表编辑，是常见的 vim 界面。每行是一条命令。</p>
<p><strong>crontab 的命令格式：</strong></p>
<p><img src="/2020/12/15/linux-command/45b1947d455a43e71d169dba7ca042fea49b6968c1697f3433a1a92e12c5786c.png" alt="Thumbnail"></p>
<p><strong>crontab 的命令构成：</strong></p>
<p><code>时间 + 命令</code>，其时间有<strong>分、时、日、月、周</strong>五种，时间的操作符有：</p>
<ul>
<li><span style="color:red;">*****</span>：取值范围内的所有数字</li>
<li><span style="color:red;"><strong>/</strong></span>：每过多少个数字，间隔频率，例如：用在小时段的”*/2”表示每隔两小时</li>
<li><span style="color:red;"><strong>-</strong></span>：从X到Z，例如：”2-6”表示”2,3,4,5,6”</li>
<li><span style="color:red;"><strong>,</strong></span>：散列数字，例如：”1,2,5,7”</li>
</ul>
<p><strong>crontab 的命令实例：</strong></p>
<ul>
<li>每 2 小时执行一次：<code>0 */2 * * * command</code></li>
</ul>
<blockquote>
<p>上述命令的含义：能被2整除的整点的0分，执行命令，即 0、2、4、6、…、20、22、24。</p>
</blockquote>
<p><strong>crontab 的日志查看：</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tail -f /var/<span class="built_in">log</span>/cron.log</span><br><span class="line">$ tail -f /var/spool/mail/[username]</span><br></pre></td></tr></table></figure>

<p><strong>注意事项：</strong></p>
<ol>
<li><strong>环境变量问题</strong></li>
</ol>
<p>有时我们创建了一个 crontab，但是这个任务却无法自动执行，而手动执行这个任务却没有问题，这种情况一般是由于在 crontab 文件中没有配置环境变量引起的。</p>
<p>在 crontab 文件中定义多个调度任务时，需要特别注环境变量的设置，因为我们手动执行某个任务时，是在当前 shell 环境下进行的，程序当然能找到环境变量，而系统自动执行任务调度时，是不会加载任何环境变量的，因此，就需要在 crontab 文件中指定任务运行所需的所有环境变量，这样，系统执行任务调度时就没有问题了。</p>
<p>不要假定 cron 知道所需要的特殊环境，它其实并不知道。所以你要保证在 shell 脚本中提供所有必要的路径和环境变量，除了一些自动设置的全局变量。所以注意如下 3 点：</p>
<ul>
<li><p>脚本中涉及文件路径时写全局路径；</p>
</li>
<li><p>脚本执行要用到 java 或其他环境变量时，通过 source 命令引入环境变量，如：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cat start_cbp.sh</span><br><span class="line">!/bin/sh</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="built_in">export</span> RUN_CONF=/home/d139/conf/platform/cbp/cbp_jboss.conf</span><br><span class="line">/usr/<span class="built_in">local</span>/jboss-4.0.5/bin/run.sh -c mev &amp;</span><br></pre></td></tr></table></figure>

<ul>
<li>或者通过在 crontab 中直接引入环境变量解决问题。如：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 * * * * . /etc/profile;/bin/sh /var/www/java/audit_no_count/bin/restart_audit.sh</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>及时清理系统用户的邮件日志</strong></li>
</ol>
<p>每条任务调度执行完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行，因此，将每条任务进行重定向处理非常重要。 例如，可以在 crontab 文件中设置如下形式，忽略日志输出：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 */3 * * * /usr/<span class="built_in">local</span>/apache2/apachectl restart &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>“&gt;/dev/null 2&gt;&amp;1” 表示先将标准输出重定向到 /dev/null，然后将标准错误重定向到标准输出，由于标准输出已经重定向到了 /dev/null，因此标准错误也会重定向到 /dev/null，这样日志输出问题就解决了。</p>
<ol start="3">
<li><strong>其他注意事项</strong></li>
</ol>
<p>新创建的 cron job，不会马上执行，至少要过 2 分钟才执行。如果重启 cron 则马上执行。</p>
<p>当 crontab 失效时，可以尝试 <code>/etc/init.d/crond restart</code> 解决问题。或者查看日志看某个 job 有没有执行/报错 <code>tail -f /var/log/cron</code>。</p>
<p>**千万别乱运行 <code>crontab -r</code>**。它从 crontab 目录 (/var/spool/cron) 中删除用户的 crontab 文件，删除了该文件，则用户的所有 crontab 都没了。</p>
<p>在 crontab 中 % 是有特殊含义的，表示换行的意思。如果要用的话必须进行转义 %，如经常用的 date ‘+%Y%m%d’ 在 crontab 里是不会执行的，应该换成 date ‘+%Y%m%d’。</p>
<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html">https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html</a></p>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000021815907">https://segmentfault.com/a/1190000021815907</a></p>
<h2 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h2><p>用于为文件或目录改名、或将文件或目录移入其它位置。</p>
<h3 id="语法-6"><a href="#语法-6" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	mv [OPTION]... [-T] SOURCE DEST</span><br><span class="line">or: mv [OPTION]... SOURCE... DIRECTORY</span><br><span class="line">or: mv [OPTION]... -t DIRECTORY SOURCE...</span><br></pre></td></tr></table></figure>

<h3 id="参数说明-6"><a href="#参数说明-6" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-b</span><br><span class="line">	当目标文件或目录sh存在时，在执行覆盖前，会为其创建一个备份。</span><br><span class="line"></span><br><span class="line">-i</span><br><span class="line">	如果指定移动的源目录或文件与目标的目录或文件同名，则会先询问是否覆盖旧文件，输入y表示直接覆盖，输入n表示取消该操作。</span><br><span class="line"></span><br><span class="line">-f</span><br><span class="line">	如果指定移动的源目录或文件与目标的目录或文件同名，不会询问，直接覆盖旧文件。</span><br><span class="line"></span><br><span class="line">-n</span><br><span class="line">	不要覆盖任何已存在的文件或目录。</span><br><span class="line"></span><br><span class="line">-u</span><br><span class="line">	当源文件比目标文件新或者目标文件不存在时，才执行移动操作。</span><br></pre></td></tr></table></figure>

<h3 id="实例-6"><a href="#实例-6" class="headerlink" title="实例"></a>实例</h3><ul>
<li>将源文件名 source_file 改为目标文件名 dest_file</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv source_file(文件) dest_file(文件)</span><br></pre></td></tr></table></figure>

<ul>
<li>将文件 source_file 移动到目标目录 dest_directory 中</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv source_file(文件) dest_directory(目录)</span><br></pre></td></tr></table></figure>

<ul>
<li>将源目录 source_directory 移动到 目标目录 dest_directory中</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv source_directory(目录) dest_directory(目录)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>若目录名 dest_directory 已存在，则 source_directory 移动到目录名 dest_directory 中；</p>
<p>若目录名 dest_directory 不存在，则 source_directory 改名为目录名 dest_directory。</p>
</blockquote>
<h2 id="rename"><a href="#rename" class="headerlink" title="rename"></a>rename</h2><p>用于实现文件或批量文件重命名。在不同的 linux 版本，命令的语法格式可能不同。</p>
<h3 id="语法-7"><a href="#语法-7" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename [ -h|-m|-V ] [ -v ] [ -n ] [ -f ] [ -e|-E *perlexpr*]*|*perlexpr* [ *files* ]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>linux 版本：</p>
<p>Linux version 4.4.0-116-generic (buildd@lgw01-amd64-021) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9) ) #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018</p>
</blockquote>
<p>或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename [options] expression replacement file...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>linux 版本：</p>
<p>Linux version 3.10.0-1062.el7.x86_64 (<a href="mailto:&#109;&#111;&#99;&#x6b;&#98;&#117;&#x69;&#108;&#100;&#x40;&#x6b;&#x62;&#x75;&#105;&#108;&#x64;&#x65;&#x72;&#46;&#98;&#x73;&#121;&#x73;&#x2e;&#99;&#x65;&#x6e;&#116;&#111;&#115;&#46;&#x6f;&#x72;&#x67;">&#109;&#111;&#99;&#x6b;&#98;&#117;&#x69;&#108;&#100;&#x40;&#x6b;&#x62;&#x75;&#105;&#108;&#x64;&#x65;&#x72;&#46;&#98;&#x73;&#121;&#x73;&#x2e;&#99;&#x65;&#x6e;&#116;&#111;&#115;&#46;&#x6f;&#x72;&#x67;</a>) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-36) (GCC) ) #1 SMP Wed Aug 7 18:08:02 UTC 2019</p>
</blockquote>
<h3 id="参数说明-7"><a href="#参数说明-7" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-v, -verbose</span><br><span class="line">        Verbose: <span class="built_in">print</span> names of files successfully renamed.</span><br><span class="line">-n, -nono</span><br><span class="line">        No action: <span class="built_in">print</span> names of files to be renamed, but don<span class="string">&#x27;t rename.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-f, -force</span></span><br><span class="line"><span class="string">        Over write: allow existing files to be over-written.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-h, -help</span></span><br><span class="line"><span class="string">        Help: print SYNOPSIS and OPTIONS.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-m, -man</span></span><br><span class="line"><span class="string">        Manual: print manual page.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-V, -version</span></span><br><span class="line"><span class="string">        Version: show version number.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-e      Expression: code to act on files name.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        May be repeated to build up code (like &quot;perl -e&quot;). If no -e, the</span></span><br><span class="line"><span class="string">        first argument is used as code.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-E      Statement: code to act on files name, as -e but terminated by</span></span><br><span class="line"><span class="string">        &#x27;</span>;<span class="string">&#x27;.</span></span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-v, --verbose  explain what is being <span class="keyword">done</span></span><br><span class="line">-s, --symlink  act on symlink target</span><br><span class="line"></span><br><span class="line">-h, --<span class="built_in">help</span>     display this <span class="built_in">help</span> and <span class="built_in">exit</span></span><br><span class="line">-V, --version  output version information and <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h3 id="实例-7"><a href="#实例-7" class="headerlink" title="实例"></a>实例</h3><ul>
<li>替换文件名中特定字段</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rename -v <span class="string">&quot;s/20/patent-application/&quot;</span> *.tar.gz</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lin @ lin in ~/share/storage_server_3/Download/test [14:52:08] </span></span><br><span class="line">$ ll</span><br><span class="line">total 76G</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.3G Dec  4 16:54 2005.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.3G Dec  5 21:50 2006.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.4G Dec  5 21:52 2007.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.7G Dec  5 21:53 2008.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 5.0G Dec  7 22:10 2009.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># lin @ lin in ~/share/storage_server_3/Download/test [14:52:08] </span></span><br><span class="line">$ rename -v <span class="string">&quot;s/20/patent-application/&quot;</span> *.tar.gz</span><br><span class="line">2005.tar.gz renamed as patent-application05.tar.gz</span><br><span class="line">2006.tar.gz renamed as patent-application06.tar.gz</span><br><span class="line">2007.tar.gz renamed as patent-application07.tar.gz</span><br><span class="line">2008.tar.gz renamed as patent-application08.tar.gz</span><br><span class="line">2009.tar.gz renamed as patent-application09.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># lin @ lin in ~/share/storage_server_3/Download/test [14:53:55] </span></span><br><span class="line">$ ll</span><br><span class="line">total 76G</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.3G Dec  4 16:54 patent-application05.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.3G Dec  5 21:50 patent-application06.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.4G Dec  5 21:52 patent-application07.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 4.7G Dec  5 21:53 patent-application08.tar.gz</span><br><span class="line">-rw-rw-r-- 1 lin lin 5.0G Dec  7 22:10 patent-application09.tar.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rename 20 patent-application-20 *.tar.gz</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(base) [hadoop@client version-1.0]$ ll</span><br><span class="line">total 79555796</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4527645498 Dec  4 16:54 2005.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4550889304 Dec  5 21:50 2006.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4712276001 Dec  5 21:52 2007.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4986740725 Dec  5 21:53 2008.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 5311490484 Dec  7 22:10 2009.tar.gz</span><br><span class="line">(base) [hadoop@client version-1.0]$ rename 20 patent-application-20 *.tar.gz</span><br><span class="line">(base) [hadoop@client version-1.0]$ ll</span><br><span class="line">total 79555796</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop       1372 Dec 16 09:15 hash_calculate.txt</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4527645498 Dec  4 16:54 patent-application-2005.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4550889304 Dec  5 21:50 patent-application-2006.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4712276001 Dec  5 21:52 patent-application-2007.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 4986740725 Dec  5 21:53 patent-application-2008.tar.gz</span><br><span class="line">-rw-rw-r-- 1 hadoop hadoop 5311490484 Dec  7 22:10 patent-application-2009.tar.gz</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="http://einverne.github.io/post/2018/01/rename-files-batch.html">http://einverne.github.io/post/2018/01/rename-files-batch.html</a></p>
<h2 id="unzip"><a href="#unzip" class="headerlink" title="unzip"></a>unzip</h2><p>用于解压缩 .zip 文件。</p>
<h3 id="语法-8"><a href="#语法-8" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">	unzip [-cflptuvz][-agCjLMnoqsVX][-P &lt;密码&gt;][.zip文件][文件][-d &lt;目录&gt;][-x &lt;文件&gt;]</span><br><span class="line">or: unzip [-Z]</span><br></pre></td></tr></table></figure>

<h3 id="参数说明-8"><a href="#参数说明-8" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">-c</span><br><span class="line">	将解压缩的结果显示到屏幕上，并对字符做适当的转换。</span><br><span class="line"></span><br><span class="line">-f</span><br><span class="line">	更新现有的文件。</span><br><span class="line"></span><br><span class="line">-l</span><br><span class="line">	显示压缩文件内所包含的文件。</span><br><span class="line"></span><br><span class="line">-p</span><br><span class="line">	与-c参数类似，会将解压缩的结果显示到屏幕上，但不会执行任何的转换。</span><br><span class="line"></span><br><span class="line">-t</span><br><span class="line">	检查压缩文件是否正确。</span><br><span class="line"></span><br><span class="line">-u</span><br><span class="line">	与-f参数类似，但是除了更新现有的文件外，也会将压缩文件中的其他文件解压缩到目录中。</span><br><span class="line"></span><br><span class="line">-v</span><br><span class="line">	查看压缩文件目录信息，但是不解压该文件。</span><br><span class="line"></span><br><span class="line">-z</span><br><span class="line">	仅显示压缩文件的备注文字。</span><br><span class="line"></span><br><span class="line">-a</span><br><span class="line">	对文本文件进行必要的字符转换。</span><br><span class="line"></span><br><span class="line">-b</span><br><span class="line">	不要对文本文件进行字符转换。</span><br><span class="line"></span><br><span class="line">-C</span><br><span class="line">	压缩文件中的文件名称区分大小写。</span><br><span class="line"></span><br><span class="line">-j</span><br><span class="line">	不处理压缩文件中原有的目录路径。</span><br><span class="line"></span><br><span class="line">-L</span><br><span class="line">	将压缩文件中的全部文件名改为小写。</span><br><span class="line"></span><br><span class="line">-M</span><br><span class="line">	将输出结果送到more程序处理。</span><br><span class="line"></span><br><span class="line">-n</span><br><span class="line">	解压缩时不要覆盖原有的文件。</span><br><span class="line"></span><br><span class="line">-o</span><br><span class="line">	不必先询问用户，unzip执行后覆盖原有文件。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-q</span><br><span class="line">	执行时不显示任何信息。</span><br><span class="line"></span><br><span class="line">-s</span><br><span class="line">	将文件名中的空白字符转换为底线字符。</span><br><span class="line"></span><br><span class="line">-V</span><br><span class="line">	保留VMS的文件版本信息。</span><br><span class="line"></span><br><span class="line">-X</span><br><span class="line">	解压缩时同时回存文件原来的UID/GID。</span><br><span class="line"></span><br><span class="line">-P &lt;密码&gt;</span><br><span class="line">	使用zip的密码选项。</span><br><span class="line"></span><br><span class="line">[.zip文件]</span><br><span class="line">	指定.zip压缩文件。</span><br><span class="line"></span><br><span class="line">[文件]</span><br><span class="line">	指定要处理.zip压缩文件中的哪些文件。</span><br><span class="line"></span><br><span class="line">-d &lt;目录&gt;</span><br><span class="line">	指定文件解压缩后所要存储的目录。</span><br><span class="line"></span><br><span class="line">-x &lt;文件&gt;</span><br><span class="line">	指定不要处理.zip压缩文件中的哪些文件。</span><br><span class="line"></span><br><span class="line">-Z</span><br><span class="line">    <span class="string">&#x27;unzip -Z&#x27;</span>等于执行zipinfo指令。</span><br></pre></td></tr></table></figure>

<h3 id="实例-8"><a href="#实例-8" class="headerlink" title="实例"></a>实例</h3><ul>
<li>查看压缩文件目录信息，但不解压</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ unzip -v I20090212-SUPP.ZIP </span><br><span class="line">Archive:  I20090212-SUPP.ZIP</span><br><span class="line"> Length   Method    Size  Cmpr    Date    Time   CRC-32   Name</span><br><span class="line">--------  ------  ------- ---- ---------- ----- --------  ----</span><br><span class="line">       0  Stored        0   0% 2009-01-31 04:56 00000000  project/pdds/ICEApplication/I20090212-SUPP/</span><br><span class="line">       0  Stored        0   0% 2009-01-31 04:56 00000000  project/pdds/ICEApplication/I20090212-SUPP/DTDS/</span><br><span class="line">   88199  Stored    88199   0% 2007-01-22 00:07 d5e3060f  project/pdds/ICEApplication/I20090212-SUPP/DTDS/DTDS.zip</span><br><span class="line">       0  Stored        0   0% 2009-01-31 04:56 00000000  project/pdds/ICEApplication/I20090212-SUPP/UTIL0041/</span><br><span class="line">   15664  Stored    15664   0% 2009-01-28 22:45 3dfa6c1c  project/pdds/ICEApplication/I20090212-SUPP/UTIL0041/US20090041797A1-20090212-SUPP.ZIP</span><br><span class="line">       0  Stored        0   0% 2009-01-31 04:56 00000000  project/pdds/ICEApplication/I20090212-SUPP/UTIL0044/</span><br><span class="line">  901714  Stored   901714   0% 2009-01-28 22:45 75ce3ca6  project/pdds/ICEApplication/I20090212-SUPP/UTIL0044/US20090044288A1-20090212-SUPP.ZIP</span><br><span class="line"> 1911858  Stored  1911858   0% 2009-01-28 22:45 cbc1d0bd  project/pdds/ICEApplication/I20090212-SUPP/UTIL0044/US20090044297A1-20090212-SUPP.ZIP</span><br><span class="line">--------          -------  ---                            -------</span><br><span class="line"> 2917435          2917435   0%                            8 files</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>解压 .zip 文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ unzip I20090212-SUPP.ZIP </span><br><span class="line">Archive:  I20090212-SUPP.ZIP</span><br><span class="line">   creating: project/pdds/ICEApplication/I20090212-SUPP/</span><br><span class="line">   creating: project/pdds/ICEApplication/I20090212-SUPP/DTDS/</span><br><span class="line"> extracting: project/pdds/ICEApplication/I20090212-SUPP/DTDS/DTDS.zip  </span><br><span class="line">   creating: project/pdds/ICEApplication/I20090212-SUPP/UTIL0041/</span><br><span class="line"> extracting: project/pdds/ICEApplication/I20090212-SUPP/UTIL0041/US20090041797A1-20090212-SUPP.ZIP  </span><br><span class="line">   creating: project/pdds/ICEApplication/I20090212-SUPP/UTIL0044/</span><br><span class="line"> extracting: project/pdds/ICEApplication/I20090212-SUPP/UTIL0044/US20090044288A1-20090212-SUPP.ZIP  </span><br><span class="line"> extracting: project/pdds/ICEApplication/I20090212-SUPP/UTIL0044/US20090044297A1-20090212-SUPP.ZIP </span><br></pre></td></tr></table></figure>

<ul>
<li>解压 .zip 文件，但不显示信息</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ unzip -q I20090212-SUPP.ZIP</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：如果压缩文件 .zip 是大于 2G 的，那 unzip 就无法使用，此时可以使用 7zip 解压。</p>
</blockquote>
<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.bbsmax.com/A/lk5aMEAP51/">https://www.bbsmax.com/A/lk5aMEAP51/</a></p>
<h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>用于压缩文件，压缩后的文件后缀名为 .zip。</p>
<h3 id="语法-9"><a href="#语法-9" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip [-AcdDfFghjJKlLmoqrSTuvVwXyz$] [-b &lt;工作目录&gt;] [-ll] [-n &lt;字尾字符串&gt;] [-t &lt;日期时间&gt;] [-&lt;压缩效率&gt;] [压缩文件] [文件...] [-i &lt;范本样式&gt;] [-x &lt;范本样式&gt;]</span><br></pre></td></tr></table></figure>

<h3 id="参数说明-9"><a href="#参数说明-9" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">-A</span><br><span class="line">	调整可执行的自动解压缩文件。</span><br><span class="line">	</span><br><span class="line">-c</span><br><span class="line">	替每个被压缩的文件加上注释。</span><br><span class="line"></span><br><span class="line">-d</span><br><span class="line">	从压缩文件内删除指定的文件。</span><br><span class="line"></span><br><span class="line">-D</span><br><span class="line">	压缩文件内不建立目录名称。</span><br><span class="line"></span><br><span class="line">-f</span><br><span class="line">	更新现有的文件。</span><br><span class="line"></span><br><span class="line">-F</span><br><span class="line">	尝试修复已损坏的压缩文件。</span><br><span class="line"></span><br><span class="line">-g</span><br><span class="line">	将文件压缩后附加在既有的压缩文件之后，而非另行建立新的压缩文件。</span><br><span class="line"></span><br><span class="line">-h</span><br><span class="line">	在线帮助。</span><br><span class="line"></span><br><span class="line">-j</span><br><span class="line">	只保存文件名称及其内容，而不存放任何目录名称。</span><br><span class="line"></span><br><span class="line">-J</span><br><span class="line">	删除压缩文件前面不必要的数据。</span><br><span class="line">	</span><br><span class="line">-k</span><br><span class="line">	使用MS-DOS兼容格式的文件名称。</span><br><span class="line">	</span><br><span class="line">-l</span><br><span class="line">	压缩文件时，把LF字符置换成LF+CR字符。</span><br><span class="line"></span><br><span class="line">-L</span><br><span class="line">	显示版权信息。</span><br><span class="line"></span><br><span class="line">-m</span><br><span class="line">	将文件压缩并加入压缩文件后，删除原始文件，即把文件移到压缩文件中。</span><br><span class="line"></span><br><span class="line">-o</span><br><span class="line">	以压缩文件内拥有最新更改时间的文件为准，将压缩文件的更改时间设成和该文件相同。</span><br><span class="line"></span><br><span class="line">-q</span><br><span class="line">	不显示指令执行过程。</span><br><span class="line"></span><br><span class="line">-r</span><br><span class="line">	递归处理，将指定目录下的所有文件和子目录一并处理。</span><br><span class="line"></span><br><span class="line">-S</span><br><span class="line">	包含系统和隐藏文件。</span><br><span class="line"></span><br><span class="line">-T</span><br><span class="line">	检查备份文件内的每个文件是否正确无误。</span><br><span class="line"></span><br><span class="line">-u</span><br><span class="line">	与-f参数类似，但是除了更新现有的文件外，也会将压缩文件中的其他文件解压缩到目录中。</span><br><span class="line"></span><br><span class="line">-v</span><br><span class="line">	显示指令执行过程或显示版本信息。</span><br><span class="line"></span><br><span class="line">-V</span><br><span class="line">	保存VMS操作系统的文件属性。</span><br><span class="line"></span><br><span class="line">-w</span><br><span class="line">	在文件名称里假如版本编号，本参数仅在VMS操作系统下有效。</span><br><span class="line"></span><br><span class="line">-X</span><br><span class="line">	不保存额外的文件属性。</span><br><span class="line"></span><br><span class="line">-y</span><br><span class="line">	直接保存符号连接，而非该连接所指向的文件，本参数仅在UNIX之类的系统下有效。</span><br><span class="line"></span><br><span class="line">-z</span><br><span class="line">	替压缩文件加上注释。</span><br><span class="line"></span><br><span class="line">-$</span><br><span class="line">	保存第一个被压缩文件所在磁盘的卷册名称。</span><br><span class="line">	</span><br><span class="line">-b &lt;工作目录&gt;</span><br><span class="line">	指定暂时存放文件的目录。</span><br><span class="line">	</span><br><span class="line">-ll</span><br><span class="line">	压缩文件时，把LF+CR字符置换成LF字符。</span><br><span class="line"></span><br><span class="line">-n &lt;字尾字符串&gt;</span><br><span class="line">	不压缩具有特定字尾字符串的文件。</span><br><span class="line"></span><br><span class="line">-t &lt;日期时间&gt;</span><br><span class="line">	把压缩文件的日期设成指定的日期。</span><br><span class="line"></span><br><span class="line">-&lt;压缩效率&gt;</span><br><span class="line">	压缩效率是一个介于1-9的数值。</span><br><span class="line"></span><br><span class="line">-i &lt;范本样式&gt;</span><br><span class="line">	只压缩符合条件的文件。</span><br><span class="line"></span><br><span class="line">-x &lt;范本样式&gt;</span><br><span class="line">	压缩时排除符合条件的文件。</span><br></pre></td></tr></table></figure>

<h3 id="实例-9"><a href="#实例-9" class="headerlink" title="实例"></a>实例</h3><ul>
<li>将 /home/html/ 目录下所有文件和文件夹打包为当前目录下的 html.zip</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zip -q -r html.zip /home/html</span><br></pre></td></tr></table></figure>

<ul>
<li>如果当前在 /home/html 目录下，可以执行以下命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zip -q -r html.zip *</span><br></pre></td></tr></table></figure>

<ul>
<li>从压缩文件 cp.zip 中删除文件 a.c</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -dv cp.zip a.c</span><br></pre></td></tr></table></figure>

<h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><p>用于打包、解包文件。</p>
<blockquote>
<p>tar 本身不具有压缩功能，可以通过参数调用其他压缩工具实现压缩功能。 </p>
</blockquote>
<h3 id="语法-10"><a href="#语法-10" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar [-ABcdgGhiklmMoOpPrRsStuUvwWxzZ] [-b &lt;区块数目&gt;] [-C &lt;目的目录&gt;] [-f &lt;备份文件&gt;] [-F &lt;Script文件&gt;] [-K &lt;文件&gt;] [-L &lt;媒体容量&gt;] [-N &lt;日期时间&gt;] [-T &lt;范本文件&gt;] [-V &lt;卷册名称&gt;] [-X &lt;范本文件&gt;] [-&lt;设备编号&gt;&lt;存储密度&gt;] [--after-date=&lt;日期时间&gt;] [--atime-preserve] [--backuup=&lt;备份方式&gt;] [--checkpoint] [--concatenate] [--confirmation] [--delete] [--exclude=&lt;范本样式&gt;] [--force-local] [--group=&lt;群组名称&gt;] [--<span class="built_in">help</span>] [--ignore-failed-read] [--new-volume-script=&lt;Script文件&gt;] [--newer-mtime] [--no-recursion] [--null] [--numeric-owner] [--owner=&lt;用户名称&gt;] [--posix] [--erve] [--preserve-order] [--preserve-permissions] [--record-size=&lt;区块数目&gt;] [--recursive-unlink] [--remove-files] [--rsh-command=&lt;执行指令&gt;] [--same-owner] [--suffix=&lt;备份字尾字符串&gt;] [--totals] [--use-compress-program=&lt;执行指令&gt;] [--version] [--volno-file=&lt;编号文件&gt;] [文件或目录...]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>语法结构：<code>tar [必要参数] [可选参数] [文件]</code></p>
</blockquote>
<h3 id="参数说明-10"><a href="#参数说明-10" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line">-A | --catenate</span><br><span class="line">		新增文件到已存在的备份文件。</span><br><span class="line">		</span><br><span class="line">-B | --read-full-records</span><br><span class="line">		读取数据时重设区块大小。</span><br><span class="line">		</span><br><span class="line">-c | --create</span><br><span class="line">		建立新的备份文件。</span><br><span class="line">		</span><br><span class="line">-d | --diff | --compare</span><br><span class="line">		对比备份文件内和文件系统上的文件的差异。</span><br><span class="line">		</span><br><span class="line">-g | --listed-incremental</span><br><span class="line">		处理GNU格式的大量备份。</span><br><span class="line">		</span><br><span class="line">-G | --incremental</span><br><span class="line">		处理旧的GNU格式的大量备份。</span><br><span class="line">		</span><br><span class="line">-h | --dereference</span><br><span class="line">		不建立符号连接，直接复制该连接所指向的原始文件。</span><br><span class="line">		</span><br><span class="line">-i | --ignore-zeros</span><br><span class="line">		忽略备份文件中的0 Byte区块，也就是EOF。</span><br><span class="line">		</span><br><span class="line">-k | --keep-old-files</span><br><span class="line">		解开备份文件时，不覆盖已有的文件。</span><br><span class="line">		</span><br><span class="line">-l | --one-file-system</span><br><span class="line">		复制的文件或目录存放的文件系统，必须与tar指令执行时所处的文件系统相同，否则不予复制。</span><br><span class="line">		</span><br><span class="line">-m | --modification-time</span><br><span class="line">		还原文件时，不变更文件的更改时间。</span><br><span class="line">		</span><br><span class="line">-M | --multi-volume</span><br><span class="line">		在建立，还原备份文件或列出其中的内容时，采用多卷册模式。</span><br><span class="line">		</span><br><span class="line">-o | --old-archive | --portability</span><br><span class="line">		将资料写入备份文件时使用V7格式。</span><br><span class="line">		</span><br><span class="line">-O | --stdout</span><br><span class="line">		把从备份文件里还原的文件输出到标准输出设备。</span><br><span class="line">		</span><br><span class="line">-p | --same-permissions</span><br><span class="line">		用原来的文件权限还原文件。</span><br><span class="line">		</span><br><span class="line">-P | --absolute-names</span><br><span class="line">		文件名使用绝对名称，不移除文件名称前的<span class="string">&quot;/&quot;</span>号。</span><br><span class="line">		</span><br><span class="line">-r | --append</span><br><span class="line">		新增文件到已存在的备份文件的结尾部分。</span><br><span class="line">		</span><br><span class="line">-R | --block-number</span><br><span class="line">		列出每个信息在备份文件中的区块编号。</span><br><span class="line">		</span><br><span class="line">-s | --same-order</span><br><span class="line">		还原文件的顺序和备份文件内的存放顺序相同。</span><br><span class="line">		</span><br><span class="line">-S | --sparse</span><br><span class="line">		倘若一个文件内含大量的连续0字节，则将此文件存成稀疏文件。</span><br><span class="line">		</span><br><span class="line">-t | --list</span><br><span class="line">		列出备份文件的内容。</span><br><span class="line">		</span><br><span class="line">-u | --update</span><br><span class="line">		仅置换较备份文件内的文件更新的文件。</span><br><span class="line">		</span><br><span class="line">-U | --unlink-first</span><br><span class="line">		解开压缩文件还原文件之前，先解除文件的连接。</span><br><span class="line">		</span><br><span class="line">-v | --verbose</span><br><span class="line">		显示指令执行过程。</span><br><span class="line">		</span><br><span class="line">-w | --interactive</span><br><span class="line">		遭遇问题时先询问用户。</span><br><span class="line">		</span><br><span class="line">-W | --verify</span><br><span class="line">		写入备份文件后，确认文件正确无误。</span><br><span class="line">		</span><br><span class="line">-x | --extract | --get</span><br><span class="line">		从备份文件中还原文件。</span><br><span class="line">		</span><br><span class="line">-z | --gzip | --ungzip</span><br><span class="line">		通过gzip指令处理备份文件。</span><br><span class="line">		</span><br><span class="line">-Z | --compress | --uncompress</span><br><span class="line">		通过compress指令处理备份文件。</span><br><span class="line"></span><br><span class="line">-b &lt;区块数目&gt; | --blocking-factor=&lt;区块数目&gt;</span><br><span class="line">		设置每笔记录的区块数目，每个区块大小为12Bytes。</span><br><span class="line"></span><br><span class="line">-C &lt;目的目录&gt; | --directory=&lt;目的目录&gt;</span><br><span class="line">		切换到指定的目录。</span><br><span class="line"></span><br><span class="line">-f &lt;备份文件&gt; | --file=&lt;备份文件&gt;</span><br><span class="line">		指定备份文件。多个命令时需要放在最后面。</span><br><span class="line">		</span><br><span class="line">-F &lt;Script文件&gt; | --info-script=&lt;Script文件&gt;</span><br><span class="line">		每次更换磁带时，就执行指定的Script文件。</span><br><span class="line"></span><br><span class="line">-K &lt;文件&gt; | --starting-file=&lt;文件&gt;</span><br><span class="line">		从指定的文件开始还原。</span><br><span class="line"></span><br><span class="line">-L &lt;媒体容量&gt; | -tape-length=&lt;媒体容量&gt;</span><br><span class="line">		设置存放每体的容量，单位以1024Bytes计算。</span><br><span class="line"></span><br><span class="line">-N &lt;日期格式&gt; | --newer=&lt;日期时间&gt;</span><br><span class="line">		只将较指定日期更新的文件保存到备份文件里。</span><br><span class="line"></span><br><span class="line">-T &lt;范本文件&gt; | --files-from=&lt;范本文件&gt;</span><br><span class="line">		指定范本文件，其内含有一个或多个范本样式，让tar解开或建立符合设置条件的文件。</span><br><span class="line"></span><br><span class="line">-V&lt;卷册名称&gt; | --label=&lt;卷册名称&gt;</span><br><span class="line">		建立使用指定的卷册名称的备份文件。</span><br><span class="line"></span><br><span class="line">-X &lt;范本文件&gt; | --exclude-from=&lt;范本文件&gt;</span><br><span class="line">		指定范本文件，其内含有一个或多个范本样式，让tar排除符合设置条件的文件。</span><br><span class="line"></span><br><span class="line">-&lt;设备编号&gt;&lt;存储密度&gt;</span><br><span class="line">		设置备份用的外围设备编号及存放数据的密度。</span><br><span class="line">		</span><br><span class="line">--after-date=&lt;日期时间&gt;</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-N&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--atime-preserve</span><br><span class="line">		不变更文件的存取时间。</span><br><span class="line"></span><br><span class="line">--backup=&lt;备份方式&gt; | --backup</span><br><span class="line">		移除文件前先进行备份。</span><br><span class="line"></span><br><span class="line">--checkpoint</span><br><span class="line">		读取备份文件时列出目录名称。</span><br><span class="line"></span><br><span class="line">--concatenate</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-A&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--confirmation</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-w&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--delete</span><br><span class="line">		从备份文件中删除指定的文件。</span><br><span class="line"></span><br><span class="line">--exclude=&lt;范本样式&gt;</span><br><span class="line">		排除符合范本样式的文件。</span><br><span class="line"></span><br><span class="line">--group=&lt;群组名称&gt;</span><br><span class="line">		把加入设备文件中的文件的所属群组设成指定的群组。</span><br><span class="line"></span><br><span class="line">--<span class="built_in">help</span></span><br><span class="line">		在线帮助。</span><br><span class="line"></span><br><span class="line">--ignore-failed-read</span><br><span class="line">		忽略数据读取错误，不中断程序的执行。</span><br><span class="line"></span><br><span class="line">--new-volume-script=&lt;Script文件&gt;</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-F&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--newer-mtime</span><br><span class="line">		只保存更改过的文件。</span><br><span class="line"></span><br><span class="line">--no-recursion</span><br><span class="line">		不做递归处理，也就是指定目录下的所有文件及子目录不予处理。</span><br><span class="line"></span><br><span class="line">--null</span><br><span class="line">		从null设备读取文件名称。</span><br><span class="line"></span><br><span class="line">--numeric-owner</span><br><span class="line">		以用户识别码及群组识别码取代用户名称和群组名称。</span><br><span class="line"></span><br><span class="line">--owner=&lt;用户名称&gt;</span><br><span class="line">		把加入备份文件中的文件的拥有者设成指定的用户。</span><br><span class="line"></span><br><span class="line">--posix</span><br><span class="line">		将数据写入备份文件时使用POSIX格式。</span><br><span class="line"></span><br><span class="line">--preserve</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-ps&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--preserve-order</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-A&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--preserve-permissions</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-p&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--record-size=&lt;区块数目&gt;</span><br><span class="line">		此参数的效果和指定<span class="string">&quot;-b&quot;</span>参数相同。</span><br><span class="line"></span><br><span class="line">--recursive-unlink</span><br><span class="line">		解开压缩文件还原目录之前，先解除整个目录下所有文件的连接。</span><br><span class="line"></span><br><span class="line">--remove-files</span><br><span class="line">		文件加入备份文件后，就将其删除。</span><br><span class="line"></span><br><span class="line">--rsh-command=&lt;执行指令&gt;</span><br><span class="line">		设置要在远端主机上执行的指令，以取代rsh指令。</span><br><span class="line"></span><br><span class="line">--same-owner</span><br><span class="line">		尝试以相同的文件拥有者还原文件。</span><br><span class="line"></span><br><span class="line">--suffix=&lt;备份字尾字符串&gt;</span><br><span class="line">		移除文件前先行备份。</span><br><span class="line"></span><br><span class="line">--totals</span><br><span class="line">		备份文件建立后，列出文件大小。</span><br><span class="line"></span><br><span class="line">--use-compress-program=&lt;执行指令&gt;</span><br><span class="line">		通过指定的指令处理备份文件。</span><br><span class="line"></span><br><span class="line">--version</span><br><span class="line">		显示版本信息。</span><br><span class="line"></span><br><span class="line">--volno-file=&lt;编号文件&gt;</span><br><span class="line">		使用指定文件内的编号取代预设的卷册编号。</span><br></pre></td></tr></table></figure>

<h3 id="实例-10"><a href="#实例-10" class="headerlink" title="实例"></a>实例</h3><ul>
<li>打包，不压缩</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -cvf test.tar <span class="built_in">test</span></span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>解包</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -xvf test.tar </span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>打包，并以 <strong>gzip</strong> 压缩</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zcvf test.tar.gz <span class="built_in">test</span></span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在参数 f 之后的文件档名是自己取的，我们习惯上都用 .tar 来作为辨识。 如果加 z 参数，则以 .tar.gz 或 .tgz 来代表 gzip 压缩过的 tar 包。</p>
</blockquote>
<ul>
<li>解压 .tar.gz</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zxvf test.tar.gz </span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>打包，以 <strong>bzip2</strong> 压缩</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zcvf test.tar.bz2 <span class="built_in">test</span></span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>解压 .tar.bz2</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zxvf test.tar.bz2 </span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>查看 .tar.gz 或 .tar.bz2 压缩包内的文件，但不解压</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ tar -ztvf test.tar.gz </span><br><span class="line">drwxrwxr-x lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/3</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/1</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/2</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/5</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/4</span><br><span class="line"></span><br><span class="line">$ tar -ztvf test.tar.bz2 </span><br><span class="line">drwxrwxr-x lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/3</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/1</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/2</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/5</span><br><span class="line">-rw-rw-r-- lin/lin           0 2020-12-21 11:38 <span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>解压 .tar.gz 压缩包内的部分文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zxvf test.tar.gz <span class="built_in">test</span>/2 <span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/2</span><br></pre></td></tr></table></figure>

<ul>
<li>解压 .tar.gz 到指定目录</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zxvf test.tar.gz -C ../Download </span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line"><span class="built_in">test</span>/3</span><br><span class="line"><span class="built_in">test</span>/1</span><br><span class="line"><span class="built_in">test</span>/2</span><br><span class="line"><span class="built_in">test</span>/5</span><br><span class="line"><span class="built_in">test</span>/4</span><br></pre></td></tr></table></figure>

<ul>
<li>使用绝对路径打包压缩和解压</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 压缩</span></span><br><span class="line">$ tar -zcPf /home/lin/share/storage_server_3/patent/grant-patent/patent_version-1.0/patent-grant-2019.tar.gz /home/lin/share/storage_server_3/patent/grant-patent/patent_version-1.0/2019</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">$ tar -zxPf patent-grant-2019.tar.gz</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>tar 对文件打包时，一般不建议使用绝对路径。</strong></p>
<p>如果使用绝对路径，需要加 -P 参数。如果不添加，会发出警告：<code>tar: Removing leading &#39;/&#39; from member names</code>。</p>
<p>对于使用绝对路径打包压缩的文件，解压时 tar 会在当前目录下创建压缩时的绝对路径所对应的目录，在上面例子中，即为在当前目录下创建一个子目录 <code>home/lin/share/storage_server_3/patent/grant-patent/patent_version-1.0</code>。</p>
<p>如果在解压时使用 -P 参数，需要保证系统存在压缩时的绝对路径。</p>
</blockquote>
<ul>
<li>使用 <strong>pigz</strong> 并发压缩和解压</li>
</ul>
<p>安装 pigz：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install pigz</span><br></pre></td></tr></table></figure>

<p>打包：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar --use-compress-program=pigz -cvpf package.tgz ./package</span><br></pre></td></tr></table></figure>

<p>解包：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar --use-compress-program=pigz -xvpf package.tgz -C ./package</span><br></pre></td></tr></table></figure>

<blockquote>
<p>pigz 是支持并行的 gzip，默认用当前逻辑 cpu 个数来并发压缩，无法检测个数的话，则并发 8 个线程。</p>
</blockquote>
<p>另一种方式：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法</span></span><br><span class="line">$ tar -cvpf - <span class="variable">$Dir</span> | pigz -9 -p 6 <span class="variable">$target</span>-name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实例</span></span><br><span class="line">$ tar -cvpf - /usr/bin | pigz -9 -p 6 bin.tgz</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-9：代表压缩率<br>-p ：代表 cpu 数量</p>
</blockquote>
<h2 id="time"><a href="#time" class="headerlink" title="time"></a>time</h2><p>用于检测特定指令执行时所需消耗的时间及系统资源 (内存和 I/O) 等资讯。</p>
<h3 id="语法-11"><a href="#语法-11" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time [options] COMMAND [arguments]</span><br></pre></td></tr></table></figure>

<h3 id="参数说明-11"><a href="#参数说明-11" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-o | --output=FILE</span><br><span class="line">			设定结果输出档。这个选项会将time的输出写入所指定的档案中。如果档案已经存在，系统将覆写其内容。</span><br><span class="line">		</span><br><span class="line">-a | --append</span><br><span class="line">			配合-o使用，会将结果写到档案的末端，而不会覆盖掉原来的内容。</span><br><span class="line">			</span><br><span class="line">-f FORMAT | --format=FORMAT</span><br><span class="line">			以FORMAT字串设定显示方式。当这个选项没有被设定的时候，会用系统预设的格式。不过你可以用环境变数time来设定这个格式，如此一来就不必每次登入系统都要设定一次。</span><br></pre></td></tr></table></figure>

<h3 id="实例-11"><a href="#实例-11" class="headerlink" title="实例"></a>实例</h3><ul>
<li>date 命令的运行时间</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ time date</span><br><span class="line">Tue Dec 22 12:01:50 CST 2020</span><br><span class="line">date  0.00s user 0.01s system 8% cpu 0.092 total</span><br></pre></td></tr></table></figure>

<ul>
<li>查找文件并复制的运行时间</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ time find /home/lin/share/storage_server_3/patent/application/unzip_version-1.0/2019 -iname <span class="string">&quot;*.xml&quot;</span> | xargs -P 6 -i cp &#123;&#125; /home/lin/share/storage_server_3/patent/application-patent/patent_version-1.0/2019 </span><br><span class="line">find  -iname <span class="string">&quot;*.xml&quot;</span>  24.00s user 114.39s system 1% cpu 2:08:02.95 total</span><br><span class="line">xargs -P 6 -i cp &#123;&#125;   4.35s user 28.35s system 0% cpu 2:08:02.99 total</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong></p>
<p><a target="_blank" rel="noopener" href="http://c.biancheng.net/linux/time.html">http://c.biancheng.net/linux/time.html</a></p>
<h2 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h2><h3 id="语法-12"><a href="#语法-12" class="headerlink" title="语法"></a>语法</h3><h3 id="参数说明-12"><a href="#参数说明-12" class="headerlink" title="参数说明"></a>参数说明</h3><h3 id="实例-12"><a href="#实例-12" class="headerlink" title="实例"></a>实例</h3><ul>
<li>创建多级目录</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p Project/a/src</span><br></pre></td></tr></table></figure>

<ul>
<li>创建多层次、多维度的目录树</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p Project/&#123;a,b,c,d&#125;/src</span><br></pre></td></tr></table></figure>

<h2 id="sh-c"><a href="#sh-c" class="headerlink" title="sh -c"></a>sh -c</h2><p>sh -c 命令，可以让 bash 将一个字串作为完整的命令来执行。</p>
<p>比如，向 test.asc 文件中随便写入点内容，可以：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;信息&quot;</span> &gt; test.asc</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;信息&quot;</span> &gt;&gt; test.asc</span><br></pre></td></tr></table></figure>

<p>下面，如果将 test.asc 权限设置为只有 root 用户才有权限进行写操作：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo chown root.root test.asc</span><br></pre></td></tr></table></figure>

<p>然后，我们使用 sudo 并配合 echo 命令再次向修改权限之后的 test.asc 文件中写入信息：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo <span class="built_in">echo</span> <span class="string">&quot;又一行信息&quot;</span> &gt;&gt; test.asc</span><br><span class="line">-bash: test.asc: Permission denied</span><br></pre></td></tr></table></figure>

<p>这时，可以看到 bash 拒绝这么做，说是权限不够。这是因为重定向符号 &gt; 和 &gt;&gt; 也是 bash 的命令。我们使用 sudo 只是让 echo 命令具有了 root 权限，但是没有让 &gt; 和 &gt;&gt; 命令也具有 root 权限，所以 bash 会认为这两个命令都没有向 test.asc 文件写入信息的权限。解决这一问题的途径有两种。</p>
<p>第一种是利用 sh -c 命令，它可以让 bash 将一个字串作为完整的命令来执行，这样就可以将 sudo 的影响范围扩展到整条命令。具体用法如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo sh -c <span class="string">&#x27;echo &quot;又一行信息&quot; &gt;&gt; test.asc&#x27;</span></span><br></pre></td></tr></table></figure>

<p>另一种方法是利用管道和 tee 命令，该命令可以从标准输入中读入信息并将其写入标准输出或文件中，具体用法如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;第三条信息&quot;</span> | sudo tee -a test.asc</span><br></pre></td></tr></table></figure>

<p>注意，tee 命令的 -a 选项的作用等同于 &gt;&gt; 命令，如果去除该选项，那么 tee 命令的作用就等同于 &gt; 命令。 </p>
<h2 id="1-gt-dev-null-2-gt-amp-1"><a href="#1-gt-dev-null-2-gt-amp-1" class="headerlink" title="1&gt;/dev/null 2&gt;&amp;1"></a>1&gt;/dev/null 2&gt;&amp;1</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ithomer/article/details/9288353">https://blog.csdn.net/ithomer/article/details/9288353</a></p>
<h2 id="top"><a href="#top" class="headerlink" title="top"></a>top</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e9e0ce23a152">https://www.jianshu.com/p/e9e0ce23a152</a></p>
<h2 id="free"><a href="#free" class="headerlink" title="free"></a>free</h2><h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><h2 id="md5sum"><a href="#md5sum" class="headerlink" title="md5sum"></a>md5sum</h2><h2 id="sha1sum"><a href="#sha1sum" class="headerlink" title="sha1sum"></a>sha1sum</h2><p>用来为给定的文件或文件夹计算单个哈希，以校验文件或文件夹的完整性。</p>
<p>给文件：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sha1sum patent-grant-2005.tar.gz </span><br><span class="line">77b6416501d34b904bd25f9aa32ca60d3e14659a  patent-grant-2005.tar.gz</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://www.itranslater.com/qa/details/2326085750774825984">https://www.itranslater.com/qa/details/2326085750774825984</a></p>
<h2 id="parallel"><a href="#parallel" class="headerlink" title="parallel"></a>parallel</h2><p><a target="_blank" rel="noopener" href="https://linux.cn/article-9718-1.html">https://linux.cn/article-9718-1.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.myfreax.com/gnu-parallel/">https://www.myfreax.com/gnu-parallel/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.hi-linux.com/posts/32794.html">https://www.hi-linux.com/posts/32794.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c5a2369fa613">https://www.jianshu.com/p/c5a2369fa613</a></p>
<p><a target="_blank" rel="noopener" href="https://www.aqee.net/post/use-multiple-cpu-cores-with-your-linux-commands.html">https://www.aqee.net/post/use-multiple-cpu-cores-with-your-linux-commands.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/orangefly0214/article/details/103701600">https://blog.csdn.net/orangefly0214/article/details/103701600</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="XiSun"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">XiSun</p>
  <div class="site-description" itemprop="description">心如止水者，虽世间繁华之红尘纷扰，已然空无一物</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">33</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XiSun</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">528k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">8:01</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
